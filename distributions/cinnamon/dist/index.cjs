'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var require$$0$4 = require('fs');
var require$$0$3 = require('util');
var require$$0$5 = require('path');
var require$$1$1 = require('os');
var require$$1 = require('tty');
var require$$0$6 = require('stream');
var require$$0$7 = require('events');
var require$$0$8 = require('constants');
var require$$5$1 = require('assert');
var Module = require('module');
var crypto$3 = require('crypto');
var require$$0$9 = require('domain');
var require$$0$a = require('url');
var require$$0$b = require('buffer');
var require$$2 = require('http');
var require$$1$2 = require('net');
var require$$5$2 = require('querystring');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

function _interopNamespace(e) {
  if (e && e.__esModule) return e;
  var n = Object.create(null);
  if (e) {
    Object.keys(e).forEach(function (k) {
      if (k !== 'default') {
        var d = Object.getOwnPropertyDescriptor(e, k);
        Object.defineProperty(n, k, d.get ? d : {
          enumerable: true,
          get: function () { return e[k]; }
        });
      }
    });
  }
  n["default"] = e;
  return Object.freeze(n);
}

function _mergeNamespaces(n, m) {
  m.forEach(function (e) {
    Object.keys(e).forEach(function (k) {
      if (k !== 'default' && !(k in n)) {
        var d = Object.getOwnPropertyDescriptor(e, k);
        Object.defineProperty(n, k, d.get ? d : {
          enumerable: true,
          get: function () { return e[k]; }
        });
      }
    });
  });
  return Object.freeze(n);
}

var require$$0__namespace = /*#__PURE__*/_interopNamespace(require$$0$4);
var require$$0__default$3 = /*#__PURE__*/_interopDefaultLegacy(require$$0$4);
var require$$0__default$2 = /*#__PURE__*/_interopDefaultLegacy(require$$0$3);
var require$$0__namespace$1 = /*#__PURE__*/_interopNamespace(require$$0$5);
var require$$0__default$1 = /*#__PURE__*/_interopDefaultLegacy(require$$0$5);
var require$$1__default$1 = /*#__PURE__*/_interopDefaultLegacy(require$$1$1);
var require$$1__default = /*#__PURE__*/_interopDefaultLegacy(require$$1);
var require$$0__default = /*#__PURE__*/_interopDefaultLegacy(require$$0$6);
var require$$0__default$4 = /*#__PURE__*/_interopDefaultLegacy(require$$0$7);
var require$$0__default$5 = /*#__PURE__*/_interopDefaultLegacy(require$$0$8);
var require$$5__default = /*#__PURE__*/_interopDefaultLegacy(require$$5$1);
var Module__default = /*#__PURE__*/_interopDefaultLegacy(Module);
var crypto__default = /*#__PURE__*/_interopDefaultLegacy(crypto$3);
var require$$0__default$6 = /*#__PURE__*/_interopDefaultLegacy(require$$0$9);
var require$$0__default$7 = /*#__PURE__*/_interopDefaultLegacy(require$$0$a);
var require$$0__default$8 = /*#__PURE__*/_interopDefaultLegacy(require$$0$b);
var require$$2__default = /*#__PURE__*/_interopDefaultLegacy(require$$2);
var require$$1__default$2 = /*#__PURE__*/_interopDefaultLegacy(require$$1$2);
var require$$5__default$1 = /*#__PURE__*/_interopDefaultLegacy(require$$5$2);

function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else {obj[key]=value;}return obj}

var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

function getDefaultExportFromCjs (x) {
	return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;
}

function getAugmentedNamespace(n) {
	if (n.__esModule) return n;
	var a = Object.defineProperty({}, '__esModule', {value: true});
	Object.keys(n).forEach(function (k) {
		var d = Object.getOwnPropertyDescriptor(n, k);
		Object.defineProperty(a, k, d.get ? d : {
			enumerable: true,
			get: function () {
				return n[k];
			}
		});
	});
	return a;
}

function commonjsRequire (path) {
	throw new Error('Could not dynamically require "' + path + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}

var parser$1=function(){function peg$subclass(child,parent){function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor;}function SyntaxError(message,expected,found,offset,line,column){this.message=message;this.expected=expected;this.found=found;this.offset=offset;this.line=line;this.column=column;this.name="SyntaxError";}peg$subclass(SyntaxError,Error);function parse(input){var options=arguments.length>1?arguments[1]:{},peg$FAILED={},peg$startRuleFunctions={start:peg$parsestart},peg$startRuleFunction=peg$parsestart,peg$c1=function(){return nodes},peg$c2=peg$FAILED,peg$c3="#",peg$c4={type:"literal",value:"#",description:"\"#\""},peg$c5=void 0,peg$c6={type:"any",description:"any character"},peg$c7="[",peg$c8={type:"literal",value:"[",description:"\"[\""},peg$c9="]",peg$c10={type:"literal",value:"]",description:"\"]\""},peg$c11=function(name){addNode(node("ObjectPath",name,line,column));},peg$c12=function(name){addNode(node("ArrayPath",name,line,column));},peg$c13=function(parts,name){return parts.concat(name)},peg$c14=function(name){return [name]},peg$c15=function(name){return name},peg$c16=".",peg$c17={type:"literal",value:".",description:"\".\""},peg$c18="=",peg$c19={type:"literal",value:"=",description:"\"=\""},peg$c20=function(key,value){addNode(node("Assign",value,line,column,key));},peg$c21=function(chars){return chars.join("")},peg$c22=function(node){return node.value},peg$c23="\"\"\"",peg$c24={type:"literal",value:"\"\"\"",description:"\"\\\"\\\"\\\"\""},peg$c25=null,peg$c26=function(chars){return node("String",chars.join(""),line,column)},peg$c27="\"",peg$c28={type:"literal",value:"\"",description:"\"\\\"\""},peg$c29="'''",peg$c30={type:"literal",value:"'''",description:"\"'''\""},peg$c31="'",peg$c32={type:"literal",value:"'",description:"\"'\""},peg$c33=function(char){return char},peg$c34=function(char){return char},peg$c35="\\",peg$c36={type:"literal",value:"\\",description:"\"\\\\\""},peg$c37=function(){return ""},peg$c38="e",peg$c39={type:"literal",value:"e",description:"\"e\""},peg$c40="E",peg$c41={type:"literal",value:"E",description:"\"E\""},peg$c42=function(left,right){return node("Float",parseFloat(left+"e"+right),line,column)},peg$c43=function(text){return node("Float",parseFloat(text),line,column)},peg$c44="+",peg$c45={type:"literal",value:"+",description:"\"+\""},peg$c46=function(digits){return digits.join("")},peg$c47="-",peg$c48={type:"literal",value:"-",description:"\"-\""},peg$c49=function(digits){return "-"+digits.join("")},peg$c50=function(text){return node("Integer",parseInt(text,10),line,column)},peg$c51="true",peg$c52={type:"literal",value:"true",description:"\"true\""},peg$c53=function(){return node("Boolean",true,line,column)},peg$c54="false",peg$c55={type:"literal",value:"false",description:"\"false\""},peg$c56=function(){return node("Boolean",false,line,column)},peg$c57=function(){return node("Array",[],line,column)},peg$c58=function(value){return node("Array",value?[value]:[],line,column)},peg$c59=function(values){return node("Array",values,line,column)},peg$c60=function(values,value){return node("Array",values.concat(value),line,column)},peg$c61=function(value){return value},peg$c62=",",peg$c63={type:"literal",value:",",description:"\",\""},peg$c64="{",peg$c65={type:"literal",value:"{",description:"\"{\""},peg$c66="}",peg$c67={type:"literal",value:"}",description:"\"}\""},peg$c68=function(values){return node("InlineTable",values,line,column)},peg$c69=function(key,value){return node("InlineTableValue",value,line,column,key)},peg$c70=function(digits){return "."+digits},peg$c71=function(date){return date.join("")},peg$c72=":",peg$c73={type:"literal",value:":",description:"\":\""},peg$c74=function(time){return time.join("")},peg$c75="T",peg$c76={type:"literal",value:"T",description:"\"T\""},peg$c77="Z",peg$c78={type:"literal",value:"Z",description:"\"Z\""},peg$c79=function(date,time){return node("Date",new Date(date+"T"+time+"Z"),line,column)},peg$c80=function(date,time){return node("Date",new Date(date+"T"+time),line,column)},peg$c81=/^[ \t]/,peg$c82={type:"class",value:"[ \\t]",description:"[ \\t]"},peg$c83="\n",peg$c84={type:"literal",value:"\n",description:"\"\\n\""},peg$c85="\r",peg$c86={type:"literal",value:"\r",description:"\"\\r\""},peg$c87=/^[0-9a-f]/i,peg$c88={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},peg$c89=/^[0-9]/,peg$c90={type:"class",value:"[0-9]",description:"[0-9]"},peg$c91="_",peg$c92={type:"literal",value:"_",description:"\"_\""},peg$c93=function(){return ""},peg$c94=/^[A-Za-z0-9_\-]/,peg$c95={type:"class",value:"[A-Za-z0-9_\\-]",description:"[A-Za-z0-9_\\-]"},peg$c96=function(d){return d.join("")},peg$c97="\\\"",peg$c98={type:"literal",value:"\\\"",description:"\"\\\\\\\"\""},peg$c99=function(){return "\""},peg$c100="\\\\",peg$c101={type:"literal",value:"\\\\",description:"\"\\\\\\\\\""},peg$c102=function(){return "\\"},peg$c103="\\b",peg$c104={type:"literal",value:"\\b",description:"\"\\\\b\""},peg$c105=function(){return "\b"},peg$c106="\\t",peg$c107={type:"literal",value:"\\t",description:"\"\\\\t\""},peg$c108=function(){return "\t"},peg$c109="\\n",peg$c110={type:"literal",value:"\\n",description:"\"\\\\n\""},peg$c111=function(){return "\n"},peg$c112="\\f",peg$c113={type:"literal",value:"\\f",description:"\"\\\\f\""},peg$c114=function(){return "\f"},peg$c115="\\r",peg$c116={type:"literal",value:"\\r",description:"\"\\\\r\""},peg$c117=function(){return "\r"},peg$c118="\\U",peg$c119={type:"literal",value:"\\U",description:"\"\\\\U\""},peg$c120=function(digits){return convertCodePoint(digits.join(""))},peg$c121="\\u",peg$c122={type:"literal",value:"\\u",description:"\"\\\\u\""},peg$currPos=0,peg$reportedPos=0,peg$cachedPos=0,peg$cachedPosDetails={line:1,column:1,seenCR:false},peg$maxFailPos=0,peg$maxFailExpected=[],peg$silentFails=0,peg$cache={},peg$result;if("startRule"in options){if(!(options.startRule in peg$startRuleFunctions)){throw new Error("Can't start parsing from rule \""+options.startRule+"\".")}peg$startRuleFunction=peg$startRuleFunctions[options.startRule];}function line(){return peg$computePosDetails(peg$reportedPos).line}function column(){return peg$computePosDetails(peg$reportedPos).column}function peg$computePosDetails(pos){function advance(details,startPos,endPos){var p,ch;for(p=startPos;p<endPos;p++){ch=input.charAt(p);if(ch==="\n"){if(!details.seenCR){details.line++;}details.column=1;details.seenCR=false;}else if(ch==="\r"||ch==="\u2028"||ch==="\u2029"){details.line++;details.column=1;details.seenCR=true;}else {details.column++;details.seenCR=false;}}}if(peg$cachedPos!==pos){if(peg$cachedPos>pos){peg$cachedPos=0;peg$cachedPosDetails={line:1,column:1,seenCR:false};}advance(peg$cachedPosDetails,peg$cachedPos,pos);peg$cachedPos=pos;}return peg$cachedPosDetails}function peg$fail(expected){if(peg$currPos<peg$maxFailPos){return}if(peg$currPos>peg$maxFailPos){peg$maxFailPos=peg$currPos;peg$maxFailExpected=[];}peg$maxFailExpected.push(expected);}function peg$buildException(message,expected,pos){function cleanupExpected(expected){var i=1;expected.sort(function(a,b){if(a.description<b.description){return -1}else if(a.description>b.description){return 1}else {return 0}});while(i<expected.length){if(expected[i-1]===expected[i]){expected.splice(i,1);}else {i++;}}}function buildMessage(expected,found){function stringEscape(s){function hex(ch){return ch.charCodeAt(0).toString(16).toUpperCase()}return s.replace(/\\/g,"\\\\").replace(/"/g,"\\\"").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(ch){return "\\x0"+hex(ch)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(ch){return "\\x"+hex(ch)}).replace(/[\u0180-\u0FFF]/g,function(ch){return "\\u0"+hex(ch)}).replace(/[\u1080-\uFFFF]/g,function(ch){return "\\u"+hex(ch)})}var expectedDescs=new Array(expected.length),expectedDesc,foundDesc,i;for(i=0;i<expected.length;i++){expectedDescs[i]=expected[i].description;}expectedDesc=expected.length>1?expectedDescs.slice(0,-1).join(", ")+" or "+expectedDescs[expected.length-1]:expectedDescs[0];foundDesc=found?"\""+stringEscape(found)+"\"":"end of input";return "Expected "+expectedDesc+" but "+foundDesc+" found."}var posDetails=peg$computePosDetails(pos),found=pos<input.length?input.charAt(pos):null;if(expected!==null){cleanupExpected(expected);}return new SyntaxError(message!==null?message:buildMessage(expected,found),expected,found,pos,posDetails.line,posDetails.column)}function peg$parsestart(){var s0,s1,s2;var key=peg$currPos*49+0,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseline();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseline();}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c1();}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseline(){var s0,s1,s2,s3,s4,s5,s6;var key=peg$currPos*49+1,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parseexpression();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){s4=[];s5=peg$parsecomment();while(s5!==peg$FAILED){s4.push(s5);s5=peg$parsecomment();}if(s4!==peg$FAILED){s5=[];s6=peg$parseNL();if(s6!==peg$FAILED){while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseNL();}}else {s5=peg$c2;}if(s5===peg$FAILED){s5=peg$parseEOF();}if(s5!==peg$FAILED){s1=[s1,s2,s3,s4,s5];s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=[];s2=peg$parseS();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}}else {s1=peg$c2;}if(s1!==peg$FAILED){s2=[];s3=peg$parseNL();if(s3!==peg$FAILED){while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseNL();}}else {s2=peg$c2;}if(s2===peg$FAILED){s2=peg$parseEOF();}if(s2!==peg$FAILED){s1=[s1,s2];s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$parseNL();}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseexpression(){var s0;var key=peg$currPos*49+2,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parsecomment();if(s0===peg$FAILED){s0=peg$parsepath();if(s0===peg$FAILED){s0=peg$parsetablearray();if(s0===peg$FAILED){s0=peg$parseassignment();}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsecomment(){var s0,s1,s2,s3,s4,s5;var key=peg$currPos*49+3,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===35){s1=peg$c3;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c4);}}if(s1!==peg$FAILED){s2=[];s3=peg$currPos;s4=peg$currPos;peg$silentFails++;s5=peg$parseNL();if(s5===peg$FAILED){s5=peg$parseEOF();}peg$silentFails--;if(s5===peg$FAILED){s4=peg$c5;}else {peg$currPos=s4;s4=peg$c2;}if(s4!==peg$FAILED){if(input.length>peg$currPos){s5=input.charAt(peg$currPos);peg$currPos++;}else {s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s5!==peg$FAILED){s4=[s4,s5];s3=s4;}else {peg$currPos=s3;s3=peg$c2;}}else {peg$currPos=s3;s3=peg$c2;}while(s3!==peg$FAILED){s2.push(s3);s3=peg$currPos;s4=peg$currPos;peg$silentFails++;s5=peg$parseNL();if(s5===peg$FAILED){s5=peg$parseEOF();}peg$silentFails--;if(s5===peg$FAILED){s4=peg$c5;}else {peg$currPos=s4;s4=peg$c2;}if(s4!==peg$FAILED){if(input.length>peg$currPos){s5=input.charAt(peg$currPos);peg$currPos++;}else {s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s5!==peg$FAILED){s4=[s4,s5];s3=s4;}else {peg$currPos=s3;s3=peg$c2;}}else {peg$currPos=s3;s3=peg$c2;}}if(s2!==peg$FAILED){s1=[s1,s2];s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsepath(){var s0,s1,s2,s3,s4,s5;var key=peg$currPos*49+4,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){s2=[];s3=peg$parseS();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseS();}if(s2!==peg$FAILED){s3=peg$parsetable_key();if(s3!==peg$FAILED){s4=[];s5=peg$parseS();while(s5!==peg$FAILED){s4.push(s5);s5=peg$parseS();}if(s4!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s5=peg$c9;peg$currPos++;}else {s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c11(s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsetablearray(){var s0,s1,s2,s3,s4,s5,s6,s7;var key=peg$currPos*49+5,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===91){s2=peg$c7;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){s4=peg$parsetable_key();if(s4!==peg$FAILED){s5=[];s6=peg$parseS();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseS();}if(s5!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s6=peg$c9;peg$currPos++;}else {s6=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s6!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s7=peg$c9;peg$currPos++;}else {s7=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s7!==peg$FAILED){peg$reportedPos=s0;s1=peg$c12(s4);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsetable_key(){var s0,s1,s2;var key=peg$currPos*49+6,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parsedot_ended_table_key_part();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parsedot_ended_table_key_part();}}else {s1=peg$c2;}if(s1!==peg$FAILED){s2=peg$parsetable_key_part();if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c13(s1,s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parsetable_key_part();if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c14(s1);}s0=s1;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsetable_key_part(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+7,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsekey();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c15(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsequoted_key();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c15(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsedot_ended_table_key_part(){var s0,s1,s2,s3,s4,s5,s6;var key=peg$currPos*49+8,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsekey();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}if(s4!==peg$FAILED){s5=[];s6=peg$parseS();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseS();}if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c15(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsequoted_key();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}if(s4!==peg$FAILED){s5=[];s6=peg$parseS();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseS();}if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c15(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseassignment(){var s0,s1,s2,s3,s4,s5;var key=peg$currPos*49+9,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$parsekey();if(s1!==peg$FAILED){s2=[];s3=peg$parseS();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseS();}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s3=peg$c18;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c19);}}if(s3!==peg$FAILED){s4=[];s5=peg$parseS();while(s5!==peg$FAILED){s4.push(s5);s5=peg$parseS();}if(s4!==peg$FAILED){s5=peg$parsevalue();if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c20(s1,s5);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parsequoted_key();if(s1!==peg$FAILED){s2=[];s3=peg$parseS();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseS();}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s3=peg$c18;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c19);}}if(s3!==peg$FAILED){s4=[];s5=peg$parseS();while(s5!==peg$FAILED){s4.push(s5);s5=peg$parseS();}if(s4!==peg$FAILED){s5=peg$parsevalue();if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c20(s1,s5);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsekey(){var s0,s1,s2;var key=peg$currPos*49+10,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseASCII_BASIC();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseASCII_BASIC();}}else {s1=peg$c2;}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c21(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsequoted_key(){var s0,s1;var key=peg$currPos*49+11,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$parsedouble_quoted_single_line_string();if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c22(s1);}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parsesingle_quoted_single_line_string();if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c22(s1);}s0=s1;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsevalue(){var s0;var key=peg$currPos*49+12,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parsestring();if(s0===peg$FAILED){s0=peg$parsedatetime();if(s0===peg$FAILED){s0=peg$parsefloat();if(s0===peg$FAILED){s0=peg$parseinteger();if(s0===peg$FAILED){s0=peg$parseboolean();if(s0===peg$FAILED){s0=peg$parsearray();if(s0===peg$FAILED){s0=peg$parseinline_table();}}}}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsestring(){var s0;var key=peg$currPos*49+13,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parsedouble_quoted_multiline_string();if(s0===peg$FAILED){s0=peg$parsedouble_quoted_single_line_string();if(s0===peg$FAILED){s0=peg$parsesingle_quoted_multiline_string();if(s0===peg$FAILED){s0=peg$parsesingle_quoted_single_line_string();}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsedouble_quoted_multiline_string(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+14,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.substr(peg$currPos,3)===peg$c23){s1=peg$c23;peg$currPos+=3;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c24);}}if(s1!==peg$FAILED){s2=peg$parseNL();if(s2===peg$FAILED){s2=peg$c25;}if(s2!==peg$FAILED){s3=[];s4=peg$parsemultiline_string_char();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parsemultiline_string_char();}if(s3!==peg$FAILED){if(input.substr(peg$currPos,3)===peg$c23){s4=peg$c23;peg$currPos+=3;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c24);}}if(s4!==peg$FAILED){peg$reportedPos=s0;s1=peg$c26(s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsedouble_quoted_single_line_string(){var s0,s1,s2,s3;var key=peg$currPos*49+15,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===34){s1=peg$c27;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28);}}if(s1!==peg$FAILED){s2=[];s3=peg$parsestring_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsestring_char();}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===34){s3=peg$c27;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28);}}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c26(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsesingle_quoted_multiline_string(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+16,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.substr(peg$currPos,3)===peg$c29){s1=peg$c29;peg$currPos+=3;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c30);}}if(s1!==peg$FAILED){s2=peg$parseNL();if(s2===peg$FAILED){s2=peg$c25;}if(s2!==peg$FAILED){s3=[];s4=peg$parsemultiline_literal_char();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parsemultiline_literal_char();}if(s3!==peg$FAILED){if(input.substr(peg$currPos,3)===peg$c29){s4=peg$c29;peg$currPos+=3;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c30);}}if(s4!==peg$FAILED){peg$reportedPos=s0;s1=peg$c26(s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsesingle_quoted_single_line_string(){var s0,s1,s2,s3;var key=peg$currPos*49+17,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===39){s1=peg$c31;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c32);}}if(s1!==peg$FAILED){s2=[];s3=peg$parseliteral_char();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseliteral_char();}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===39){s3=peg$c31;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c32);}}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c26(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsestring_char(){var s0,s1,s2;var key=peg$currPos*49+18,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parseESCAPED();if(s0===peg$FAILED){s0=peg$currPos;s1=peg$currPos;peg$silentFails++;if(input.charCodeAt(peg$currPos)===34){s2=peg$c27;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c28);}}peg$silentFails--;if(s2===peg$FAILED){s1=peg$c5;}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){if(input.length>peg$currPos){s2=input.charAt(peg$currPos);peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c33(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseliteral_char(){var s0,s1,s2;var key=peg$currPos*49+19,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$currPos;peg$silentFails++;if(input.charCodeAt(peg$currPos)===39){s2=peg$c31;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c32);}}peg$silentFails--;if(s2===peg$FAILED){s1=peg$c5;}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){if(input.length>peg$currPos){s2=input.charAt(peg$currPos);peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c33(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsemultiline_string_char(){var s0,s1,s2;var key=peg$currPos*49+20,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parseESCAPED();if(s0===peg$FAILED){s0=peg$parsemultiline_string_delim();if(s0===peg$FAILED){s0=peg$currPos;s1=peg$currPos;peg$silentFails++;if(input.substr(peg$currPos,3)===peg$c23){s2=peg$c23;peg$currPos+=3;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c24);}}peg$silentFails--;if(s2===peg$FAILED){s1=peg$c5;}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){if(input.length>peg$currPos){s2=input.charAt(peg$currPos);peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c34(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsemultiline_string_delim(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+21,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===92){s1=peg$c35;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c36);}}if(s1!==peg$FAILED){s2=peg$parseNL();if(s2!==peg$FAILED){s3=[];s4=peg$parseNLS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseNLS();}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c37();s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsemultiline_literal_char(){var s0,s1,s2;var key=peg$currPos*49+22,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$currPos;peg$silentFails++;if(input.substr(peg$currPos,3)===peg$c29){s2=peg$c29;peg$currPos+=3;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c30);}}peg$silentFails--;if(s2===peg$FAILED){s1=peg$c5;}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){if(input.length>peg$currPos){s2=input.charAt(peg$currPos);peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c33(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsefloat(){var s0,s1,s2,s3;var key=peg$currPos*49+23,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$parsefloat_text();if(s1===peg$FAILED){s1=peg$parseinteger_text();}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===101){s2=peg$c38;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c39);}}if(s2===peg$FAILED){if(input.charCodeAt(peg$currPos)===69){s2=peg$c40;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c41);}}}if(s2!==peg$FAILED){s3=peg$parseinteger_text();if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c42(s1,s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parsefloat_text();if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c43(s1);}s0=s1;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsefloat_text(){var s0,s1,s2,s3,s4,s5;var key=peg$currPos*49+24,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===43){s1=peg$c44;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c45);}}if(s1===peg$FAILED){s1=peg$c25;}if(s1!==peg$FAILED){s2=peg$currPos;s3=peg$parseDIGITS();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}if(s4!==peg$FAILED){s5=peg$parseDIGITS();if(s5!==peg$FAILED){s3=[s3,s4,s5];s2=s3;}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c46(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===45){s1=peg$c47;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c48);}}if(s1!==peg$FAILED){s2=peg$currPos;s3=peg$parseDIGITS();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}if(s4!==peg$FAILED){s5=peg$parseDIGITS();if(s5!==peg$FAILED){s3=[s3,s4,s5];s2=s3;}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c49(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseinteger(){var s0,s1;var key=peg$currPos*49+25,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$parseinteger_text();if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c50(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseinteger_text(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+26,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===43){s1=peg$c44;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c45);}}if(s1===peg$FAILED){s1=peg$c25;}if(s1!==peg$FAILED){s2=[];s3=peg$parseDIGIT_OR_UNDER();if(s3!==peg$FAILED){while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseDIGIT_OR_UNDER();}}else {s2=peg$c2;}if(s2!==peg$FAILED){s3=peg$currPos;peg$silentFails++;if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}peg$silentFails--;if(s4===peg$FAILED){s3=peg$c5;}else {peg$currPos=s3;s3=peg$c2;}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c46(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===45){s1=peg$c47;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c48);}}if(s1!==peg$FAILED){s2=[];s3=peg$parseDIGIT_OR_UNDER();if(s3!==peg$FAILED){while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseDIGIT_OR_UNDER();}}else {s2=peg$c2;}if(s2!==peg$FAILED){s3=peg$currPos;peg$silentFails++;if(input.charCodeAt(peg$currPos)===46){s4=peg$c16;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}peg$silentFails--;if(s4===peg$FAILED){s3=peg$c5;}else {peg$currPos=s3;s3=peg$c2;}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c49(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseboolean(){var s0,s1;var key=peg$currPos*49+27,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.substr(peg$currPos,4)===peg$c51){s1=peg$c51;peg$currPos+=4;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c52);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c53();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,5)===peg$c54){s1=peg$c54;peg$currPos+=5;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c55);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c56();}s0=s1;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsearray(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+28,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){s2=[];s3=peg$parsearray_sep();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsearray_sep();}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s3=peg$c9;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c57();s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){s2=peg$parsearray_value();if(s2===peg$FAILED){s2=peg$c25;}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s3=peg$c9;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c58(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){s2=[];s3=peg$parsearray_value_list();if(s3!==peg$FAILED){while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsearray_value_list();}}else {s2=peg$c2;}if(s2!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s3=peg$c9;peg$currPos++;}else {s3=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c59(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===91){s1=peg$c7;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c8);}}if(s1!==peg$FAILED){s2=[];s3=peg$parsearray_value_list();if(s3!==peg$FAILED){while(s3!==peg$FAILED){s2.push(s3);s3=peg$parsearray_value_list();}}else {s2=peg$c2;}if(s2!==peg$FAILED){s3=peg$parsearray_value();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===93){s4=peg$c9;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c10);}}if(s4!==peg$FAILED){peg$reportedPos=s0;s1=peg$c60(s2,s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsearray_value(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+29,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parsearray_sep();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parsearray_sep();}if(s1!==peg$FAILED){s2=peg$parsevalue();if(s2!==peg$FAILED){s3=[];s4=peg$parsearray_sep();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parsearray_sep();}if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c61(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsearray_value_list(){var s0,s1,s2,s3,s4,s5,s6;var key=peg$currPos*49+30,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parsearray_sep();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parsearray_sep();}if(s1!==peg$FAILED){s2=peg$parsevalue();if(s2!==peg$FAILED){s3=[];s4=peg$parsearray_sep();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parsearray_sep();}if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===44){s4=peg$c62;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c63);}}if(s4!==peg$FAILED){s5=[];s6=peg$parsearray_sep();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parsearray_sep();}if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c61(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsearray_sep(){var s0;var key=peg$currPos*49+31,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parseS();if(s0===peg$FAILED){s0=peg$parseNL();if(s0===peg$FAILED){s0=peg$parsecomment();}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseinline_table(){var s0,s1,s2,s3,s4,s5;var key=peg$currPos*49+32,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===123){s1=peg$c64;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c65);}}if(s1!==peg$FAILED){s2=[];s3=peg$parseS();while(s3!==peg$FAILED){s2.push(s3);s3=peg$parseS();}if(s2!==peg$FAILED){s3=[];s4=peg$parseinline_table_assignment();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseinline_table_assignment();}if(s3!==peg$FAILED){s4=[];s5=peg$parseS();while(s5!==peg$FAILED){s4.push(s5);s5=peg$parseS();}if(s4!==peg$FAILED){if(input.charCodeAt(peg$currPos)===125){s5=peg$c66;peg$currPos++;}else {s5=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c67);}}if(s5!==peg$FAILED){peg$reportedPos=s0;s1=peg$c68(s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseinline_table_assignment(){var s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10;var key=peg$currPos*49+33,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsekey();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s4=peg$c18;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c19);}}if(s4!==peg$FAILED){s5=[];s6=peg$parseS();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseS();}if(s5!==peg$FAILED){s6=peg$parsevalue();if(s6!==peg$FAILED){s7=[];s8=peg$parseS();while(s8!==peg$FAILED){s7.push(s8);s8=peg$parseS();}if(s7!==peg$FAILED){if(input.charCodeAt(peg$currPos)===44){s8=peg$c62;peg$currPos++;}else {s8=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c63);}}if(s8!==peg$FAILED){s9=[];s10=peg$parseS();while(s10!==peg$FAILED){s9.push(s10);s10=peg$parseS();}if(s9!==peg$FAILED){peg$reportedPos=s0;s1=peg$c69(s2,s6);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=[];s2=peg$parseS();while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseS();}if(s1!==peg$FAILED){s2=peg$parsekey();if(s2!==peg$FAILED){s3=[];s4=peg$parseS();while(s4!==peg$FAILED){s3.push(s4);s4=peg$parseS();}if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===61){s4=peg$c18;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c19);}}if(s4!==peg$FAILED){s5=[];s6=peg$parseS();while(s6!==peg$FAILED){s5.push(s6);s6=peg$parseS();}if(s5!==peg$FAILED){s6=peg$parsevalue();if(s6!==peg$FAILED){peg$reportedPos=s0;s1=peg$c69(s2,s6);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsesecfragment(){var s0,s1,s2;var key=peg$currPos*49+34,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.charCodeAt(peg$currPos)===46){s1=peg$c16;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c17);}}if(s1!==peg$FAILED){s2=peg$parseDIGITS();if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c70(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsedate(){var s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11;var key=peg$currPos*49+35,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$currPos;s2=peg$parseDIGIT_OR_UNDER();if(s2!==peg$FAILED){s3=peg$parseDIGIT_OR_UNDER();if(s3!==peg$FAILED){s4=peg$parseDIGIT_OR_UNDER();if(s4!==peg$FAILED){s5=peg$parseDIGIT_OR_UNDER();if(s5!==peg$FAILED){if(input.charCodeAt(peg$currPos)===45){s6=peg$c47;peg$currPos++;}else {s6=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c48);}}if(s6!==peg$FAILED){s7=peg$parseDIGIT_OR_UNDER();if(s7!==peg$FAILED){s8=peg$parseDIGIT_OR_UNDER();if(s8!==peg$FAILED){if(input.charCodeAt(peg$currPos)===45){s9=peg$c47;peg$currPos++;}else {s9=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c48);}}if(s9!==peg$FAILED){s10=peg$parseDIGIT_OR_UNDER();if(s10!==peg$FAILED){s11=peg$parseDIGIT_OR_UNDER();if(s11!==peg$FAILED){s2=[s2,s3,s4,s5,s6,s7,s8,s9,s10,s11];s1=s2;}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c71(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsetime(){var s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10;var key=peg$currPos*49+36,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$currPos;s2=peg$parseDIGIT_OR_UNDER();if(s2!==peg$FAILED){s3=peg$parseDIGIT_OR_UNDER();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===58){s4=peg$c72;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c73);}}if(s4!==peg$FAILED){s5=peg$parseDIGIT_OR_UNDER();if(s5!==peg$FAILED){s6=peg$parseDIGIT_OR_UNDER();if(s6!==peg$FAILED){if(input.charCodeAt(peg$currPos)===58){s7=peg$c72;peg$currPos++;}else {s7=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c73);}}if(s7!==peg$FAILED){s8=peg$parseDIGIT_OR_UNDER();if(s8!==peg$FAILED){s9=peg$parseDIGIT_OR_UNDER();if(s9!==peg$FAILED){s10=peg$parsesecfragment();if(s10===peg$FAILED){s10=peg$c25;}if(s10!==peg$FAILED){s2=[s2,s3,s4,s5,s6,s7,s8,s9,s10];s1=s2;}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c74(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsetime_with_offset(){var s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15,s16;var key=peg$currPos*49+37,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$currPos;s2=peg$parseDIGIT_OR_UNDER();if(s2!==peg$FAILED){s3=peg$parseDIGIT_OR_UNDER();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===58){s4=peg$c72;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c73);}}if(s4!==peg$FAILED){s5=peg$parseDIGIT_OR_UNDER();if(s5!==peg$FAILED){s6=peg$parseDIGIT_OR_UNDER();if(s6!==peg$FAILED){if(input.charCodeAt(peg$currPos)===58){s7=peg$c72;peg$currPos++;}else {s7=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c73);}}if(s7!==peg$FAILED){s8=peg$parseDIGIT_OR_UNDER();if(s8!==peg$FAILED){s9=peg$parseDIGIT_OR_UNDER();if(s9!==peg$FAILED){s10=peg$parsesecfragment();if(s10===peg$FAILED){s10=peg$c25;}if(s10!==peg$FAILED){if(input.charCodeAt(peg$currPos)===45){s11=peg$c47;peg$currPos++;}else {s11=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c48);}}if(s11===peg$FAILED){if(input.charCodeAt(peg$currPos)===43){s11=peg$c44;peg$currPos++;}else {s11=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c45);}}}if(s11!==peg$FAILED){s12=peg$parseDIGIT_OR_UNDER();if(s12!==peg$FAILED){s13=peg$parseDIGIT_OR_UNDER();if(s13!==peg$FAILED){if(input.charCodeAt(peg$currPos)===58){s14=peg$c72;peg$currPos++;}else {s14=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c73);}}if(s14!==peg$FAILED){s15=peg$parseDIGIT_OR_UNDER();if(s15!==peg$FAILED){s16=peg$parseDIGIT_OR_UNDER();if(s16!==peg$FAILED){s2=[s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15,s16];s1=s2;}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}}else {peg$currPos=s1;s1=peg$c2;}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c74(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parsedatetime(){var s0,s1,s2,s3,s4;var key=peg$currPos*49+38,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=peg$parsedate();if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===84){s2=peg$c75;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c76);}}if(s2!==peg$FAILED){s3=peg$parsetime();if(s3!==peg$FAILED){if(input.charCodeAt(peg$currPos)===90){s4=peg$c77;peg$currPos++;}else {s4=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c78);}}if(s4!==peg$FAILED){peg$reportedPos=s0;s1=peg$c79(s1,s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;s1=peg$parsedate();if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===84){s2=peg$c75;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c76);}}if(s2!==peg$FAILED){s3=peg$parsetime_with_offset();if(s3!==peg$FAILED){peg$reportedPos=s0;s1=peg$c80(s1,s3);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseS(){var s0;var key=peg$currPos*49+39,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}if(peg$c81.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++;}else {s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c82);}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseNL(){var s0,s1,s2;var key=peg$currPos*49+40,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}if(input.charCodeAt(peg$currPos)===10){s0=peg$c83;peg$currPos++;}else {s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c84);}}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===13){s1=peg$c85;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c86);}}if(s1!==peg$FAILED){if(input.charCodeAt(peg$currPos)===10){s2=peg$c83;peg$currPos++;}else {s2=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c84);}}if(s2!==peg$FAILED){s1=[s1,s2];s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseNLS(){var s0;var key=peg$currPos*49+41,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$parseNL();if(s0===peg$FAILED){s0=peg$parseS();}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseEOF(){var s0,s1;var key=peg$currPos*49+42,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;peg$silentFails++;if(input.length>peg$currPos){s1=input.charAt(peg$currPos);peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c6);}}peg$silentFails--;if(s1===peg$FAILED){s0=peg$c5;}else {peg$currPos=s0;s0=peg$c2;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseHEX(){var s0;var key=peg$currPos*49+43,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}if(peg$c87.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++;}else {s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c88);}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseDIGIT_OR_UNDER(){var s0,s1;var key=peg$currPos*49+44,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}if(peg$c89.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++;}else {s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c90);}}if(s0===peg$FAILED){s0=peg$currPos;if(input.charCodeAt(peg$currPos)===95){s1=peg$c91;peg$currPos++;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c92);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c93();}s0=s1;}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseASCII_BASIC(){var s0;var key=peg$currPos*49+45,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}if(peg$c94.test(input.charAt(peg$currPos))){s0=input.charAt(peg$currPos);peg$currPos++;}else {s0=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c95);}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseDIGITS(){var s0,s1,s2;var key=peg$currPos*49+46,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;s1=[];s2=peg$parseDIGIT_OR_UNDER();if(s2!==peg$FAILED){while(s2!==peg$FAILED){s1.push(s2);s2=peg$parseDIGIT_OR_UNDER();}}else {s1=peg$c2;}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c96(s1);}s0=s1;peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseESCAPED(){var s0,s1;var key=peg$currPos*49+47,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c97){s1=peg$c97;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c98);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c99();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c100){s1=peg$c100;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c101);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c102();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c103){s1=peg$c103;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c104);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c105();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c106){s1=peg$c106;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c107);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c108();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c109){s1=peg$c109;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c110);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c111();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c112){s1=peg$c112;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c113);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c114();}s0=s1;if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c115){s1=peg$c115;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c116);}}if(s1!==peg$FAILED){peg$reportedPos=s0;s1=peg$c117();}s0=s1;if(s0===peg$FAILED){s0=peg$parseESCAPED_UNICODE();}}}}}}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}function peg$parseESCAPED_UNICODE(){var s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10;var key=peg$currPos*49+48,cached=peg$cache[key];if(cached){peg$currPos=cached.nextPos;return cached.result}s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c118){s1=peg$c118;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c119);}}if(s1!==peg$FAILED){s2=peg$currPos;s3=peg$parseHEX();if(s3!==peg$FAILED){s4=peg$parseHEX();if(s4!==peg$FAILED){s5=peg$parseHEX();if(s5!==peg$FAILED){s6=peg$parseHEX();if(s6!==peg$FAILED){s7=peg$parseHEX();if(s7!==peg$FAILED){s8=peg$parseHEX();if(s8!==peg$FAILED){s9=peg$parseHEX();if(s9!==peg$FAILED){s10=peg$parseHEX();if(s10!==peg$FAILED){s3=[s3,s4,s5,s6,s7,s8,s9,s10];s2=s3;}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c120(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}if(s0===peg$FAILED){s0=peg$currPos;if(input.substr(peg$currPos,2)===peg$c121){s1=peg$c121;peg$currPos+=2;}else {s1=peg$FAILED;if(peg$silentFails===0){peg$fail(peg$c122);}}if(s1!==peg$FAILED){s2=peg$currPos;s3=peg$parseHEX();if(s3!==peg$FAILED){s4=peg$parseHEX();if(s4!==peg$FAILED){s5=peg$parseHEX();if(s5!==peg$FAILED){s6=peg$parseHEX();if(s6!==peg$FAILED){s3=[s3,s4,s5,s6];s2=s3;}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}}else {peg$currPos=s2;s2=peg$c2;}if(s2!==peg$FAILED){peg$reportedPos=s0;s1=peg$c120(s2);s0=s1;}else {peg$currPos=s0;s0=peg$c2;}}else {peg$currPos=s0;s0=peg$c2;}}peg$cache[key]={nextPos:peg$currPos,result:s0};return s0}var nodes=[];function genError(err,line,col){var ex=new Error(err);ex.line=line;ex.column=col;throw ex}function addNode(node){nodes.push(node);}function node(type,value,line,column,key){var obj={type:type,value:value,line:line(),column:column()};if(key)obj.key=key;return obj}function convertCodePoint(str,line,col){var num=parseInt("0x"+str);if(!isFinite(num)||Math.floor(num)!=num||num<0||num>1114111||num>55295&&num<57344){genError("Invalid Unicode escape code: "+str,line,col);}else {return fromCodePoint(num)}}function fromCodePoint(){var MAX_SIZE=16384;var codeUnits=[];var highSurrogate;var lowSurrogate;var index=-1;var length=arguments.length;if(!length){return ""}var result="";while(++index<length){var codePoint=Number(arguments[index]);if(codePoint<=65535){codeUnits.push(codePoint);}else {codePoint-=65536;highSurrogate=(codePoint>>10)+55296;lowSurrogate=codePoint%1024+56320;codeUnits.push(highSurrogate,lowSurrogate);}if(index+1==length||codeUnits.length>MAX_SIZE){result+=String.fromCharCode.apply(null,codeUnits);codeUnits.length=0;}}return result}peg$result=peg$startRuleFunction();if(peg$result!==peg$FAILED&&peg$currPos===input.length){return peg$result}else {if(peg$result!==peg$FAILED&&peg$currPos<input.length){peg$fail({type:"end",description:"end of input"});}throw peg$buildException(null,peg$maxFailExpected,peg$maxFailPos)}}return {SyntaxError:SyntaxError,parse:parse}}();

function compile$4(nodes){var assignedPaths=[];var valueAssignments=[];var currentPath="";var data=Object.create(null);var context=data;return reduce(nodes);function reduce(nodes){var node;for(var i=0;i<nodes.length;i++){node=nodes[i];switch(node.type){case"Assign":assign(node);break;case"ObjectPath":setPath(node);break;case"ArrayPath":addTableArray(node);break;}}return data}function genError(err,line,col){var ex=new Error(err);ex.line=line;ex.column=col;throw ex}function assign(node){var key=node.key;var value=node.value;var line=node.line;var column=node.column;var fullPath;if(currentPath){fullPath=currentPath+"."+key;}else {fullPath=key;}if(typeof context[key]!=="undefined"){genError("Cannot redefine existing key '"+fullPath+"'.",line,column);}context[key]=reduceValueNode(value);if(!pathAssigned(fullPath)){assignedPaths.push(fullPath);valueAssignments.push(fullPath);}}function pathAssigned(path){return assignedPaths.indexOf(path)!==-1}function reduceValueNode(node){if(node.type==="Array"){return reduceArrayWithTypeChecking(node.value)}else if(node.type==="InlineTable"){return reduceInlineTableNode(node.value)}else {return node.value}}function reduceInlineTableNode(values){var obj=Object.create(null);for(var i=0;i<values.length;i++){var val=values[i];if(val.value.type==="InlineTable"){obj[val.key]=reduceInlineTableNode(val.value.value);}else if(val.type==="InlineTableValue"){obj[val.key]=reduceValueNode(val.value);}}return obj}function setPath(node){var path=node.value;var quotedPath=path.map(quoteDottedString).join(".");var line=node.line;var column=node.column;if(pathAssigned(quotedPath)){genError("Cannot redefine existing key '"+path+"'.",line,column);}assignedPaths.push(quotedPath);context=deepRef(data,path,Object.create(null),line,column);currentPath=path;}function addTableArray(node){var path=node.value;var quotedPath=path.map(quoteDottedString).join(".");var line=node.line;var column=node.column;if(!pathAssigned(quotedPath)){assignedPaths.push(quotedPath);}assignedPaths=assignedPaths.filter(function(p){return p.indexOf(quotedPath)!==0});assignedPaths.push(quotedPath);context=deepRef(data,path,[],line,column);currentPath=quotedPath;if(context instanceof Array){var newObj=Object.create(null);context.push(newObj);context=newObj;}else {genError("Cannot redefine existing key '"+path+"'.",line,column);}}function deepRef(start,keys,value,line,column){var traversed=[];var traversedPath="";keys.join(".");var ctx=start;for(var i=0;i<keys.length;i++){var key=keys[i];traversed.push(key);traversedPath=traversed.join(".");if(typeof ctx[key]==="undefined"){if(i===keys.length-1){ctx[key]=value;}else {ctx[key]=Object.create(null);}}else if(i!==keys.length-1&&valueAssignments.indexOf(traversedPath)>-1){genError("Cannot redefine existing key '"+traversedPath+"'.",line,column);}ctx=ctx[key];if(ctx instanceof Array&&ctx.length&&i<keys.length-1){ctx=ctx[ctx.length-1];}}return ctx}function reduceArrayWithTypeChecking(array){var firstType=null;for(var i=0;i<array.length;i++){var node=array[i];if(firstType===null){firstType=node.type;}else {if(node.type!==firstType){genError("Cannot add value of type "+node.type+" to array of type "+firstType+".",node.line,node.column);}}}return array.map(reduceValueNode)}function quoteDottedString(str){if(str.indexOf(".")>-1){return "\""+str+"\""}else {return str}}}var compiler$1={compile:compile$4};

var parser=parser$1;var compiler=compiler$1;var toml={parse:function(input){var nodes=parser.parse(input.toString());return compiler.compile(nodes)}};

class CinnamonModule{constructor(framework){_defineProperty(this,"framework",void 0);this.framework=framework;}}

exports.Config = void 0;exports.Logger = void 0;exports.Database = void 0;exports.DatabaseModule = void 0;function initializeCoreModules(modules){exports.Config=modules.Config;exports.Logger=modules.Logger;exports.Database=modules.Database.entityManager;exports.DatabaseModule=modules.Database;}

var data;(function(data){data.NESTED_OBJECT_DELIMITER=".";function arrayEquals(a,b){if(!Array.isArray(a)||!Array.isArray(b))return false;if(a.length!==b.length)return false;let aValuesInB=[...a];b.forEach(element=>{if(aValuesInB.includes(element))aValuesInB.splice(aValuesInB.indexOf(element),1);});return aValuesInB.length===0}data.arrayEquals=arrayEquals;function resolveObjectDeep(key,obj){const keyParts=key.split(data.NESTED_OBJECT_DELIMITER);const isFinalKey=keyParts.length<=1;const imperativeKey=keyParts.shift();if(!Object.keys(obj).includes(imperativeKey))return undefined;if(isFinalKey)return obj[imperativeKey];else return resolveObjectDeep(keyParts.join(data.NESTED_OBJECT_DELIMITER),obj[imperativeKey])}data.resolveObjectDeep=resolveObjectDeep;function setObjectDeep(key,value,obj,options,_entireKey){if(!options)options={createChildrenIfNeeded:true};const keyParts=key.split(data.NESTED_OBJECT_DELIMITER);const isFinalKey=keyParts.length<=1;const imperativeKey=keyParts.shift();if(!Object.keys(obj).includes(imperativeKey)){if(!options.createChildrenIfNeeded){throw new Error(`Failed to locate key: ${_entireKey}.`)}else obj[imperativeKey]={};}if(isFinalKey){obj[imperativeKey]=value;return}else setObjectDeep(keyParts.join(data.NESTED_OBJECT_DELIMITER),value,obj[imperativeKey],options,_entireKey);}data.setObjectDeep=setObjectDeep;function mergeObjectDeep(target,source){const isObject=x=>x!==null&&typeof x==="object"&&!Array.isArray(x);for(const key of Object.keys(source)){if(isObject(source[key])&&isObject(target[key])){target[key]=mergeObjectDeep(target[key],source[key]);}else if(!isObject(source[key])&&!isObject(target[key])){target[key]=source[key];}}return target}data.mergeObjectDeep=mergeObjectDeep;})(data||(data={}));

var fs$y;(function(fs){async function fileExists(filePath){try{const stats=await require$$0$3.promisify(require$$0__namespace.stat)(filePath);return stats.isFile()}catch(ex){return false}}fs.fileExists=fileExists;async function directoryExists(directoryPath){try{if(typeof directoryPath!=="string")return false;const stats=await require$$0$3.promisify(require$$0__namespace.stat)(directoryPath);return stats.isDirectory()}catch(ex){return false}}fs.directoryExists=directoryExists;function toAbsolutePath(childPath){if(childPath===undefined||childPath===null)throw new Error("Missing path.");return require$$0__namespace$1.join(process.cwd(),childPath)}fs.toAbsolutePath=toAbsolutePath;async function listRecursively(directoryPath){let discoveredFiles=[];for(const filePath of await require$$0$3.promisify(require$$0__namespace.readdir)(directoryPath)){const absoluteFilePath=require$$0__namespace$1.join(directoryPath,filePath);if((await require$$0$3.promisify(require$$0__namespace.stat)(absoluteFilePath)).isDirectory())discoveredFiles.push(...(await listRecursively(absoluteFilePath)));else discoveredFiles.push(absoluteFilePath);}return discoveredFiles}fs.listRecursively=listRecursively;async function getLastModification(path){return (await require$$0$3.promisify(require$$0__namespace.stat)(path)).mtime}fs.getLastModification=getLastModification;})(fs$y||(fs$y={}));

var cinnamonInternals;(function(cinnamonInternals){cinnamonInternals.data=data;cinnamonInternals.fs=fs$y;})(cinnamonInternals||(cinnamonInternals={}));var cinnamonInternals$1 = cinnamonInternals;

class ValidationResult{constructor(options){_defineProperty(this,"success",void 0);_defineProperty(this,"message",void 0);this.success=options.success;this.message=options.message;}static success(){return new ValidationResult({success:true})}static fail(message){return new ValidationResult({success:false,message})}}

class Validator{constructor(schema){_defineProperty(this,"schema",void 0);_defineProperty(this,"isSingleFieldSchema",void 0);this.schema=schema;this.isSingleFieldSchema=!this._isValidationSchemaObject(this.schema);}validate(value){if(this.isSingleFieldSchema){return this.validateSchemaAgainstField(this.schema,value,undefined,"$root",undefined)}return this.validateSchemaAgainstObject(this.schema,value,value,"$root",undefined)}validateSchemaAgainstObject(object,value,_entireObject,_fieldName,_parentName){for(let key of Object.keys(object)){if(this._isValidationSchemaObject(object[key])){const childSchemaValidation=this.validateSchemaAgainstObject(object[key],value[key],_entireObject,key,`${_parentName!==undefined?_parentName+".":""}${_fieldName}`);if(!childSchemaValidation.success)return childSchemaValidation}else {const childFieldValidation=this.validateSchemaAgainstField(object[key],value[key],_entireObject,key,`${_parentName!==undefined?_parentName+".":""}${_fieldName}`);if(!childFieldValidation.success)return childFieldValidation}}return ValidationResult.success()}validateSchemaAgainstField(field,value,_entireObject,fieldName,parentName){var _field$fieldName;fieldName=(_field$fieldName=field.fieldName)!==null&&_field$fieldName!==void 0?_field$fieldName:fieldName;if(field.type==="OneOf"){for(const possibleSchema of field.possibleSchemas){const childFieldValidation=this.validateSchemaAgainstField(possibleSchema,value,_entireObject);if(!childFieldValidation.success)return childFieldValidation}return ValidationResult.success()}if(field.required!==undefined&&field.required!==null&&field.required!==false){if(field.required===true&&(value===undefined||value===null))return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be set and not null."});else if(field.required==="explicit"&&value===undefined)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be set."})}else if(field.required===false||field.required===undefined){if(value===undefined||value==null)return ValidationResult.success()}else {throw new Error("You may only set a field's required property to true, false or 'explicit'.")}if(field.equals&&field.arrayEquals){throw new Error("You may not specify equals AND arrayEquals; they are mutually exclusive.")}if(field.equals!==undefined&&field.equals!==null){if(Array.isArray(field.equals)&&!Array.isArray(value)){if(!field.equals.some(entry=>value===entry))return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field was not set to a valid value. Possible values are: "+JSON.stringify(field.equals)})}else {if(value!==field.equals)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be equal to: "+field.equals})}}if(field.arrayEquals!==undefined&&field.arrayEquals!==null){if(field.arrayEquals.every(entry=>Array.isArray(entry))){if(!field.arrayEquals.some(entry=>cinnamonInternals$1.data.arrayEquals(entry,value)))return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field was not set to a valid value. Possible values are: "+JSON.stringify(field.arrayEquals)})}else {if(!cinnamonInternals$1.data.arrayEquals(field.arrayEquals,value))return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be equal to: "+field.arrayEquals})}}if(field.matches!==undefined&&field.matches!==null){if(field.matches instanceof RegExp){if(!field.matches.test(value))return this._fail({field,fieldName,parentName})}else {if(field.matches["$any"]&&field.matches["$all"])throw new Error("You may not have $any and $all specified on a field's 'matches' property; they are mutually exclusive.");let comparisionFunc;let aggregateOp;if(field.matches.$any){aggregateOp="$any";comparisionFunc="some";}if(field.matches.$all){aggregateOp="$all";comparisionFunc="every";}if(comparisionFunc&&aggregateOp){if(!field.matches[aggregateOp][comparisionFunc](expression=>expression.test(value)))return this._fail({field,fieldName,parentName})}else throw new Error("Invalid matches property. Must be a regular expression (regex), or an aggregate expression with $any or $all operator.")}}if(field.$eq!==undefined){if(_entireObject){var _entireObject$field$$;if(cinnamonInternals$1.data.resolveObjectDeep(field.$eq,_entireObject)!==value)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be equal to the "+this._toHumanReadableFieldName((_entireObject$field$$=_entireObject[field.$eq].fieldName)!==null&&_entireObject$field$$!==void 0?_entireObject$field$$:field.$eq)+" field."})}else throw new Error("The $eq operator may not be used on a field outside of an object context.")}let attrs={};switch(field.type){case"any":return ValidationResult.success();case"string":attrs.minLength=field.minLength;attrs.maxLength=field.maxLength;this._evaluateAttributeValues(attrs,_entireObject);if(attrs.minLength!==undefined&&value.length<attrs.minLength||attrs.maxLength!==undefined&&value.length>attrs.maxLength)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be at least "+attrs.minLength+` character${attrs.minLength!==1?"":"s"}`+" and at most "+attrs.maxLength+` character${attrs.maxLength!==1?"":"s"}`+"."});return ValidationResult.success();case"boolean":if(value!==false&&value!==true)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} must be either true or false."});return ValidationResult.success();case"number":if(isNaN(value))return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} must be a number."});attrs.min=field.min;attrs.max=field.max;this._evaluateAttributeValues(attrs,_entireObject);if(attrs.min!==undefined&&value<attrs.min||attrs.max!==undefined&&value>attrs.max)return this._fail({field,fieldName,parentName,defaultMessage:"The ${fieldName} field must be at least "+attrs.min+" and at most "+attrs.max+" in value."});return ValidationResult.success();default:throw new Error(`Invalid or unimplemented validation type '${field.type}' encountered!`);}}_evaluateAttributeValues(attrs,entireObjectToValidate){for(const key of Object.values(attrs)){const entry=attrs[key];if(typeof entry==="object"&&(typeof entry["$eq"]==="string"||typeof entry["$eval"]==="function")){if(typeof entry["$eq"]==="string"&&typeof entry["$eval"]==="function")throw new Error("You cannot set both $eq and $eval attribute operators. They are mutually exclusive.");if(typeof entry["$eval"]==="function"){attrs[key]=entry["$eval"](entireObjectToValidate);}else if(typeof entry["$eq"]==="string"){attrs[key]=cinnamonInternals$1.data.resolveObjectDeep(entry["$eq"],entireObjectToValidate);}}}}_fail(options){return ValidationResult.fail(this._badFieldMessage(options))}_badFieldMessage(options){var _ref,_options$field$invali;const message=(_ref=(_options$field$invali=options.field.invalidMessage)!==null&&_options$field$invali!==void 0?_options$field$invali:options.defaultMessage)!==null&&_ref!==void 0?_ref:"The ${fieldName} field was invalid.";return message.replace(/\$\{fieldName\}/g,this._toHumanReadableFieldName(`${options.parentName}.${options.fieldName}`))}_toHumanReadableFieldName(fieldName){return fieldName.replace(/^\$root\./,"").replace("."," > ").replace("_"," ").replace("-","").replace(/(?<!^)[A-Z]/g,char=>" "+char.toLowerCase())}_isValidationSchemaObject(value){if(typeof value!=="object")return false;for(let entry of Object.values(value)){if(!entry["type"]||typeof entry["type"]!=="string")return false}return true}}

function createValidator(schema){return new Validator(schema)}

class Config extends CinnamonModule{get hasAppConfig(){return this.appConfig!==null&&this.appConfig!==undefined}constructor(framework,appConfig,appConfigSchema){super(framework);_defineProperty(this,"appConfig",void 0);_defineProperty(this,"didFailValidation",void 0);if(appConfigSchema&&!createValidator(appConfigSchema).validate(appConfig)){this.didFailValidation=true;this.appConfig=null;}else {this.didFailValidation=false;this.appConfig=appConfig;}}get(key){if(!this.appConfig)throw new Error("There is no app configuration loaded.\n"+"You can initialize a runtime app configuration by calling set to add a key to a new, empty, configuration.\n"+"Alternatively, ensure that no validation errors occurred whilst loading the configuration *and* that you have a loadable app configuration in your cinnamon.toml.");const result=cinnamonInternals$1.data.resolveObjectDeep(key,this.appConfig);if(result===undefined)throw new Error("No object located at the specified key.");return result}set(key,value){const jsonValue=JSON.stringify(value);if(JSON.parse(jsonValue)!==value){throw new Error("This type of value cannot be stored.")}if(!this.appConfig)this.appConfig={};cinnamonInternals$1.data.setObjectDeep(key,value,this.appConfig);}}

var ansiStyles$1 = {exports: {}};

var colorName={"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aqua":[0,255,255],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"black":[0,0,0],"blanchedalmond":[255,235,205],"blue":[0,0,255],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"fuchsia":[255,0,255],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"gray":[128,128,128],"green":[0,128,0],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"lime":[0,255,0],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"maroon":[128,0,0],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"navy":[0,0,128],"oldlace":[253,245,230],"olive":[128,128,0],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"purple":[128,0,128],"rebeccapurple":[102,51,153],"red":[255,0,0],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"silver":[192,192,192],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"teal":[0,128,128],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"white":[255,255,255],"whitesmoke":[245,245,245],"yellow":[255,255,0],"yellowgreen":[154,205,50]};

const cssKeywords=colorName;const reverseKeywords={};for(const key of Object.keys(cssKeywords)){reverseKeywords[cssKeywords[key]]=key;}const convert$3={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var conversions$2=convert$3;for(const model of Object.keys(convert$3)){if(!("channels"in convert$3[model])){throw new Error("missing channels property: "+model)}if(!("labels"in convert$3[model])){throw new Error("missing channel labels property: "+model)}if(convert$3[model].labels.length!==convert$3[model].channels){throw new Error("channel and label counts mismatch: "+model)}const{channels,labels}=convert$3[model];delete convert$3[model].channels;delete convert$3[model].labels;Object.defineProperty(convert$3[model],"channels",{value:channels});Object.defineProperty(convert$3[model],"labels",{value:labels});}convert$3.rgb.hsl=function(rgb){const r=rgb[0]/255;const g=rgb[1]/255;const b=rgb[2]/255;const min=Math.min(r,g,b);const max=Math.max(r,g,b);const delta=max-min;let h;let s;if(max===min){h=0;}else if(r===max){h=(g-b)/delta;}else if(g===max){h=2+(b-r)/delta;}else if(b===max){h=4+(r-g)/delta;}h=Math.min(h*60,360);if(h<0){h+=360;}const l=(min+max)/2;if(max===min){s=0;}else if(l<=0.5){s=delta/(max+min);}else {s=delta/(2-max-min);}return [h,s*100,l*100]};convert$3.rgb.hsv=function(rgb){let rdif;let gdif;let bdif;let h;let s;const r=rgb[0]/255;const g=rgb[1]/255;const b=rgb[2]/255;const v=Math.max(r,g,b);const diff=v-Math.min(r,g,b);const diffc=function(c){return (v-c)/6/diff+1/2};if(diff===0){h=0;s=0;}else {s=diff/v;rdif=diffc(r);gdif=diffc(g);bdif=diffc(b);if(r===v){h=bdif-gdif;}else if(g===v){h=1/3+rdif-bdif;}else if(b===v){h=2/3+gdif-rdif;}if(h<0){h+=1;}else if(h>1){h-=1;}}return [h*360,s*100,v*100]};convert$3.rgb.hwb=function(rgb){const r=rgb[0];const g=rgb[1];let b=rgb[2];const h=convert$3.rgb.hsl(rgb)[0];const w=1/255*Math.min(r,Math.min(g,b));b=1-1/255*Math.max(r,Math.max(g,b));return [h,w*100,b*100]};convert$3.rgb.cmyk=function(rgb){const r=rgb[0]/255;const g=rgb[1]/255;const b=rgb[2]/255;const k=Math.min(1-r,1-g,1-b);const c=(1-r-k)/(1-k)||0;const m=(1-g-k)/(1-k)||0;const y=(1-b-k)/(1-k)||0;return [c*100,m*100,y*100,k*100]};function comparativeDistance(x,y){return (x[0]-y[0])**2+(x[1]-y[1])**2+(x[2]-y[2])**2}convert$3.rgb.keyword=function(rgb){const reversed=reverseKeywords[rgb];if(reversed){return reversed}let currentClosestDistance=Infinity;let currentClosestKeyword;for(const keyword of Object.keys(cssKeywords)){const value=cssKeywords[keyword];const distance=comparativeDistance(rgb,value);if(distance<currentClosestDistance){currentClosestDistance=distance;currentClosestKeyword=keyword;}}return currentClosestKeyword};convert$3.keyword.rgb=function(keyword){return cssKeywords[keyword]};convert$3.rgb.xyz=function(rgb){let r=rgb[0]/255;let g=rgb[1]/255;let b=rgb[2]/255;r=r>0.04045?((r+0.055)/1.055)**2.4:r/12.92;g=g>0.04045?((g+0.055)/1.055)**2.4:g/12.92;b=b>0.04045?((b+0.055)/1.055)**2.4:b/12.92;const x=r*0.4124+g*0.3576+b*0.1805;const y=r*0.2126+g*0.7152+b*0.0722;const z=r*0.0193+g*0.1192+b*0.9505;return [x*100,y*100,z*100]};convert$3.rgb.lab=function(rgb){const xyz=convert$3.rgb.xyz(rgb);let x=xyz[0];let y=xyz[1];let z=xyz[2];x/=95.047;y/=100;z/=108.883;x=x>0.008856?x**(1/3):7.787*x+16/116;y=y>0.008856?y**(1/3):7.787*y+16/116;z=z>0.008856?z**(1/3):7.787*z+16/116;const l=116*y-16;const a=500*(x-y);const b=200*(y-z);return [l,a,b]};convert$3.hsl.rgb=function(hsl){const h=hsl[0]/360;const s=hsl[1]/100;const l=hsl[2]/100;let t2;let t3;let val;if(s===0){val=l*255;return [val,val,val]}if(l<0.5){t2=l*(1+s);}else {t2=l+s-l*s;}const t1=2*l-t2;const rgb=[0,0,0];for(let i=0;i<3;i++){t3=h+1/3*-(i-1);if(t3<0){t3++;}if(t3>1){t3--;}if(6*t3<1){val=t1+(t2-t1)*6*t3;}else if(2*t3<1){val=t2;}else if(3*t3<2){val=t1+(t2-t1)*(2/3-t3)*6;}else {val=t1;}rgb[i]=val*255;}return rgb};convert$3.hsl.hsv=function(hsl){const h=hsl[0];let s=hsl[1]/100;let l=hsl[2]/100;let smin=s;const lmin=Math.max(l,0.01);l*=2;s*=l<=1?l:2-l;smin*=lmin<=1?lmin:2-lmin;const v=(l+s)/2;const sv=l===0?2*smin/(lmin+smin):2*s/(l+s);return [h,sv*100,v*100]};convert$3.hsv.rgb=function(hsv){const h=hsv[0]/60;const s=hsv[1]/100;let v=hsv[2]/100;const hi=Math.floor(h)%6;const f=h-Math.floor(h);const p=255*v*(1-s);const q=255*v*(1-s*f);const t=255*v*(1-s*(1-f));v*=255;switch(hi){case 0:return [v,t,p];case 1:return [q,v,p];case 2:return [p,v,t];case 3:return [p,q,v];case 4:return [t,p,v];case 5:return [v,p,q];}};convert$3.hsv.hsl=function(hsv){const h=hsv[0];const s=hsv[1]/100;const v=hsv[2]/100;const vmin=Math.max(v,0.01);let sl;let l;l=(2-s)*v;const lmin=(2-s)*vmin;sl=s*vmin;sl/=lmin<=1?lmin:2-lmin;sl=sl||0;l/=2;return [h,sl*100,l*100]};convert$3.hwb.rgb=function(hwb){const h=hwb[0]/360;let wh=hwb[1]/100;let bl=hwb[2]/100;const ratio=wh+bl;let f;if(ratio>1){wh/=ratio;bl/=ratio;}const i=Math.floor(6*h);const v=1-bl;f=6*h-i;if((i&1)!==0){f=1-f;}const n=wh+f*(v-wh);let r;let g;let b;switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break;}return [r*255,g*255,b*255]};convert$3.cmyk.rgb=function(cmyk){const c=cmyk[0]/100;const m=cmyk[1]/100;const y=cmyk[2]/100;const k=cmyk[3]/100;const r=1-Math.min(1,c*(1-k)+k);const g=1-Math.min(1,m*(1-k)+k);const b=1-Math.min(1,y*(1-k)+k);return [r*255,g*255,b*255]};convert$3.xyz.rgb=function(xyz){const x=xyz[0]/100;const y=xyz[1]/100;const z=xyz[2]/100;let r;let g;let b;r=x*3.2406+y*-1.5372+z*-0.4986;g=x*-0.9689+y*1.8758+z*0.0415;b=x*0.0557+y*-0.204+z*1.057;r=r>0.0031308?1.055*r**(1/2.4)-0.055:r*12.92;g=g>0.0031308?1.055*g**(1/2.4)-0.055:g*12.92;b=b>0.0031308?1.055*b**(1/2.4)-0.055:b*12.92;r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return [r*255,g*255,b*255]};convert$3.xyz.lab=function(xyz){let x=xyz[0];let y=xyz[1];let z=xyz[2];x/=95.047;y/=100;z/=108.883;x=x>0.008856?x**(1/3):7.787*x+16/116;y=y>0.008856?y**(1/3):7.787*y+16/116;z=z>0.008856?z**(1/3):7.787*z+16/116;const l=116*y-16;const a=500*(x-y);const b=200*(y-z);return [l,a,b]};convert$3.lab.xyz=function(lab){const l=lab[0];const a=lab[1];const b=lab[2];let x;let y;let z;y=(l+16)/116;x=a/500+y;z=y-b/200;const y2=y**3;const x2=x**3;const z2=z**3;y=y2>0.008856?y2:(y-16/116)/7.787;x=x2>0.008856?x2:(x-16/116)/7.787;z=z2>0.008856?z2:(z-16/116)/7.787;x*=95.047;y*=100;z*=108.883;return [x,y,z]};convert$3.lab.lch=function(lab){const l=lab[0];const a=lab[1];const b=lab[2];let h;const hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360;}const c=Math.sqrt(a*a+b*b);return [l,c,h]};convert$3.lch.lab=function(lch){const l=lch[0];const c=lch[1];const h=lch[2];const hr=h/360*2*Math.PI;const a=c*Math.cos(hr);const b=c*Math.sin(hr);return [l,a,b]};convert$3.rgb.ansi16=function(args,saturation=null){const[r,g,b]=args;let value=saturation===null?convert$3.rgb.hsv(args)[2]:saturation;value=Math.round(value/50);if(value===0){return 30}let ansi=30+(Math.round(b/255)<<2|Math.round(g/255)<<1|Math.round(r/255));if(value===2){ansi+=60;}return ansi};convert$3.hsv.ansi16=function(args){return convert$3.rgb.ansi16(convert$3.hsv.rgb(args),args[2])};convert$3.rgb.ansi256=function(args){const r=args[0];const g=args[1];const b=args[2];if(r===g&&g===b){if(r<8){return 16}if(r>248){return 231}return Math.round((r-8)/247*24)+232}const ansi=16+36*Math.round(r/255*5)+6*Math.round(g/255*5)+Math.round(b/255*5);return ansi};convert$3.ansi16.rgb=function(args){let color=args%10;if(color===0||color===7){if(args>50){color+=3.5;}color=color/10.5*255;return [color,color,color]}const mult=(~~(args>50)+1)*0.5;const r=(color&1)*mult*255;const g=(color>>1&1)*mult*255;const b=(color>>2&1)*mult*255;return [r,g,b]};convert$3.ansi256.rgb=function(args){if(args>=232){const c=(args-232)*10+8;return [c,c,c]}args-=16;let rem;const r=Math.floor(args/36)/5*255;const g=Math.floor((rem=args%36)/6)/5*255;const b=rem%6/5*255;return [r,g,b]};convert$3.rgb.hex=function(args){const integer=((Math.round(args[0])&255)<<16)+((Math.round(args[1])&255)<<8)+(Math.round(args[2])&255);const string=integer.toString(16).toUpperCase();return "000000".substring(string.length)+string};convert$3.hex.rgb=function(args){const match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match){return [0,0,0]}let colorString=match[0];if(match[0].length===3){colorString=colorString.split("").map(char=>{return char+char}).join("");}const integer=parseInt(colorString,16);const r=integer>>16&255;const g=integer>>8&255;const b=integer&255;return [r,g,b]};convert$3.rgb.hcg=function(rgb){const r=rgb[0]/255;const g=rgb[1]/255;const b=rgb[2]/255;const max=Math.max(Math.max(r,g),b);const min=Math.min(Math.min(r,g),b);const chroma=max-min;let grayscale;let hue;if(chroma<1){grayscale=min/(1-chroma);}else {grayscale=0;}if(chroma<=0){hue=0;}else if(max===r){hue=(g-b)/chroma%6;}else if(max===g){hue=2+(b-r)/chroma;}else {hue=4+(r-g)/chroma;}hue/=6;hue%=1;return [hue*360,chroma*100,grayscale*100]};convert$3.hsl.hcg=function(hsl){const s=hsl[1]/100;const l=hsl[2]/100;const c=l<0.5?2*s*l:2*s*(1-l);let f=0;if(c<1){f=(l-0.5*c)/(1-c);}return [hsl[0],c*100,f*100]};convert$3.hsv.hcg=function(hsv){const s=hsv[1]/100;const v=hsv[2]/100;const c=s*v;let f=0;if(c<1){f=(v-c)/(1-c);}return [hsv[0],c*100,f*100]};convert$3.hcg.rgb=function(hcg){const h=hcg[0]/360;const c=hcg[1]/100;const g=hcg[2]/100;if(c===0){return [g*255,g*255,g*255]}const pure=[0,0,0];const hi=h%1*6;const v=hi%1;const w=1-v;let mg=0;switch(Math.floor(hi)){case 0:pure[0]=1;pure[1]=v;pure[2]=0;break;case 1:pure[0]=w;pure[1]=1;pure[2]=0;break;case 2:pure[0]=0;pure[1]=1;pure[2]=v;break;case 3:pure[0]=0;pure[1]=w;pure[2]=1;break;case 4:pure[0]=v;pure[1]=0;pure[2]=1;break;default:pure[0]=1;pure[1]=0;pure[2]=w;}mg=(1-c)*g;return [(c*pure[0]+mg)*255,(c*pure[1]+mg)*255,(c*pure[2]+mg)*255]};convert$3.hcg.hsv=function(hcg){const c=hcg[1]/100;const g=hcg[2]/100;const v=c+g*(1-c);let f=0;if(v>0){f=c/v;}return [hcg[0],f*100,v*100]};convert$3.hcg.hsl=function(hcg){const c=hcg[1]/100;const g=hcg[2]/100;const l=g*(1-c)+0.5*c;let s=0;if(l>0&&l<0.5){s=c/(2*l);}else if(l>=0.5&&l<1){s=c/(2*(1-l));}return [hcg[0],s*100,l*100]};convert$3.hcg.hwb=function(hcg){const c=hcg[1]/100;const g=hcg[2]/100;const v=c+g*(1-c);return [hcg[0],(v-c)*100,(1-v)*100]};convert$3.hwb.hcg=function(hwb){const w=hwb[1]/100;const b=hwb[2]/100;const v=1-b;const c=v-w;let g=0;if(c<1){g=(v-c)/(1-c);}return [hwb[0],c*100,g*100]};convert$3.apple.rgb=function(apple){return [apple[0]/65535*255,apple[1]/65535*255,apple[2]/65535*255]};convert$3.rgb.apple=function(rgb){return [rgb[0]/255*65535,rgb[1]/255*65535,rgb[2]/255*65535]};convert$3.gray.rgb=function(args){return [args[0]/100*255,args[0]/100*255,args[0]/100*255]};convert$3.gray.hsl=function(args){return [0,0,args[0]]};convert$3.gray.hsv=convert$3.gray.hsl;convert$3.gray.hwb=function(gray){return [0,100,gray[0]]};convert$3.gray.cmyk=function(gray){return [0,0,0,gray[0]]};convert$3.gray.lab=function(gray){return [gray[0],0,0]};convert$3.gray.hex=function(gray){const val=Math.round(gray[0]/100*255)&255;const integer=(val<<16)+(val<<8)+val;const string=integer.toString(16).toUpperCase();return "000000".substring(string.length)+string};convert$3.rgb.gray=function(rgb){const val=(rgb[0]+rgb[1]+rgb[2])/3;return [val/255*100]};

const conversions$1=conversions$2;function buildGraph(){const graph={};const models=Object.keys(conversions$1);for(let len=models.length,i=0;i<len;i++){graph[models[i]]={distance:-1,parent:null};}return graph}function deriveBFS(fromModel){const graph=buildGraph();const queue=[fromModel];graph[fromModel].distance=0;while(queue.length){const current=queue.pop();const adjacents=Object.keys(conversions$1[current]);for(let len=adjacents.length,i=0;i<len;i++){const adjacent=adjacents[i];const node=graph[adjacent];if(node.distance===-1){node.distance=graph[current].distance+1;node.parent=current;queue.unshift(adjacent);}}}return graph}function link$2(from,to){return function(args){return to(from(args))}}function wrapConversion(toModel,graph){const path=[graph[toModel].parent,toModel];let fn=conversions$1[graph[toModel].parent][toModel];let cur=graph[toModel].parent;while(graph[cur].parent){path.unshift(graph[cur].parent);fn=link$2(conversions$1[graph[cur].parent][cur],fn);cur=graph[cur].parent;}fn.conversion=path;return fn}var route$1=function(fromModel){const graph=deriveBFS(fromModel);const conversion={};const models=Object.keys(graph);for(let len=models.length,i=0;i<len;i++){const toModel=models[i];const node=graph[toModel];if(node.parent===null){continue}conversion[toModel]=wrapConversion(toModel,graph);}return conversion};

const conversions=conversions$2;const route=route$1;const convert$2={};const models=Object.keys(conversions);function wrapRaw(fn){const wrappedFn=function(...args){const arg0=args[0];if(arg0===undefined||arg0===null){return arg0}if(arg0.length>1){args=arg0;}return fn(args)};if("conversion"in fn){wrappedFn.conversion=fn.conversion;}return wrappedFn}function wrapRounded(fn){const wrappedFn=function(...args){const arg0=args[0];if(arg0===undefined||arg0===null){return arg0}if(arg0.length>1){args=arg0;}const result=fn(args);if(typeof result==="object"){for(let len=result.length,i=0;i<len;i++){result[i]=Math.round(result[i]);}}return result};if("conversion"in fn){wrappedFn.conversion=fn.conversion;}return wrappedFn}models.forEach(fromModel=>{convert$2[fromModel]={};Object.defineProperty(convert$2[fromModel],"channels",{value:conversions[fromModel].channels});Object.defineProperty(convert$2[fromModel],"labels",{value:conversions[fromModel].labels});const routes=route(fromModel);const routeModels=Object.keys(routes);routeModels.forEach(toModel=>{const fn=routes[toModel];convert$2[fromModel][toModel]=wrapRounded(fn);convert$2[fromModel][toModel].raw=wrapRaw(fn);});});var colorConvert=convert$2;

(function(module){const wrapAnsi16=(fn,offset)=>(...args)=>{const code=fn(...args);return `\u001B[${code+offset}m`};const wrapAnsi256=(fn,offset)=>(...args)=>{const code=fn(...args);return `\u001B[${38+offset};5;${code}m`};const wrapAnsi16m=(fn,offset)=>(...args)=>{const rgb=fn(...args);return `\u001B[${38+offset};2;${rgb[0]};${rgb[1]};${rgb[2]}m`};const ansi2ansi=n=>n;const rgb2rgb=(r,g,b)=>[r,g,b];const setLazyProperty=(object,property,get)=>{Object.defineProperty(object,property,{get:()=>{const value=get();Object.defineProperty(object,property,{value,enumerable:true,configurable:true});return value},enumerable:true,configurable:true});};let colorConvert$1;const makeDynamicStyles=(wrap,targetSpace,identity,isBackground)=>{if(colorConvert$1===undefined){colorConvert$1=colorConvert;}const offset=isBackground?10:0;const styles={};for(const[sourceSpace,suite]of Object.entries(colorConvert$1)){const name=sourceSpace==="ansi16"?"ansi":sourceSpace;if(sourceSpace===targetSpace){styles[name]=wrap(identity,offset);}else if(typeof suite==="object"){styles[name]=wrap(suite[targetSpace],offset);}}return styles};function assembleStyles(){const codes=new Map;const styles={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};styles.color.gray=styles.color.blackBright;styles.bgColor.bgGray=styles.bgColor.bgBlackBright;styles.color.grey=styles.color.blackBright;styles.bgColor.bgGrey=styles.bgColor.bgBlackBright;for(const[groupName,group]of Object.entries(styles)){for(const[styleName,style]of Object.entries(group)){styles[styleName]={open:`\u001B[${style[0]}m`,close:`\u001B[${style[1]}m`};group[styleName]=styles[styleName];codes.set(style[0],style[1]);}Object.defineProperty(styles,groupName,{value:group,enumerable:false});}Object.defineProperty(styles,"codes",{value:codes,enumerable:false});styles.color.close="\x1B[39m";styles.bgColor.close="\x1B[49m";setLazyProperty(styles.color,"ansi",()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,false));setLazyProperty(styles.color,"ansi256",()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,false));setLazyProperty(styles.color,"ansi16m",()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,false));setLazyProperty(styles.bgColor,"ansi",()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,true));setLazyProperty(styles.bgColor,"ansi256",()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,true));setLazyProperty(styles.bgColor,"ansi16m",()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,true));return styles}Object.defineProperty(module,"exports",{enumerable:true,get:assembleStyles});})(ansiStyles$1);

var hasFlag$1=(flag,argv=process.argv)=>{const prefix=flag.startsWith("-")?"":flag.length===1?"-":"--";const position=argv.indexOf(prefix+flag);const terminatorPosition=argv.indexOf("--");return position!==-1&&(terminatorPosition===-1||position<terminatorPosition)};

const os=require$$1__default$1["default"];const tty=require$$1__default["default"];const hasFlag=hasFlag$1;const{env}=process;let forceColor;if(hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false")||hasFlag("color=never")){forceColor=0;}else if(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always")){forceColor=1;}if("FORCE_COLOR"in env){if(env.FORCE_COLOR==="true"){forceColor=1;}else if(env.FORCE_COLOR==="false"){forceColor=0;}else {forceColor=env.FORCE_COLOR.length===0?1:Math.min(parseInt(env.FORCE_COLOR,10),3);}}function translateLevel(level){if(level===0){return false}return {level,hasBasic:true,has256:level>=2,has16m:level>=3}}function supportsColor(haveStream,streamIsTTY){if(forceColor===0){return 0}if(hasFlag("color=16m")||hasFlag("color=full")||hasFlag("color=truecolor")){return 3}if(hasFlag("color=256")){return 2}if(haveStream&&!streamIsTTY&&forceColor===undefined){return 0}const min=forceColor||0;if(env.TERM==="dumb"){return min}if(process.platform==="win32"){const osRelease=os.release().split(".");if(Number(osRelease[0])>=10&&Number(osRelease[2])>=10586){return Number(osRelease[2])>=14931?3:2}return 1}if("CI"in env){if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(sign=>sign in env)||env.CI_NAME==="codeship"){return 1}return min}if("TEAMCITY_VERSION"in env){return /^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(env.TEAMCITY_VERSION)?1:0}if(env.COLORTERM==="truecolor"){return 3}if("TERM_PROGRAM"in env){const version=parseInt((env.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(env.TERM_PROGRAM){case"iTerm.app":return version>=3?3:2;case"Apple_Terminal":return 2;}}if(/-256(color)?$/i.test(env.TERM)){return 2}if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(env.TERM)){return 1}if("COLORTERM"in env){return 1}return min}function getSupportLevel(stream){const level=supportsColor(stream,stream&&stream.isTTY);return translateLevel(level)}var supportsColor_1={supportsColor:getSupportLevel,stdout:translateLevel(supportsColor(true,tty.isatty(1))),stderr:translateLevel(supportsColor(true,tty.isatty(2)))};

const stringReplaceAll$1=(string,substring,replacer)=>{let index=string.indexOf(substring);if(index===-1){return string}const substringLength=substring.length;let endIndex=0;let returnValue="";do{returnValue+=string.substr(endIndex,index-endIndex)+substring+replacer;endIndex=index+substringLength;index=string.indexOf(substring,endIndex);}while(index!==-1);returnValue+=string.substr(endIndex);return returnValue};const stringEncaseCRLFWithFirstIndex$1=(string,prefix,postfix,index)=>{let endIndex=0;let returnValue="";do{const gotCR=string[index-1]==="\r";returnValue+=string.substr(endIndex,(gotCR?index-1:index)-endIndex)+prefix+(gotCR?"\r\n":"\n")+postfix;endIndex=index+1;index=string.indexOf("\n",endIndex);}while(index!==-1);returnValue+=string.substr(endIndex);return returnValue};var util$6={stringReplaceAll: stringReplaceAll$1,stringEncaseCRLFWithFirstIndex: stringEncaseCRLFWithFirstIndex$1};

const TEMPLATE_REGEX=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi;const STYLE_REGEX=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g;const STRING_REGEX=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/;const ESCAPE_REGEX=/\\(u(?:[a-f\d]{4}|{[a-f\d]{1,6}})|x[a-f\d]{2}|.)|([^\\])/gi;const ESCAPES=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\x0B"],["0","\0"],["\\","\\"],["e","\x1B"],["a","\x07"]]);function unescape$1(c){const u=c[0]==="u";const bracket=c[1]==="{";if(u&&!bracket&&c.length===5||c[0]==="x"&&c.length===3){return String.fromCharCode(parseInt(c.slice(1),16))}if(u&&bracket){return String.fromCodePoint(parseInt(c.slice(2,-1),16))}return ESCAPES.get(c)||c}function parseArguments(name,arguments_){const results=[];const chunks=arguments_.trim().split(/\s*,\s*/g);let matches;for(const chunk of chunks){const number=Number(chunk);if(!Number.isNaN(number)){results.push(number);}else if(matches=chunk.match(STRING_REGEX)){results.push(matches[2].replace(ESCAPE_REGEX,(m,escape,character)=>escape?unescape$1(escape):character));}else {throw new Error(`Invalid Chalk template style argument: ${chunk} (in style '${name}')`)}}return results}function parseStyle(style){STYLE_REGEX.lastIndex=0;const results=[];let matches;while((matches=STYLE_REGEX.exec(style))!==null){const name=matches[1];if(matches[2]){const args=parseArguments(name,matches[2]);results.push([name].concat(args));}else {results.push([name]);}}return results}function buildStyle(chalk,styles){const enabled={};for(const layer of styles){for(const style of layer.styles){enabled[style[0]]=layer.inverse?null:style.slice(1);}}let current=chalk;for(const[styleName,styles]of Object.entries(enabled)){if(!Array.isArray(styles)){continue}if(!(styleName in current)){throw new Error(`Unknown Chalk style: ${styleName}`)}current=styles.length>0?current[styleName](...styles):current[styleName];}return current}var templates=(chalk,temporary)=>{const styles=[];const chunks=[];let chunk=[];temporary.replace(TEMPLATE_REGEX,(m,escapeCharacter,inverse,style,close,character)=>{if(escapeCharacter){chunk.push(unescape$1(escapeCharacter));}else if(style){const string=chunk.join("");chunk=[];chunks.push(styles.length===0?string:buildStyle(chalk,styles)(string));styles.push({inverse,styles:parseStyle(style)});}else if(close){if(styles.length===0){throw new Error("Found extraneous } in Chalk template literal")}chunks.push(buildStyle(chalk,styles)(chunk.join("")));chunk=[];styles.pop();}else {chunk.push(character);}});chunks.push(chunk.join(""));if(styles.length>0){const errMessage=`Chalk template literal is missing ${styles.length} closing bracket${styles.length===1?"":"s"} (\`}\`)`;throw new Error(errMessage)}return chunks.join("")};

const ansiStyles=ansiStyles$1.exports;const{stdout:stdoutColor,stderr:stderrColor}=supportsColor_1;const{stringReplaceAll,stringEncaseCRLFWithFirstIndex}=util$6;const{isArray}=Array;const levelMapping=["ansi","ansi","ansi256","ansi16m"];const styles=Object.create(null);const applyOptions=(object,options={})=>{if(options.level&&!(Number.isInteger(options.level)&&options.level>=0&&options.level<=3)){throw new Error("The `level` option should be an integer from 0 to 3")}const colorLevel=stdoutColor?stdoutColor.level:0;object.level=options.level===undefined?colorLevel:options.level;};class ChalkClass{constructor(options){return chalkFactory(options)}}const chalkFactory=options=>{const chalk={};applyOptions(chalk,options);chalk.template=(...arguments_)=>chalkTag(chalk.template,...arguments_);Object.setPrototypeOf(chalk,Chalk.prototype);Object.setPrototypeOf(chalk.template,chalk);chalk.template.constructor=()=>{throw new Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")};chalk.template.Instance=ChalkClass;return chalk.template};function Chalk(options){return chalkFactory(options)}for(const[styleName,style]of Object.entries(ansiStyles)){styles[styleName]={get(){const builder=createBuilder(this,createStyler(style.open,style.close,this._styler),this._isEmpty);Object.defineProperty(this,styleName,{value:builder});return builder}};}styles.visible={get(){const builder=createBuilder(this,this._styler,true);Object.defineProperty(this,"visible",{value:builder});return builder}};const usedModels=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(const model of usedModels){styles[model]={get(){const{level}=this;return function(...arguments_){const styler=createStyler(ansiStyles.color[levelMapping[level]][model](...arguments_),ansiStyles.color.close,this._styler);return createBuilder(this,styler,this._isEmpty)}}};}for(const model of usedModels){const bgModel="bg"+model[0].toUpperCase()+model.slice(1);styles[bgModel]={get(){const{level}=this;return function(...arguments_){const styler=createStyler(ansiStyles.bgColor[levelMapping[level]][model](...arguments_),ansiStyles.bgColor.close,this._styler);return createBuilder(this,styler,this._isEmpty)}}};}const proto=Object.defineProperties(()=>{},{...styles,level:{enumerable:true,get(){return this._generator.level},set(level){this._generator.level=level;}}});const createStyler=(open,close,parent)=>{let openAll;let closeAll;if(parent===undefined){openAll=open;closeAll=close;}else {openAll=parent.openAll+open;closeAll=close+parent.closeAll;}return {open,close,openAll,closeAll,parent}};const createBuilder=(self,_styler,_isEmpty)=>{const builder=(...arguments_)=>{if(isArray(arguments_[0])&&isArray(arguments_[0].raw)){return applyStyle(builder,chalkTag(builder,...arguments_))}return applyStyle(builder,arguments_.length===1?""+arguments_[0]:arguments_.join(" "))};Object.setPrototypeOf(builder,proto);builder._generator=self;builder._styler=_styler;builder._isEmpty=_isEmpty;return builder};const applyStyle=(self,string)=>{if(self.level<=0||!string){return self._isEmpty?"":string}let styler=self._styler;if(styler===undefined){return string}const{openAll,closeAll}=styler;if(string.indexOf("\x1B")!==-1){while(styler!==undefined){string=stringReplaceAll(string,styler.close,styler.open);styler=styler.parent;}}const lfIndex=string.indexOf("\n");if(lfIndex!==-1){string=stringEncaseCRLFWithFirstIndex(string,closeAll,openAll,lfIndex);}return openAll+string+closeAll};let template;const chalkTag=(chalk,...strings)=>{const[firstString]=strings;if(!isArray(firstString)||!isArray(firstString.raw)){return strings.join(" ")}const arguments_=strings.slice(1);const parts=[firstString.raw[0]];for(let i=1;i<firstString.length;i++){parts.push(String(arguments_[i-1]).replace(/[{}\\]/g,"\\$&"),String(firstString.raw[i]));}if(template===undefined){template=templates;}return template(chalk,parts.join(""))};Object.defineProperties(Chalk.prototype,styles);const chalk=Chalk();chalk.supportsColor=stdoutColor;chalk.stderr=Chalk({level:stderrColor?stderrColor.level:0});chalk.stderr.supportsColor=stderrColor;var source=chalk;

var index = /*#__PURE__*/Object.freeze(/*#__PURE__*/_mergeNamespaces({
  __proto__: null,
  'default': source
}, [source]));

var LogLevel;(function(LogLevel){LogLevel[LogLevel["FRAMEWORK"]=-1]="FRAMEWORK";LogLevel[LogLevel["DEBUG"]=0]="DEBUG";LogLevel[LogLevel["INFO"]=1]="INFO";LogLevel[LogLevel["WARN"]=2]="WARN";LogLevel[LogLevel["ERROR"]=3]="ERROR";})(LogLevel||(LogLevel={}));class Logger$2 extends CinnamonModule{constructor(framework,showDebugMessages=false,options){var _options$showFramewor;super(framework);_defineProperty(this,"showDebugMessages",void 0);_defineProperty(this,"showFrameworkDebugMessages",void 0);_defineProperty(this,"logDelegate",void 0);this.showDebugMessages=showDebugMessages;this.logDelegate=options===null||options===void 0?void 0:options.logDelegate;this.showFrameworkDebugMessages=(_options$showFramewor=options===null||options===void 0?void 0:options.showFrameworkDebugMessages)!==null&&_options$showFramewor!==void 0?_options$showFramewor:false;}frameworkDebug(message,module){this.log({level:LogLevel.FRAMEWORK,timestamp:new Date,module,message});}debug(message,module){this.log({level:LogLevel.DEBUG,timestamp:new Date,module,message});}info(message,module){this.log({level:LogLevel.INFO,timestamp:new Date,module,message});}warn(message,module){this.log({level:LogLevel.WARN,timestamp:new Date,module,message});}error(message,module){this.log({level:LogLevel.ERROR,timestamp:new Date,module,message});}log(entry){let posixPrintFunction=entry.level!==LogLevel.ERROR?console.error:console.log;let printFunction;switch(entry.level){case LogLevel.FRAMEWORK:if(!this.showFrameworkDebugMessages){printFunction=null;break}printFunction=(...data)=>posixPrintFunction(source.bgGray.whiteBright(...data));break;case LogLevel.DEBUG:if(!this.showDebugMessages){printFunction=null;break}printFunction=(...data)=>posixPrintFunction(source.bgGray.whiteBright(...data));break;case LogLevel.WARN:printFunction=(...data)=>posixPrintFunction(source.bgRed.whiteBright.bold(...data));break;case LogLevel.ERROR:printFunction=(...data)=>posixPrintFunction(source.red(...data));break;default:printFunction=(...data)=>posixPrintFunction(...data);break;}const moduleName=entry.module?` [${entry.module}]`:"";if(printFunction!==null)printFunction(`${LogLevel[entry.level]}\t[${this.framework.appName}]${moduleName} [${Logger$2.timestampStringFor(entry.timestamp)}] ${entry.message}`);if(this.logDelegate!=null&&(entry.level!=LogLevel.FRAMEWORK||this.showFrameworkDebugMessages))this.logDelegate({...entry,levelString:LogLevel[entry.level],prefix:this.framework.appName,timestampString:Logger$2.timestampStringFor(entry.timestamp)});}static timestampStringFor(date){let padStart=_=>_.toString().padStart(2,"0");let time=`${padStart(date.getHours())}:${padStart(date.getMinutes())}:${padStart(date.getSeconds())}`;return `${date.getFullYear()}-${padStart(date.getMonth()+1)}-${padStart(date.getDate())} ${time}`}}

var core = {};

var typings$1 = {};

var enums = {};

(function(exports){Object.defineProperty(exports,"__esModule",{value:true});exports.EventType=exports.LockMode=exports.LoadStrategy=exports.Cascade=exports.ReferenceType=exports.SCALAR_TYPES=exports.QueryFlag=exports.QueryOrderNumeric=exports.QueryOrder=exports.ARRAY_OPERATORS=exports.QueryOperator=exports.GroupOperator=void 0;(function(GroupOperator){GroupOperator["$and"]="and";GroupOperator["$or"]="or";})(exports.GroupOperator||(exports.GroupOperator={}));(function(QueryOperator){QueryOperator["$eq"]="=";QueryOperator["$in"]="in";QueryOperator["$nin"]="not in";QueryOperator["$gt"]=">";QueryOperator["$gte"]=">=";QueryOperator["$lt"]="<";QueryOperator["$lte"]="<=";QueryOperator["$ne"]="!=";QueryOperator["$not"]="not";QueryOperator["$like"]="like";QueryOperator["$re"]="regexp";QueryOperator["$ilike"]="ilike";QueryOperator["$overlap"]="&&";QueryOperator["$contains"]="@>";QueryOperator["$contained"]="<@";})(exports.QueryOperator||(exports.QueryOperator={}));exports.ARRAY_OPERATORS=["$overlap","$contains","$contained"];(function(QueryOrder){QueryOrder["ASC"]="ASC";QueryOrder["ASC_NULLS_LAST"]="ASC NULLS LAST";QueryOrder["ASC_NULLS_FIRST"]="ASC NULLS FIRST";QueryOrder["DESC"]="DESC";QueryOrder["DESC_NULLS_LAST"]="DESC NULLS LAST";QueryOrder["DESC_NULLS_FIRST"]="DESC NULLS FIRST";QueryOrder["asc"]="asc";QueryOrder["asc_nulls_last"]="asc nulls last";QueryOrder["asc_nulls_first"]="asc nulls first";QueryOrder["desc"]="desc";QueryOrder["desc_nulls_last"]="desc nulls last";QueryOrder["desc_nulls_first"]="desc nulls first";})(exports.QueryOrder||(exports.QueryOrder={}));(function(QueryOrderNumeric){QueryOrderNumeric[QueryOrderNumeric["ASC"]=1]="ASC";QueryOrderNumeric[QueryOrderNumeric["DESC"]=-1]="DESC";})(exports.QueryOrderNumeric||(exports.QueryOrderNumeric={}));(function(QueryFlag){QueryFlag["DISTINCT"]="DISTINCT";QueryFlag["PAGINATE"]="PAGINATE";QueryFlag["UPDATE_SUB_QUERY"]="UPDATE_SUB_QUERY";QueryFlag["DELETE_SUB_QUERY"]="DELETE_SUB_QUERY";QueryFlag["CONVERT_CUSTOM_TYPES"]="CONVERT_CUSTOM_TYPES";QueryFlag["INCLUDE_LAZY_FORMULAS"]="INCLUDE_LAZY_FORMULAS";QueryFlag["AUTO_JOIN_ONE_TO_ONE_OWNER"]="AUTO_JOIN_ONE_TO_ONE_OWNER";})(exports.QueryFlag||(exports.QueryFlag={}));exports.SCALAR_TYPES=["string","number","boolean","Date","Buffer","RegExp"];(function(ReferenceType){ReferenceType["SCALAR"]="scalar";ReferenceType["ONE_TO_ONE"]="1:1";ReferenceType["ONE_TO_MANY"]="1:m";ReferenceType["MANY_TO_ONE"]="m:1";ReferenceType["MANY_TO_MANY"]="m:n";ReferenceType["EMBEDDED"]="embedded";})(exports.ReferenceType||(exports.ReferenceType={}));(function(Cascade){Cascade["PERSIST"]="persist";Cascade["MERGE"]="merge";Cascade["REMOVE"]="remove";Cascade["ALL"]="all";})(exports.Cascade||(exports.Cascade={}));(function(LoadStrategy){LoadStrategy["SELECT_IN"]="select-in";LoadStrategy["JOINED"]="joined";})(exports.LoadStrategy||(exports.LoadStrategy={}));(function(LockMode){LockMode[LockMode["NONE"]=0]="NONE";LockMode[LockMode["OPTIMISTIC"]=1]="OPTIMISTIC";LockMode[LockMode["PESSIMISTIC_READ"]=2]="PESSIMISTIC_READ";LockMode[LockMode["PESSIMISTIC_WRITE"]=3]="PESSIMISTIC_WRITE";})(exports.LockMode||(exports.LockMode={}));(function(EventType){EventType["onInit"]="onInit";EventType["beforeCreate"]="beforeCreate";EventType["afterCreate"]="afterCreate";EventType["beforeUpdate"]="beforeUpdate";EventType["afterUpdate"]="afterUpdate";EventType["beforeDelete"]="beforeDelete";EventType["afterDelete"]="afterDelete";EventType["beforeFlush"]="beforeFlush";EventType["onFlush"]="onFlush";EventType["afterFlush"]="afterFlush";EventType["beforeTransactionStart"]="beforeTransactionStart";EventType["afterTransactionStart"]="afterTransactionStart";EventType["beforeTransactionCommit"]="beforeTransactionCommit";EventType["afterTransactionCommit"]="afterTransactionCommit";EventType["beforeTransactionRollback"]="beforeTransactionRollback";EventType["afterTransactionRollback"]="afterTransactionRollback";})(exports.EventType||(exports.EventType={}));})(enums);getDefaultExportFromCjs(enums);

var utils$m = {};

var Configuration$1 = {};

var cache$1 = {};

var CacheAdapter = {};

Object.defineProperty(CacheAdapter,"__esModule",{value:true});

var NullCacheAdapter$1 = {};

Object.defineProperty(NullCacheAdapter$1,"__esModule",{value:true});NullCacheAdapter$1.NullCacheAdapter=void 0;class NullCacheAdapter{async get(name){return null}async set(name,data,origin){}async clear(){}}NullCacheAdapter$1.NullCacheAdapter=NullCacheAdapter;

var FileCacheAdapter$1 = {};

var globby$1 = {exports: {}};

var arrayUnion$1=(...arguments_)=>{return [...new Set([].concat(...arguments_))]};

const Stream$3=require$$0__default["default"];const PassThrough=Stream$3.PassThrough;const slice$1=Array.prototype.slice;var merge2_1=merge2$2;function merge2$2(){const streamsQueue=[];const args=slice$1.call(arguments);let merging=false;let options=args[args.length-1];if(options&&!Array.isArray(options)&&options.pipe==null){args.pop();}else {options={};}const doEnd=options.end!==false;const doPipeError=options.pipeError===true;if(options.objectMode==null){options.objectMode=true;}if(options.highWaterMark==null){options.highWaterMark=64*1024;}const mergedStream=PassThrough(options);function addStream(){for(let i=0,len=arguments.length;i<len;i++){streamsQueue.push(pauseStreams(arguments[i],options));}mergeStream();return this}function mergeStream(){if(merging){return}merging=true;let streams=streamsQueue.shift();if(!streams){process.nextTick(endStream);return}if(!Array.isArray(streams)){streams=[streams];}let pipesCount=streams.length+1;function next(){if(--pipesCount>0){return}merging=false;mergeStream();}function pipe(stream){function onend(){stream.removeListener("merge2UnpipeEnd",onend);stream.removeListener("end",onend);if(doPipeError){stream.removeListener("error",onerror);}next();}function onerror(err){mergedStream.emit("error",err);}if(stream._readableState.endEmitted){return next()}stream.on("merge2UnpipeEnd",onend);stream.on("end",onend);if(doPipeError){stream.on("error",onerror);}stream.pipe(mergedStream,{end:false});stream.resume();}for(let i=0;i<streams.length;i++){pipe(streams[i]);}next();}function endStream(){merging=false;mergedStream.emit("queueDrain");if(doEnd){mergedStream.end();}}mergedStream.setMaxListeners(0);mergedStream.add=addStream;mergedStream.on("unpipe",function(stream){stream.emit("merge2UnpipeEnd");});if(args.length){addStream.apply(null,args);}return mergedStream}function pauseStreams(streams,options){if(!Array.isArray(streams)){if(!streams._readableState&&streams.pipe){streams=streams.pipe(PassThrough(options));}if(!streams._readableState||!streams.pause||!streams.pipe){throw new Error("Only readable stream can be merged.")}streams.pause();}else {for(let i=0,len=streams.length;i<len;i++){streams[i]=pauseStreams(streams[i],options);}}return streams}

var tasks = {};

var utils$l = {};

var array$1 = {};

Object.defineProperty(array$1,"__esModule",{value:true});array$1.splitWhen=array$1.flatten=void 0;function flatten$1(items){return items.reduce((collection,item)=>[].concat(collection,item),[])}array$1.flatten=flatten$1;function splitWhen(items,predicate){const result=[[]];let groupIndex=0;for(const item of items){if(predicate(item)){groupIndex++;result[groupIndex]=[];}else {result[groupIndex].push(item);}}return result}array$1.splitWhen=splitWhen;

var errno$1 = {};

Object.defineProperty(errno$1,"__esModule",{value:true});errno$1.isEnoentCodeError=void 0;function isEnoentCodeError(error){return error.code==="ENOENT"}errno$1.isEnoentCodeError=isEnoentCodeError;

var fs$x = {};

Object.defineProperty(fs$x,"__esModule",{value:true});fs$x.createDirentFromStats=void 0;class DirentFromStats$1{constructor(name,stats){this.name=name;this.isBlockDevice=stats.isBlockDevice.bind(stats);this.isCharacterDevice=stats.isCharacterDevice.bind(stats);this.isDirectory=stats.isDirectory.bind(stats);this.isFIFO=stats.isFIFO.bind(stats);this.isFile=stats.isFile.bind(stats);this.isSocket=stats.isSocket.bind(stats);this.isSymbolicLink=stats.isSymbolicLink.bind(stats);}}function createDirentFromStats$1(name,stats){return new DirentFromStats$1(name,stats)}fs$x.createDirentFromStats=createDirentFromStats$1;

var path$q = {};

Object.defineProperty(path$q,"__esModule",{value:true});path$q.removeLeadingDotSegment=path$q.escape=path$q.makeAbsolute=path$q.unixify=void 0;const path$p=require$$0__default$1["default"];const LEADING_DOT_SEGMENT_CHARACTERS_COUNT=2;const UNESCAPED_GLOB_SYMBOLS_RE=/(\\?)([()*?[\]{|}]|^!|[!+@](?=\())/g;function unixify(filepath){return filepath.replace(/\\/g,"/")}path$q.unixify=unixify;function makeAbsolute(cwd,filepath){return path$p.resolve(cwd,filepath)}path$q.makeAbsolute=makeAbsolute;function escape(pattern){return pattern.replace(UNESCAPED_GLOB_SYMBOLS_RE,"\\$2")}path$q.escape=escape;function removeLeadingDotSegment(entry){if(entry.charAt(0)==="."){const secondCharactery=entry.charAt(1);if(secondCharactery==="/"||secondCharactery==="\\"){return entry.slice(LEADING_DOT_SEGMENT_CHARACTERS_COUNT)}}return entry}path$q.removeLeadingDotSegment=removeLeadingDotSegment;

var pattern$1 = {};

var isExtglob$1=function isExtglob(str){if(typeof str!=="string"||str===""){return false}var match;while(match=/(\\).|([@?!+*]\(.*\))/g.exec(str)){if(match[2])return true;str=str.slice(match.index+match[0].length);}return false};

var isExtglob=isExtglob$1;var chars={"{":"}","(":")","[":"]"};var strictCheck=function(str){if(str[0]==="!"){return true}var index=0;var pipeIndex=-2;var closeSquareIndex=-2;var closeCurlyIndex=-2;var closeParenIndex=-2;var backSlashIndex=-2;while(index<str.length){if(str[index]==="*"){return true}if(str[index+1]==="?"&&/[\].+)]/.test(str[index])){return true}if(closeSquareIndex!==-1&&str[index]==="["&&str[index+1]!=="]"){if(closeSquareIndex<index){closeSquareIndex=str.indexOf("]",index);}if(closeSquareIndex>index){if(backSlashIndex===-1||backSlashIndex>closeSquareIndex){return true}backSlashIndex=str.indexOf("\\",index);if(backSlashIndex===-1||backSlashIndex>closeSquareIndex){return true}}}if(closeCurlyIndex!==-1&&str[index]==="{"&&str[index+1]!=="}"){closeCurlyIndex=str.indexOf("}",index);if(closeCurlyIndex>index){backSlashIndex=str.indexOf("\\",index);if(backSlashIndex===-1||backSlashIndex>closeCurlyIndex){return true}}}if(closeParenIndex!==-1&&str[index]==="("&&str[index+1]==="?"&&/[:!=]/.test(str[index+2])&&str[index+3]!==")"){closeParenIndex=str.indexOf(")",index);if(closeParenIndex>index){backSlashIndex=str.indexOf("\\",index);if(backSlashIndex===-1||backSlashIndex>closeParenIndex){return true}}}if(pipeIndex!==-1&&str[index]==="("&&str[index+1]!=="|"){if(pipeIndex<index){pipeIndex=str.indexOf("|",index);}if(pipeIndex!==-1&&str[pipeIndex+1]!==")"){closeParenIndex=str.indexOf(")",pipeIndex);if(closeParenIndex>pipeIndex){backSlashIndex=str.indexOf("\\",pipeIndex);if(backSlashIndex===-1||backSlashIndex>closeParenIndex){return true}}}}if(str[index]==="\\"){var open=str[index+1];index+=2;var close=chars[open];if(close){var n=str.indexOf(close,index);if(n!==-1){index=n+1;}}if(str[index]==="!"){return true}}else {index++;}}return false};var relaxedCheck=function(str){if(str[0]==="!"){return true}var index=0;while(index<str.length){if(/[*?{}()[\]]/.test(str[index])){return true}if(str[index]==="\\"){var open=str[index+1];index+=2;var close=chars[open];if(close){var n=str.indexOf(close,index);if(n!==-1){index=n+1;}}if(str[index]==="!"){return true}}else {index++;}}return false};var isGlob$2=function isGlob(str,options){if(typeof str!=="string"||str===""){return false}if(isExtglob(str)){return true}var check=strictCheck;if(options&&options.strict===false){check=relaxedCheck;}return check(str)};

var isGlob$1=isGlob$2;var pathPosixDirname=require$$0__default$1["default"].posix.dirname;var isWin32=require$$1__default$1["default"].platform()==="win32";var slash$2="/";var backslash=/\\/g;var enclosure=/[\{\[].*[\}\]]$/;var globby=/(^|[^\\])([\{\[]|\([^\)]+$)/;var escaped=/\\([\!\*\?\|\[\]\(\)\{\}])/g;var globParent$2=function globParent(str,opts){var options=Object.assign({flipBackslashes:true},opts);if(options.flipBackslashes&&isWin32&&str.indexOf(slash$2)<0){str=str.replace(backslash,slash$2);}if(enclosure.test(str)){str+=slash$2;}str+="a";do{str=pathPosixDirname(str);}while(isGlob$1(str)||globby.test(str));return str.replace(escaped,"$1")};

var utils$k = {};

(function(exports){exports.isInteger=num=>{if(typeof num==="number"){return Number.isInteger(num)}if(typeof num==="string"&&num.trim()!==""){return Number.isInteger(Number(num))}return false};exports.find=(node,type)=>node.nodes.find(node=>node.type===type);exports.exceedsLimit=(min,max,step=1,limit)=>{if(limit===false)return false;if(!exports.isInteger(min)||!exports.isInteger(max))return false;return (Number(max)-Number(min))/Number(step)>=limit};exports.escapeNode=(block,n=0,type)=>{let node=block.nodes[n];if(!node)return;if(type&&node.type===type||node.type==="open"||node.type==="close"){if(node.escaped!==true){node.value="\\"+node.value;node.escaped=true;}}};exports.encloseBrace=node=>{if(node.type!=="brace")return false;if(node.commas>>0+node.ranges>>0===0){node.invalid=true;return true}return false};exports.isInvalidBrace=block=>{if(block.type!=="brace")return false;if(block.invalid===true||block.dollar)return true;if(block.commas>>0+block.ranges>>0===0){block.invalid=true;return true}if(block.open!==true||block.close!==true){block.invalid=true;return true}return false};exports.isOpenOrClose=node=>{if(node.type==="open"||node.type==="close"){return true}return node.open===true||node.close===true};exports.reduce=nodes=>nodes.reduce((acc,node)=>{if(node.type==="text")acc.push(node.value);if(node.type==="range")node.type="text";return acc},[]);exports.flatten=(...args)=>{const result=[];const flat=arr=>{for(let i=0;i<arr.length;i++){let ele=arr[i];Array.isArray(ele)?flat(ele):ele!==void 0&&result.push(ele);}return result};flat(args);return result};})(utils$k);

const utils$j=utils$k;var stringify$9=(ast,options={})=>{let stringify=(node,parent={})=>{let invalidBlock=options.escapeInvalid&&utils$j.isInvalidBrace(parent);let invalidNode=node.invalid===true&&options.escapeInvalid===true;let output="";if(node.value){if((invalidBlock||invalidNode)&&utils$j.isOpenOrClose(node)){return "\\"+node.value}return node.value}if(node.value){return node.value}if(node.nodes){for(let child of node.nodes){output+=stringify(child);}}return output};return stringify(ast)};

var isNumber$2=function(num){if(typeof num==="number"){return num-num===0}if(typeof num==="string"&&num.trim()!==""){return Number.isFinite?Number.isFinite(+num):isFinite(+num)}return false};

const isNumber$1=isNumber$2;const toRegexRange$1=(min,max,options)=>{if(isNumber$1(min)===false){throw new TypeError("toRegexRange: expected the first argument to be a number")}if(max===void 0||min===max){return String(min)}if(isNumber$1(max)===false){throw new TypeError("toRegexRange: expected the second argument to be a number.")}let opts={relaxZeros:true,...options};if(typeof opts.strictZeros==="boolean"){opts.relaxZeros=opts.strictZeros===false;}let relax=String(opts.relaxZeros);let shorthand=String(opts.shorthand);let capture=String(opts.capture);let wrap=String(opts.wrap);let cacheKey=min+":"+max+"="+relax+shorthand+capture+wrap;if(toRegexRange$1.cache.hasOwnProperty(cacheKey)){return toRegexRange$1.cache[cacheKey].result}let a=Math.min(min,max);let b=Math.max(min,max);if(Math.abs(a-b)===1){let result=min+"|"+max;if(opts.capture){return `(${result})`}if(opts.wrap===false){return result}return `(?:${result})`}let isPadded=hasPadding(min)||hasPadding(max);let state={min,max,a,b};let positives=[];let negatives=[];if(isPadded){state.isPadded=isPadded;state.maxLen=String(state.max).length;}if(a<0){let newMin=b<0?Math.abs(b):1;negatives=splitToPatterns(newMin,Math.abs(a),state,opts);a=state.a=0;}if(b>=0){positives=splitToPatterns(a,b,state,opts);}state.negatives=negatives;state.positives=positives;state.result=collatePatterns(negatives,positives);if(opts.capture===true){state.result=`(${state.result})`;}else if(opts.wrap!==false&&positives.length+negatives.length>1){state.result=`(?:${state.result})`;}toRegexRange$1.cache[cacheKey]=state;return state.result};function collatePatterns(neg,pos,options){let onlyNegative=filterPatterns(neg,pos,"-",false)||[];let onlyPositive=filterPatterns(pos,neg,"",false)||[];let intersected=filterPatterns(neg,pos,"-?",true)||[];let subpatterns=onlyNegative.concat(intersected).concat(onlyPositive);return subpatterns.join("|")}function splitToRanges(min,max){let nines=1;let zeros=1;let stop=countNines(min,nines);let stops=new Set([max]);while(min<=stop&&stop<=max){stops.add(stop);nines+=1;stop=countNines(min,nines);}stop=countZeros(max+1,zeros)-1;while(min<stop&&stop<=max){stops.add(stop);zeros+=1;stop=countZeros(max+1,zeros)-1;}stops=[...stops];stops.sort(compare$1);return stops}function rangeToPattern(start,stop,options){if(start===stop){return {pattern:start,count:[],digits:0}}let zipped=zip(start,stop);let digits=zipped.length;let pattern="";let count=0;for(let i=0;i<digits;i++){let[startDigit,stopDigit]=zipped[i];if(startDigit===stopDigit){pattern+=startDigit;}else if(startDigit!=="0"||stopDigit!=="9"){pattern+=toCharacterClass(startDigit,stopDigit);}else {count++;}}if(count){pattern+=options.shorthand===true?"\\d":"[0-9]";}return {pattern,count:[count],digits}}function splitToPatterns(min,max,tok,options){let ranges=splitToRanges(min,max);let tokens=[];let start=min;let prev;for(let i=0;i<ranges.length;i++){let max=ranges[i];let obj=rangeToPattern(String(start),String(max),options);let zeros="";if(!tok.isPadded&&prev&&prev.pattern===obj.pattern){if(prev.count.length>1){prev.count.pop();}prev.count.push(obj.count[0]);prev.string=prev.pattern+toQuantifier(prev.count);start=max+1;continue}if(tok.isPadded){zeros=padZeros(max,tok,options);}obj.string=zeros+obj.pattern+toQuantifier(obj.count);tokens.push(obj);start=max+1;prev=obj;}return tokens}function filterPatterns(arr,comparison,prefix,intersection,options){let result=[];for(let ele of arr){let{string}=ele;if(!intersection&&!contains(comparison,"string",string)){result.push(prefix+string);}if(intersection&&contains(comparison,"string",string)){result.push(prefix+string);}}return result}function zip(a,b){let arr=[];for(let i=0;i<a.length;i++)arr.push([a[i],b[i]]);return arr}function compare$1(a,b){return a>b?1:b>a?-1:0}function contains(arr,key,val){return arr.some(ele=>ele[key]===val)}function countNines(min,len){return Number(String(min).slice(0,-len)+"9".repeat(len))}function countZeros(integer,zeros){return integer-integer%Math.pow(10,zeros)}function toQuantifier(digits){let[start=0,stop=""]=digits;if(stop||start>1){return `{${start+(stop?","+stop:"")}}`}return ""}function toCharacterClass(a,b,options){return `[${a}${b-a===1?"":"-"}${b}]`}function hasPadding(str){return /^-?(0+)\d/.test(str)}function padZeros(value,tok,options){if(!tok.isPadded){return value}let diff=Math.abs(tok.maxLen-String(value).length);let relax=options.relaxZeros!==false;switch(diff){case 0:return "";case 1:return relax?"0?":"0";case 2:return relax?"0{0,2}":"00";default:{return relax?`0{0,${diff}}`:`0{${diff}}`}}}toRegexRange$1.cache={};toRegexRange$1.clearCache=()=>toRegexRange$1.cache={};var toRegexRange_1=toRegexRange$1;

const util$5=require$$0__default$2["default"];const toRegexRange=toRegexRange_1;const isObject$3=val=>val!==null&&typeof val==="object"&&!Array.isArray(val);const transform=toNumber=>{return value=>toNumber===true?Number(value):String(value)};const isValidValue=value=>{return typeof value==="number"||typeof value==="string"&&value!==""};const isNumber=num=>Number.isInteger(+num);const zeros=input=>{let value=`${input}`;let index=-1;if(value[0]==="-")value=value.slice(1);if(value==="0")return false;while(value[++index]==="0");return index>0};const stringify$8=(start,end,options)=>{if(typeof start==="string"||typeof end==="string"){return true}return options.stringify===true};const pad=(input,maxLength,toNumber)=>{if(maxLength>0){let dash=input[0]==="-"?"-":"";if(dash)input=input.slice(1);input=dash+input.padStart(dash?maxLength-1:maxLength,"0");}if(toNumber===false){return String(input)}return input};const toMaxLen=(input,maxLength)=>{let negative=input[0]==="-"?"-":"";if(negative){input=input.slice(1);maxLength--;}while(input.length<maxLength)input="0"+input;return negative?"-"+input:input};const toSequence=(parts,options)=>{parts.negatives.sort((a,b)=>a<b?-1:a>b?1:0);parts.positives.sort((a,b)=>a<b?-1:a>b?1:0);let prefix=options.capture?"":"?:";let positives="";let negatives="";let result;if(parts.positives.length){positives=parts.positives.join("|");}if(parts.negatives.length){negatives=`-(${prefix}${parts.negatives.join("|")})`;}if(positives&&negatives){result=`${positives}|${negatives}`;}else {result=positives||negatives;}if(options.wrap){return `(${prefix}${result})`}return result};const toRange=(a,b,isNumbers,options)=>{if(isNumbers){return toRegexRange(a,b,{wrap:false,...options})}let start=String.fromCharCode(a);if(a===b)return start;let stop=String.fromCharCode(b);return `[${start}-${stop}]`};const toRegex=(start,end,options)=>{if(Array.isArray(start)){let wrap=options.wrap===true;let prefix=options.capture?"":"?:";return wrap?`(${prefix}${start.join("|")})`:start.join("|")}return toRegexRange(start,end,options)};const rangeError=(...args)=>{return new RangeError("Invalid range arguments: "+util$5.inspect(...args))};const invalidRange=(start,end,options)=>{if(options.strictRanges===true)throw rangeError([start,end]);return []};const invalidStep=(step,options)=>{if(options.strictRanges===true){throw new TypeError(`Expected step "${step}" to be a number`)}return []};const fillNumbers=(start,end,step=1,options={})=>{let a=Number(start);let b=Number(end);if(!Number.isInteger(a)||!Number.isInteger(b)){if(options.strictRanges===true)throw rangeError([start,end]);return []}if(a===0)a=0;if(b===0)b=0;let descending=a>b;let startString=String(start);let endString=String(end);let stepString=String(step);step=Math.max(Math.abs(step),1);let padded=zeros(startString)||zeros(endString)||zeros(stepString);let maxLen=padded?Math.max(startString.length,endString.length,stepString.length):0;let toNumber=padded===false&&stringify$8(start,end,options)===false;let format=options.transform||transform(toNumber);if(options.toRegex&&step===1){return toRange(toMaxLen(start,maxLen),toMaxLen(end,maxLen),true,options)}let parts={negatives:[],positives:[]};let push=num=>parts[num<0?"negatives":"positives"].push(Math.abs(num));let range=[];let index=0;while(descending?a>=b:a<=b){if(options.toRegex===true&&step>1){push(a);}else {range.push(pad(format(a,index),maxLen,toNumber));}a=descending?a-step:a+step;index++;}if(options.toRegex===true){return step>1?toSequence(parts,options):toRegex(range,null,{wrap:false,...options})}return range};const fillLetters=(start,end,step=1,options={})=>{if(!isNumber(start)&&start.length>1||!isNumber(end)&&end.length>1){return invalidRange(start,end,options)}let format=options.transform||(val=>String.fromCharCode(val));let a=`${start}`.charCodeAt(0);let b=`${end}`.charCodeAt(0);let descending=a>b;let min=Math.min(a,b);let max=Math.max(a,b);if(options.toRegex&&step===1){return toRange(min,max,false,options)}let range=[];let index=0;while(descending?a>=b:a<=b){range.push(format(a,index));a=descending?a-step:a+step;index++;}if(options.toRegex===true){return toRegex(range,null,{wrap:false,options})}return range};const fill$2=(start,end,step,options={})=>{if(end==null&&isValidValue(start)){return [start]}if(!isValidValue(start)||!isValidValue(end)){return invalidRange(start,end,options)}if(typeof step==="function"){return fill$2(start,end,1,{transform:step})}if(isObject$3(step)){return fill$2(start,end,0,step)}let opts={...options};if(opts.capture===true)opts.wrap=true;step=step||opts.step||1;if(!isNumber(step)){if(step!=null&&!isObject$3(step))return invalidStep(step,opts);return fill$2(start,end,1,step)}if(isNumber(start)&&isNumber(end)){return fillNumbers(start,end,step,opts)}return fillLetters(start,end,Math.max(Math.abs(step),1),opts)};var fillRange=fill$2;

const fill$1=fillRange;const utils$i=utils$k;const compile$3=(ast,options={})=>{let walk=(node,parent={})=>{let invalidBlock=utils$i.isInvalidBrace(parent);let invalidNode=node.invalid===true&&options.escapeInvalid===true;let invalid=invalidBlock===true||invalidNode===true;let prefix=options.escapeInvalid===true?"\\":"";let output="";if(node.isOpen===true){return prefix+node.value}if(node.isClose===true){return prefix+node.value}if(node.type==="open"){return invalid?prefix+node.value:"("}if(node.type==="close"){return invalid?prefix+node.value:")"}if(node.type==="comma"){return node.prev.type==="comma"?"":invalid?node.value:"|"}if(node.value){return node.value}if(node.nodes&&node.ranges>0){let args=utils$i.reduce(node.nodes);let range=fill$1(...args,{...options,wrap:false,toRegex:true});if(range.length!==0){return args.length>1&&range.length>1?`(${range})`:range}}if(node.nodes){for(let child of node.nodes){output+=walk(child,node);}}return output};return walk(ast)};var compile_1=compile$3;

const fill=fillRange;const stringify$7=stringify$9;const utils$h=utils$k;const append$1=(queue="",stash="",enclose=false)=>{let result=[];queue=[].concat(queue);stash=[].concat(stash);if(!stash.length)return queue;if(!queue.length){return enclose?utils$h.flatten(stash).map(ele=>`{${ele}}`):stash}for(let item of queue){if(Array.isArray(item)){for(let value of item){result.push(append$1(value,stash,enclose));}}else {for(let ele of stash){if(enclose===true&&typeof ele==="string")ele=`{${ele}}`;result.push(Array.isArray(ele)?append$1(item,ele,enclose):item+ele);}}}return utils$h.flatten(result)};const expand$1=(ast,options={})=>{let rangeLimit=options.rangeLimit===void 0?1000:options.rangeLimit;let walk=(node,parent={})=>{node.queue=[];let p=parent;let q=parent.queue;while(p.type!=="brace"&&p.type!=="root"&&p.parent){p=p.parent;q=p.queue;}if(node.invalid||node.dollar){q.push(append$1(q.pop(),stringify$7(node,options)));return}if(node.type==="brace"&&node.invalid!==true&&node.nodes.length===2){q.push(append$1(q.pop(),["{}"]));return}if(node.nodes&&node.ranges>0){let args=utils$h.reduce(node.nodes);if(utils$h.exceedsLimit(...args,options.step,rangeLimit)){throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.")}let range=fill(...args,options);if(range.length===0){range=stringify$7(node,options);}q.push(append$1(q.pop(),range));node.nodes=[];return}let enclose=utils$h.encloseBrace(node);let queue=node.queue;let block=node;while(block.type!=="brace"&&block.type!=="root"&&block.parent){block=block.parent;queue=block.queue;}for(let i=0;i<node.nodes.length;i++){let child=node.nodes[i];if(child.type==="comma"&&node.type==="brace"){if(i===1)queue.push("");queue.push("");continue}if(child.type==="close"){q.push(append$1(q.pop(),queue,enclose));continue}if(child.value&&child.type!=="open"){queue.push(append$1(queue.pop(),child.value));continue}if(child.nodes){walk(child,node);}}return queue};return utils$h.flatten(walk(ast))};var expand_1=expand$1;

var constants$6={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:"\"",CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:"\n",CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"\t",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"};

const stringify$6=stringify$9;const{MAX_LENGTH: MAX_LENGTH$1,CHAR_BACKSLASH,CHAR_BACKTICK,CHAR_COMMA: CHAR_COMMA$1,CHAR_DOT: CHAR_DOT$1,CHAR_LEFT_PARENTHESES: CHAR_LEFT_PARENTHESES$1,CHAR_RIGHT_PARENTHESES: CHAR_RIGHT_PARENTHESES$1,CHAR_LEFT_CURLY_BRACE: CHAR_LEFT_CURLY_BRACE$1,CHAR_RIGHT_CURLY_BRACE: CHAR_RIGHT_CURLY_BRACE$1,CHAR_LEFT_SQUARE_BRACKET: CHAR_LEFT_SQUARE_BRACKET$1,CHAR_RIGHT_SQUARE_BRACKET: CHAR_RIGHT_SQUARE_BRACKET$1,CHAR_DOUBLE_QUOTE,CHAR_SINGLE_QUOTE,CHAR_NO_BREAK_SPACE,CHAR_ZERO_WIDTH_NOBREAK_SPACE}=constants$6;const parse$d=(input,options={})=>{if(typeof input!=="string"){throw new TypeError("Expected a string")}let opts=options||{};let max=typeof opts.maxLength==="number"?Math.min(MAX_LENGTH$1,opts.maxLength):MAX_LENGTH$1;if(input.length>max){throw new SyntaxError(`Input length (${input.length}), exceeds max characters (${max})`)}let ast={type:"root",input,nodes:[]};let stack=[ast];let block=ast;let prev=ast;let brackets=0;let length=input.length;let index=0;let depth=0;let value;const advance=()=>input[index++];const push=node=>{if(node.type==="text"&&prev.type==="dot"){prev.type="text";}if(prev&&prev.type==="text"&&node.type==="text"){prev.value+=node.value;return}block.nodes.push(node);node.parent=block;node.prev=prev;prev=node;return node};push({type:"bos"});while(index<length){block=stack[stack.length-1];value=advance();if(value===CHAR_ZERO_WIDTH_NOBREAK_SPACE||value===CHAR_NO_BREAK_SPACE){continue}if(value===CHAR_BACKSLASH){push({type:"text",value:(options.keepEscaping?value:"")+advance()});continue}if(value===CHAR_RIGHT_SQUARE_BRACKET$1){push({type:"text",value:"\\"+value});continue}if(value===CHAR_LEFT_SQUARE_BRACKET$1){brackets++;let next;while(index<length&&(next=advance())){value+=next;if(next===CHAR_LEFT_SQUARE_BRACKET$1){brackets++;continue}if(next===CHAR_BACKSLASH){value+=advance();continue}if(next===CHAR_RIGHT_SQUARE_BRACKET$1){brackets--;if(brackets===0){break}}}push({type:"text",value});continue}if(value===CHAR_LEFT_PARENTHESES$1){block=push({type:"paren",nodes:[]});stack.push(block);push({type:"text",value});continue}if(value===CHAR_RIGHT_PARENTHESES$1){if(block.type!=="paren"){push({type:"text",value});continue}block=stack.pop();push({type:"text",value});block=stack[stack.length-1];continue}if(value===CHAR_DOUBLE_QUOTE||value===CHAR_SINGLE_QUOTE||value===CHAR_BACKTICK){let open=value;let next;if(options.keepQuotes!==true){value="";}while(index<length&&(next=advance())){if(next===CHAR_BACKSLASH){value+=next+advance();continue}if(next===open){if(options.keepQuotes===true)value+=next;break}value+=next;}push({type:"text",value});continue}if(value===CHAR_LEFT_CURLY_BRACE$1){depth++;let dollar=prev.value&&prev.value.slice(-1)==="$"||block.dollar===true;let brace={type:"brace",open:true,close:false,dollar,depth,commas:0,ranges:0,nodes:[]};block=push(brace);stack.push(block);push({type:"open",value});continue}if(value===CHAR_RIGHT_CURLY_BRACE$1){if(block.type!=="brace"){push({type:"text",value});continue}let type="close";block=stack.pop();block.close=true;push({type,value});depth--;block=stack[stack.length-1];continue}if(value===CHAR_COMMA$1&&depth>0){if(block.ranges>0){block.ranges=0;let open=block.nodes.shift();block.nodes=[open,{type:"text",value:stringify$6(block)}];}push({type:"comma",value});block.commas++;continue}if(value===CHAR_DOT$1&&depth>0&&block.commas===0){let siblings=block.nodes;if(depth===0||siblings.length===0){push({type:"text",value});continue}if(prev.type==="dot"){block.range=[];prev.value+=value;prev.type="range";if(block.nodes.length!==3&&block.nodes.length!==5){block.invalid=true;block.ranges=0;prev.type="text";continue}block.ranges++;block.args=[];continue}if(prev.type==="range"){siblings.pop();let before=siblings[siblings.length-1];before.value+=prev.value+value;prev=before;block.ranges--;continue}push({type:"dot",value});continue}push({type:"text",value});}do{block=stack.pop();if(block.type!=="root"){block.nodes.forEach(node=>{if(!node.nodes){if(node.type==="open")node.isOpen=true;if(node.type==="close")node.isClose=true;if(!node.nodes)node.type="text";node.invalid=true;}});let parent=stack[stack.length-1];let index=parent.nodes.indexOf(block);parent.nodes.splice(index,1,...block.nodes);}}while(stack.length>0);push({type:"eos"});return ast};var parse_1$1=parse$d;

const stringify$5=stringify$9;const compile$2=compile_1;const expand=expand_1;const parse$c=parse_1$1;const braces$2=(input,options={})=>{let output=[];if(Array.isArray(input)){for(let pattern of input){let result=braces$2.create(pattern,options);if(Array.isArray(result)){output.push(...result);}else {output.push(result);}}}else {output=[].concat(braces$2.create(input,options));}if(options&&options.expand===true&&options.nodupes===true){output=[...new Set(output)];}return output};braces$2.parse=(input,options={})=>parse$c(input,options);braces$2.stringify=(input,options={})=>{if(typeof input==="string"){return stringify$5(braces$2.parse(input,options),options)}return stringify$5(input,options)};braces$2.compile=(input,options={})=>{if(typeof input==="string"){input=braces$2.parse(input,options);}return compile$2(input,options)};braces$2.expand=(input,options={})=>{if(typeof input==="string"){input=braces$2.parse(input,options);}let result=expand(input,options);if(options.noempty===true){result=result.filter(Boolean);}if(options.nodupes===true){result=[...new Set(result)];}return result};braces$2.create=(input,options={})=>{if(input===""||input.length<3){return [input]}return options.expand!==true?braces$2.compile(input,options):braces$2.expand(input,options)};var braces_1=braces$2;

var utils$g = {};

const path$o=require$$0__default$1["default"];const WIN_SLASH="\\\\/";const WIN_NO_SLASH=`[^${WIN_SLASH}]`;const DOT_LITERAL="\\.";const PLUS_LITERAL="\\+";const QMARK_LITERAL="\\?";const SLASH_LITERAL="\\/";const ONE_CHAR="(?=.)";const QMARK="[^/]";const END_ANCHOR=`(?:${SLASH_LITERAL}|$)`;const START_ANCHOR=`(?:^|${SLASH_LITERAL})`;const DOTS_SLASH=`${DOT_LITERAL}{1,2}${END_ANCHOR}`;const NO_DOT=`(?!${DOT_LITERAL})`;const NO_DOTS=`(?!${START_ANCHOR}${DOTS_SLASH})`;const NO_DOT_SLASH=`(?!${DOT_LITERAL}{0,1}${END_ANCHOR})`;const NO_DOTS_SLASH=`(?!${DOTS_SLASH})`;const QMARK_NO_DOT=`[^.${SLASH_LITERAL}]`;const STAR$1=`${QMARK}*?`;const POSIX_CHARS={DOT_LITERAL,PLUS_LITERAL,QMARK_LITERAL,SLASH_LITERAL,ONE_CHAR,QMARK,END_ANCHOR,DOTS_SLASH,NO_DOT,NO_DOTS,NO_DOT_SLASH,NO_DOTS_SLASH,QMARK_NO_DOT,STAR: STAR$1,START_ANCHOR};const WINDOWS_CHARS={...POSIX_CHARS,SLASH_LITERAL:`[${WIN_SLASH}]`,QMARK:WIN_NO_SLASH,STAR:`${WIN_NO_SLASH}*?`,DOTS_SLASH:`${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$)`,NO_DOT:`(?!${DOT_LITERAL})`,NO_DOTS:`(?!(?:^|[${WIN_SLASH}])${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,NO_DOT_SLASH:`(?!${DOT_LITERAL}{0,1}(?:[${WIN_SLASH}]|$))`,NO_DOTS_SLASH:`(?!${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,QMARK_NO_DOT:`[^.${WIN_SLASH}]`,START_ANCHOR:`(?:^|[${WIN_SLASH}])`,END_ANCHOR:`(?:[${WIN_SLASH}]|$)`};const POSIX_REGEX_SOURCE$1={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};var constants$5={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE: POSIX_REGEX_SOURCE$1,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:path$o.sep,extglobChars(chars){return {"!":{type:"negate",open:"(?:(?!(?:",close:`))${chars.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(win32){return win32===true?WINDOWS_CHARS:POSIX_CHARS}};

(function(exports){const path=require$$0__default$1["default"];const win32=process.platform==="win32";const{REGEX_BACKSLASH,REGEX_REMOVE_BACKSLASH,REGEX_SPECIAL_CHARS,REGEX_SPECIAL_CHARS_GLOBAL}=constants$5;exports.isObject=val=>val!==null&&typeof val==="object"&&!Array.isArray(val);exports.hasRegexChars=str=>REGEX_SPECIAL_CHARS.test(str);exports.isRegexChar=str=>str.length===1&&exports.hasRegexChars(str);exports.escapeRegex=str=>str.replace(REGEX_SPECIAL_CHARS_GLOBAL,"\\$1");exports.toPosixSlashes=str=>str.replace(REGEX_BACKSLASH,"/");exports.removeBackslashes=str=>{return str.replace(REGEX_REMOVE_BACKSLASH,match=>{return match==="\\"?"":match})};exports.supportsLookbehinds=()=>{const segs=process.version.slice(1).split(".").map(Number);if(segs.length===3&&segs[0]>=9||segs[0]===8&&segs[1]>=10){return true}return false};exports.isWindows=options=>{if(options&&typeof options.windows==="boolean"){return options.windows}return win32===true||path.sep==="\\"};exports.escapeLast=(input,char,lastIdx)=>{const idx=input.lastIndexOf(char,lastIdx);if(idx===-1)return input;if(input[idx-1]==="\\")return exports.escapeLast(input,char,idx-1);return `${input.slice(0,idx)}\\${input.slice(idx)}`};exports.removePrefix=(input,state={})=>{let output=input;if(output.startsWith("./")){output=output.slice(2);state.prefix="./";}return output};exports.wrapOutput=(input,state={},options={})=>{const prepend=options.contains?"":"^";const append=options.contains?"":"$";let output=`${prepend}(?:${input})${append}`;if(state.negated===true){output=`(?:^(?!${output}).*$)`;}return output};})(utils$g);

const utils$f=utils$g;const{CHAR_ASTERISK,CHAR_AT,CHAR_BACKWARD_SLASH,CHAR_COMMA,CHAR_DOT,CHAR_EXCLAMATION_MARK,CHAR_FORWARD_SLASH,CHAR_LEFT_CURLY_BRACE,CHAR_LEFT_PARENTHESES,CHAR_LEFT_SQUARE_BRACKET,CHAR_PLUS,CHAR_QUESTION_MARK,CHAR_RIGHT_CURLY_BRACE,CHAR_RIGHT_PARENTHESES,CHAR_RIGHT_SQUARE_BRACKET}=constants$5;const isPathSeparator=code=>{return code===CHAR_FORWARD_SLASH||code===CHAR_BACKWARD_SLASH};const depth=token=>{if(token.isPrefix!==true){token.depth=token.isGlobstar?Infinity:1;}};const scan$1=(input,options)=>{const opts=options||{};const length=input.length-1;const scanToEnd=opts.parts===true||opts.scanToEnd===true;const slashes=[];const tokens=[];const parts=[];let str=input;let index=-1;let start=0;let lastIndex=0;let isBrace=false;let isBracket=false;let isGlob=false;let isExtglob=false;let isGlobstar=false;let braceEscaped=false;let backslashes=false;let negated=false;let negatedExtglob=false;let finished=false;let braces=0;let prev;let code;let token={value:"",depth:0,isGlob:false};const eos=()=>index>=length;const peek=()=>str.charCodeAt(index+1);const advance=()=>{prev=code;return str.charCodeAt(++index)};while(index<length){code=advance();let next;if(code===CHAR_BACKWARD_SLASH){backslashes=token.backslashes=true;code=advance();if(code===CHAR_LEFT_CURLY_BRACE){braceEscaped=true;}continue}if(braceEscaped===true||code===CHAR_LEFT_CURLY_BRACE){braces++;while(eos()!==true&&(code=advance())){if(code===CHAR_BACKWARD_SLASH){backslashes=token.backslashes=true;advance();continue}if(code===CHAR_LEFT_CURLY_BRACE){braces++;continue}if(braceEscaped!==true&&code===CHAR_DOT&&(code=advance())===CHAR_DOT){isBrace=token.isBrace=true;isGlob=token.isGlob=true;finished=true;if(scanToEnd===true){continue}break}if(braceEscaped!==true&&code===CHAR_COMMA){isBrace=token.isBrace=true;isGlob=token.isGlob=true;finished=true;if(scanToEnd===true){continue}break}if(code===CHAR_RIGHT_CURLY_BRACE){braces--;if(braces===0){braceEscaped=false;isBrace=token.isBrace=true;finished=true;break}}}if(scanToEnd===true){continue}break}if(code===CHAR_FORWARD_SLASH){slashes.push(index);tokens.push(token);token={value:"",depth:0,isGlob:false};if(finished===true)continue;if(prev===CHAR_DOT&&index===start+1){start+=2;continue}lastIndex=index+1;continue}if(opts.noext!==true){const isExtglobChar=code===CHAR_PLUS||code===CHAR_AT||code===CHAR_ASTERISK||code===CHAR_QUESTION_MARK||code===CHAR_EXCLAMATION_MARK;if(isExtglobChar===true&&peek()===CHAR_LEFT_PARENTHESES){isGlob=token.isGlob=true;isExtglob=token.isExtglob=true;finished=true;if(code===CHAR_EXCLAMATION_MARK&&index===start){negatedExtglob=true;}if(scanToEnd===true){while(eos()!==true&&(code=advance())){if(code===CHAR_BACKWARD_SLASH){backslashes=token.backslashes=true;code=advance();continue}if(code===CHAR_RIGHT_PARENTHESES){isGlob=token.isGlob=true;finished=true;break}}continue}break}}if(code===CHAR_ASTERISK){if(prev===CHAR_ASTERISK)isGlobstar=token.isGlobstar=true;isGlob=token.isGlob=true;finished=true;if(scanToEnd===true){continue}break}if(code===CHAR_QUESTION_MARK){isGlob=token.isGlob=true;finished=true;if(scanToEnd===true){continue}break}if(code===CHAR_LEFT_SQUARE_BRACKET){while(eos()!==true&&(next=advance())){if(next===CHAR_BACKWARD_SLASH){backslashes=token.backslashes=true;advance();continue}if(next===CHAR_RIGHT_SQUARE_BRACKET){isBracket=token.isBracket=true;isGlob=token.isGlob=true;finished=true;break}}if(scanToEnd===true){continue}break}if(opts.nonegate!==true&&code===CHAR_EXCLAMATION_MARK&&index===start){negated=token.negated=true;start++;continue}if(opts.noparen!==true&&code===CHAR_LEFT_PARENTHESES){isGlob=token.isGlob=true;if(scanToEnd===true){while(eos()!==true&&(code=advance())){if(code===CHAR_LEFT_PARENTHESES){backslashes=token.backslashes=true;code=advance();continue}if(code===CHAR_RIGHT_PARENTHESES){finished=true;break}}continue}break}if(isGlob===true){finished=true;if(scanToEnd===true){continue}break}}if(opts.noext===true){isExtglob=false;isGlob=false;}let base=str;let prefix="";let glob="";if(start>0){prefix=str.slice(0,start);str=str.slice(start);lastIndex-=start;}if(base&&isGlob===true&&lastIndex>0){base=str.slice(0,lastIndex);glob=str.slice(lastIndex);}else if(isGlob===true){base="";glob=str;}else {base=str;}if(base&&base!==""&&base!=="/"&&base!==str){if(isPathSeparator(base.charCodeAt(base.length-1))){base=base.slice(0,-1);}}if(opts.unescape===true){if(glob)glob=utils$f.removeBackslashes(glob);if(base&&backslashes===true){base=utils$f.removeBackslashes(base);}}const state={prefix,input,start,base,glob,isBrace,isBracket,isGlob,isExtglob,isGlobstar,negated,negatedExtglob};if(opts.tokens===true){state.maxDepth=0;if(!isPathSeparator(code)){tokens.push(token);}state.tokens=tokens;}if(opts.parts===true||opts.tokens===true){let prevIndex;for(let idx=0;idx<slashes.length;idx++){const n=prevIndex?prevIndex+1:start;const i=slashes[idx];const value=input.slice(n,i);if(opts.tokens){if(idx===0&&start!==0){tokens[idx].isPrefix=true;tokens[idx].value=prefix;}else {tokens[idx].value=value;}depth(tokens[idx]);state.maxDepth+=tokens[idx].depth;}if(idx!==0||value!==""){parts.push(value);}prevIndex=i;}if(prevIndex&&prevIndex+1<input.length){const value=input.slice(prevIndex+1);parts.push(value);if(opts.tokens){tokens[tokens.length-1].value=value;depth(tokens[tokens.length-1]);state.maxDepth+=tokens[tokens.length-1].depth;}}state.slashes=slashes;state.parts=parts;}return state};var scan_1=scan$1;

const constants$4=constants$5;const utils$e=utils$g;const{MAX_LENGTH,POSIX_REGEX_SOURCE,REGEX_NON_SPECIAL_CHARS,REGEX_SPECIAL_CHARS_BACKREF,REPLACEMENTS}=constants$4;const expandRange=(args,options)=>{if(typeof options.expandRange==="function"){return options.expandRange(...args,options)}args.sort();const value=`[${args.join("-")}]`;try{new RegExp(value);}catch(ex){return args.map(v=>utils$e.escapeRegex(v)).join("..")}return value};const syntaxError=(type,char)=>{return `Missing ${type}: "${char}" - use "\\\\${char}" to match literal characters`};const parse$b=(input,options)=>{if(typeof input!=="string"){throw new TypeError("Expected a string")}input=REPLACEMENTS[input]||input;const opts={...options};const max=typeof opts.maxLength==="number"?Math.min(MAX_LENGTH,opts.maxLength):MAX_LENGTH;let len=input.length;if(len>max){throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`)}const bos={type:"bos",value:"",output:opts.prepend||""};const tokens=[bos];const capture=opts.capture?"":"?:";const win32=utils$e.isWindows(options);const PLATFORM_CHARS=constants$4.globChars(win32);const EXTGLOB_CHARS=constants$4.extglobChars(PLATFORM_CHARS);const{DOT_LITERAL,PLUS_LITERAL,SLASH_LITERAL,ONE_CHAR,DOTS_SLASH,NO_DOT,NO_DOT_SLASH,NO_DOTS_SLASH,QMARK,QMARK_NO_DOT,STAR,START_ANCHOR}=PLATFORM_CHARS;const globstar=opts=>{return `(${capture}(?:(?!${START_ANCHOR}${opts.dot?DOTS_SLASH:DOT_LITERAL}).)*?)`};const nodot=opts.dot?"":NO_DOT;const qmarkNoDot=opts.dot?QMARK:QMARK_NO_DOT;let star=opts.bash===true?globstar(opts):STAR;if(opts.capture){star=`(${star})`;}if(typeof opts.noext==="boolean"){opts.noextglob=opts.noext;}const state={input,index:-1,start:0,dot:opts.dot===true,consumed:"",output:"",prefix:"",backtrack:false,negated:false,brackets:0,braces:0,parens:0,quotes:0,globstar:false,tokens};input=utils$e.removePrefix(input,state);len=input.length;const extglobs=[];const braces=[];const stack=[];let prev=bos;let value;const eos=()=>state.index===len-1;const peek=state.peek=(n=1)=>input[state.index+n];const advance=state.advance=()=>input[++state.index]||"";const remaining=()=>input.slice(state.index+1);const consume=(value="",num=0)=>{state.consumed+=value;state.index+=num;};const append=token=>{state.output+=token.output!=null?token.output:token.value;consume(token.value);};const negate=()=>{let count=1;while(peek()==="!"&&(peek(2)!=="("||peek(3)==="?")){advance();state.start++;count++;}if(count%2===0){return false}state.negated=true;state.start++;return true};const increment=type=>{state[type]++;stack.push(type);};const decrement=type=>{state[type]--;stack.pop();};const push=tok=>{if(prev.type==="globstar"){const isBrace=state.braces>0&&(tok.type==="comma"||tok.type==="brace");const isExtglob=tok.extglob===true||extglobs.length&&(tok.type==="pipe"||tok.type==="paren");if(tok.type!=="slash"&&tok.type!=="paren"&&!isBrace&&!isExtglob){state.output=state.output.slice(0,-prev.output.length);prev.type="star";prev.value="*";prev.output=star;state.output+=prev.output;}}if(extglobs.length&&tok.type!=="paren"){extglobs[extglobs.length-1].inner+=tok.value;}if(tok.value||tok.output)append(tok);if(prev&&prev.type==="text"&&tok.type==="text"){prev.value+=tok.value;prev.output=(prev.output||"")+tok.value;return}tok.prev=prev;tokens.push(tok);prev=tok;};const extglobOpen=(type,value)=>{const token={...EXTGLOB_CHARS[value],conditions:1,inner:""};token.prev=prev;token.parens=state.parens;token.output=state.output;const output=(opts.capture?"(":"")+token.open;increment("parens");push({type,value,output:state.output?"":ONE_CHAR});push({type:"paren",extglob:true,value:advance(),output});extglobs.push(token);};const extglobClose=token=>{let output=token.close+(opts.capture?")":"");let rest;if(token.type==="negate"){let extglobStar=star;if(token.inner&&token.inner.length>1&&token.inner.includes("/")){extglobStar=globstar(opts);}if(extglobStar!==star||eos()||/^\)+$/.test(remaining())){output=token.close=`)$))${extglobStar}`;}if(token.inner.includes("*")&&(rest=remaining())&&/^\.[^\\/.]+$/.test(rest)){output=token.close=`)${rest})${extglobStar})`;}if(token.prev.type==="bos"){state.negatedExtglob=true;}}push({type:"paren",extglob:true,value,output});decrement("parens");};if(opts.fastpaths!==false&&!/(^[*!]|[/()[\]{}"])/.test(input)){let backslashes=false;let output=input.replace(REGEX_SPECIAL_CHARS_BACKREF,(m,esc,chars,first,rest,index)=>{if(first==="\\"){backslashes=true;return m}if(first==="?"){if(esc){return esc+first+(rest?QMARK.repeat(rest.length):"")}if(index===0){return qmarkNoDot+(rest?QMARK.repeat(rest.length):"")}return QMARK.repeat(chars.length)}if(first==="."){return DOT_LITERAL.repeat(chars.length)}if(first==="*"){if(esc){return esc+first+(rest?star:"")}return star}return esc?m:`\\${m}`});if(backslashes===true){if(opts.unescape===true){output=output.replace(/\\/g,"");}else {output=output.replace(/\\+/g,m=>{return m.length%2===0?"\\\\":m?"\\":""});}}if(output===input&&opts.contains===true){state.output=input;return state}state.output=utils$e.wrapOutput(output,state,options);return state}while(!eos()){value=advance();if(value==="\0"){continue}if(value==="\\"){const next=peek();if(next==="/"&&opts.bash!==true){continue}if(next==="."||next===";"){continue}if(!next){value+="\\";push({type:"text",value});continue}const match=/^\\+/.exec(remaining());let slashes=0;if(match&&match[0].length>2){slashes=match[0].length;state.index+=slashes;if(slashes%2!==0){value+="\\";}}if(opts.unescape===true){value=advance();}else {value+=advance();}if(state.brackets===0){push({type:"text",value});continue}}if(state.brackets>0&&(value!=="]"||prev.value==="["||prev.value==="[^")){if(opts.posix!==false&&value===":"){const inner=prev.value.slice(1);if(inner.includes("[")){prev.posix=true;if(inner.includes(":")){const idx=prev.value.lastIndexOf("[");const pre=prev.value.slice(0,idx);const rest=prev.value.slice(idx+2);const posix=POSIX_REGEX_SOURCE[rest];if(posix){prev.value=pre+posix;state.backtrack=true;advance();if(!bos.output&&tokens.indexOf(prev)===1){bos.output=ONE_CHAR;}continue}}}}if(value==="["&&peek()!==":"||value==="-"&&peek()==="]"){value=`\\${value}`;}if(value==="]"&&(prev.value==="["||prev.value==="[^")){value=`\\${value}`;}if(opts.posix===true&&value==="!"&&prev.value==="["){value="^";}prev.value+=value;append({value});continue}if(state.quotes===1&&value!=="\""){value=utils$e.escapeRegex(value);prev.value+=value;append({value});continue}if(value==="\""){state.quotes=state.quotes===1?0:1;if(opts.keepQuotes===true){push({type:"text",value});}continue}if(value==="("){increment("parens");push({type:"paren",value});continue}if(value===")"){if(state.parens===0&&opts.strictBrackets===true){throw new SyntaxError(syntaxError("opening","("))}const extglob=extglobs[extglobs.length-1];if(extglob&&state.parens===extglob.parens+1){extglobClose(extglobs.pop());continue}push({type:"paren",value,output:state.parens?")":"\\)"});decrement("parens");continue}if(value==="["){if(opts.nobracket===true||!remaining().includes("]")){if(opts.nobracket!==true&&opts.strictBrackets===true){throw new SyntaxError(syntaxError("closing","]"))}value=`\\${value}`;}else {increment("brackets");}push({type:"bracket",value});continue}if(value==="]"){if(opts.nobracket===true||prev&&prev.type==="bracket"&&prev.value.length===1){push({type:"text",value,output:`\\${value}`});continue}if(state.brackets===0){if(opts.strictBrackets===true){throw new SyntaxError(syntaxError("opening","["))}push({type:"text",value,output:`\\${value}`});continue}decrement("brackets");const prevValue=prev.value.slice(1);if(prev.posix!==true&&prevValue[0]==="^"&&!prevValue.includes("/")){value=`/${value}`;}prev.value+=value;append({value});if(opts.literalBrackets===false||utils$e.hasRegexChars(prevValue)){continue}const escaped=utils$e.escapeRegex(prev.value);state.output=state.output.slice(0,-prev.value.length);if(opts.literalBrackets===true){state.output+=escaped;prev.value=escaped;continue}prev.value=`(${capture}${escaped}|${prev.value})`;state.output+=prev.value;continue}if(value==="{"&&opts.nobrace!==true){increment("braces");const open={type:"brace",value,output:"(",outputIndex:state.output.length,tokensIndex:state.tokens.length};braces.push(open);push(open);continue}if(value==="}"){const brace=braces[braces.length-1];if(opts.nobrace===true||!brace){push({type:"text",value,output:value});continue}let output=")";if(brace.dots===true){const arr=tokens.slice();const range=[];for(let i=arr.length-1;i>=0;i--){tokens.pop();if(arr[i].type==="brace"){break}if(arr[i].type!=="dots"){range.unshift(arr[i].value);}}output=expandRange(range,opts);state.backtrack=true;}if(brace.comma!==true&&brace.dots!==true){const out=state.output.slice(0,brace.outputIndex);const toks=state.tokens.slice(brace.tokensIndex);brace.value=brace.output="\\{";value=output="\\}";state.output=out;for(const t of toks){state.output+=t.output||t.value;}}push({type:"brace",value,output});decrement("braces");braces.pop();continue}if(value==="|"){if(extglobs.length>0){extglobs[extglobs.length-1].conditions++;}push({type:"text",value});continue}if(value===","){let output=value;const brace=braces[braces.length-1];if(brace&&stack[stack.length-1]==="braces"){brace.comma=true;output="|";}push({type:"comma",value,output});continue}if(value==="/"){if(prev.type==="dot"&&state.index===state.start+1){state.start=state.index+1;state.consumed="";state.output="";tokens.pop();prev=bos;continue}push({type:"slash",value,output:SLASH_LITERAL});continue}if(value==="."){if(state.braces>0&&prev.type==="dot"){if(prev.value===".")prev.output=DOT_LITERAL;const brace=braces[braces.length-1];prev.type="dots";prev.output+=value;prev.value+=value;brace.dots=true;continue}if(state.braces+state.parens===0&&prev.type!=="bos"&&prev.type!=="slash"){push({type:"text",value,output:DOT_LITERAL});continue}push({type:"dot",value,output:DOT_LITERAL});continue}if(value==="?"){const isGroup=prev&&prev.value==="(";if(!isGroup&&opts.noextglob!==true&&peek()==="("&&peek(2)!=="?"){extglobOpen("qmark",value);continue}if(prev&&prev.type==="paren"){const next=peek();let output=value;if(next==="<"&&!utils$e.supportsLookbehinds()){throw new Error("Node.js v10 or higher is required for regex lookbehinds")}if(prev.value==="("&&!/[!=<:]/.test(next)||next==="<"&&!/<([!=]|\w+>)/.test(remaining())){output=`\\${value}`;}push({type:"text",value,output});continue}if(opts.dot!==true&&(prev.type==="slash"||prev.type==="bos")){push({type:"qmark",value,output:QMARK_NO_DOT});continue}push({type:"qmark",value,output:QMARK});continue}if(value==="!"){if(opts.noextglob!==true&&peek()==="("){if(peek(2)!=="?"||!/[!=<:]/.test(peek(3))){extglobOpen("negate",value);continue}}if(opts.nonegate!==true&&state.index===0){negate();continue}}if(value==="+"){if(opts.noextglob!==true&&peek()==="("&&peek(2)!=="?"){extglobOpen("plus",value);continue}if(prev&&prev.value==="("||opts.regex===false){push({type:"plus",value,output:PLUS_LITERAL});continue}if(prev&&(prev.type==="bracket"||prev.type==="paren"||prev.type==="brace")||state.parens>0){push({type:"plus",value});continue}push({type:"plus",value:PLUS_LITERAL});continue}if(value==="@"){if(opts.noextglob!==true&&peek()==="("&&peek(2)!=="?"){push({type:"at",extglob:true,value,output:""});continue}push({type:"text",value});continue}if(value!=="*"){if(value==="$"||value==="^"){value=`\\${value}`;}const match=REGEX_NON_SPECIAL_CHARS.exec(remaining());if(match){value+=match[0];state.index+=match[0].length;}push({type:"text",value});continue}if(prev&&(prev.type==="globstar"||prev.star===true)){prev.type="star";prev.star=true;prev.value+=value;prev.output=star;state.backtrack=true;state.globstar=true;consume(value);continue}let rest=remaining();if(opts.noextglob!==true&&/^\([^?]/.test(rest)){extglobOpen("star",value);continue}if(prev.type==="star"){if(opts.noglobstar===true){consume(value);continue}const prior=prev.prev;const before=prior.prev;const isStart=prior.type==="slash"||prior.type==="bos";const afterStar=before&&(before.type==="star"||before.type==="globstar");if(opts.bash===true&&(!isStart||rest[0]&&rest[0]!=="/")){push({type:"star",value,output:""});continue}const isBrace=state.braces>0&&(prior.type==="comma"||prior.type==="brace");const isExtglob=extglobs.length&&(prior.type==="pipe"||prior.type==="paren");if(!isStart&&prior.type!=="paren"&&!isBrace&&!isExtglob){push({type:"star",value,output:""});continue}while(rest.slice(0,3)==="/**"){const after=input[state.index+4];if(after&&after!=="/"){break}rest=rest.slice(3);consume("/**",3);}if(prior.type==="bos"&&eos()){prev.type="globstar";prev.value+=value;prev.output=globstar(opts);state.output=prev.output;state.globstar=true;consume(value);continue}if(prior.type==="slash"&&prior.prev.type!=="bos"&&!afterStar&&eos()){state.output=state.output.slice(0,-(prior.output+prev.output).length);prior.output=`(?:${prior.output}`;prev.type="globstar";prev.output=globstar(opts)+(opts.strictSlashes?")":"|$)");prev.value+=value;state.globstar=true;state.output+=prior.output+prev.output;consume(value);continue}if(prior.type==="slash"&&prior.prev.type!=="bos"&&rest[0]==="/"){const end=rest[1]!==void 0?"|$":"";state.output=state.output.slice(0,-(prior.output+prev.output).length);prior.output=`(?:${prior.output}`;prev.type="globstar";prev.output=`${globstar(opts)}${SLASH_LITERAL}|${SLASH_LITERAL}${end})`;prev.value+=value;state.output+=prior.output+prev.output;state.globstar=true;consume(value+advance());push({type:"slash",value:"/",output:""});continue}if(prior.type==="bos"&&rest[0]==="/"){prev.type="globstar";prev.value+=value;prev.output=`(?:^|${SLASH_LITERAL}|${globstar(opts)}${SLASH_LITERAL})`;state.output=prev.output;state.globstar=true;consume(value+advance());push({type:"slash",value:"/",output:""});continue}state.output=state.output.slice(0,-prev.output.length);prev.type="globstar";prev.output=globstar(opts);prev.value+=value;state.output+=prev.output;state.globstar=true;consume(value);continue}const token={type:"star",value,output:star};if(opts.bash===true){token.output=".*?";if(prev.type==="bos"||prev.type==="slash"){token.output=nodot+token.output;}push(token);continue}if(prev&&(prev.type==="bracket"||prev.type==="paren")&&opts.regex===true){token.output=value;push(token);continue}if(state.index===state.start||prev.type==="slash"||prev.type==="dot"){if(prev.type==="dot"){state.output+=NO_DOT_SLASH;prev.output+=NO_DOT_SLASH;}else if(opts.dot===true){state.output+=NO_DOTS_SLASH;prev.output+=NO_DOTS_SLASH;}else {state.output+=nodot;prev.output+=nodot;}if(peek()!=="*"){state.output+=ONE_CHAR;prev.output+=ONE_CHAR;}}push(token);}while(state.brackets>0){if(opts.strictBrackets===true)throw new SyntaxError(syntaxError("closing","]"));state.output=utils$e.escapeLast(state.output,"[");decrement("brackets");}while(state.parens>0){if(opts.strictBrackets===true)throw new SyntaxError(syntaxError("closing",")"));state.output=utils$e.escapeLast(state.output,"(");decrement("parens");}while(state.braces>0){if(opts.strictBrackets===true)throw new SyntaxError(syntaxError("closing","}"));state.output=utils$e.escapeLast(state.output,"{");decrement("braces");}if(opts.strictSlashes!==true&&(prev.type==="star"||prev.type==="bracket")){push({type:"maybe_slash",value:"",output:`${SLASH_LITERAL}?`});}if(state.backtrack===true){state.output="";for(const token of state.tokens){state.output+=token.output!=null?token.output:token.value;if(token.suffix){state.output+=token.suffix;}}}return state};parse$b.fastpaths=(input,options)=>{const opts={...options};const max=typeof opts.maxLength==="number"?Math.min(MAX_LENGTH,opts.maxLength):MAX_LENGTH;const len=input.length;if(len>max){throw new SyntaxError(`Input length: ${len}, exceeds maximum allowed length: ${max}`)}input=REPLACEMENTS[input]||input;const win32=utils$e.isWindows(options);const{DOT_LITERAL,SLASH_LITERAL,ONE_CHAR,DOTS_SLASH,NO_DOT,NO_DOTS,NO_DOTS_SLASH,STAR,START_ANCHOR}=constants$4.globChars(win32);const nodot=opts.dot?NO_DOTS:NO_DOT;const slashDot=opts.dot?NO_DOTS_SLASH:NO_DOT;const capture=opts.capture?"":"?:";const state={negated:false,prefix:""};let star=opts.bash===true?".*?":STAR;if(opts.capture){star=`(${star})`;}const globstar=opts=>{if(opts.noglobstar===true)return star;return `(${capture}(?:(?!${START_ANCHOR}${opts.dot?DOTS_SLASH:DOT_LITERAL}).)*?)`};const create=str=>{switch(str){case"*":return `${nodot}${ONE_CHAR}${star}`;case".*":return `${DOT_LITERAL}${ONE_CHAR}${star}`;case"*.*":return `${nodot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;case"*/*":return `${nodot}${star}${SLASH_LITERAL}${ONE_CHAR}${slashDot}${star}`;case"**":return nodot+globstar(opts);case"**/*":return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${ONE_CHAR}${star}`;case"**/*.*":return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${slashDot}${star}${DOT_LITERAL}${ONE_CHAR}${star}`;case"**/.*":return `(?:${nodot}${globstar(opts)}${SLASH_LITERAL})?${DOT_LITERAL}${ONE_CHAR}${star}`;default:{const match=/^(.*?)\.(\w+)$/.exec(str);if(!match)return;const source=create(match[1]);if(!source)return;return source+DOT_LITERAL+match[2]}}};const output=utils$e.removePrefix(input,state);let source=create(output);if(source&&opts.strictSlashes!==true){source+=`${SLASH_LITERAL}?`;}return source};var parse_1=parse$b;

const path$n=require$$0__default$1["default"];const scan=scan_1;const parse$a=parse_1;const utils$d=utils$g;const constants$3=constants$5;const isObject$2=val=>val&&typeof val==="object"&&!Array.isArray(val);const picomatch$4=(glob,options,returnState=false)=>{if(Array.isArray(glob)){const fns=glob.map(input=>picomatch$4(input,options,returnState));const arrayMatcher=str=>{for(const isMatch of fns){const state=isMatch(str);if(state)return state}return false};return arrayMatcher}const isState=isObject$2(glob)&&glob.tokens&&glob.input;if(glob===""||typeof glob!=="string"&&!isState){throw new TypeError("Expected pattern to be a non-empty string")}const opts=options||{};const posix=utils$d.isWindows(options);const regex=isState?picomatch$4.compileRe(glob,options):picomatch$4.makeRe(glob,options,false,true);const state=regex.state;delete regex.state;let isIgnored=()=>false;if(opts.ignore){const ignoreOpts={...options,ignore:null,onMatch:null,onResult:null};isIgnored=picomatch$4(opts.ignore,ignoreOpts,returnState);}const matcher=(input,returnObject=false)=>{const{isMatch,match,output}=picomatch$4.test(input,regex,options,{glob,posix});const result={glob,state,regex,posix,input,output,match,isMatch};if(typeof opts.onResult==="function"){opts.onResult(result);}if(isMatch===false){result.isMatch=false;return returnObject?result:false}if(isIgnored(input)){if(typeof opts.onIgnore==="function"){opts.onIgnore(result);}result.isMatch=false;return returnObject?result:false}if(typeof opts.onMatch==="function"){opts.onMatch(result);}return returnObject?result:true};if(returnState){matcher.state=state;}return matcher};picomatch$4.test=(input,regex,options,{glob,posix}={})=>{if(typeof input!=="string"){throw new TypeError("Expected input to be a string")}if(input===""){return {isMatch:false,output:""}}const opts=options||{};const format=opts.format||(posix?utils$d.toPosixSlashes:null);let match=input===glob;let output=match&&format?format(input):input;if(match===false){output=format?format(input):input;match=output===glob;}if(match===false||opts.capture===true){if(opts.matchBase===true||opts.basename===true){match=picomatch$4.matchBase(input,regex,options,posix);}else {match=regex.exec(output);}}return {isMatch:Boolean(match),match,output}};picomatch$4.matchBase=(input,glob,options,posix=utils$d.isWindows(options))=>{const regex=glob instanceof RegExp?glob:picomatch$4.makeRe(glob,options);return regex.test(path$n.basename(input))};picomatch$4.isMatch=(str,patterns,options)=>picomatch$4(patterns,options)(str);picomatch$4.parse=(pattern,options)=>{if(Array.isArray(pattern))return pattern.map(p=>picomatch$4.parse(p,options));return parse$a(pattern,{...options,fastpaths:false})};picomatch$4.scan=(input,options)=>scan(input,options);picomatch$4.compileRe=(state,options,returnOutput=false,returnState=false)=>{if(returnOutput===true){return state.output}const opts=options||{};const prepend=opts.contains?"":"^";const append=opts.contains?"":"$";let source=`${prepend}(?:${state.output})${append}`;if(state&&state.negated===true){source=`^(?!${source}).*$`;}const regex=picomatch$4.toRegex(source,options);if(returnState===true){regex.state=state;}return regex};picomatch$4.makeRe=(input,options={},returnOutput=false,returnState=false)=>{if(!input||typeof input!=="string"){throw new TypeError("Expected a non-empty string")}let parsed={negated:false,fastpaths:true};if(options.fastpaths!==false&&(input[0]==="."||input[0]==="*")){parsed.output=parse$a.fastpaths(input,options);}if(!parsed.output){parsed=parse$a(input,options);}return picomatch$4.compileRe(parsed,options,returnOutput,returnState)};picomatch$4.toRegex=(source,options)=>{try{const opts=options||{};return new RegExp(source,opts.flags||(opts.nocase?"i":""))}catch(err){if(options&&options.debug===true)throw err;return /$^/}};picomatch$4.constants=constants$3;var picomatch_1=picomatch$4;

var picomatch$3=picomatch_1;

const util$4=require$$0__default$2["default"];const braces$1=braces_1;const picomatch$2=picomatch$3;const utils$c=utils$g;const isEmptyString=val=>val===""||val==="./";const micromatch$1=(list,patterns,options)=>{patterns=[].concat(patterns);list=[].concat(list);let omit=new Set;let keep=new Set;let items=new Set;let negatives=0;let onResult=state=>{items.add(state.output);if(options&&options.onResult){options.onResult(state);}};for(let i=0;i<patterns.length;i++){let isMatch=picomatch$2(String(patterns[i]),{...options,onResult},true);let negated=isMatch.state.negated||isMatch.state.negatedExtglob;if(negated)negatives++;for(let item of list){let matched=isMatch(item,true);let match=negated?!matched.isMatch:matched.isMatch;if(!match)continue;if(negated){omit.add(matched.output);}else {omit.delete(matched.output);keep.add(matched.output);}}}let result=negatives===patterns.length?[...items]:[...keep];let matches=result.filter(item=>!omit.has(item));if(options&&matches.length===0){if(options.failglob===true){throw new Error(`No matches found for "${patterns.join(", ")}"`)}if(options.nonull===true||options.nullglob===true){return options.unescape?patterns.map(p=>p.replace(/\\/g,"")):patterns}}return matches};micromatch$1.match=micromatch$1;micromatch$1.matcher=(pattern,options)=>picomatch$2(pattern,options);micromatch$1.isMatch=(str,patterns,options)=>picomatch$2(patterns,options)(str);micromatch$1.any=micromatch$1.isMatch;micromatch$1.not=(list,patterns,options={})=>{patterns=[].concat(patterns).map(String);let result=new Set;let items=[];let onResult=state=>{if(options.onResult)options.onResult(state);items.push(state.output);};let matches=micromatch$1(list,patterns,{...options,onResult});for(let item of items){if(!matches.includes(item)){result.add(item);}}return [...result]};micromatch$1.contains=(str,pattern,options)=>{if(typeof str!=="string"){throw new TypeError(`Expected a string: "${util$4.inspect(str)}"`)}if(Array.isArray(pattern)){return pattern.some(p=>micromatch$1.contains(str,p,options))}if(typeof pattern==="string"){if(isEmptyString(str)||isEmptyString(pattern)){return false}if(str.includes(pattern)||str.startsWith("./")&&str.slice(2).includes(pattern)){return true}}return micromatch$1.isMatch(str,pattern,{...options,contains:true})};micromatch$1.matchKeys=(obj,patterns,options)=>{if(!utils$c.isObject(obj)){throw new TypeError("Expected the first argument to be an object")}let keys=micromatch$1(Object.keys(obj),patterns,options);let res={};for(let key of keys)res[key]=obj[key];return res};micromatch$1.some=(list,patterns,options)=>{let items=[].concat(list);for(let pattern of [].concat(patterns)){let isMatch=picomatch$2(String(pattern),options);if(items.some(item=>isMatch(item))){return true}}return false};micromatch$1.every=(list,patterns,options)=>{let items=[].concat(list);for(let pattern of [].concat(patterns)){let isMatch=picomatch$2(String(pattern),options);if(!items.every(item=>isMatch(item))){return false}}return true};micromatch$1.all=(str,patterns,options)=>{if(typeof str!=="string"){throw new TypeError(`Expected a string: "${util$4.inspect(str)}"`)}return [].concat(patterns).every(p=>picomatch$2(p,options)(str))};micromatch$1.capture=(glob,input,options)=>{let posix=utils$c.isWindows(options);let regex=picomatch$2.makeRe(String(glob),{...options,capture:true});let match=regex.exec(posix?utils$c.toPosixSlashes(input):input);if(match){return match.slice(1).map(v=>v===void 0?"":v)}};micromatch$1.makeRe=(...args)=>picomatch$2.makeRe(...args);micromatch$1.scan=(...args)=>picomatch$2.scan(...args);micromatch$1.parse=(patterns,options)=>{let res=[];for(let pattern of [].concat(patterns||[])){for(let str of braces$1(String(pattern),options)){res.push(picomatch$2.parse(str,options));}}return res};micromatch$1.braces=(pattern,options)=>{if(typeof pattern!=="string")throw new TypeError("Expected a string");if(options&&options.nobrace===true||!/\{.*\}/.test(pattern)){return [pattern]}return braces$1(pattern,options)};micromatch$1.braceExpand=(pattern,options)=>{if(typeof pattern!=="string")throw new TypeError("Expected a string");return micromatch$1.braces(pattern,{...options,expand:true})};var micromatch_1=micromatch$1;

Object.defineProperty(pattern$1,"__esModule",{value:true});pattern$1.matchAny=pattern$1.convertPatternsToRe=pattern$1.makeRe=pattern$1.getPatternParts=pattern$1.expandBraceExpansion=pattern$1.expandPatternsWithBraceExpansion=pattern$1.isAffectDepthOfReadingPattern=pattern$1.endsWithSlashGlobStar=pattern$1.hasGlobStar=pattern$1.getBaseDirectory=pattern$1.isPatternRelatedToParentDirectory=pattern$1.getPatternsOutsideCurrentDirectory=pattern$1.getPatternsInsideCurrentDirectory=pattern$1.getPositivePatterns=pattern$1.getNegativePatterns=pattern$1.isPositivePattern=pattern$1.isNegativePattern=pattern$1.convertToNegativePattern=pattern$1.convertToPositivePattern=pattern$1.isDynamicPattern=pattern$1.isStaticPattern=void 0;const path$m=require$$0__default$1["default"];const globParent$1=globParent$2;const micromatch=micromatch_1;const GLOBSTAR$1="**";const ESCAPE_SYMBOL="\\";const COMMON_GLOB_SYMBOLS_RE=/[*?]|^!/;const REGEX_CHARACTER_CLASS_SYMBOLS_RE=/\[.*]/;const REGEX_GROUP_SYMBOLS_RE=/(?:^|[^!*+?@])\(.*\|.*\)/;const GLOB_EXTENSION_SYMBOLS_RE=/[!*+?@]\(.*\)/;const BRACE_EXPANSIONS_SYMBOLS_RE=/{.*(?:,|\.\.).*}/;function isStaticPattern(pattern,options={}){return !isDynamicPattern(pattern,options)}pattern$1.isStaticPattern=isStaticPattern;function isDynamicPattern(pattern,options={}){if(pattern===""){return false}if(options.caseSensitiveMatch===false||pattern.includes(ESCAPE_SYMBOL)){return true}if(COMMON_GLOB_SYMBOLS_RE.test(pattern)||REGEX_CHARACTER_CLASS_SYMBOLS_RE.test(pattern)||REGEX_GROUP_SYMBOLS_RE.test(pattern)){return true}if(options.extglob!==false&&GLOB_EXTENSION_SYMBOLS_RE.test(pattern)){return true}if(options.braceExpansion!==false&&BRACE_EXPANSIONS_SYMBOLS_RE.test(pattern)){return true}return false}pattern$1.isDynamicPattern=isDynamicPattern;function convertToPositivePattern(pattern){return isNegativePattern(pattern)?pattern.slice(1):pattern}pattern$1.convertToPositivePattern=convertToPositivePattern;function convertToNegativePattern(pattern){return "!"+pattern}pattern$1.convertToNegativePattern=convertToNegativePattern;function isNegativePattern(pattern){return pattern.startsWith("!")&&pattern[1]!=="("}pattern$1.isNegativePattern=isNegativePattern;function isPositivePattern(pattern){return !isNegativePattern(pattern)}pattern$1.isPositivePattern=isPositivePattern;function getNegativePatterns(patterns){return patterns.filter(isNegativePattern)}pattern$1.getNegativePatterns=getNegativePatterns;function getPositivePatterns$1(patterns){return patterns.filter(isPositivePattern)}pattern$1.getPositivePatterns=getPositivePatterns$1;function getPatternsInsideCurrentDirectory(patterns){return patterns.filter(pattern=>!isPatternRelatedToParentDirectory(pattern))}pattern$1.getPatternsInsideCurrentDirectory=getPatternsInsideCurrentDirectory;function getPatternsOutsideCurrentDirectory(patterns){return patterns.filter(isPatternRelatedToParentDirectory)}pattern$1.getPatternsOutsideCurrentDirectory=getPatternsOutsideCurrentDirectory;function isPatternRelatedToParentDirectory(pattern){return pattern.startsWith("..")||pattern.startsWith("./..")}pattern$1.isPatternRelatedToParentDirectory=isPatternRelatedToParentDirectory;function getBaseDirectory(pattern){return globParent$1(pattern,{flipBackslashes:false})}pattern$1.getBaseDirectory=getBaseDirectory;function hasGlobStar(pattern){return pattern.includes(GLOBSTAR$1)}pattern$1.hasGlobStar=hasGlobStar;function endsWithSlashGlobStar(pattern){return pattern.endsWith("/"+GLOBSTAR$1)}pattern$1.endsWithSlashGlobStar=endsWithSlashGlobStar;function isAffectDepthOfReadingPattern(pattern){const basename=path$m.basename(pattern);return endsWithSlashGlobStar(pattern)||isStaticPattern(basename)}pattern$1.isAffectDepthOfReadingPattern=isAffectDepthOfReadingPattern;function expandPatternsWithBraceExpansion(patterns){return patterns.reduce((collection,pattern)=>{return collection.concat(expandBraceExpansion(pattern))},[])}pattern$1.expandPatternsWithBraceExpansion=expandPatternsWithBraceExpansion;function expandBraceExpansion(pattern){return micromatch.braces(pattern,{expand:true,nodupes:true})}pattern$1.expandBraceExpansion=expandBraceExpansion;function getPatternParts(pattern,options){let{parts}=micromatch.scan(pattern,Object.assign(Object.assign({},options),{parts:true}));if(parts.length===0){parts=[pattern];}if(parts[0].startsWith("/")){parts[0]=parts[0].slice(1);parts.unshift("");}return parts}pattern$1.getPatternParts=getPatternParts;function makeRe(pattern,options){return micromatch.makeRe(pattern,options)}pattern$1.makeRe=makeRe;function convertPatternsToRe(patterns,options){return patterns.map(pattern=>makeRe(pattern,options))}pattern$1.convertPatternsToRe=convertPatternsToRe;function matchAny(entry,patternsRe){return patternsRe.some(patternRe=>patternRe.test(entry))}pattern$1.matchAny=matchAny;

var stream$4 = {};

Object.defineProperty(stream$4,"__esModule",{value:true});stream$4.merge=void 0;const merge2$1=merge2_1;function merge(streams){const mergedStream=merge2$1(streams);streams.forEach(stream=>{stream.once("error",error=>mergedStream.emit("error",error));});mergedStream.once("close",()=>propagateCloseEventToSources(streams));mergedStream.once("end",()=>propagateCloseEventToSources(streams));return mergedStream}stream$4.merge=merge;function propagateCloseEventToSources(streams){streams.forEach(stream=>stream.emit("close"));}

var string$1 = {};

Object.defineProperty(string$1,"__esModule",{value:true});string$1.isEmpty=string$1.isString=void 0;function isString$1(input){return typeof input==="string"}string$1.isString=isString$1;function isEmpty(input){return input===""}string$1.isEmpty=isEmpty;

Object.defineProperty(utils$l,"__esModule",{value:true});utils$l.string=utils$l.stream=utils$l.pattern=utils$l.path=utils$l.fs=utils$l.errno=utils$l.array=void 0;const array=array$1;utils$l.array=array;const errno=errno$1;utils$l.errno=errno;const fs$w=fs$x;utils$l.fs=fs$w;const path$l=path$q;utils$l.path=path$l;const pattern=pattern$1;utils$l.pattern=pattern;const stream$3=stream$4;utils$l.stream=stream$3;const string=string$1;utils$l.string=string;

Object.defineProperty(tasks,"__esModule",{value:true});tasks.convertPatternGroupToTask=tasks.convertPatternGroupsToTasks=tasks.groupPatternsByBaseDirectory=tasks.getNegativePatternsAsPositive=tasks.getPositivePatterns=tasks.convertPatternsToTasks=tasks.generate=void 0;const utils$b=utils$l;function generate(patterns,settings){const positivePatterns=getPositivePatterns(patterns);const negativePatterns=getNegativePatternsAsPositive(patterns,settings.ignore);const staticPatterns=positivePatterns.filter(pattern=>utils$b.pattern.isStaticPattern(pattern,settings));const dynamicPatterns=positivePatterns.filter(pattern=>utils$b.pattern.isDynamicPattern(pattern,settings));const staticTasks=convertPatternsToTasks(staticPatterns,negativePatterns,false);const dynamicTasks=convertPatternsToTasks(dynamicPatterns,negativePatterns,true);return staticTasks.concat(dynamicTasks)}tasks.generate=generate;function convertPatternsToTasks(positive,negative,dynamic){const tasks=[];const patternsOutsideCurrentDirectory=utils$b.pattern.getPatternsOutsideCurrentDirectory(positive);const patternsInsideCurrentDirectory=utils$b.pattern.getPatternsInsideCurrentDirectory(positive);const outsideCurrentDirectoryGroup=groupPatternsByBaseDirectory(patternsOutsideCurrentDirectory);const insideCurrentDirectoryGroup=groupPatternsByBaseDirectory(patternsInsideCurrentDirectory);tasks.push(...convertPatternGroupsToTasks(outsideCurrentDirectoryGroup,negative,dynamic));if("."in insideCurrentDirectoryGroup){tasks.push(convertPatternGroupToTask(".",patternsInsideCurrentDirectory,negative,dynamic));}else {tasks.push(...convertPatternGroupsToTasks(insideCurrentDirectoryGroup,negative,dynamic));}return tasks}tasks.convertPatternsToTasks=convertPatternsToTasks;function getPositivePatterns(patterns){return utils$b.pattern.getPositivePatterns(patterns)}tasks.getPositivePatterns=getPositivePatterns;function getNegativePatternsAsPositive(patterns,ignore){const negative=utils$b.pattern.getNegativePatterns(patterns).concat(ignore);const positive=negative.map(utils$b.pattern.convertToPositivePattern);return positive}tasks.getNegativePatternsAsPositive=getNegativePatternsAsPositive;function groupPatternsByBaseDirectory(patterns){const group={};return patterns.reduce((collection,pattern)=>{const base=utils$b.pattern.getBaseDirectory(pattern);if(base in collection){collection[base].push(pattern);}else {collection[base]=[pattern];}return collection},group)}tasks.groupPatternsByBaseDirectory=groupPatternsByBaseDirectory;function convertPatternGroupsToTasks(positive,negative,dynamic){return Object.keys(positive).map(base=>{return convertPatternGroupToTask(base,positive[base],negative,dynamic)})}tasks.convertPatternGroupsToTasks=convertPatternGroupsToTasks;function convertPatternGroupToTask(base,positive,negative,dynamic){return {dynamic,positive,negative,base,patterns:[].concat(positive,negative.map(utils$b.pattern.convertToNegativePattern))}}tasks.convertPatternGroupToTask=convertPatternGroupToTask;

var async$6 = {};

var stream$2 = {};

var out$3 = {};

var async$5 = {};

Object.defineProperty(async$5,"__esModule",{value:true});async$5.read=void 0;function read$3(path,settings,callback){settings.fs.lstat(path,(lstatError,lstat)=>{if(lstatError!==null){callFailureCallback$2(callback,lstatError);return}if(!lstat.isSymbolicLink()||!settings.followSymbolicLink){callSuccessCallback$2(callback,lstat);return}settings.fs.stat(path,(statError,stat)=>{if(statError!==null){if(settings.throwErrorOnBrokenSymbolicLink){callFailureCallback$2(callback,statError);return}callSuccessCallback$2(callback,lstat);return}if(settings.markSymbolicLink){stat.isSymbolicLink=()=>true;}callSuccessCallback$2(callback,stat);});});}async$5.read=read$3;function callFailureCallback$2(callback,error){callback(error);}function callSuccessCallback$2(callback,result){callback(null,result);}

var sync$7 = {};

Object.defineProperty(sync$7,"__esModule",{value:true});sync$7.read=void 0;function read$2(path,settings){const lstat=settings.fs.lstatSync(path);if(!lstat.isSymbolicLink()||!settings.followSymbolicLink){return lstat}try{const stat=settings.fs.statSync(path);if(settings.markSymbolicLink){stat.isSymbolicLink=()=>true;}return stat}catch(error){if(!settings.throwErrorOnBrokenSymbolicLink){return lstat}throw error}}sync$7.read=read$2;

var settings$3 = {};

var fs$v = {};

(function(exports){Object.defineProperty(exports,"__esModule",{value:true});exports.createFileSystemAdapter=exports.FILE_SYSTEM_ADAPTER=void 0;const fs=require$$0__default$3["default"];exports.FILE_SYSTEM_ADAPTER={lstat:fs.lstat,stat:fs.stat,lstatSync:fs.lstatSync,statSync:fs.statSync};function createFileSystemAdapter(fsMethods){if(fsMethods===undefined){return exports.FILE_SYSTEM_ADAPTER}return Object.assign(Object.assign({},exports.FILE_SYSTEM_ADAPTER),fsMethods)}exports.createFileSystemAdapter=createFileSystemAdapter;})(fs$v);getDefaultExportFromCjs(fs$v);

Object.defineProperty(settings$3,"__esModule",{value:true});const fs$u=fs$v;class Settings$2{constructor(_options={}){this._options=_options;this.followSymbolicLink=this._getValue(this._options.followSymbolicLink,true);this.fs=fs$u.createFileSystemAdapter(this._options.fs);this.markSymbolicLink=this._getValue(this._options.markSymbolicLink,false);this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,true);}_getValue(option,value){return option!==null&&option!==void 0?option:value}}settings$3.default=Settings$2;

Object.defineProperty(out$3,"__esModule",{value:true});out$3.statSync=out$3.stat=out$3.Settings=void 0;const async$4=async$5;const sync$6=sync$7;const settings_1$3=settings$3;out$3.Settings=settings_1$3.default;function stat$9(path,optionsOrSettingsOrCallback,callback){if(typeof optionsOrSettingsOrCallback==="function"){async$4.read(path,getSettings$2(),optionsOrSettingsOrCallback);return}async$4.read(path,getSettings$2(optionsOrSettingsOrCallback),callback);}out$3.stat=stat$9;function statSync$1(path,optionsOrSettings){const settings=getSettings$2(optionsOrSettings);return sync$6.read(path,settings)}out$3.statSync=statSync$1;function getSettings$2(settingsOrOptions={}){if(settingsOrOptions instanceof settings_1$3.default){return settingsOrOptions}return new settings_1$3.default(settingsOrOptions)}

var out$2 = {};

var async$3 = {};

var async$2 = {};

var out$1 = {};

var async$1 = {};

let promise;var queueMicrotask_1=typeof queueMicrotask==="function"?queueMicrotask.bind(typeof window!=="undefined"?window:commonjsGlobal):cb=>(promise||(promise=Promise.resolve())).then(cb).catch(err=>setTimeout(()=>{throw err},0));

var runParallel_1=runParallel;const queueMicrotask$1=queueMicrotask_1;function runParallel(tasks,cb){let results,pending,keys;let isSync=true;if(Array.isArray(tasks)){results=[];pending=tasks.length;}else {keys=Object.keys(tasks);results={};pending=keys.length;}function done(err){function end(){if(cb)cb(err,results);cb=null;}if(isSync)queueMicrotask$1(end);else end();}function each(i,err,result){results[i]=result;if(--pending===0||err){done(err);}}if(!pending){done(null);}else if(keys){keys.forEach(function(key){tasks[key](function(err,result){each(key,err,result);});});}else {tasks.forEach(function(task,i){task(function(err,result){each(i,err,result);});});}isSync=false;}

var constants$2 = {};

Object.defineProperty(constants$2,"__esModule",{value:true});constants$2.IS_SUPPORT_READDIR_WITH_FILE_TYPES=void 0;const NODE_PROCESS_VERSION_PARTS=process.versions.node.split(".");if(NODE_PROCESS_VERSION_PARTS[0]===undefined||NODE_PROCESS_VERSION_PARTS[1]===undefined){throw new Error(`Unexpected behavior. The 'process.versions.node' variable has invalid value: ${process.versions.node}`)}const MAJOR_VERSION=Number.parseInt(NODE_PROCESS_VERSION_PARTS[0],10);const MINOR_VERSION=Number.parseInt(NODE_PROCESS_VERSION_PARTS[1],10);const SUPPORTED_MAJOR_VERSION=10;const SUPPORTED_MINOR_VERSION=10;const IS_MATCHED_BY_MAJOR=MAJOR_VERSION>SUPPORTED_MAJOR_VERSION;const IS_MATCHED_BY_MAJOR_AND_MINOR=MAJOR_VERSION===SUPPORTED_MAJOR_VERSION&&MINOR_VERSION>=SUPPORTED_MINOR_VERSION;constants$2.IS_SUPPORT_READDIR_WITH_FILE_TYPES=IS_MATCHED_BY_MAJOR||IS_MATCHED_BY_MAJOR_AND_MINOR;

var utils$a = {};

var fs$t = {};

Object.defineProperty(fs$t,"__esModule",{value:true});fs$t.createDirentFromStats=void 0;class DirentFromStats{constructor(name,stats){this.name=name;this.isBlockDevice=stats.isBlockDevice.bind(stats);this.isCharacterDevice=stats.isCharacterDevice.bind(stats);this.isDirectory=stats.isDirectory.bind(stats);this.isFIFO=stats.isFIFO.bind(stats);this.isFile=stats.isFile.bind(stats);this.isSocket=stats.isSocket.bind(stats);this.isSymbolicLink=stats.isSymbolicLink.bind(stats);}}function createDirentFromStats(name,stats){return new DirentFromStats(name,stats)}fs$t.createDirentFromStats=createDirentFromStats;

Object.defineProperty(utils$a,"__esModule",{value:true});utils$a.fs=void 0;const fs$s=fs$t;utils$a.fs=fs$s;

var common$7 = {};

Object.defineProperty(common$7,"__esModule",{value:true});common$7.joinPathSegments=void 0;function joinPathSegments$1(a,b,separator){if(a.endsWith(separator)){return a+b}return a+separator+b}common$7.joinPathSegments=joinPathSegments$1;

Object.defineProperty(async$1,"__esModule",{value:true});async$1.readdir=async$1.readdirWithFileTypes=async$1.read=void 0;const fsStat$5=out$3;const rpl=runParallel_1;const constants_1$1=constants$2;const utils$9=utils$a;const common$6=common$7;function read$1(directory,settings,callback){if(!settings.stats&&constants_1$1.IS_SUPPORT_READDIR_WITH_FILE_TYPES){readdirWithFileTypes$1(directory,settings,callback);return}readdir$3(directory,settings,callback);}async$1.read=read$1;function readdirWithFileTypes$1(directory,settings,callback){settings.fs.readdir(directory,{withFileTypes:true},(readdirError,dirents)=>{if(readdirError!==null){callFailureCallback$1(callback,readdirError);return}const entries=dirents.map(dirent=>({dirent,name:dirent.name,path:common$6.joinPathSegments(directory,dirent.name,settings.pathSegmentSeparator)}));if(!settings.followSymbolicLinks){callSuccessCallback$1(callback,entries);return}const tasks=entries.map(entry=>makeRplTaskEntry(entry,settings));rpl(tasks,(rplError,rplEntries)=>{if(rplError!==null){callFailureCallback$1(callback,rplError);return}callSuccessCallback$1(callback,rplEntries);});});}async$1.readdirWithFileTypes=readdirWithFileTypes$1;function makeRplTaskEntry(entry,settings){return done=>{if(!entry.dirent.isSymbolicLink()){done(null,entry);return}settings.fs.stat(entry.path,(statError,stats)=>{if(statError!==null){if(settings.throwErrorOnBrokenSymbolicLink){done(statError);return}done(null,entry);return}entry.dirent=utils$9.fs.createDirentFromStats(entry.name,stats);done(null,entry);});}}function readdir$3(directory,settings,callback){settings.fs.readdir(directory,(readdirError,names)=>{if(readdirError!==null){callFailureCallback$1(callback,readdirError);return}const tasks=names.map(name=>{const path=common$6.joinPathSegments(directory,name,settings.pathSegmentSeparator);return done=>{fsStat$5.stat(path,settings.fsStatSettings,(error,stats)=>{if(error!==null){done(error);return}const entry={name,path,dirent:utils$9.fs.createDirentFromStats(name,stats)};if(settings.stats){entry.stats=stats;}done(null,entry);});}});rpl(tasks,(rplError,entries)=>{if(rplError!==null){callFailureCallback$1(callback,rplError);return}callSuccessCallback$1(callback,entries);});});}async$1.readdir=readdir$3;function callFailureCallback$1(callback,error){callback(error);}function callSuccessCallback$1(callback,result){callback(null,result);}

var sync$5 = {};

Object.defineProperty(sync$5,"__esModule",{value:true});sync$5.readdir=sync$5.readdirWithFileTypes=sync$5.read=void 0;const fsStat$4=out$3;const constants_1=constants$2;const utils$8=utils$a;const common$5=common$7;function read(directory,settings){if(!settings.stats&&constants_1.IS_SUPPORT_READDIR_WITH_FILE_TYPES){return readdirWithFileTypes(directory,settings)}return readdir$2(directory,settings)}sync$5.read=read;function readdirWithFileTypes(directory,settings){const dirents=settings.fs.readdirSync(directory,{withFileTypes:true});return dirents.map(dirent=>{const entry={dirent,name:dirent.name,path:common$5.joinPathSegments(directory,dirent.name,settings.pathSegmentSeparator)};if(entry.dirent.isSymbolicLink()&&settings.followSymbolicLinks){try{const stats=settings.fs.statSync(entry.path);entry.dirent=utils$8.fs.createDirentFromStats(entry.name,stats);}catch(error){if(settings.throwErrorOnBrokenSymbolicLink){throw error}}}return entry})}sync$5.readdirWithFileTypes=readdirWithFileTypes;function readdir$2(directory,settings){const names=settings.fs.readdirSync(directory);return names.map(name=>{const entryPath=common$5.joinPathSegments(directory,name,settings.pathSegmentSeparator);const stats=fsStat$4.statSync(entryPath,settings.fsStatSettings);const entry={name,path:entryPath,dirent:utils$8.fs.createDirentFromStats(name,stats)};if(settings.stats){entry.stats=stats;}return entry})}sync$5.readdir=readdir$2;

var settings$2 = {};

var fs$r = {};

(function(exports){Object.defineProperty(exports,"__esModule",{value:true});exports.createFileSystemAdapter=exports.FILE_SYSTEM_ADAPTER=void 0;const fs=require$$0__default$3["default"];exports.FILE_SYSTEM_ADAPTER={lstat:fs.lstat,stat:fs.stat,lstatSync:fs.lstatSync,statSync:fs.statSync,readdir:fs.readdir,readdirSync:fs.readdirSync};function createFileSystemAdapter(fsMethods){if(fsMethods===undefined){return exports.FILE_SYSTEM_ADAPTER}return Object.assign(Object.assign({},exports.FILE_SYSTEM_ADAPTER),fsMethods)}exports.createFileSystemAdapter=createFileSystemAdapter;})(fs$r);getDefaultExportFromCjs(fs$r);

Object.defineProperty(settings$2,"__esModule",{value:true});const path$k=require$$0__default$1["default"];const fsStat$3=out$3;const fs$q=fs$r;class Settings$1{constructor(_options={}){this._options=_options;this.followSymbolicLinks=this._getValue(this._options.followSymbolicLinks,false);this.fs=fs$q.createFileSystemAdapter(this._options.fs);this.pathSegmentSeparator=this._getValue(this._options.pathSegmentSeparator,path$k.sep);this.stats=this._getValue(this._options.stats,false);this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,true);this.fsStatSettings=new fsStat$3.Settings({followSymbolicLink:this.followSymbolicLinks,fs:this.fs,throwErrorOnBrokenSymbolicLink:this.throwErrorOnBrokenSymbolicLink});}_getValue(option,value){return option!==null&&option!==void 0?option:value}}settings$2.default=Settings$1;

Object.defineProperty(out$1,"__esModule",{value:true});out$1.Settings=out$1.scandirSync=out$1.scandir=void 0;const async=async$1;const sync$4=sync$5;const settings_1$2=settings$2;out$1.Settings=settings_1$2.default;function scandir(path,optionsOrSettingsOrCallback,callback){if(typeof optionsOrSettingsOrCallback==="function"){async.read(path,getSettings$1(),optionsOrSettingsOrCallback);return}async.read(path,getSettings$1(optionsOrSettingsOrCallback),callback);}out$1.scandir=scandir;function scandirSync(path,optionsOrSettings){const settings=getSettings$1(optionsOrSettings);return sync$4.read(path,settings)}out$1.scandirSync=scandirSync;function getSettings$1(settingsOrOptions={}){if(settingsOrOptions instanceof settings_1$2.default){return settingsOrOptions}return new settings_1$2.default(settingsOrOptions)}

var queue$1 = {exports: {}};

function reusify$1(Constructor){var head=new Constructor;var tail=head;function get(){var current=head;if(current.next){head=current.next;}else {head=new Constructor;tail=head;}current.next=null;return current}function release(obj){tail.next=obj;tail=obj;}return {get:get,release:release}}var reusify_1=reusify$1;

var reusify=reusify_1;function fastqueue(context,worker,concurrency){if(typeof context==="function"){concurrency=worker;worker=context;context=null;}if(concurrency<1){throw new Error("fastqueue concurrency must be greater than 1")}var cache=reusify(Task);var queueHead=null;var queueTail=null;var _running=0;var errorHandler=null;var self={push:push,drain:noop$1,saturated:noop$1,pause:pause,paused:false,concurrency:concurrency,running:running,resume:resume,idle:idle,length:length,getQueue:getQueue,unshift:unshift,empty:noop$1,kill:kill,killAndDrain:killAndDrain,error:error};return self;function running(){return _running}function pause(){self.paused=true;}function length(){var current=queueHead;var counter=0;while(current){current=current.next;counter++;}return counter}function getQueue(){var current=queueHead;var tasks=[];while(current){tasks.push(current.value);current=current.next;}return tasks}function resume(){if(!self.paused)return;self.paused=false;for(var i=0;i<self.concurrency;i++){_running++;release();}}function idle(){return _running===0&&self.length()===0}function push(value,done){var current=cache.get();current.context=context;current.release=release;current.value=value;current.callback=done||noop$1;current.errorHandler=errorHandler;if(_running===self.concurrency||self.paused){if(queueTail){queueTail.next=current;queueTail=current;}else {queueHead=current;queueTail=current;self.saturated();}}else {_running++;worker.call(context,current.value,current.worked);}}function unshift(value,done){var current=cache.get();current.context=context;current.release=release;current.value=value;current.callback=done||noop$1;if(_running===self.concurrency||self.paused){if(queueHead){current.next=queueHead;queueHead=current;}else {queueHead=current;queueTail=current;self.saturated();}}else {_running++;worker.call(context,current.value,current.worked);}}function release(holder){if(holder){cache.release(holder);}var next=queueHead;if(next){if(!self.paused){if(queueTail===queueHead){queueTail=null;}queueHead=next.next;next.next=null;worker.call(context,next.value,next.worked);if(queueTail===null){self.empty();}}else {_running--;}}else if(--_running===0){self.drain();}}function kill(){queueHead=null;queueTail=null;self.drain=noop$1;}function killAndDrain(){queueHead=null;queueTail=null;self.drain();self.drain=noop$1;}function error(handler){errorHandler=handler;}}function noop$1(){}function Task(){this.value=null;this.callback=noop$1;this.next=null;this.release=noop$1;this.context=null;this.errorHandler=null;var self=this;this.worked=function worked(err,result){var callback=self.callback;var errorHandler=self.errorHandler;var val=self.value;self.value=null;self.callback=noop$1;if(self.errorHandler){errorHandler(err,val);}callback.call(self.context,err,result);self.release(self);};}function queueAsPromised(context,worker,concurrency){if(typeof context==="function"){concurrency=worker;worker=context;context=null;}function asyncWrapper(arg,cb){worker.call(this,arg).then(function(res){cb(null,res);},cb);}var queue=fastqueue(context,asyncWrapper,concurrency);var pushCb=queue.push;var unshiftCb=queue.unshift;queue.push=push;queue.unshift=unshift;queue.drained=drained;return queue;function push(value){var p=new Promise(function(resolve,reject){pushCb(value,function(err,result){if(err){reject(err);return}resolve(result);});});p.catch(noop$1);return p}function unshift(value){var p=new Promise(function(resolve,reject){unshiftCb(value,function(err,result){if(err){reject(err);return}resolve(result);});});p.catch(noop$1);return p}function drained(){var previousDrain=queue.drain;var p=new Promise(function(resolve){queue.drain=function(){previousDrain();resolve();};});return p}}queue$1.exports=fastqueue;queue$1.exports.promise=queueAsPromised;

var common$4 = {};

Object.defineProperty(common$4,"__esModule",{value:true});common$4.joinPathSegments=common$4.replacePathSegmentSeparator=common$4.isAppliedFilter=common$4.isFatalError=void 0;function isFatalError(settings,error){if(settings.errorFilter===null){return true}return !settings.errorFilter(error)}common$4.isFatalError=isFatalError;function isAppliedFilter(filter,value){return filter===null||filter(value)}common$4.isAppliedFilter=isAppliedFilter;function replacePathSegmentSeparator(filepath,separator){return filepath.split(/[/\\]/).join(separator)}common$4.replacePathSegmentSeparator=replacePathSegmentSeparator;function joinPathSegments(a,b,separator){if(a===""){return b}if(a.endsWith(separator)){return a+b}return a+separator+b}common$4.joinPathSegments=joinPathSegments;

var reader$1 = {};

Object.defineProperty(reader$1,"__esModule",{value:true});const common$3=common$4;class Reader$1{constructor(_root,_settings){this._root=_root;this._settings=_settings;this._root=common$3.replacePathSegmentSeparator(_root,_settings.pathSegmentSeparator);}}reader$1.default=Reader$1;

Object.defineProperty(async$2,"__esModule",{value:true});const events_1$2=require$$0__default$4["default"];const fsScandir$2=out$1;const fastq=queue$1.exports;const common$2=common$4;const reader_1$3=reader$1;class AsyncReader extends reader_1$3.default{constructor(_root,_settings){super(_root,_settings);this._settings=_settings;this._scandir=fsScandir$2.scandir;this._emitter=new events_1$2.EventEmitter;this._queue=fastq(this._worker.bind(this),this._settings.concurrency);this._isFatalError=false;this._isDestroyed=false;this._queue.drain=()=>{if(!this._isFatalError){this._emitter.emit("end");}};}read(){this._isFatalError=false;this._isDestroyed=false;setImmediate(()=>{this._pushToQueue(this._root,this._settings.basePath);});return this._emitter}get isDestroyed(){return this._isDestroyed}destroy(){if(this._isDestroyed){throw new Error("The reader is already destroyed")}this._isDestroyed=true;this._queue.killAndDrain();}onEntry(callback){this._emitter.on("entry",callback);}onError(callback){this._emitter.once("error",callback);}onEnd(callback){this._emitter.once("end",callback);}_pushToQueue(directory,base){const queueItem={directory,base};this._queue.push(queueItem,error=>{if(error!==null){this._handleError(error);}});}_worker(item,done){this._scandir(item.directory,this._settings.fsScandirSettings,(error,entries)=>{if(error!==null){done(error,undefined);return}for(const entry of entries){this._handleEntry(entry,item.base);}done(null,undefined);});}_handleError(error){if(this._isDestroyed||!common$2.isFatalError(this._settings,error)){return}this._isFatalError=true;this._isDestroyed=true;this._emitter.emit("error",error);}_handleEntry(entry,base){if(this._isDestroyed||this._isFatalError){return}const fullpath=entry.path;if(base!==undefined){entry.path=common$2.joinPathSegments(base,entry.name,this._settings.pathSegmentSeparator);}if(common$2.isAppliedFilter(this._settings.entryFilter,entry)){this._emitEntry(entry);}if(entry.dirent.isDirectory()&&common$2.isAppliedFilter(this._settings.deepFilter,entry)){this._pushToQueue(fullpath,base===undefined?undefined:entry.path);}}_emitEntry(entry){this._emitter.emit("entry",entry);}}async$2.default=AsyncReader;

Object.defineProperty(async$3,"__esModule",{value:true});const async_1$3=async$2;class AsyncProvider{constructor(_root,_settings){this._root=_root;this._settings=_settings;this._reader=new async_1$3.default(this._root,this._settings);this._storage=[];}read(callback){this._reader.onError(error=>{callFailureCallback(callback,error);});this._reader.onEntry(entry=>{this._storage.push(entry);});this._reader.onEnd(()=>{callSuccessCallback(callback,this._storage);});this._reader.read();}}async$3.default=AsyncProvider;function callFailureCallback(callback,error){callback(error);}function callSuccessCallback(callback,entries){callback(null,entries);}

var stream$1 = {};

Object.defineProperty(stream$1,"__esModule",{value:true});const stream_1$5=require$$0__default["default"];const async_1$2=async$2;class StreamProvider{constructor(_root,_settings){this._root=_root;this._settings=_settings;this._reader=new async_1$2.default(this._root,this._settings);this._stream=new stream_1$5.Readable({objectMode:true,read:()=>{},destroy:()=>{if(!this._reader.isDestroyed){this._reader.destroy();}}});}read(){this._reader.onError(error=>{this._stream.emit("error",error);});this._reader.onEntry(entry=>{this._stream.push(entry);});this._reader.onEnd(()=>{this._stream.push(null);});this._reader.read();return this._stream}}stream$1.default=StreamProvider;

var sync$3 = {};

var sync$2 = {};

Object.defineProperty(sync$2,"__esModule",{value:true});const fsScandir$1=out$1;const common$1=common$4;const reader_1$2=reader$1;class SyncReader extends reader_1$2.default{constructor(){super(...arguments);this._scandir=fsScandir$1.scandirSync;this._storage=[];this._queue=new Set;}read(){this._pushToQueue(this._root,this._settings.basePath);this._handleQueue();return this._storage}_pushToQueue(directory,base){this._queue.add({directory,base});}_handleQueue(){for(const item of this._queue.values()){this._handleDirectory(item.directory,item.base);}}_handleDirectory(directory,base){try{const entries=this._scandir(directory,this._settings.fsScandirSettings);for(const entry of entries){this._handleEntry(entry,base);}}catch(error){this._handleError(error);}}_handleError(error){if(!common$1.isFatalError(this._settings,error)){return}throw error}_handleEntry(entry,base){const fullpath=entry.path;if(base!==undefined){entry.path=common$1.joinPathSegments(base,entry.name,this._settings.pathSegmentSeparator);}if(common$1.isAppliedFilter(this._settings.entryFilter,entry)){this._pushToStorage(entry);}if(entry.dirent.isDirectory()&&common$1.isAppliedFilter(this._settings.deepFilter,entry)){this._pushToQueue(fullpath,base===undefined?undefined:entry.path);}}_pushToStorage(entry){this._storage.push(entry);}}sync$2.default=SyncReader;

Object.defineProperty(sync$3,"__esModule",{value:true});const sync_1$3=sync$2;class SyncProvider{constructor(_root,_settings){this._root=_root;this._settings=_settings;this._reader=new sync_1$3.default(this._root,this._settings);}read(){return this._reader.read()}}sync$3.default=SyncProvider;

var settings$1 = {};

Object.defineProperty(settings$1,"__esModule",{value:true});const path$j=require$$0__default$1["default"];const fsScandir=out$1;class Settings{constructor(_options={}){this._options=_options;this.basePath=this._getValue(this._options.basePath,undefined);this.concurrency=this._getValue(this._options.concurrency,Number.POSITIVE_INFINITY);this.deepFilter=this._getValue(this._options.deepFilter,null);this.entryFilter=this._getValue(this._options.entryFilter,null);this.errorFilter=this._getValue(this._options.errorFilter,null);this.pathSegmentSeparator=this._getValue(this._options.pathSegmentSeparator,path$j.sep);this.fsScandirSettings=new fsScandir.Settings({followSymbolicLinks:this._options.followSymbolicLinks,fs:this._options.fs,pathSegmentSeparator:this._options.pathSegmentSeparator,stats:this._options.stats,throwErrorOnBrokenSymbolicLink:this._options.throwErrorOnBrokenSymbolicLink});}_getValue(option,value){return option!==null&&option!==void 0?option:value}}settings$1.default=Settings;

Object.defineProperty(out$2,"__esModule",{value:true});out$2.Settings=out$2.walkStream=out$2.walkSync=out$2.walk=void 0;const async_1$1=async$3;const stream_1$4=stream$1;const sync_1$2=sync$3;const settings_1$1=settings$1;out$2.Settings=settings_1$1.default;function walk(directory,optionsOrSettingsOrCallback,callback){if(typeof optionsOrSettingsOrCallback==="function"){new async_1$1.default(directory,getSettings()).read(optionsOrSettingsOrCallback);return}new async_1$1.default(directory,getSettings(optionsOrSettingsOrCallback)).read(callback);}out$2.walk=walk;function walkSync(directory,optionsOrSettings){const settings=getSettings(optionsOrSettings);const provider=new sync_1$2.default(directory,settings);return provider.read()}out$2.walkSync=walkSync;function walkStream(directory,optionsOrSettings){const settings=getSettings(optionsOrSettings);const provider=new stream_1$4.default(directory,settings);return provider.read()}out$2.walkStream=walkStream;function getSettings(settingsOrOptions={}){if(settingsOrOptions instanceof settings_1$1.default){return settingsOrOptions}return new settings_1$1.default(settingsOrOptions)}

var reader = {};

Object.defineProperty(reader,"__esModule",{value:true});const path$i=require$$0__default$1["default"];const fsStat$2=out$3;const utils$7=utils$l;class Reader{constructor(_settings){this._settings=_settings;this._fsStatSettings=new fsStat$2.Settings({followSymbolicLink:this._settings.followSymbolicLinks,fs:this._settings.fs,throwErrorOnBrokenSymbolicLink:this._settings.followSymbolicLinks});}_getFullEntryPath(filepath){return path$i.resolve(this._settings.cwd,filepath)}_makeEntry(stats,pattern){const entry={name:pattern,path:pattern,dirent:utils$7.fs.createDirentFromStats(pattern,stats)};if(this._settings.stats){entry.stats=stats;}return entry}_isFatalError(error){return !utils$7.errno.isEnoentCodeError(error)&&!this._settings.suppressErrors}}reader.default=Reader;

Object.defineProperty(stream$2,"__esModule",{value:true});const stream_1$3=require$$0__default["default"];const fsStat$1=out$3;const fsWalk$1=out$2;const reader_1$1=reader;class ReaderStream extends reader_1$1.default{constructor(){super(...arguments);this._walkStream=fsWalk$1.walkStream;this._stat=fsStat$1.stat;}dynamic(root,options){return this._walkStream(root,options)}static(patterns,options){const filepaths=patterns.map(this._getFullEntryPath,this);const stream=new stream_1$3.PassThrough({objectMode:true});stream._write=(index,_enc,done)=>{return this._getEntry(filepaths[index],patterns[index],options).then(entry=>{if(entry!==null&&options.entryFilter(entry)){stream.push(entry);}if(index===filepaths.length-1){stream.end();}done();}).catch(done)};for(let i=0;i<filepaths.length;i++){stream.write(i);}return stream}_getEntry(filepath,pattern,options){return this._getStat(filepath).then(stats=>this._makeEntry(stats,pattern)).catch(error=>{if(options.errorFilter(error)){return null}throw error})}_getStat(filepath){return new Promise((resolve,reject)=>{this._stat(filepath,this._fsStatSettings,(error,stats)=>{return error===null?resolve(stats):reject(error)});})}}stream$2.default=ReaderStream;

var provider = {};

var deep = {};

var partial = {};

var matcher = {};

Object.defineProperty(matcher,"__esModule",{value:true});const utils$6=utils$l;class Matcher{constructor(_patterns,_settings,_micromatchOptions){this._patterns=_patterns;this._settings=_settings;this._micromatchOptions=_micromatchOptions;this._storage=[];this._fillStorage();}_fillStorage(){const patterns=utils$6.pattern.expandPatternsWithBraceExpansion(this._patterns);for(const pattern of patterns){const segments=this._getPatternSegments(pattern);const sections=this._splitSegmentsIntoSections(segments);this._storage.push({complete:sections.length<=1,pattern,segments,sections});}}_getPatternSegments(pattern){const parts=utils$6.pattern.getPatternParts(pattern,this._micromatchOptions);return parts.map(part=>{const dynamic=utils$6.pattern.isDynamicPattern(part,this._settings);if(!dynamic){return {dynamic:false,pattern:part}}return {dynamic:true,pattern:part,patternRe:utils$6.pattern.makeRe(part,this._micromatchOptions)}})}_splitSegmentsIntoSections(segments){return utils$6.array.splitWhen(segments,segment=>segment.dynamic&&utils$6.pattern.hasGlobStar(segment.pattern))}}matcher.default=Matcher;

Object.defineProperty(partial,"__esModule",{value:true});const matcher_1=matcher;class PartialMatcher extends matcher_1.default{match(filepath){const parts=filepath.split("/");const levels=parts.length;const patterns=this._storage.filter(info=>!info.complete||info.segments.length>levels);for(const pattern of patterns){const section=pattern.sections[0];if(!pattern.complete&&levels>section.length){return true}const match=parts.every((part,index)=>{const segment=pattern.segments[index];if(segment.dynamic&&segment.patternRe.test(part)){return true}if(!segment.dynamic&&segment.pattern===part){return true}return false});if(match){return true}}return false}}partial.default=PartialMatcher;

Object.defineProperty(deep,"__esModule",{value:true});const utils$5=utils$l;const partial_1=partial;class DeepFilter{constructor(_settings,_micromatchOptions){this._settings=_settings;this._micromatchOptions=_micromatchOptions;}getFilter(basePath,positive,negative){const matcher=this._getMatcher(positive);const negativeRe=this._getNegativePatternsRe(negative);return entry=>this._filter(basePath,entry,matcher,negativeRe)}_getMatcher(patterns){return new partial_1.default(patterns,this._settings,this._micromatchOptions)}_getNegativePatternsRe(patterns){const affectDepthOfReadingPatterns=patterns.filter(utils$5.pattern.isAffectDepthOfReadingPattern);return utils$5.pattern.convertPatternsToRe(affectDepthOfReadingPatterns,this._micromatchOptions)}_filter(basePath,entry,matcher,negativeRe){if(this._isSkippedByDeep(basePath,entry.path)){return false}if(this._isSkippedSymbolicLink(entry)){return false}const filepath=utils$5.path.removeLeadingDotSegment(entry.path);if(this._isSkippedByPositivePatterns(filepath,matcher)){return false}return this._isSkippedByNegativePatterns(filepath,negativeRe)}_isSkippedByDeep(basePath,entryPath){if(this._settings.deep===Infinity){return false}return this._getEntryLevel(basePath,entryPath)>=this._settings.deep}_getEntryLevel(basePath,entryPath){const entryPathDepth=entryPath.split("/").length;if(basePath===""){return entryPathDepth}const basePathDepth=basePath.split("/").length;return entryPathDepth-basePathDepth}_isSkippedSymbolicLink(entry){return !this._settings.followSymbolicLinks&&entry.dirent.isSymbolicLink()}_isSkippedByPositivePatterns(entryPath,matcher){return !this._settings.baseNameMatch&&!matcher.match(entryPath)}_isSkippedByNegativePatterns(entryPath,patternsRe){return !utils$5.pattern.matchAny(entryPath,patternsRe)}}deep.default=DeepFilter;

var entry$1 = {};

Object.defineProperty(entry$1,"__esModule",{value:true});const utils$4=utils$l;class EntryFilter{constructor(_settings,_micromatchOptions){this._settings=_settings;this._micromatchOptions=_micromatchOptions;this.index=new Map;}getFilter(positive,negative){const positiveRe=utils$4.pattern.convertPatternsToRe(positive,this._micromatchOptions);const negativeRe=utils$4.pattern.convertPatternsToRe(negative,this._micromatchOptions);return entry=>this._filter(entry,positiveRe,negativeRe)}_filter(entry,positiveRe,negativeRe){if(this._settings.unique&&this._isDuplicateEntry(entry)){return false}if(this._onlyFileFilter(entry)||this._onlyDirectoryFilter(entry)){return false}if(this._isSkippedByAbsoluteNegativePatterns(entry.path,negativeRe)){return false}const filepath=this._settings.baseNameMatch?entry.name:entry.path;const isMatched=this._isMatchToPatterns(filepath,positiveRe)&&!this._isMatchToPatterns(entry.path,negativeRe);if(this._settings.unique&&isMatched){this._createIndexRecord(entry);}return isMatched}_isDuplicateEntry(entry){return this.index.has(entry.path)}_createIndexRecord(entry){this.index.set(entry.path,undefined);}_onlyFileFilter(entry){return this._settings.onlyFiles&&!entry.dirent.isFile()}_onlyDirectoryFilter(entry){return this._settings.onlyDirectories&&!entry.dirent.isDirectory()}_isSkippedByAbsoluteNegativePatterns(entryPath,patternsRe){if(!this._settings.absolute){return false}const fullpath=utils$4.path.makeAbsolute(this._settings.cwd,entryPath);return utils$4.pattern.matchAny(fullpath,patternsRe)}_isMatchToPatterns(entryPath,patternsRe){const filepath=utils$4.path.removeLeadingDotSegment(entryPath);return utils$4.pattern.matchAny(filepath,patternsRe)}}entry$1.default=EntryFilter;

var error = {};

Object.defineProperty(error,"__esModule",{value:true});const utils$3=utils$l;class ErrorFilter{constructor(_settings){this._settings=_settings;}getFilter(){return error=>this._isNonFatalError(error)}_isNonFatalError(error){return utils$3.errno.isEnoentCodeError(error)||this._settings.suppressErrors}}error.default=ErrorFilter;

var entry = {};

Object.defineProperty(entry,"__esModule",{value:true});const utils$2=utils$l;class EntryTransformer{constructor(_settings){this._settings=_settings;}getTransformer(){return entry=>this._transform(entry)}_transform(entry){let filepath=entry.path;if(this._settings.absolute){filepath=utils$2.path.makeAbsolute(this._settings.cwd,filepath);filepath=utils$2.path.unixify(filepath);}if(this._settings.markDirectories&&entry.dirent.isDirectory()){filepath+="/";}if(!this._settings.objectMode){return filepath}return Object.assign(Object.assign({},entry),{path:filepath})}}entry.default=EntryTransformer;

Object.defineProperty(provider,"__esModule",{value:true});const path$h=require$$0__default$1["default"];const deep_1=deep;const entry_1=entry$1;const error_1=error;const entry_2=entry;class Provider{constructor(_settings){this._settings=_settings;this.errorFilter=new error_1.default(this._settings);this.entryFilter=new entry_1.default(this._settings,this._getMicromatchOptions());this.deepFilter=new deep_1.default(this._settings,this._getMicromatchOptions());this.entryTransformer=new entry_2.default(this._settings);}_getRootDirectory(task){return path$h.resolve(this._settings.cwd,task.base)}_getReaderOptions(task){const basePath=task.base==="."?"":task.base;return {basePath,pathSegmentSeparator:"/",concurrency:this._settings.concurrency,deepFilter:this.deepFilter.getFilter(basePath,task.positive,task.negative),entryFilter:this.entryFilter.getFilter(task.positive,task.negative),errorFilter:this.errorFilter.getFilter(),followSymbolicLinks:this._settings.followSymbolicLinks,fs:this._settings.fs,stats:this._settings.stats,throwErrorOnBrokenSymbolicLink:this._settings.throwErrorOnBrokenSymbolicLink,transform:this.entryTransformer.getTransformer()}}_getMicromatchOptions(){return {dot:this._settings.dot,matchBase:this._settings.baseNameMatch,nobrace:!this._settings.braceExpansion,nocase:!this._settings.caseSensitiveMatch,noext:!this._settings.extglob,noglobstar:!this._settings.globstar,posix:true,strictSlashes:false}}}provider.default=Provider;

Object.defineProperty(async$6,"__esModule",{value:true});const stream_1$2=stream$2;const provider_1$2=provider;class ProviderAsync extends provider_1$2.default{constructor(){super(...arguments);this._reader=new stream_1$2.default(this._settings);}read(task){const root=this._getRootDirectory(task);const options=this._getReaderOptions(task);const entries=[];return new Promise((resolve,reject)=>{const stream=this.api(root,task,options);stream.once("error",reject);stream.on("data",entry=>entries.push(options.transform(entry)));stream.once("end",()=>resolve(entries));})}api(root,task,options){if(task.dynamic){return this._reader.dynamic(root,options)}return this._reader.static(task.patterns,options)}}async$6.default=ProviderAsync;

var stream = {};

Object.defineProperty(stream,"__esModule",{value:true});const stream_1$1=require$$0__default["default"];const stream_2=stream$2;const provider_1$1=provider;class ProviderStream extends provider_1$1.default{constructor(){super(...arguments);this._reader=new stream_2.default(this._settings);}read(task){const root=this._getRootDirectory(task);const options=this._getReaderOptions(task);const source=this.api(root,task,options);const destination=new stream_1$1.Readable({objectMode:true,read:()=>{}});source.once("error",error=>destination.emit("error",error)).on("data",entry=>destination.emit("data",options.transform(entry))).once("end",()=>destination.emit("end"));destination.once("close",()=>source.destroy());return destination}api(root,task,options){if(task.dynamic){return this._reader.dynamic(root,options)}return this._reader.static(task.patterns,options)}}stream.default=ProviderStream;

var sync$1 = {};

var sync = {};

Object.defineProperty(sync,"__esModule",{value:true});const fsStat=out$3;const fsWalk=out$2;const reader_1=reader;class ReaderSync extends reader_1.default{constructor(){super(...arguments);this._walkSync=fsWalk.walkSync;this._statSync=fsStat.statSync;}dynamic(root,options){return this._walkSync(root,options)}static(patterns,options){const entries=[];for(const pattern of patterns){const filepath=this._getFullEntryPath(pattern);const entry=this._getEntry(filepath,pattern,options);if(entry===null||!options.entryFilter(entry)){continue}entries.push(entry);}return entries}_getEntry(filepath,pattern,options){try{const stats=this._getStat(filepath);return this._makeEntry(stats,pattern)}catch(error){if(options.errorFilter(error)){return null}throw error}}_getStat(filepath){return this._statSync(filepath,this._fsStatSettings)}}sync.default=ReaderSync;

Object.defineProperty(sync$1,"__esModule",{value:true});const sync_1$1=sync;const provider_1=provider;class ProviderSync extends provider_1.default{constructor(){super(...arguments);this._reader=new sync_1$1.default(this._settings);}read(task){const root=this._getRootDirectory(task);const options=this._getReaderOptions(task);const entries=this.api(root,task,options);return entries.map(options.transform)}api(root,task,options){if(task.dynamic){return this._reader.dynamic(root,options)}return this._reader.static(task.patterns,options)}}sync$1.default=ProviderSync;

var settings = {};

(function(exports){Object.defineProperty(exports,"__esModule",{value:true});exports.DEFAULT_FILE_SYSTEM_ADAPTER=void 0;const fs=require$$0__default$3["default"];const os=require$$1__default$1["default"];const CPU_COUNT=Math.max(os.cpus().length,1);exports.DEFAULT_FILE_SYSTEM_ADAPTER={lstat:fs.lstat,lstatSync:fs.lstatSync,stat:fs.stat,statSync:fs.statSync,readdir:fs.readdir,readdirSync:fs.readdirSync};class Settings{constructor(_options={}){this._options=_options;this.absolute=this._getValue(this._options.absolute,false);this.baseNameMatch=this._getValue(this._options.baseNameMatch,false);this.braceExpansion=this._getValue(this._options.braceExpansion,true);this.caseSensitiveMatch=this._getValue(this._options.caseSensitiveMatch,true);this.concurrency=this._getValue(this._options.concurrency,CPU_COUNT);this.cwd=this._getValue(this._options.cwd,process.cwd());this.deep=this._getValue(this._options.deep,Infinity);this.dot=this._getValue(this._options.dot,false);this.extglob=this._getValue(this._options.extglob,true);this.followSymbolicLinks=this._getValue(this._options.followSymbolicLinks,true);this.fs=this._getFileSystemMethods(this._options.fs);this.globstar=this._getValue(this._options.globstar,true);this.ignore=this._getValue(this._options.ignore,[]);this.markDirectories=this._getValue(this._options.markDirectories,false);this.objectMode=this._getValue(this._options.objectMode,false);this.onlyDirectories=this._getValue(this._options.onlyDirectories,false);this.onlyFiles=this._getValue(this._options.onlyFiles,true);this.stats=this._getValue(this._options.stats,false);this.suppressErrors=this._getValue(this._options.suppressErrors,false);this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,false);this.unique=this._getValue(this._options.unique,true);if(this.onlyDirectories){this.onlyFiles=false;}if(this.stats){this.objectMode=true;}}_getValue(option,value){return option===undefined?value:option}_getFileSystemMethods(methods={}){return Object.assign(Object.assign({},exports.DEFAULT_FILE_SYSTEM_ADAPTER),methods)}}exports.default=Settings;})(settings);getDefaultExportFromCjs(settings);

const taskManager=tasks;const async_1=async$6;const stream_1=stream;const sync_1=sync$1;const settings_1=settings;const utils$1=utils$l;async function FastGlob(source,options){assertPatternsInput$1(source);const works=getWorks(source,async_1.default,options);const result=await Promise.all(works);return utils$1.array.flatten(result)}(function(FastGlob){function sync(source,options){assertPatternsInput$1(source);const works=getWorks(source,sync_1.default,options);return utils$1.array.flatten(works)}FastGlob.sync=sync;function stream(source,options){assertPatternsInput$1(source);const works=getWorks(source,stream_1.default,options);return utils$1.stream.merge(works)}FastGlob.stream=stream;function generateTasks(source,options){assertPatternsInput$1(source);const patterns=[].concat(source);const settings=new settings_1.default(options);return taskManager.generate(patterns,settings)}FastGlob.generateTasks=generateTasks;function isDynamicPattern(source,options){assertPatternsInput$1(source);const settings=new settings_1.default(options);return utils$1.pattern.isDynamicPattern(source,settings)}FastGlob.isDynamicPattern=isDynamicPattern;function escapePath(source){assertPatternsInput$1(source);return utils$1.path.escape(source)}FastGlob.escapePath=escapePath;})(FastGlob||(FastGlob={}));function getWorks(source,_Provider,options){const patterns=[].concat(source);const settings=new settings_1.default(options);const tasks=taskManager.generate(patterns,settings);const provider=new _Provider(settings);return tasks.map(provider.read,provider)}function assertPatternsInput$1(input){const source=[].concat(input);const isValidSource=source.every(item=>utils$1.string.isString(item)&&!utils$1.string.isEmpty(item));if(!isValidSource){throw new TypeError("Patterns must be a string (non empty) or an array of strings")}}var out=FastGlob;

var dirGlob$1 = {exports: {}};

var pathType$1 = {};

const{promisify: promisify$5}=require$$0__default$2["default"];const fs$p=require$$0__default$3["default"];async function isType(fsStatType,statsMethodName,filePath){if(typeof filePath!=="string"){throw new TypeError(`Expected a string, got ${typeof filePath}`)}try{const stats=await promisify$5(fs$p[fsStatType])(filePath);return stats[statsMethodName]()}catch(error){if(error.code==="ENOENT"){return false}throw error}}function isTypeSync(fsStatType,statsMethodName,filePath){if(typeof filePath!=="string"){throw new TypeError(`Expected a string, got ${typeof filePath}`)}try{return fs$p[fsStatType](filePath)[statsMethodName]()}catch(error){if(error.code==="ENOENT"){return false}throw error}}pathType$1.isFile=isType.bind(null,"stat","isFile");pathType$1.isDirectory=isType.bind(null,"stat","isDirectory");pathType$1.isSymlink=isType.bind(null,"lstat","isSymbolicLink");pathType$1.isFileSync=isTypeSync.bind(null,"statSync","isFile");pathType$1.isDirectorySync=isTypeSync.bind(null,"statSync","isDirectory");pathType$1.isSymlinkSync=isTypeSync.bind(null,"lstatSync","isSymbolicLink");

const path$g=require$$0__default$1["default"];const pathType=pathType$1;const getExtensions=extensions=>extensions.length>1?`{${extensions.join(",")}}`:extensions[0];const getPath=(filepath,cwd)=>{const pth=filepath[0]==="!"?filepath.slice(1):filepath;return path$g.isAbsolute(pth)?pth:path$g.join(cwd,pth)};const addExtensions=(file,extensions)=>{if(path$g.extname(file)){return `**/${file}`}return `**/${file}.${getExtensions(extensions)}`};const getGlob=(directory,options)=>{if(options.files&&!Array.isArray(options.files)){throw new TypeError(`Expected \`files\` to be of type \`Array\` but received type \`${typeof options.files}\``)}if(options.extensions&&!Array.isArray(options.extensions)){throw new TypeError(`Expected \`extensions\` to be of type \`Array\` but received type \`${typeof options.extensions}\``)}if(options.files&&options.extensions){return options.files.map(x=>path$g.posix.join(directory,addExtensions(x,options.extensions)))}if(options.files){return options.files.map(x=>path$g.posix.join(directory,`**/${x}`))}if(options.extensions){return [path$g.posix.join(directory,`**/*.${getExtensions(options.extensions)}`)]}return [path$g.posix.join(directory,"**")]};dirGlob$1.exports=async(input,options)=>{options={cwd:process.cwd(),...options};if(typeof options.cwd!=="string"){throw new TypeError(`Expected \`cwd\` to be of type \`string\` but received type \`${typeof options.cwd}\``)}const globs=await Promise.all([].concat(input).map(async x=>{const isDirectory=await pathType.isDirectory(getPath(x,options.cwd));return isDirectory?getGlob(x,options):x}));return [].concat.apply([],globs)};dirGlob$1.exports.sync=(input,options)=>{options={cwd:process.cwd(),...options};if(typeof options.cwd!=="string"){throw new TypeError(`Expected \`cwd\` to be of type \`string\` but received type \`${typeof options.cwd}\``)}const globs=[].concat(input).map(x=>pathType.isDirectorySync(getPath(x,options.cwd))?getGlob(x,options):x);return [].concat.apply([],globs)};

var gitignore$1 = {exports: {}};

function makeArray(subject){return Array.isArray(subject)?subject:[subject]}const EMPTY="";const SPACE=" ";const ESCAPE="\\";const REGEX_TEST_BLANK_LINE=/^\s+$/;const REGEX_REPLACE_LEADING_EXCAPED_EXCLAMATION=/^\\!/;const REGEX_REPLACE_LEADING_EXCAPED_HASH=/^\\#/;const REGEX_SPLITALL_CRLF=/\r?\n/g;const REGEX_TEST_INVALID_PATH=/^\.*\/|^\.+$/;const SLASH$1="/";const KEY_IGNORE=typeof Symbol!=="undefined"?Symbol.for("node-ignore"):"node-ignore";const define=(object,key,value)=>Object.defineProperty(object,key,{value});const REGEX_REGEXP_RANGE=/([0-z])-([0-z])/g;const sanitizeRange=range=>range.replace(REGEX_REGEXP_RANGE,(match,from,to)=>from.charCodeAt(0)<=to.charCodeAt(0)?match:EMPTY);const cleanRangeBackSlash=slashes=>{const{length}=slashes;return slashes.slice(0,length-length%2)};const REPLACERS=[[/\\?\s+$/,match=>match.indexOf("\\")===0?SPACE:EMPTY],[/\\\s/g,()=>SPACE],[/[\\$.|*+(){^]/g,match=>`\\${match}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function startingReplacer(){return !/\/(?!$)/.test(this)?"(?:^|\\/)":"^"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(_,index,str)=>index+6<str.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)\\\*(?=.+)/g,(_,p1)=>`${p1}[^\\/]*`],[/\\\\\\(?=[$.|*+(){^])/g,()=>ESCAPE],[/\\\\/g,()=>ESCAPE],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(match,leadEscape,range,endEscape,close)=>leadEscape===ESCAPE?`\\[${range}${cleanRangeBackSlash(endEscape)}${close}`:close==="]"?endEscape.length%2===0?`[${sanitizeRange(range)}${endEscape}]`:"[]":"[]"],[/(?:[^*])$/,match=>/\/$/.test(match)?`${match}$`:`${match}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(_,p1)=>{const prefix=p1?`${p1}[^/]+`:"[^/]*";return `${prefix}(?=$|\\/$)`}]];const regexCache=Object.create(null);const makeRegex=(pattern,negative,ignorecase)=>{const r=regexCache[pattern];if(r){return r}const source=REPLACERS.reduce((prev,current)=>prev.replace(current[0],current[1].bind(pattern)),pattern);return regexCache[pattern]=ignorecase?new RegExp(source,"i"):new RegExp(source)};const isString=subject=>typeof subject==="string";const checkPattern=pattern=>pattern&&isString(pattern)&&!REGEX_TEST_BLANK_LINE.test(pattern)&&pattern.indexOf("#")!==0;const splitPattern=pattern=>pattern.split(REGEX_SPLITALL_CRLF);class IgnoreRule{constructor(origin,pattern,negative,regex){this.origin=origin;this.pattern=pattern;this.negative=negative;this.regex=regex;}}const createRule=(pattern,ignorecase)=>{const origin=pattern;let negative=false;if(pattern.indexOf("!")===0){negative=true;pattern=pattern.substr(1);}pattern=pattern.replace(REGEX_REPLACE_LEADING_EXCAPED_EXCLAMATION,"!").replace(REGEX_REPLACE_LEADING_EXCAPED_HASH,"#");const regex=makeRegex(pattern,negative,ignorecase);return new IgnoreRule(origin,pattern,negative,regex)};const throwError=(message,Ctor)=>{throw new Ctor(message)};const checkPath$1=(path,originalPath,doThrow)=>{if(!isString(path)){return doThrow(`path must be a string, but got \`${originalPath}\``,TypeError)}if(!path){return doThrow(`path must not be empty`,TypeError)}if(checkPath$1.isNotRelative(path)){const r="`path.relative()`d";return doThrow(`path should be a ${r} string, but got "${originalPath}"`,RangeError)}return true};const isNotRelative=path=>REGEX_TEST_INVALID_PATH.test(path);checkPath$1.isNotRelative=isNotRelative;checkPath$1.convert=p=>p;class Ignore{constructor({ignorecase=true}={}){this._rules=[];this._ignorecase=ignorecase;define(this,KEY_IGNORE,true);this._initCache();}_initCache(){this._ignoreCache=Object.create(null);this._testCache=Object.create(null);}_addPattern(pattern){if(pattern&&pattern[KEY_IGNORE]){this._rules=this._rules.concat(pattern._rules);this._added=true;return}if(checkPattern(pattern)){const rule=createRule(pattern,this._ignorecase);this._added=true;this._rules.push(rule);}}add(pattern){this._added=false;makeArray(isString(pattern)?splitPattern(pattern):pattern).forEach(this._addPattern,this);if(this._added){this._initCache();}return this}addPattern(pattern){return this.add(pattern)}_testOne(path,checkUnignored){let ignored=false;let unignored=false;this._rules.forEach(rule=>{const{negative}=rule;if(unignored===negative&&ignored!==unignored||negative&&!ignored&&!unignored&&!checkUnignored){return}const matched=rule.regex.test(path);if(matched){ignored=!negative;unignored=negative;}});return {ignored,unignored}}_test(originalPath,cache,checkUnignored,slices){const path=originalPath&&checkPath$1.convert(originalPath);checkPath$1(path,originalPath,throwError);return this._t(path,cache,checkUnignored,slices)}_t(path,cache,checkUnignored,slices){if(path in cache){return cache[path]}if(!slices){slices=path.split(SLASH$1);}slices.pop();if(!slices.length){return cache[path]=this._testOne(path,checkUnignored)}const parent=this._t(slices.join(SLASH$1)+SLASH$1,cache,checkUnignored,slices);return cache[path]=parent.ignored?parent:this._testOne(path,checkUnignored)}ignores(path){return this._test(path,this._ignoreCache,false).ignored}createFilter(){return path=>!this.ignores(path)}filter(paths){return makeArray(paths).filter(this.createFilter())}test(path){return this._test(path,this._testCache,true)}}const factory=options=>new Ignore(options);const returnFalse=()=>false;const isPathValid=path=>checkPath$1(path&&checkPath$1.convert(path),path,returnFalse);factory.isPathValid=isPathValid;factory.default=factory;var ignore=factory;if(typeof process!=="undefined"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){const makePosix=str=>/^\\\\\?\\/.test(str)||/["<>|\u0000-\u001F]+/u.test(str)?str:str.replace(/\\/g,"/");checkPath$1.convert=makePosix;const REGIX_IS_WINDOWS_PATH_ABSOLUTE=/^[a-z]:\//i;checkPath$1.isNotRelative=path=>REGIX_IS_WINDOWS_PATH_ABSOLUTE.test(path)||isNotRelative(path);}

var slash$1=path=>{const isExtendedLengthPath=/^\\\\\?\\/.test(path);const hasNonAscii=/[^\u0000-\u0080]+/.test(path);if(isExtendedLengthPath||hasNonAscii){return path}return path.replace(/\\/g,"/")};

const{promisify: promisify$4}=require$$0__default$2["default"];const fs$o=require$$0__default$3["default"];const path$f=require$$0__default$1["default"];const fastGlob$1=out;const gitIgnore=ignore;const slash=slash$1;const DEFAULT_IGNORE=["**/node_modules/**","**/flow-typed/**","**/coverage/**","**/.git"];const readFileP=promisify$4(fs$o.readFile);const mapGitIgnorePatternTo=base=>ignore=>{if(ignore.startsWith("!")){return "!"+path$f.posix.join(base,ignore.slice(1))}return path$f.posix.join(base,ignore)};const parseGitIgnore=(content,options)=>{const base=slash(path$f.relative(options.cwd,path$f.dirname(options.fileName)));return content.split(/\r?\n/).filter(Boolean).filter(line=>!line.startsWith("#")).map(mapGitIgnorePatternTo(base))};const reduceIgnore=files=>{const ignores=gitIgnore();for(const file of files){ignores.add(parseGitIgnore(file.content,{cwd:file.cwd,fileName:file.filePath}));}return ignores};const ensureAbsolutePathForCwd=(cwd,p)=>{cwd=slash(cwd);if(path$f.isAbsolute(p)){if(slash(p).startsWith(cwd)){return p}throw new Error(`Path ${p} is not in cwd ${cwd}`)}return path$f.join(cwd,p)};const getIsIgnoredPredecate=(ignores,cwd)=>{return p=>ignores.ignores(slash(path$f.relative(cwd,ensureAbsolutePathForCwd(cwd,p.path||p))))};const getFile=async(file,cwd)=>{const filePath=path$f.join(cwd,file);const content=await readFileP(filePath,"utf8");return {cwd,filePath,content}};const getFileSync=(file,cwd)=>{const filePath=path$f.join(cwd,file);const content=fs$o.readFileSync(filePath,"utf8");return {cwd,filePath,content}};const normalizeOptions=({ignore=[],cwd=slash(process.cwd())}={})=>{return {ignore,cwd}};gitignore$1.exports=async options=>{options=normalizeOptions(options);const paths=await fastGlob$1("**/.gitignore",{ignore:DEFAULT_IGNORE.concat(options.ignore),cwd:options.cwd});const files=await Promise.all(paths.map(file=>getFile(file,options.cwd)));const ignores=reduceIgnore(files);return getIsIgnoredPredecate(ignores,options.cwd)};gitignore$1.exports.sync=options=>{options=normalizeOptions(options);const paths=fastGlob$1.sync("**/.gitignore",{ignore:DEFAULT_IGNORE.concat(options.ignore),cwd:options.cwd});const files=paths.map(file=>getFileSync(file,options.cwd));const ignores=reduceIgnore(files);return getIsIgnoredPredecate(ignores,options.cwd)};

const{Transform}=require$$0__default["default"];class ObjectTransform extends Transform{constructor(){super({objectMode:true});}}class FilterStream$1 extends ObjectTransform{constructor(filter){super();this._filter=filter;}_transform(data,encoding,callback){if(this._filter(data)){this.push(data);}callback();}}class UniqueStream$1 extends ObjectTransform{constructor(){super();this._pushed=new Set;}_transform(data,encoding,callback){if(!this._pushed.has(data)){this.push(data);this._pushed.add(data);}callback();}}var streamUtils={FilterStream: FilterStream$1,UniqueStream: UniqueStream$1};

const fs$n=require$$0__default$3["default"];const arrayUnion=arrayUnion$1;const merge2=merge2_1;const fastGlob=out;const dirGlob=dirGlob$1.exports;const gitignore=gitignore$1.exports;const{FilterStream,UniqueStream}=streamUtils;const DEFAULT_FILTER=()=>false;const isNegative=pattern=>pattern[0]==="!";const assertPatternsInput=patterns=>{if(!patterns.every(pattern=>typeof pattern==="string")){throw new TypeError("Patterns must be a string or an array of strings")}};const checkCwdOption=(options={})=>{if(!options.cwd){return}let stat;try{stat=fs$n.statSync(options.cwd);}catch{return}if(!stat.isDirectory()){throw new Error("The `cwd` option must be a path to a directory")}};const getPathString=p=>p.stats instanceof fs$n.Stats?p.path:p;const generateGlobTasks=(patterns,taskOptions)=>{patterns=arrayUnion([].concat(patterns));assertPatternsInput(patterns);checkCwdOption(taskOptions);const globTasks=[];taskOptions={ignore:[],expandDirectories:true,...taskOptions};for(const[index,pattern]of patterns.entries()){if(isNegative(pattern)){continue}const ignore=patterns.slice(index).filter(pattern=>isNegative(pattern)).map(pattern=>pattern.slice(1));const options={...taskOptions,ignore:taskOptions.ignore.concat(ignore)};globTasks.push({pattern,options});}return globTasks};const globDirs=(task,fn)=>{let options={};if(task.options.cwd){options.cwd=task.options.cwd;}if(Array.isArray(task.options.expandDirectories)){options={...options,files:task.options.expandDirectories};}else if(typeof task.options.expandDirectories==="object"){options={...options,...task.options.expandDirectories};}return fn(task.pattern,options)};const getPattern$1=(task,fn)=>task.options.expandDirectories?globDirs(task,fn):[task.pattern];const getFilterSync=options=>{return options&&options.gitignore?gitignore.sync({cwd:options.cwd,ignore:options.ignore}):DEFAULT_FILTER};const globToTask=task=>glob=>{const{options}=task;if(options.ignore&&Array.isArray(options.ignore)&&options.expandDirectories){options.ignore=dirGlob.sync(options.ignore);}return {pattern:glob,options}};globby$1.exports=async(patterns,options)=>{const globTasks=generateGlobTasks(patterns,options);const getFilter=async()=>{return options&&options.gitignore?gitignore({cwd:options.cwd,ignore:options.ignore}):DEFAULT_FILTER};const getTasks=async()=>{const tasks=await Promise.all(globTasks.map(async task=>{const globs=await getPattern$1(task,dirGlob);return Promise.all(globs.map(globToTask(task)))}));return arrayUnion(...tasks)};const[filter,tasks]=await Promise.all([getFilter(),getTasks()]);const paths=await Promise.all(tasks.map(task=>fastGlob(task.pattern,task.options)));return arrayUnion(...paths).filter(path_=>!filter(getPathString(path_)))};globby$1.exports.sync=(patterns,options)=>{const globTasks=generateGlobTasks(patterns,options);const tasks=[];for(const task of globTasks){const newTask=getPattern$1(task,dirGlob.sync).map(globToTask(task));tasks.push(...newTask);}const filter=getFilterSync(options);let matches=[];for(const task of tasks){matches=arrayUnion(matches,fastGlob.sync(task.pattern,task.options));}return matches.filter(path_=>!filter(path_))};globby$1.exports.stream=(patterns,options)=>{const globTasks=generateGlobTasks(patterns,options);const tasks=[];for(const task of globTasks){const newTask=getPattern$1(task,dirGlob.sync).map(globToTask(task));tasks.push(...newTask);}const filter=getFilterSync(options);const filterStream=new FilterStream(p=>!filter(p));const uniqueStream=new UniqueStream;return merge2(tasks.map(task=>fastGlob.stream(task.pattern,task.options))).pipe(filterStream).pipe(uniqueStream)};globby$1.exports.generateGlobTasks=generateGlobTasks;globby$1.exports.hasMagic=(patterns,options)=>[].concat(patterns).some(pattern=>fastGlob.isDynamicPattern(pattern,options));globby$1.exports.gitignore=gitignore;

var lib$1 = {exports: {}};

var fs$m = {};

var universalify$1 = {};

universalify$1.fromCallback=function(fn){return Object.defineProperty(function(...args){if(typeof args[args.length-1]==="function")fn.apply(this,args);else {return new Promise((resolve,reject)=>{fn.call(this,...args,(err,res)=>err!=null?reject(err):resolve(res));})}},"name",{value:fn.name})};universalify$1.fromPromise=function(fn){return Object.defineProperty(function(...args){const cb=args[args.length-1];if(typeof cb!=="function")return fn.apply(this,args);else fn.apply(this,args.slice(0,-1)).then(r=>cb(null,r),cb);},"name",{value:fn.name})};

var constants$1=require$$0__default$5["default"];var origCwd=process.cwd;var cwd=null;var platform=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){if(!cwd)cwd=origCwd.call(process);return cwd};try{process.cwd();}catch(er){}if(typeof process.chdir==="function"){var chdir=process.chdir;process.chdir=function(d){cwd=null;chdir.call(process,d);};if(Object.setPrototypeOf)Object.setPrototypeOf(process.chdir,chdir);}var polyfills$1=patch$1;function patch$1(fs){if(constants$1.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)){patchLchmod(fs);}if(!fs.lutimes){patchLutimes(fs);}fs.chown=chownFix(fs.chown);fs.fchown=chownFix(fs.fchown);fs.lchown=chownFix(fs.lchown);fs.chmod=chmodFix(fs.chmod);fs.fchmod=chmodFix(fs.fchmod);fs.lchmod=chmodFix(fs.lchmod);fs.chownSync=chownFixSync(fs.chownSync);fs.fchownSync=chownFixSync(fs.fchownSync);fs.lchownSync=chownFixSync(fs.lchownSync);fs.chmodSync=chmodFixSync(fs.chmodSync);fs.fchmodSync=chmodFixSync(fs.fchmodSync);fs.lchmodSync=chmodFixSync(fs.lchmodSync);fs.stat=statFix(fs.stat);fs.fstat=statFix(fs.fstat);fs.lstat=statFix(fs.lstat);fs.statSync=statFixSync(fs.statSync);fs.fstatSync=statFixSync(fs.fstatSync);fs.lstatSync=statFixSync(fs.lstatSync);if(!fs.lchmod){fs.lchmod=function(path,mode,cb){if(cb)process.nextTick(cb);};fs.lchmodSync=function(){};}if(!fs.lchown){fs.lchown=function(path,uid,gid,cb){if(cb)process.nextTick(cb);};fs.lchownSync=function(){};}if(platform==="win32"){fs.rename=function(fs$rename){return function(from,to,cb){var start=Date.now();var backoff=0;fs$rename(from,to,function CB(er){if(er&&(er.code==="EACCES"||er.code==="EPERM")&&Date.now()-start<60000){setTimeout(function(){fs.stat(to,function(stater,st){if(stater&&stater.code==="ENOENT")fs$rename(from,to,CB);else cb(er);});},backoff);if(backoff<100)backoff+=10;return}if(cb)cb(er);});}}(fs.rename);}fs.read=function(fs$read){function read(fd,buffer,offset,length,position,callback_){var callback;if(callback_&&typeof callback_==="function"){var eagCounter=0;callback=function(er,_,__){if(er&&er.code==="EAGAIN"&&eagCounter<10){eagCounter++;return fs$read.call(fs,fd,buffer,offset,length,position,callback)}callback_.apply(this,arguments);};}return fs$read.call(fs,fd,buffer,offset,length,position,callback)}if(Object.setPrototypeOf)Object.setPrototypeOf(read,fs$read);return read}(fs.read);fs.readSync=function(fs$readSync){return function(fd,buffer,offset,length,position){var eagCounter=0;while(true){try{return fs$readSync.call(fs,fd,buffer,offset,length,position)}catch(er){if(er.code==="EAGAIN"&&eagCounter<10){eagCounter++;continue}throw er}}}}(fs.readSync);function patchLchmod(fs){fs.lchmod=function(path,mode,callback){fs.open(path,constants$1.O_WRONLY|constants$1.O_SYMLINK,mode,function(err,fd){if(err){if(callback)callback(err);return}fs.fchmod(fd,mode,function(err){fs.close(fd,function(err2){if(callback)callback(err||err2);});});});};fs.lchmodSync=function(path,mode){var fd=fs.openSync(path,constants$1.O_WRONLY|constants$1.O_SYMLINK,mode);var threw=true;var ret;try{ret=fs.fchmodSync(fd,mode);threw=false;}finally{if(threw){try{fs.closeSync(fd);}catch(er){}}else {fs.closeSync(fd);}}return ret};}function patchLutimes(fs){if(constants$1.hasOwnProperty("O_SYMLINK")){fs.lutimes=function(path,at,mt,cb){fs.open(path,constants$1.O_SYMLINK,function(er,fd){if(er){if(cb)cb(er);return}fs.futimes(fd,at,mt,function(er){fs.close(fd,function(er2){if(cb)cb(er||er2);});});});};fs.lutimesSync=function(path,at,mt){var fd=fs.openSync(path,constants$1.O_SYMLINK);var ret;var threw=true;try{ret=fs.futimesSync(fd,at,mt);threw=false;}finally{if(threw){try{fs.closeSync(fd);}catch(er){}}else {fs.closeSync(fd);}}return ret};}else {fs.lutimes=function(_a,_b,_c,cb){if(cb)process.nextTick(cb);};fs.lutimesSync=function(){};}}function chmodFix(orig){if(!orig)return orig;return function(target,mode,cb){return orig.call(fs,target,mode,function(er){if(chownErOk(er))er=null;if(cb)cb.apply(this,arguments);})}}function chmodFixSync(orig){if(!orig)return orig;return function(target,mode){try{return orig.call(fs,target,mode)}catch(er){if(!chownErOk(er))throw er}}}function chownFix(orig){if(!orig)return orig;return function(target,uid,gid,cb){return orig.call(fs,target,uid,gid,function(er){if(chownErOk(er))er=null;if(cb)cb.apply(this,arguments);})}}function chownFixSync(orig){if(!orig)return orig;return function(target,uid,gid){try{return orig.call(fs,target,uid,gid)}catch(er){if(!chownErOk(er))throw er}}}function statFix(orig){if(!orig)return orig;return function(target,options,cb){if(typeof options==="function"){cb=options;options=null;}function callback(er,stats){if(stats){if(stats.uid<0)stats.uid+=4294967296;if(stats.gid<0)stats.gid+=4294967296;}if(cb)cb.apply(this,arguments);}return options?orig.call(fs,target,options,callback):orig.call(fs,target,callback)}}function statFixSync(orig){if(!orig)return orig;return function(target,options){var stats=options?orig.call(fs,target,options):orig.call(fs,target);if(stats.uid<0)stats.uid+=4294967296;if(stats.gid<0)stats.gid+=4294967296;return stats}}function chownErOk(er){if(!er)return true;if(er.code==="ENOSYS")return true;var nonroot=!process.getuid||process.getuid()!==0;if(nonroot){if(er.code==="EINVAL"||er.code==="EPERM")return true}return false}}

var Stream$2=require$$0__default["default"].Stream;var legacyStreams=legacy$1;function legacy$1(fs){return {ReadStream:ReadStream,WriteStream:WriteStream};function ReadStream(path,options){if(!(this instanceof ReadStream))return new ReadStream(path,options);Stream$2.call(this);var self=this;this.path=path;this.fd=null;this.readable=true;this.paused=false;this.flags="r";this.mode=438;this.bufferSize=64*1024;options=options||{};var keys=Object.keys(options);for(var index=0,length=keys.length;index<length;index++){var key=keys[index];this[key]=options[key];}if(this.encoding)this.setEncoding(this.encoding);if(this.start!==undefined){if("number"!==typeof this.start){throw TypeError("start must be a Number")}if(this.end===undefined){this.end=Infinity;}else if("number"!==typeof this.end){throw TypeError("end must be a Number")}if(this.start>this.end){throw new Error("start must be <= end")}this.pos=this.start;}if(this.fd!==null){process.nextTick(function(){self._read();});return}fs.open(this.path,this.flags,this.mode,function(err,fd){if(err){self.emit("error",err);self.readable=false;return}self.fd=fd;self.emit("open",fd);self._read();});}function WriteStream(path,options){if(!(this instanceof WriteStream))return new WriteStream(path,options);Stream$2.call(this);this.path=path;this.fd=null;this.writable=true;this.flags="w";this.encoding="binary";this.mode=438;this.bytesWritten=0;options=options||{};var keys=Object.keys(options);for(var index=0,length=keys.length;index<length;index++){var key=keys[index];this[key]=options[key];}if(this.start!==undefined){if("number"!==typeof this.start){throw TypeError("start must be a Number")}if(this.start<0){throw new Error("start must be >= zero")}this.pos=this.start;}this.busy=false;this._queue=[];if(this.fd===null){this._open=fs.open;this._queue.push([this._open,this.path,this.flags,this.mode,undefined]);this.flush();}}}

var clone_1$1=clone$2;var getPrototypeOf=Object.getPrototypeOf||function(obj){return obj.__proto__};function clone$2(obj){if(obj===null||typeof obj!=="object")return obj;if(obj instanceof Object)var copy={__proto__:getPrototypeOf(obj)};else var copy=Object.create(null);Object.getOwnPropertyNames(obj).forEach(function(key){Object.defineProperty(copy,key,Object.getOwnPropertyDescriptor(obj,key));});return copy}

var fs$l=require$$0__default$3["default"];var polyfills=polyfills$1;var legacy=legacyStreams;var clone$1=clone_1$1;var util$3=require$$0__default$2["default"];var gracefulQueue;var previousSymbol;if(typeof Symbol==="function"&&typeof Symbol.for==="function"){gracefulQueue=Symbol.for("graceful-fs.queue");previousSymbol=Symbol.for("graceful-fs.previous");}else {gracefulQueue="___graceful-fs.queue";previousSymbol="___graceful-fs.previous";}function noop(){}function publishQueue(context,queue){Object.defineProperty(context,gracefulQueue,{get:function(){return queue}});}var debug$2=noop;if(util$3.debuglog)debug$2=util$3.debuglog("gfs4");else if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))debug$2=function(){var m=util$3.format.apply(util$3,arguments);m="GFS4: "+m.split(/\n/).join("\nGFS4: ");console.error(m);};if(!fs$l[gracefulQueue]){var queue=commonjsGlobal[gracefulQueue]||[];publishQueue(fs$l,queue);fs$l.close=function(fs$close){function close(fd,cb){return fs$close.call(fs$l,fd,function(err){if(!err){resetQueue();}if(typeof cb==="function")cb.apply(this,arguments);})}Object.defineProperty(close,previousSymbol,{value:fs$close});return close}(fs$l.close);fs$l.closeSync=function(fs$closeSync){function closeSync(fd){fs$closeSync.apply(fs$l,arguments);resetQueue();}Object.defineProperty(closeSync,previousSymbol,{value:fs$closeSync});return closeSync}(fs$l.closeSync);if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")){process.on("exit",function(){debug$2(fs$l[gracefulQueue]);require$$5__default["default"].equal(fs$l[gracefulQueue].length,0);});}}if(!commonjsGlobal[gracefulQueue]){publishQueue(commonjsGlobal,fs$l[gracefulQueue]);}var gracefulFs=patch(clone$1(fs$l));if(process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!fs$l.__patched){gracefulFs=patch(fs$l);fs$l.__patched=true;}function patch(fs){polyfills(fs);fs.gracefulify=patch;fs.createReadStream=createReadStream;fs.createWriteStream=createWriteStream;var fs$readFile=fs.readFile;fs.readFile=readFile;function readFile(path,options,cb){if(typeof options==="function")cb=options,options=null;return go$readFile(path,options,cb);function go$readFile(path,options,cb,startTime){return fs$readFile(path,options,function(err){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$readFile,[path,options,cb],err,startTime||Date.now(),Date.now()]);else {if(typeof cb==="function")cb.apply(this,arguments);}})}}var fs$writeFile=fs.writeFile;fs.writeFile=writeFile;function writeFile(path,data,options,cb){if(typeof options==="function")cb=options,options=null;return go$writeFile(path,data,options,cb);function go$writeFile(path,data,options,cb,startTime){return fs$writeFile(path,data,options,function(err){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$writeFile,[path,data,options,cb],err,startTime||Date.now(),Date.now()]);else {if(typeof cb==="function")cb.apply(this,arguments);}})}}var fs$appendFile=fs.appendFile;if(fs$appendFile)fs.appendFile=appendFile;function appendFile(path,data,options,cb){if(typeof options==="function")cb=options,options=null;return go$appendFile(path,data,options,cb);function go$appendFile(path,data,options,cb,startTime){return fs$appendFile(path,data,options,function(err){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$appendFile,[path,data,options,cb],err,startTime||Date.now(),Date.now()]);else {if(typeof cb==="function")cb.apply(this,arguments);}})}}var fs$copyFile=fs.copyFile;if(fs$copyFile)fs.copyFile=copyFile;function copyFile(src,dest,flags,cb){if(typeof flags==="function"){cb=flags;flags=0;}return go$copyFile(src,dest,flags,cb);function go$copyFile(src,dest,flags,cb,startTime){return fs$copyFile(src,dest,flags,function(err){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$copyFile,[src,dest,flags,cb],err,startTime||Date.now(),Date.now()]);else {if(typeof cb==="function")cb.apply(this,arguments);}})}}var fs$readdir=fs.readdir;fs.readdir=readdir;function readdir(path,options,cb){if(typeof options==="function")cb=options,options=null;return go$readdir(path,options,cb);function go$readdir(path,options,cb,startTime){return fs$readdir(path,options,function(err,files){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$readdir,[path,options,cb],err,startTime||Date.now(),Date.now()]);else {if(files&&files.sort)files.sort();if(typeof cb==="function")cb.call(this,err,files);}})}}if(process.version.substr(0,4)==="v0.8"){var legStreams=legacy(fs);ReadStream=legStreams.ReadStream;WriteStream=legStreams.WriteStream;}var fs$ReadStream=fs.ReadStream;if(fs$ReadStream){ReadStream.prototype=Object.create(fs$ReadStream.prototype);ReadStream.prototype.open=ReadStream$open;}var fs$WriteStream=fs.WriteStream;if(fs$WriteStream){WriteStream.prototype=Object.create(fs$WriteStream.prototype);WriteStream.prototype.open=WriteStream$open;}Object.defineProperty(fs,"ReadStream",{get:function(){return ReadStream},set:function(val){ReadStream=val;},enumerable:true,configurable:true});Object.defineProperty(fs,"WriteStream",{get:function(){return WriteStream},set:function(val){WriteStream=val;},enumerable:true,configurable:true});var FileReadStream=ReadStream;Object.defineProperty(fs,"FileReadStream",{get:function(){return FileReadStream},set:function(val){FileReadStream=val;},enumerable:true,configurable:true});var FileWriteStream=WriteStream;Object.defineProperty(fs,"FileWriteStream",{get:function(){return FileWriteStream},set:function(val){FileWriteStream=val;},enumerable:true,configurable:true});function ReadStream(path,options){if(this instanceof ReadStream)return fs$ReadStream.apply(this,arguments),this;else return ReadStream.apply(Object.create(ReadStream.prototype),arguments)}function ReadStream$open(){var that=this;open(that.path,that.flags,that.mode,function(err,fd){if(err){if(that.autoClose)that.destroy();that.emit("error",err);}else {that.fd=fd;that.emit("open",fd);that.read();}});}function WriteStream(path,options){if(this instanceof WriteStream)return fs$WriteStream.apply(this,arguments),this;else return WriteStream.apply(Object.create(WriteStream.prototype),arguments)}function WriteStream$open(){var that=this;open(that.path,that.flags,that.mode,function(err,fd){if(err){that.destroy();that.emit("error",err);}else {that.fd=fd;that.emit("open",fd);}});}function createReadStream(path,options){return new fs.ReadStream(path,options)}function createWriteStream(path,options){return new fs.WriteStream(path,options)}var fs$open=fs.open;fs.open=open;function open(path,flags,mode,cb){if(typeof mode==="function")cb=mode,mode=null;return go$open(path,flags,mode,cb);function go$open(path,flags,mode,cb,startTime){return fs$open(path,flags,mode,function(err,fd){if(err&&(err.code==="EMFILE"||err.code==="ENFILE"))enqueue([go$open,[path,flags,mode,cb],err,startTime||Date.now(),Date.now()]);else {if(typeof cb==="function")cb.apply(this,arguments);}})}}return fs}function enqueue(elem){debug$2("ENQUEUE",elem[0].name,elem[1]);fs$l[gracefulQueue].push(elem);retry();}var retryTimer;function resetQueue(){var now=Date.now();for(var i=0;i<fs$l[gracefulQueue].length;++i){if(fs$l[gracefulQueue][i].length>2){fs$l[gracefulQueue][i][3]=now;fs$l[gracefulQueue][i][4]=now;}}retry();}function retry(){clearTimeout(retryTimer);retryTimer=undefined;if(fs$l[gracefulQueue].length===0)return;var elem=fs$l[gracefulQueue].shift();var fn=elem[0];var args=elem[1];var err=elem[2];var startTime=elem[3];var lastTime=elem[4];if(startTime===undefined){debug$2("RETRY",fn.name,args);fn.apply(null,args);}else if(Date.now()-startTime>=60000){debug$2("TIMEOUT",fn.name,args);var cb=args.pop();if(typeof cb==="function")cb.call(null,err);}else {var sinceAttempt=Date.now()-lastTime;var sinceStart=Math.max(lastTime-startTime,1);var desiredDelay=Math.min(sinceStart*1.2,100);if(sinceAttempt>=desiredDelay){debug$2("RETRY",fn.name,args);fn.apply(null,args.concat([startTime]));}else {fs$l[gracefulQueue].push(elem);}}if(retryTimer===undefined){retryTimer=setTimeout(retry,0);}}

(function(exports){const u=universalify$1.fromCallback;const fs=gracefulFs;const api=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(key=>{return typeof fs[key]==="function"});Object.keys(fs).forEach(key=>{if(key==="promises"){return}exports[key]=fs[key];});api.forEach(method=>{exports[method]=u(fs[method]);});exports.exists=function(filename,callback){if(typeof callback==="function"){return fs.exists(filename,callback)}return new Promise(resolve=>{return fs.exists(filename,resolve)})};exports.read=function(fd,buffer,offset,length,position,callback){if(typeof callback==="function"){return fs.read(fd,buffer,offset,length,position,callback)}return new Promise((resolve,reject)=>{fs.read(fd,buffer,offset,length,position,(err,bytesRead,buffer)=>{if(err)return reject(err);resolve({bytesRead,buffer});});})};exports.write=function(fd,buffer,...args){if(typeof args[args.length-1]==="function"){return fs.write(fd,buffer,...args)}return new Promise((resolve,reject)=>{fs.write(fd,buffer,...args,(err,bytesWritten,buffer)=>{if(err)return reject(err);resolve({bytesWritten,buffer});});})};if(typeof fs.writev==="function"){exports.writev=function(fd,buffers,...args){if(typeof args[args.length-1]==="function"){return fs.writev(fd,buffers,...args)}return new Promise((resolve,reject)=>{fs.writev(fd,buffers,...args,(err,bytesWritten,buffers)=>{if(err)return reject(err);resolve({bytesWritten,buffers});});})};}if(typeof fs.realpath.native==="function"){exports.realpath.native=u(fs.realpath.native);}})(fs$m);

var makeDir$1 = {};

var atLeastNode$2=r=>{const n=process.versions.node.split(".").map(x=>parseInt(x,10));r=r.split(".").map(x=>parseInt(x,10));return n[0]>r[0]||n[0]===r[0]&&(n[1]>r[1]||n[1]===r[1]&&n[2]>=r[2])};

const fs$k=fs$m;const path$e=require$$0__default$1["default"];const atLeastNode$1=atLeastNode$2;const useNativeRecursiveOption=atLeastNode$1("10.12.0");const checkPath=pth=>{if(process.platform==="win32"){const pathHasInvalidWinCharacters=/[<>:"|?*]/.test(pth.replace(path$e.parse(pth).root,""));if(pathHasInvalidWinCharacters){const error=new Error(`Path contains invalid characters: ${pth}`);error.code="EINVAL";throw error}}};const processOptions=options=>{const defaults={mode:511};if(typeof options==="number")options={mode:options};return {...defaults,...options}};const permissionError=pth=>{const error=new Error(`operation not permitted, mkdir '${pth}'`);error.code="EPERM";error.errno=-4048;error.path=pth;error.syscall="mkdir";return error};makeDir$1.makeDir=async(input,options)=>{checkPath(input);options=processOptions(options);if(useNativeRecursiveOption){const pth=path$e.resolve(input);return fs$k.mkdir(pth,{mode:options.mode,recursive:true})}const make=async pth=>{try{await fs$k.mkdir(pth,options.mode);}catch(error){if(error.code==="EPERM"){throw error}if(error.code==="ENOENT"){if(path$e.dirname(pth)===pth){throw permissionError(pth)}if(error.message.includes("null bytes")){throw error}await make(path$e.dirname(pth));return make(pth)}try{const stats=await fs$k.stat(pth);if(!stats.isDirectory()){throw new Error("The path is not a directory")}}catch{throw error}}};return make(path$e.resolve(input))};makeDir$1.makeDirSync=(input,options)=>{checkPath(input);options=processOptions(options);if(useNativeRecursiveOption){const pth=path$e.resolve(input);return fs$k.mkdirSync(pth,{mode:options.mode,recursive:true})}const make=pth=>{try{fs$k.mkdirSync(pth,options.mode);}catch(error){if(error.code==="EPERM"){throw error}if(error.code==="ENOENT"){if(path$e.dirname(pth)===pth){throw permissionError(pth)}if(error.message.includes("null bytes")){throw error}make(path$e.dirname(pth));return make(pth)}try{if(!fs$k.statSync(pth).isDirectory()){throw new Error("The path is not a directory")}}catch{throw error}}};return make(path$e.resolve(input))};

const u$b=universalify$1.fromPromise;const{makeDir:_makeDir,makeDirSync}=makeDir$1;const makeDir=u$b(_makeDir);var mkdirs$2={mkdirs:makeDir,mkdirsSync:makeDirSync,mkdirp:makeDir,mkdirpSync:makeDirSync,ensureDir:makeDir,ensureDirSync:makeDirSync};

const fs$j=gracefulFs;function utimesMillis$1(path,atime,mtime,callback){fs$j.open(path,"r+",(err,fd)=>{if(err)return callback(err);fs$j.futimes(fd,atime,mtime,futimesErr=>{fs$j.close(fd,closeErr=>{if(callback)callback(futimesErr||closeErr);});});});}function utimesMillisSync$1(path,atime,mtime){const fd=fs$j.openSync(path,"r+");fs$j.futimesSync(fd,atime,mtime);return fs$j.closeSync(fd)}var utimes={utimesMillis: utimesMillis$1,utimesMillisSync: utimesMillisSync$1};

const fs$i=fs$m;const path$d=require$$0__default$1["default"];const util$2=require$$0__default$2["default"];const atLeastNode=atLeastNode$2;const nodeSupportsBigInt=atLeastNode("10.5.0");const stat$8=file=>nodeSupportsBigInt?fs$i.stat(file,{bigint:true}):fs$i.stat(file);const statSync=file=>nodeSupportsBigInt?fs$i.statSync(file,{bigint:true}):fs$i.statSync(file);function getStats$2(src,dest){return Promise.all([stat$8(src),stat$8(dest).catch(err=>{if(err.code==="ENOENT")return null;throw err})]).then(([srcStat,destStat])=>({srcStat,destStat}))}function getStatsSync(src,dest){let destStat;const srcStat=statSync(src);try{destStat=statSync(dest);}catch(err){if(err.code==="ENOENT")return {srcStat,destStat:null};throw err}return {srcStat,destStat}}function checkPaths(src,dest,funcName,cb){util$2.callbackify(getStats$2)(src,dest,(err,stats)=>{if(err)return cb(err);const{srcStat,destStat}=stats;if(destStat&&areIdentical(srcStat,destStat)){return cb(new Error("Source and destination must not be the same."))}if(srcStat.isDirectory()&&isSrcSubdir(src,dest)){return cb(new Error(errMsg(src,dest,funcName)))}return cb(null,{srcStat,destStat})});}function checkPathsSync(src,dest,funcName){const{srcStat,destStat}=getStatsSync(src,dest);if(destStat&&areIdentical(srcStat,destStat)){throw new Error("Source and destination must not be the same.")}if(srcStat.isDirectory()&&isSrcSubdir(src,dest)){throw new Error(errMsg(src,dest,funcName))}return {srcStat,destStat}}function checkParentPaths(src,srcStat,dest,funcName,cb){const srcParent=path$d.resolve(path$d.dirname(src));const destParent=path$d.resolve(path$d.dirname(dest));if(destParent===srcParent||destParent===path$d.parse(destParent).root)return cb();const callback=(err,destStat)=>{if(err){if(err.code==="ENOENT")return cb();return cb(err)}if(areIdentical(srcStat,destStat)){return cb(new Error(errMsg(src,dest,funcName)))}return checkParentPaths(src,srcStat,destParent,funcName,cb)};if(nodeSupportsBigInt)fs$i.stat(destParent,{bigint:true},callback);else fs$i.stat(destParent,callback);}function checkParentPathsSync(src,srcStat,dest,funcName){const srcParent=path$d.resolve(path$d.dirname(src));const destParent=path$d.resolve(path$d.dirname(dest));if(destParent===srcParent||destParent===path$d.parse(destParent).root)return;let destStat;try{destStat=statSync(destParent);}catch(err){if(err.code==="ENOENT")return;throw err}if(areIdentical(srcStat,destStat)){throw new Error(errMsg(src,dest,funcName))}return checkParentPathsSync(src,srcStat,destParent,funcName)}function areIdentical(srcStat,destStat){if(destStat.ino&&destStat.dev&&destStat.ino===srcStat.ino&&destStat.dev===srcStat.dev){if(nodeSupportsBigInt||destStat.ino<Number.MAX_SAFE_INTEGER){return true}if(destStat.size===srcStat.size&&destStat.mode===srcStat.mode&&destStat.nlink===srcStat.nlink&&destStat.atimeMs===srcStat.atimeMs&&destStat.mtimeMs===srcStat.mtimeMs&&destStat.ctimeMs===srcStat.ctimeMs&&destStat.birthtimeMs===srcStat.birthtimeMs){return true}}return false}function isSrcSubdir(src,dest){const srcArr=path$d.resolve(src).split(path$d.sep).filter(i=>i);const destArr=path$d.resolve(dest).split(path$d.sep).filter(i=>i);return srcArr.reduce((acc,cur,i)=>acc&&destArr[i]===cur,true)}function errMsg(src,dest,funcName){return `Cannot ${funcName} '${src}' to a subdirectory of itself, '${dest}'.`}var stat_1={checkPaths,checkPathsSync,checkParentPaths,checkParentPathsSync,isSrcSubdir};

const fs$h=gracefulFs;const path$c=require$$0__default$1["default"];const mkdirsSync$1=mkdirs$2.mkdirsSync;const utimesMillisSync=utimes.utimesMillisSync;const stat$7=stat_1;function copySync$2(src,dest,opts){if(typeof opts==="function"){opts={filter:opts};}opts=opts||{};opts.clobber="clobber"in opts?!!opts.clobber:true;opts.overwrite="overwrite"in opts?!!opts.overwrite:opts.clobber;if(opts.preserveTimestamps&&process.arch==="ia32"){console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n
    see https://github.com/jprichardson/node-fs-extra/issues/269`);}const{srcStat,destStat}=stat$7.checkPathsSync(src,dest,"copy");stat$7.checkParentPathsSync(src,srcStat,dest,"copy");return handleFilterAndCopy(destStat,src,dest,opts)}function handleFilterAndCopy(destStat,src,dest,opts){if(opts.filter&&!opts.filter(src,dest))return;const destParent=path$c.dirname(dest);if(!fs$h.existsSync(destParent))mkdirsSync$1(destParent);return startCopy$1(destStat,src,dest,opts)}function startCopy$1(destStat,src,dest,opts){if(opts.filter&&!opts.filter(src,dest))return;return getStats$1(destStat,src,dest,opts)}function getStats$1(destStat,src,dest,opts){const statSync=opts.dereference?fs$h.statSync:fs$h.lstatSync;const srcStat=statSync(src);if(srcStat.isDirectory())return onDir$1(srcStat,destStat,src,dest,opts);else if(srcStat.isFile()||srcStat.isCharacterDevice()||srcStat.isBlockDevice())return onFile$1(srcStat,destStat,src,dest,opts);else if(srcStat.isSymbolicLink())return onLink$1(destStat,src,dest,opts)}function onFile$1(srcStat,destStat,src,dest,opts){if(!destStat)return copyFile$1(srcStat,src,dest,opts);return mayCopyFile$1(srcStat,src,dest,opts)}function mayCopyFile$1(srcStat,src,dest,opts){if(opts.overwrite){fs$h.unlinkSync(dest);return copyFile$1(srcStat,src,dest,opts)}else if(opts.errorOnExist){throw new Error(`'${dest}' already exists`)}}function copyFile$1(srcStat,src,dest,opts){fs$h.copyFileSync(src,dest);if(opts.preserveTimestamps)handleTimestamps(srcStat.mode,src,dest);return setDestMode$1(dest,srcStat.mode)}function handleTimestamps(srcMode,src,dest){if(fileIsNotWritable$1(srcMode))makeFileWritable$1(dest,srcMode);return setDestTimestamps$1(src,dest)}function fileIsNotWritable$1(srcMode){return (srcMode&128)===0}function makeFileWritable$1(dest,srcMode){return setDestMode$1(dest,srcMode|128)}function setDestMode$1(dest,srcMode){return fs$h.chmodSync(dest,srcMode)}function setDestTimestamps$1(src,dest){const updatedSrcStat=fs$h.statSync(src);return utimesMillisSync(dest,updatedSrcStat.atime,updatedSrcStat.mtime)}function onDir$1(srcStat,destStat,src,dest,opts){if(!destStat)return mkDirAndCopy$1(srcStat.mode,src,dest,opts);if(destStat&&!destStat.isDirectory()){throw new Error(`Cannot overwrite non-directory '${dest}' with directory '${src}'.`)}return copyDir$1(src,dest,opts)}function mkDirAndCopy$1(srcMode,src,dest,opts){fs$h.mkdirSync(dest);copyDir$1(src,dest,opts);return setDestMode$1(dest,srcMode)}function copyDir$1(src,dest,opts){fs$h.readdirSync(src).forEach(item=>copyDirItem$1(item,src,dest,opts));}function copyDirItem$1(item,src,dest,opts){const srcItem=path$c.join(src,item);const destItem=path$c.join(dest,item);const{destStat}=stat$7.checkPathsSync(srcItem,destItem,"copy");return startCopy$1(destStat,srcItem,destItem,opts)}function onLink$1(destStat,src,dest,opts){let resolvedSrc=fs$h.readlinkSync(src);if(opts.dereference){resolvedSrc=path$c.resolve(process.cwd(),resolvedSrc);}if(!destStat){return fs$h.symlinkSync(resolvedSrc,dest)}else {let resolvedDest;try{resolvedDest=fs$h.readlinkSync(dest);}catch(err){if(err.code==="EINVAL"||err.code==="UNKNOWN")return fs$h.symlinkSync(resolvedSrc,dest);throw err}if(opts.dereference){resolvedDest=path$c.resolve(process.cwd(),resolvedDest);}if(stat$7.isSrcSubdir(resolvedSrc,resolvedDest)){throw new Error(`Cannot copy '${resolvedSrc}' to a subdirectory of itself, '${resolvedDest}'.`)}if(fs$h.statSync(dest).isDirectory()&&stat$7.isSrcSubdir(resolvedDest,resolvedSrc)){throw new Error(`Cannot overwrite '${resolvedDest}' with '${resolvedSrc}'.`)}return copyLink$1(resolvedSrc,dest)}}function copyLink$1(resolvedSrc,dest){fs$h.unlinkSync(dest);return fs$h.symlinkSync(resolvedSrc,dest)}var copySync_1=copySync$2;

var copySync$1={copySync:copySync_1};

const u$a=universalify$1.fromPromise;const fs$g=fs$m;function pathExists$6(path){return fs$g.access(path).then(()=>true).catch(()=>false)}var pathExists_1={pathExists:u$a(pathExists$6),pathExistsSync:fs$g.existsSync};

const fs$f=gracefulFs;const path$b=require$$0__default$1["default"];const mkdirs$1=mkdirs$2.mkdirs;const pathExists$5=pathExists_1.pathExists;const utimesMillis=utimes.utimesMillis;const stat$6=stat_1;function copy$2(src,dest,opts,cb){if(typeof opts==="function"&&!cb){cb=opts;opts={};}else if(typeof opts==="function"){opts={filter:opts};}cb=cb||function(){};opts=opts||{};opts.clobber="clobber"in opts?!!opts.clobber:true;opts.overwrite="overwrite"in opts?!!opts.overwrite:opts.clobber;if(opts.preserveTimestamps&&process.arch==="ia32"){console.warn(`fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n
    see https://github.com/jprichardson/node-fs-extra/issues/269`);}stat$6.checkPaths(src,dest,"copy",(err,stats)=>{if(err)return cb(err);const{srcStat,destStat}=stats;stat$6.checkParentPaths(src,srcStat,dest,"copy",err=>{if(err)return cb(err);if(opts.filter)return handleFilter(checkParentDir,destStat,src,dest,opts,cb);return checkParentDir(destStat,src,dest,opts,cb)});});}function checkParentDir(destStat,src,dest,opts,cb){const destParent=path$b.dirname(dest);pathExists$5(destParent,(err,dirExists)=>{if(err)return cb(err);if(dirExists)return startCopy(destStat,src,dest,opts,cb);mkdirs$1(destParent,err=>{if(err)return cb(err);return startCopy(destStat,src,dest,opts,cb)});});}function handleFilter(onInclude,destStat,src,dest,opts,cb){Promise.resolve(opts.filter(src,dest)).then(include=>{if(include)return onInclude(destStat,src,dest,opts,cb);return cb()},error=>cb(error));}function startCopy(destStat,src,dest,opts,cb){if(opts.filter)return handleFilter(getStats,destStat,src,dest,opts,cb);return getStats(destStat,src,dest,opts,cb)}function getStats(destStat,src,dest,opts,cb){const stat=opts.dereference?fs$f.stat:fs$f.lstat;stat(src,(err,srcStat)=>{if(err)return cb(err);if(srcStat.isDirectory())return onDir(srcStat,destStat,src,dest,opts,cb);else if(srcStat.isFile()||srcStat.isCharacterDevice()||srcStat.isBlockDevice())return onFile(srcStat,destStat,src,dest,opts,cb);else if(srcStat.isSymbolicLink())return onLink(destStat,src,dest,opts,cb)});}function onFile(srcStat,destStat,src,dest,opts,cb){if(!destStat)return copyFile(srcStat,src,dest,opts,cb);return mayCopyFile(srcStat,src,dest,opts,cb)}function mayCopyFile(srcStat,src,dest,opts,cb){if(opts.overwrite){fs$f.unlink(dest,err=>{if(err)return cb(err);return copyFile(srcStat,src,dest,opts,cb)});}else if(opts.errorOnExist){return cb(new Error(`'${dest}' already exists`))}else return cb()}function copyFile(srcStat,src,dest,opts,cb){fs$f.copyFile(src,dest,err=>{if(err)return cb(err);if(opts.preserveTimestamps)return handleTimestampsAndMode(srcStat.mode,src,dest,cb);return setDestMode(dest,srcStat.mode,cb)});}function handleTimestampsAndMode(srcMode,src,dest,cb){if(fileIsNotWritable(srcMode)){return makeFileWritable(dest,srcMode,err=>{if(err)return cb(err);return setDestTimestampsAndMode(srcMode,src,dest,cb)})}return setDestTimestampsAndMode(srcMode,src,dest,cb)}function fileIsNotWritable(srcMode){return (srcMode&128)===0}function makeFileWritable(dest,srcMode,cb){return setDestMode(dest,srcMode|128,cb)}function setDestTimestampsAndMode(srcMode,src,dest,cb){setDestTimestamps(src,dest,err=>{if(err)return cb(err);return setDestMode(dest,srcMode,cb)});}function setDestMode(dest,srcMode,cb){return fs$f.chmod(dest,srcMode,cb)}function setDestTimestamps(src,dest,cb){fs$f.stat(src,(err,updatedSrcStat)=>{if(err)return cb(err);return utimesMillis(dest,updatedSrcStat.atime,updatedSrcStat.mtime,cb)});}function onDir(srcStat,destStat,src,dest,opts,cb){if(!destStat)return mkDirAndCopy(srcStat.mode,src,dest,opts,cb);if(destStat&&!destStat.isDirectory()){return cb(new Error(`Cannot overwrite non-directory '${dest}' with directory '${src}'.`))}return copyDir(src,dest,opts,cb)}function mkDirAndCopy(srcMode,src,dest,opts,cb){fs$f.mkdir(dest,err=>{if(err)return cb(err);copyDir(src,dest,opts,err=>{if(err)return cb(err);return setDestMode(dest,srcMode,cb)});});}function copyDir(src,dest,opts,cb){fs$f.readdir(src,(err,items)=>{if(err)return cb(err);return copyDirItems(items,src,dest,opts,cb)});}function copyDirItems(items,src,dest,opts,cb){const item=items.pop();if(!item)return cb();return copyDirItem(items,item,src,dest,opts,cb)}function copyDirItem(items,item,src,dest,opts,cb){const srcItem=path$b.join(src,item);const destItem=path$b.join(dest,item);stat$6.checkPaths(srcItem,destItem,"copy",(err,stats)=>{if(err)return cb(err);const{destStat}=stats;startCopy(destStat,srcItem,destItem,opts,err=>{if(err)return cb(err);return copyDirItems(items,src,dest,opts,cb)});});}function onLink(destStat,src,dest,opts,cb){fs$f.readlink(src,(err,resolvedSrc)=>{if(err)return cb(err);if(opts.dereference){resolvedSrc=path$b.resolve(process.cwd(),resolvedSrc);}if(!destStat){return fs$f.symlink(resolvedSrc,dest,cb)}else {fs$f.readlink(dest,(err,resolvedDest)=>{if(err){if(err.code==="EINVAL"||err.code==="UNKNOWN")return fs$f.symlink(resolvedSrc,dest,cb);return cb(err)}if(opts.dereference){resolvedDest=path$b.resolve(process.cwd(),resolvedDest);}if(stat$6.isSrcSubdir(resolvedSrc,resolvedDest)){return cb(new Error(`Cannot copy '${resolvedSrc}' to a subdirectory of itself, '${resolvedDest}'.`))}if(destStat.isDirectory()&&stat$6.isSrcSubdir(resolvedDest,resolvedSrc)){return cb(new Error(`Cannot overwrite '${resolvedDest}' with '${resolvedSrc}'.`))}return copyLink(resolvedSrc,dest,cb)});}});}function copyLink(resolvedSrc,dest,cb){fs$f.unlink(dest,err=>{if(err)return cb(err);return fs$f.symlink(resolvedSrc,dest,cb)});}var copy_1=copy$2;

const u$9=universalify$1.fromCallback;var copy$1={copy:u$9(copy_1)};

const fs$e=gracefulFs;const path$a=require$$0__default$1["default"];const assert$1=require$$5__default["default"];const isWindows$2=process.platform==="win32";function defaults(options){const methods=["unlink","chmod","stat","lstat","rmdir","readdir"];methods.forEach(m=>{options[m]=options[m]||fs$e[m];m=m+"Sync";options[m]=options[m]||fs$e[m];});options.maxBusyTries=options.maxBusyTries||3;}function rimraf$1(p,options,cb){let busyTries=0;if(typeof options==="function"){cb=options;options={};}assert$1(p,"rimraf: missing path");assert$1.strictEqual(typeof p,"string","rimraf: path should be a string");assert$1.strictEqual(typeof cb,"function","rimraf: callback function required");assert$1(options,"rimraf: invalid options argument provided");assert$1.strictEqual(typeof options,"object","rimraf: options should be object");defaults(options);rimraf_(p,options,function CB(er){if(er){if((er.code==="EBUSY"||er.code==="ENOTEMPTY"||er.code==="EPERM")&&busyTries<options.maxBusyTries){busyTries++;const time=busyTries*100;return setTimeout(()=>rimraf_(p,options,CB),time)}if(er.code==="ENOENT")er=null;}cb(er);});}function rimraf_(p,options,cb){assert$1(p);assert$1(options);assert$1(typeof cb==="function");options.lstat(p,(er,st)=>{if(er&&er.code==="ENOENT"){return cb(null)}if(er&&er.code==="EPERM"&&isWindows$2){return fixWinEPERM(p,options,er,cb)}if(st&&st.isDirectory()){return rmdir(p,options,er,cb)}options.unlink(p,er=>{if(er){if(er.code==="ENOENT"){return cb(null)}if(er.code==="EPERM"){return isWindows$2?fixWinEPERM(p,options,er,cb):rmdir(p,options,er,cb)}if(er.code==="EISDIR"){return rmdir(p,options,er,cb)}}return cb(er)});});}function fixWinEPERM(p,options,er,cb){assert$1(p);assert$1(options);assert$1(typeof cb==="function");options.chmod(p,438,er2=>{if(er2){cb(er2.code==="ENOENT"?null:er);}else {options.stat(p,(er3,stats)=>{if(er3){cb(er3.code==="ENOENT"?null:er);}else if(stats.isDirectory()){rmdir(p,options,er,cb);}else {options.unlink(p,cb);}});}});}function fixWinEPERMSync(p,options,er){let stats;assert$1(p);assert$1(options);try{options.chmodSync(p,438);}catch(er2){if(er2.code==="ENOENT"){return}else {throw er}}try{stats=options.statSync(p);}catch(er3){if(er3.code==="ENOENT"){return}else {throw er}}if(stats.isDirectory()){rmdirSync(p,options,er);}else {options.unlinkSync(p);}}function rmdir(p,options,originalEr,cb){assert$1(p);assert$1(options);assert$1(typeof cb==="function");options.rmdir(p,er=>{if(er&&(er.code==="ENOTEMPTY"||er.code==="EEXIST"||er.code==="EPERM")){rmkids(p,options,cb);}else if(er&&er.code==="ENOTDIR"){cb(originalEr);}else {cb(er);}});}function rmkids(p,options,cb){assert$1(p);assert$1(options);assert$1(typeof cb==="function");options.readdir(p,(er,files)=>{if(er)return cb(er);let n=files.length;let errState;if(n===0)return options.rmdir(p,cb);files.forEach(f=>{rimraf$1(path$a.join(p,f),options,er=>{if(errState){return}if(er)return cb(errState=er);if(--n===0){options.rmdir(p,cb);}});});});}function rimrafSync(p,options){let st;options=options||{};defaults(options);assert$1(p,"rimraf: missing path");assert$1.strictEqual(typeof p,"string","rimraf: path should be a string");assert$1(options,"rimraf: missing options");assert$1.strictEqual(typeof options,"object","rimraf: options should be object");try{st=options.lstatSync(p);}catch(er){if(er.code==="ENOENT"){return}if(er.code==="EPERM"&&isWindows$2){fixWinEPERMSync(p,options,er);}}try{if(st&&st.isDirectory()){rmdirSync(p,options,null);}else {options.unlinkSync(p);}}catch(er){if(er.code==="ENOENT"){return}else if(er.code==="EPERM"){return isWindows$2?fixWinEPERMSync(p,options,er):rmdirSync(p,options,er)}else if(er.code!=="EISDIR"){throw er}rmdirSync(p,options,er);}}function rmdirSync(p,options,originalEr){assert$1(p);assert$1(options);try{options.rmdirSync(p);}catch(er){if(er.code==="ENOTDIR"){throw originalEr}else if(er.code==="ENOTEMPTY"||er.code==="EEXIST"||er.code==="EPERM"){rmkidsSync(p,options);}else if(er.code!=="ENOENT"){throw er}}}function rmkidsSync(p,options){assert$1(p);assert$1(options);options.readdirSync(p).forEach(f=>rimrafSync(path$a.join(p,f),options));if(isWindows$2){const startTime=Date.now();do{try{const ret=options.rmdirSync(p,options);return ret}catch{}}while(Date.now()-startTime<500)}else {const ret=options.rmdirSync(p,options);return ret}}var rimraf_1=rimraf$1;rimraf$1.sync=rimrafSync;

const u$8=universalify$1.fromCallback;const rimraf=rimraf_1;var remove$2={remove:u$8(rimraf),removeSync:rimraf.sync};

const u$7=universalify$1.fromCallback;const fs$d=gracefulFs;const path$9=require$$0__default$1["default"];const mkdir$3=mkdirs$2;const remove$1=remove$2;const emptyDir=u$7(function emptyDir(dir,callback){callback=callback||function(){};fs$d.readdir(dir,(err,items)=>{if(err)return mkdir$3.mkdirs(dir,callback);items=items.map(item=>path$9.join(dir,item));deleteItem();function deleteItem(){const item=items.pop();if(!item)return callback();remove$1.remove(item,err=>{if(err)return callback(err);deleteItem();});}});});function emptyDirSync(dir){let items;try{items=fs$d.readdirSync(dir);}catch{return mkdir$3.mkdirsSync(dir)}items.forEach(item=>{item=path$9.join(dir,item);remove$1.removeSync(item);});}var empty={emptyDirSync,emptydirSync:emptyDirSync,emptyDir,emptydir:emptyDir};

const u$6=universalify$1.fromCallback;const path$8=require$$0__default$1["default"];const fs$c=gracefulFs;const mkdir$2=mkdirs$2;function createFile(file,callback){function makeFile(){fs$c.writeFile(file,"",err=>{if(err)return callback(err);callback();});}fs$c.stat(file,(err,stats)=>{if(!err&&stats.isFile())return callback();const dir=path$8.dirname(file);fs$c.stat(dir,(err,stats)=>{if(err){if(err.code==="ENOENT"){return mkdir$2.mkdirs(dir,err=>{if(err)return callback(err);makeFile();})}return callback(err)}if(stats.isDirectory())makeFile();else {fs$c.readdir(dir,err=>{if(err)return callback(err)});}});});}function createFileSync(file){let stats;try{stats=fs$c.statSync(file);}catch{}if(stats&&stats.isFile())return;const dir=path$8.dirname(file);try{if(!fs$c.statSync(dir).isDirectory()){fs$c.readdirSync(dir);}}catch(err){if(err&&err.code==="ENOENT")mkdir$2.mkdirsSync(dir);else throw err}fs$c.writeFileSync(file,"");}var file$1={createFile:u$6(createFile),createFileSync};

const u$5=universalify$1.fromCallback;const path$7=require$$0__default$1["default"];const fs$b=gracefulFs;const mkdir$1=mkdirs$2;const pathExists$4=pathExists_1.pathExists;function createLink(srcpath,dstpath,callback){function makeLink(srcpath,dstpath){fs$b.link(srcpath,dstpath,err=>{if(err)return callback(err);callback(null);});}pathExists$4(dstpath,(err,destinationExists)=>{if(err)return callback(err);if(destinationExists)return callback(null);fs$b.lstat(srcpath,err=>{if(err){err.message=err.message.replace("lstat","ensureLink");return callback(err)}const dir=path$7.dirname(dstpath);pathExists$4(dir,(err,dirExists)=>{if(err)return callback(err);if(dirExists)return makeLink(srcpath,dstpath);mkdir$1.mkdirs(dir,err=>{if(err)return callback(err);makeLink(srcpath,dstpath);});});});});}function createLinkSync(srcpath,dstpath){const destinationExists=fs$b.existsSync(dstpath);if(destinationExists)return undefined;try{fs$b.lstatSync(srcpath);}catch(err){err.message=err.message.replace("lstat","ensureLink");throw err}const dir=path$7.dirname(dstpath);const dirExists=fs$b.existsSync(dir);if(dirExists)return fs$b.linkSync(srcpath,dstpath);mkdir$1.mkdirsSync(dir);return fs$b.linkSync(srcpath,dstpath)}var link$1={createLink:u$5(createLink),createLinkSync};

const path$6=require$$0__default$1["default"];const fs$a=gracefulFs;const pathExists$3=pathExists_1.pathExists;function symlinkPaths$1(srcpath,dstpath,callback){if(path$6.isAbsolute(srcpath)){return fs$a.lstat(srcpath,err=>{if(err){err.message=err.message.replace("lstat","ensureSymlink");return callback(err)}return callback(null,{toCwd:srcpath,toDst:srcpath})})}else {const dstdir=path$6.dirname(dstpath);const relativeToDst=path$6.join(dstdir,srcpath);return pathExists$3(relativeToDst,(err,exists)=>{if(err)return callback(err);if(exists){return callback(null,{toCwd:relativeToDst,toDst:srcpath})}else {return fs$a.lstat(srcpath,err=>{if(err){err.message=err.message.replace("lstat","ensureSymlink");return callback(err)}return callback(null,{toCwd:srcpath,toDst:path$6.relative(dstdir,srcpath)})})}})}}function symlinkPathsSync$1(srcpath,dstpath){let exists;if(path$6.isAbsolute(srcpath)){exists=fs$a.existsSync(srcpath);if(!exists)throw new Error("absolute srcpath does not exist");return {toCwd:srcpath,toDst:srcpath}}else {const dstdir=path$6.dirname(dstpath);const relativeToDst=path$6.join(dstdir,srcpath);exists=fs$a.existsSync(relativeToDst);if(exists){return {toCwd:relativeToDst,toDst:srcpath}}else {exists=fs$a.existsSync(srcpath);if(!exists)throw new Error("relative srcpath does not exist");return {toCwd:srcpath,toDst:path$6.relative(dstdir,srcpath)}}}}var symlinkPaths_1={symlinkPaths: symlinkPaths$1,symlinkPathsSync: symlinkPathsSync$1};

const fs$9=gracefulFs;function symlinkType$1(srcpath,type,callback){callback=typeof type==="function"?type:callback;type=typeof type==="function"?false:type;if(type)return callback(null,type);fs$9.lstat(srcpath,(err,stats)=>{if(err)return callback(null,"file");type=stats&&stats.isDirectory()?"dir":"file";callback(null,type);});}function symlinkTypeSync$1(srcpath,type){let stats;if(type)return type;try{stats=fs$9.lstatSync(srcpath);}catch{return "file"}return stats&&stats.isDirectory()?"dir":"file"}var symlinkType_1={symlinkType: symlinkType$1,symlinkTypeSync: symlinkTypeSync$1};

const u$4=universalify$1.fromCallback;const path$5=require$$0__default$1["default"];const fs$8=gracefulFs;const _mkdirs=mkdirs$2;const mkdirs=_mkdirs.mkdirs;const mkdirsSync=_mkdirs.mkdirsSync;const _symlinkPaths=symlinkPaths_1;const symlinkPaths=_symlinkPaths.symlinkPaths;const symlinkPathsSync=_symlinkPaths.symlinkPathsSync;const _symlinkType=symlinkType_1;const symlinkType=_symlinkType.symlinkType;const symlinkTypeSync=_symlinkType.symlinkTypeSync;const pathExists$2=pathExists_1.pathExists;function createSymlink(srcpath,dstpath,type,callback){callback=typeof type==="function"?type:callback;type=typeof type==="function"?false:type;pathExists$2(dstpath,(err,destinationExists)=>{if(err)return callback(err);if(destinationExists)return callback(null);symlinkPaths(srcpath,dstpath,(err,relative)=>{if(err)return callback(err);srcpath=relative.toDst;symlinkType(relative.toCwd,type,(err,type)=>{if(err)return callback(err);const dir=path$5.dirname(dstpath);pathExists$2(dir,(err,dirExists)=>{if(err)return callback(err);if(dirExists)return fs$8.symlink(srcpath,dstpath,type,callback);mkdirs(dir,err=>{if(err)return callback(err);fs$8.symlink(srcpath,dstpath,type,callback);});});});});});}function createSymlinkSync(srcpath,dstpath,type){const destinationExists=fs$8.existsSync(dstpath);if(destinationExists)return undefined;const relative=symlinkPathsSync(srcpath,dstpath);srcpath=relative.toDst;type=symlinkTypeSync(relative.toCwd,type);const dir=path$5.dirname(dstpath);const exists=fs$8.existsSync(dir);if(exists)return fs$8.symlinkSync(srcpath,dstpath,type);mkdirsSync(dir);return fs$8.symlinkSync(srcpath,dstpath,type)}var symlink$1={createSymlink:u$4(createSymlink),createSymlinkSync};

const file=file$1;const link=link$1;const symlink=symlink$1;var ensure={createFile:file.createFile,createFileSync:file.createFileSync,ensureFile:file.createFile,ensureFileSync:file.createFileSync,createLink:link.createLink,createLinkSync:link.createLinkSync,ensureLink:link.createLink,ensureLinkSync:link.createLinkSync,createSymlink:symlink.createSymlink,createSymlinkSync:symlink.createSymlinkSync,ensureSymlink:symlink.createSymlink,ensureSymlinkSync:symlink.createSymlinkSync};

function stringify$4(obj,{EOL="\n",finalEOL=true,replacer=null,spaces}={}){const EOF=finalEOL?EOL:"";const str=JSON.stringify(obj,replacer,spaces);return str.replace(/\n/g,EOL)+EOF}function stripBom$1(content){if(Buffer.isBuffer(content))content=content.toString("utf8");return content.replace(/^\uFEFF/,"")}var utils={stringify: stringify$4,stripBom: stripBom$1};

let _fs;try{_fs=require("graceful-fs");}catch(_){_fs=require$$0__default$3["default"];}const universalify=universalify$1;const{stringify: stringify$3,stripBom}=utils;async function _readFile(file,options={}){if(typeof options==="string"){options={encoding:options};}const fs=options.fs||_fs;const shouldThrow="throws"in options?options.throws:true;let data=await universalify.fromCallback(fs.readFile)(file,options);data=stripBom(data);let obj;try{obj=JSON.parse(data,options?options.reviver:null);}catch(err){if(shouldThrow){err.message=`${file}: ${err.message}`;throw err}else {return null}}return obj}const readFile=universalify.fromPromise(_readFile);function readFileSync(file,options={}){if(typeof options==="string"){options={encoding:options};}const fs=options.fs||_fs;const shouldThrow="throws"in options?options.throws:true;try{let content=fs.readFileSync(file,options);content=stripBom(content);return JSON.parse(content,options.reviver)}catch(err){if(shouldThrow){err.message=`${file}: ${err.message}`;throw err}else {return null}}}async function _writeFile(file,obj,options={}){const fs=options.fs||_fs;const str=stringify$3(obj,options);await universalify.fromCallback(fs.writeFile)(file,str,options);}const writeFile=universalify.fromPromise(_writeFile);function writeFileSync(file,obj,options={}){const fs=options.fs||_fs;const str=stringify$3(obj,options);return fs.writeFileSync(file,str,options)}const jsonfile$1={readFile,readFileSync,writeFile,writeFileSync};var jsonfile_1=jsonfile$1;

const jsonFile$1=jsonfile_1;var jsonfile={readJson:jsonFile$1.readFile,readJsonSync:jsonFile$1.readFileSync,writeJson:jsonFile$1.writeFile,writeJsonSync:jsonFile$1.writeFileSync};

const u$3=universalify$1.fromCallback;const fs$7=gracefulFs;const path$4=require$$0__default$1["default"];const mkdir=mkdirs$2;const pathExists$1=pathExists_1.pathExists;function outputFile$1(file,data,encoding,callback){if(typeof encoding==="function"){callback=encoding;encoding="utf8";}const dir=path$4.dirname(file);pathExists$1(dir,(err,itDoes)=>{if(err)return callback(err);if(itDoes)return fs$7.writeFile(file,data,encoding,callback);mkdir.mkdirs(dir,err=>{if(err)return callback(err);fs$7.writeFile(file,data,encoding,callback);});});}function outputFileSync$1(file,...args){const dir=path$4.dirname(file);if(fs$7.existsSync(dir)){return fs$7.writeFileSync(file,...args)}mkdir.mkdirsSync(dir);fs$7.writeFileSync(file,...args);}var output={outputFile:u$3(outputFile$1),outputFileSync: outputFileSync$1};

const{stringify: stringify$2}=utils;const{outputFile}=output;async function outputJson(file,data,options={}){const str=stringify$2(data,options);await outputFile(file,str,options);}var outputJson_1=outputJson;

const{stringify: stringify$1}=utils;const{outputFileSync}=output;function outputJsonSync(file,data,options){const str=stringify$1(data,options);outputFileSync(file,str,options);}var outputJsonSync_1=outputJsonSync;

const u$2=universalify$1.fromPromise;const jsonFile=jsonfile;jsonFile.outputJson=u$2(outputJson_1);jsonFile.outputJsonSync=outputJsonSync_1;jsonFile.outputJSON=jsonFile.outputJson;jsonFile.outputJSONSync=jsonFile.outputJsonSync;jsonFile.writeJSON=jsonFile.writeJson;jsonFile.writeJSONSync=jsonFile.writeJsonSync;jsonFile.readJSON=jsonFile.readJson;jsonFile.readJSONSync=jsonFile.readJsonSync;var json=jsonFile;

const fs$6=gracefulFs;const path$3=require$$0__default$1["default"];const copySync=copySync$1.copySync;const removeSync=remove$2.removeSync;const mkdirpSync=mkdirs$2.mkdirpSync;const stat$5=stat_1;function moveSync$1(src,dest,opts){opts=opts||{};const overwrite=opts.overwrite||opts.clobber||false;const{srcStat}=stat$5.checkPathsSync(src,dest,"move");stat$5.checkParentPathsSync(src,srcStat,dest,"move");mkdirpSync(path$3.dirname(dest));return doRename$1(src,dest,overwrite)}function doRename$1(src,dest,overwrite){if(overwrite){removeSync(dest);return rename$1(src,dest,overwrite)}if(fs$6.existsSync(dest))throw new Error("dest already exists.");return rename$1(src,dest,overwrite)}function rename$1(src,dest,overwrite){try{fs$6.renameSync(src,dest);}catch(err){if(err.code!=="EXDEV")throw err;return moveAcrossDevice$1(src,dest,overwrite)}}function moveAcrossDevice$1(src,dest,overwrite){const opts={overwrite,errorOnExist:true};copySync(src,dest,opts);return removeSync(src)}var moveSync_1=moveSync$1;

var moveSync={moveSync:moveSync_1};

const fs$5=gracefulFs;const path$2=require$$0__default$1["default"];const copy=copy$1.copy;const remove=remove$2.remove;const mkdirp=mkdirs$2.mkdirp;const pathExists=pathExists_1.pathExists;const stat$4=stat_1;function move$1(src,dest,opts,cb){if(typeof opts==="function"){cb=opts;opts={};}const overwrite=opts.overwrite||opts.clobber||false;stat$4.checkPaths(src,dest,"move",(err,stats)=>{if(err)return cb(err);const{srcStat}=stats;stat$4.checkParentPaths(src,srcStat,dest,"move",err=>{if(err)return cb(err);mkdirp(path$2.dirname(dest),err=>{if(err)return cb(err);return doRename(src,dest,overwrite,cb)});});});}function doRename(src,dest,overwrite,cb){if(overwrite){return remove(dest,err=>{if(err)return cb(err);return rename(src,dest,overwrite,cb)})}pathExists(dest,(err,destExists)=>{if(err)return cb(err);if(destExists)return cb(new Error("dest already exists."));return rename(src,dest,overwrite,cb)});}function rename(src,dest,overwrite,cb){fs$5.rename(src,dest,err=>{if(!err)return cb();if(err.code!=="EXDEV")return cb(err);return moveAcrossDevice(src,dest,overwrite,cb)});}function moveAcrossDevice(src,dest,overwrite,cb){const opts={overwrite,errorOnExist:true};copy(src,dest,opts,err=>{if(err)return cb(err);return remove(src,cb)});}var move_1=move$1;

const u$1=universalify$1.fromCallback;var move={move:u$1(move_1)};

(function(module){module.exports={...fs$m,...copySync$1,...copy$1,...empty,...ensure,...json,...mkdirs$2,...moveSync,...move,...output,...pathExists_1,...remove$2};const fs=require$$0__default$3["default"];if(Object.getOwnPropertyDescriptor(fs,"promises")){Object.defineProperty(module.exports,"promises",{get(){return fs.promises}});}})(lib$1);

var Utils = {};

var clone = {exports: {}};

(function(module){var clone=function(){function _instanceof(obj,type){return type!=null&&obj instanceof type}var nativeMap;try{nativeMap=Map;}catch(_){nativeMap=function(){};}var nativeSet;try{nativeSet=Set;}catch(_){nativeSet=function(){};}var nativePromise;try{nativePromise=Promise;}catch(_){nativePromise=function(){};}function clone(parent,circular,depth,prototype,includeNonEnumerable){if(typeof circular==="object"){depth=circular.depth;prototype=circular.prototype;includeNonEnumerable=circular.includeNonEnumerable;circular=circular.circular;}var allParents=[];var allChildren=[];var useBuffer=typeof Buffer!="undefined";if(typeof circular=="undefined")circular=true;if(typeof depth=="undefined")depth=Infinity;function _clone(parent,depth){if(parent===null)return null;if(depth===0)return parent;var child;var proto;if(typeof parent!="object"){return parent}if(_instanceof(parent,nativeMap)){child=new nativeMap;}else if(_instanceof(parent,nativeSet)){child=new nativeSet;}else if(_instanceof(parent,nativePromise)){child=new nativePromise(function(resolve,reject){parent.then(function(value){resolve(_clone(value,depth-1));},function(err){reject(_clone(err,depth-1));});});}else if(clone.__isArray(parent)){child=[];}else if(clone.__isRegExp(parent)){child=new RegExp(parent.source,__getRegExpFlags(parent));if(parent.lastIndex)child.lastIndex=parent.lastIndex;}else if(clone.__isDate(parent)){child=new Date(parent.getTime());}else if(useBuffer&&Buffer.isBuffer(parent)){if(Buffer.allocUnsafe){child=Buffer.allocUnsafe(parent.length);}else {child=new Buffer(parent.length);}parent.copy(child);return child}else if(_instanceof(parent,Error)){child=Object.create(parent);}else {if(typeof prototype=="undefined"){proto=Object.getPrototypeOf(parent);child=Object.create(proto);}else {child=Object.create(prototype);proto=prototype;}}if(circular){var index=allParents.indexOf(parent);if(index!=-1){return allChildren[index]}allParents.push(parent);allChildren.push(child);}if(_instanceof(parent,nativeMap)){parent.forEach(function(value,key){var keyChild=_clone(key,depth-1);var valueChild=_clone(value,depth-1);child.set(keyChild,valueChild);});}if(_instanceof(parent,nativeSet)){parent.forEach(function(value){var entryChild=_clone(value,depth-1);child.add(entryChild);});}for(var i in parent){var attrs;if(proto){attrs=Object.getOwnPropertyDescriptor(proto,i);}if(attrs&&attrs.set==null){continue}child[i]=_clone(parent[i],depth-1);}if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(parent);for(var i=0;i<symbols.length;i++){var symbol=symbols[i];var descriptor=Object.getOwnPropertyDescriptor(parent,symbol);if(descriptor&&!descriptor.enumerable&&!includeNonEnumerable){continue}child[symbol]=_clone(parent[symbol],depth-1);if(!descriptor.enumerable){Object.defineProperty(child,symbol,{enumerable:false});}}}if(includeNonEnumerable){var allPropertyNames=Object.getOwnPropertyNames(parent);for(var i=0;i<allPropertyNames.length;i++){var propertyName=allPropertyNames[i];var descriptor=Object.getOwnPropertyDescriptor(parent,propertyName);if(descriptor&&descriptor.enumerable){continue}child[propertyName]=_clone(parent[propertyName],depth-1);Object.defineProperty(child,propertyName,{enumerable:false});}}return child}return _clone(parent,depth)}clone.clonePrototype=function clonePrototype(parent){if(parent===null)return null;var c=function(){};c.prototype=parent;return new c};function __objToStr(o){return Object.prototype.toString.call(o)}clone.__objToStr=__objToStr;function __isDate(o){return typeof o==="object"&&__objToStr(o)==="[object Date]"}clone.__isDate=__isDate;function __isArray(o){return typeof o==="object"&&__objToStr(o)==="[object Array]"}clone.__isArray=__isArray;function __isRegExp(o){return typeof o==="object"&&__objToStr(o)==="[object RegExp]"}clone.__isRegExp=__isRegExp;function __getRegExpFlags(re){var flags="";if(re.global)flags+="g";if(re.ignoreCase)flags+="i";if(re.multiline)flags+="m";return flags}clone.__getRegExpFlags=__getRegExpFlags;return clone}();if(module.exports){module.exports=clone;}})(clone);

const e=["end of source","identifier","number","bigInt","string","regular expression","false","true","null","template continuation","template end","=>","(","{",".","...","}",")",";",",","[","]",":","?","??","?.","'","\"","++","--","=","<<=",">>=",">>>=","**=","+=","-=","*=","/=","%=","^=","|=","&=","||=","&&=","??=","typeof","delete","void","!","~","+","-","in","instanceof","*","%","/","**","&&","||","===","!==","==","!=","<=",">=","<",">","<<",">>",">>>","&","|","^","var","let","const","break","case","catch","class","continue","debugger","default","do","else","export","extends","finally","for","function","if","import","new","return","super","switch","this","throw","try","while","with","implements","interface","package","private","protected","public","static","yield","as","async","await","constructor","get","set","from","of","enum","target","meta","WhiteSpace","CarriageReturn","LineFeed","Unknown"];let n=function(){let e=[],n=0,t=8;function r(o,a){var s=i(o,t);if(!(c=e[s])){var c=[];e[s]=c;}for(var u,l=!1,d=0;d<c.length;d++){var f=c[d];f[0]===o&&(f[1]=a,l=!0);}l||(c.push([o,a]),n++,n>.75*t&&(u=e,t=2*t,n=0,e=[],u.forEach(function(e){if(e)for(var n=0;n<e.length;n++){var t=e[n];r(t[0],t[1]);}})));}function i(e,n){for(var t=0,r=0;r<e.length;r++){t=((t=(t<<5)+e[r].charCodeAt(0))&t)%n;}return t}return {get:function(n){var r=i(n,t),o=e[r];if(!o)return null;for(var a=0;a<o.length;a++){var s=o[a];if(s[0]===n)return s[1]}return null},insert:r}}();n.insert("this",134226018),n.insert("function",201334875),n.insert("if",201330780),n.insert("return",201330783),n.insert("var",671092811),n.insert("else",134217814),n.insert("for",201330778),n.insert("new",134221918),n.insert("in",135014453),n.insert("typeof",134225966),n.insert("while",201330789),n.insert("case",402653263),n.insert("break",201330766),n.insert("try",201330788),n.insert("catch",134221904),n.insert("delete",134225967),n.insert("throw",201330787),n.insert("switch",201330785),n.insert("continue",201330770),n.insert("default",402653268),n.insert("instanceof",134490166),n.insert("do",201330773),n.insert("void",134225968),n.insert("finally",201330777),n.insert("async",67182704),n.insert("await",73841),n.insert("class",201334865),n.insert("const",671092813),n.insert("constructor",65650),n.insert("debugger",201330771),n.insert("export",134221911),n.insert("extends",134217816),n.insert("false",151003142),n.insert("from",65653),n.insert("get",65651),n.insert("implements",1048679),n.insert("import",201334877),n.insert("interface",1048680),n.insert("let",537923660),n.insert("null",151003144),n.insert("of",589942),n.insert("package",1048681),n.insert("private",1048682),n.insert("protected",1048683),n.insert("public",1048684),n.insert("set",65652),n.insert("static",1048685),n.insert("super",134226016),n.insert("true",151003143),n.insert("with",201330790),n.insert("yield",1056878),n.insert("as",65647),n.insert("enum",134217847),n.insert("target",65655),n.insert("meta",65656);const t={0:"Unexpected token",6:"Unexpected token - `%0`",1:"Unexpected keyword",2:"Unexpected identifier",3:"Unexpected end of input",4:"Identifier expected",5:"`%0` expected",7:"Expression expected",8:"Statement expected",9:"Invalid character",10:"Function declaration require a name in this context",11:"Class declaration require a name in this context",12:"Unterminated regular expression",13:"Duplicate regular expression flag",14:"Unknown regular expression flag",15:"Parameter declaration expected",16:"Lexical binding expected",116:"Variable declaration expected",17:"For declaration expected",46:"`=>` expected",18:"Unexpected reserved word in strict mode",19:"Expected an binding identifier",20:"Expected an identifier",21:"Unexpected `yield` as identifier in this context",22:"Unexpected `await` as identifier in this context",90:"Unexpected `yield` as binding identifier in this context",91:"Unexpected `await` as binding identifier in this context",23:"`Await` expression cannot be used in function parameters",24:"`Yield` expression cannot be used in function parameters",25:"Line break not allowed after `throw`",142:"B.3.4 FunctionDeclarations in IfStatement Statement Clauses",141:"B.3.2 Labelled Function Declarations",26:"A `return` statement can only be used within a function body.",27:"Cannot compound-assign to an array or object literal",29:"Import declaration expected",30:"Export declaration expected",36:"`:` expected",37:"`yield` may not be used as an identifier in this context",38:"`await` may not be used as an identifier in this context",32:"Calls to super must be in the \"constructor\" method of a class expression or class declaration that has a super class",31:"Member access on super must be in a method",33:"Optional chain disallowed in super property",34:"Unary expressions as the left operand of an exponentation expression must be disambiguated with parentheses",35:"Calling delete on expression not allowed in strict mode",39:"Unexpected token. A accessor was expected",40:"Classes may not have a static property named prototype",41:"A `break` statement can only be used within an enclosing iteration or switch",42:"A `continue` statement can only be used within an enclosing iteration statement",43:"A `with` statements are not allowed in strict mode",45:"Missing initializer in destructuring declaration",44:"Coalescing and logical operators used together in the same expression must be disambiguated with parentheses",47:"Invalid lower surrogate '%0'",51:"Invalid astral character '%0'",48:"Invalid Unicode escape sequence",50:"Invalid hexadecimal escape sequence",52:"Unterminated template literal",127:"Incomplete Directive Prologue",49:"Unicode codepoint must not be greater than 0x10FFFF",53:"Unsupported unicode escape in identifier escapes start",54:"Bad escape sequence in untagged template literal",55:"Unterminated string literal",56:"Octal escape sequences are not allowed in strict mode",57:"Escapes \\8 or \\9 are not syntactically valid escapes",58:"An identifier or keyword cannot immediately follow a numeric literal",67:"Octal literals are not allowed in strict mode",65:"Binary integer literal like sequence containing an invalid digit",66:"Octal integer literal like sequence containing an invalid digit",62:"Binary integer literal like sequence without any digits",63:"Octal integer literal like sequence without any digits",64:"Hex integer literal like sequence without any digits",59:"Non-number after exponent indicator",68:"Unknown digit",60:"Invalid BigInt syntax",72:"Numeric separators not allowed here",69:"Multiple consecutive numeric separators are not permitted",70:"Numeric separators are not allowed at the end of numeric literals",71:"Numeric separator can not be used after leading 0",73:"Identifier \"let\" disallowed as left-hand side expression in strict mode",74:"The left-hand side of a for-of loop may not start with 'let'",75:"In strict mode code or without web compability enabled, functions can only be declared at top level or inside a block",77:"In non-strict mode code, functions can only be declared at top level, inside a block, or as the body of an if statement",78:"Class declaration can't appear in single-statement context",76:"Without web compability enabled functions can not be declared at top level, inside a block, or as the body of an if statement",79:"Async functions can only be declared at the top level or inside a block",80:"Invalid optional chain in tagged template",83:"Block body arrows can not be immediately invoked without a group",81:"Block body arrows can not be immediately accessed without a group",84:"Block body arrows can not be immediately tagged without a group",82:"An arrow function can not be part of an operator to the right",86:"`*/` expected",87:"A lexical declaration can not define a `let` binding",85:"The identifier `let` must not be in expression position in strict mode",88:"`yield` can not be used as a function name in this context",89:"`await` can not be used as a function name in this context",92:"`;` expected",93:"`%0` is not a valid meta-property for keyword `new`.",94:"The `export` keyword can only be used with the module goal",95:"The `import` keyword can only be used with the module goal",96:"Invalid destruct",97:"The left-hand side of an assignment expression must be a variable or a property access",98:"Invalid left-hand side expression in prefix operation",99:"Invalid left-hand side expression in postfix operation",100:"`=` can only be used in an object literal property inside a destructuring ",101:"Forbidden trailing comma",102:"Invalid shorthand property initializer",103:"The left-hand side of an arrow function can only be destructed through assignment",104:"Invalid left-hand side in for-loop",105:"A rest parameter or binding pattern may not have a trailing comma",106:"A rest element cannot have an initializer",107:"A rest element must be last in destructuring pattern",108:"A rest element must be last in a parameter list",109:"The left-hand side of a `for...in` statement must be a variable or a property access.",110:"The left-hand side of a `for...of` statement must be a variable or a property access.",112:"The left-hand side of a `for...in` statement cannot be a destructuring pattern",113:"The left-hand side of a `for...of` statement cannot be a destructuring pattern",115:"Only a single for declaration is allowed in a `for...in` statement",114:"Only a single for declaration is allowed in a `for...of` statement",111:"Lexical declaration cannot appear in a single-statement context",117:"Cannot redeclare block-scoped variable %0",118:"Duplicate identifier %0",119:"Lexical binding %0 shadows a catch clause binding",120:"Missing catch or finally after try",121:"A getter cannot be a generator",122:"`%0` already bound as a catch clause binding",125:"`%0` shadows a catch clause binding",123:"Duplicate lexical binding `%0`",124:"Duplicate binding `%0`",126:"Unknown label `%0`",128:"A `default` clause cannot appear more than once in a `switch` statement",129:"Invalid optional chain from new expression",130:"Invalid line break after async arrow",131:"Invalid use of keyword as an identifier",132:"A labelled function declaration can not be a generator",133:"String literal expected",134:"Cannot redeclare exported variable `%0`",135:"Exported binding `%0` needs to refer to a top-level declared variable",136:"`super` must be followed by an argument list or member access",137:"Redefinition of `__proto__` property",138:"A `get` cannot have parameters",140:"Illegal `use strict` directive in function with non-simple parameter list",139:"Function name may not contain any reserved words or be eval or arguments in strict mode"};function r(e,n,t,r){if(t.scopeError){const i=t.scopeError;c(e,n,2,r,3,i.start,e.index,i.name);}}function i(e,n,t,r,...i){c(e,n,2,r,3,t,e.index,...i);}function o(e,n,t,r,i,...o){c(e,n,0,i,2,t,r,...o);}function a(e,n,t,...r){c(e,n,2,t,3,e.tokenIndex,e.index,...r);}function s$1(e,n,t,r,i,...o){c(e,n,t,r,i,e.tokenIndex,e.index,...o);}function c(e,n,r,i,o,a,s,...c){let l=t[i];arguments.length>4&&(l=u(l,c));const d=q(e.diagnostics),f=s-a;if(0==(33554432&n))throw new SyntaxError(`line:${e.line}, column:${e.tokenIndex-e.columnOffset} - ${l}`);d&&a===d.start||e.diagnostics.push({kind:o,source:r,message:l,code:i,start:a,length:f});}function u(e,n){return e.replace(/%(\d+)/g,(e,t)=>n[t])}const l=[0,0,0,0,0,0,0,0,0,0,64,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,146,146,146,146,146,146,146,146,146,146,0,0,0,0,0,0,0,131,387,131,131,131,131,3,3,3,3,3,3,3,3,259,3,3,3,3,3,3,3,3,259,3,3,0,1,0,0,35,0,131,387,131,131,131,131,3,3,3,3,3,3,3,259,259,3,3,3,3,3,3,3,3,259,3,3,0,0,0,0,0],d$1=((e,n)=>{const t=new Uint32Array(208896);let r=0,i=0;for(;r<4799;){const o=e[r++];if(o<0)i-=o;else {let a=e[r++];2&o&&(a=n[a]),1&o?t.fill(a,i,i+=e[r++]):t[i++]=a;}}return t})([-1,2,24,2,25,2,5,-1,2,204,3,44,2,3,0,14,2,57,2,58,3,0,3,2,205,2,206,2,1,2,0,2,59,3,0,4,2,207,3,0,4,2,16,2,60,2,0,2,208,2,209,2,210,2,61,2,211,3,0,2,2,212,3,0,2,2,213,2,214,2,17,2,0,2,215,3,0,2,2,19,2,0,2,216,2,0,2,131,2,6,2,56,-1,2,37,2,217,2,1,3,0,3,2,218,2,39,2,219,2,220,2,221,2,222,2,223,2,224,2,225,2,226,2,2,2,227,2,228,2,229,2,2,2,230,2,231,2,232,2,233,2,234,2,194,2,3,2,235,2,236,2,237,2,238,2,239,2,240,2,241,2,3,2,0,2,242,2,243,2,244,2,66,2,245,2,246,2,4,2,11,2,247,-1,2,67,2,248,2,249,-1,2,250,2,251,2,32,2,252,2,253,2,18,2,129,-1,3,0,2,2,21,2,0,2,9,2,0,2,14,2,15,3,0,10,2,69,2,0,2,70,2,71,2,72,2,0,2,73,2,0,2,10,2,254,2,23,3,0,2,2,12,2,4,3,0,18,2,74,2,5,3,0,2,2,75,2,255,2,27,2,8,2,256,3,0,2,2,257,2,41,2,258,3,0,2,2,40,2,0,2,28,2,0,2,29,2,7,2,259,2,26,2,49,2,0,2,76,2,260,-1,2,6,2,0,2,7,2,261,2,262,2,263,0,1,-1,3,0,2,2,42,2,264,3,0,3,2,8,2,0,2,51,2,265,2,9,2,38,2,10,2,266,2,11,3,0,7,2,267,3,0,8,2,12,2,0,2,78,2,9,2,0,2,79,2,80,2,81,-1,2,124,2,268,2,82,2,13,-1,2,13,2,269,2,83,2,84,2,85,2,0,2,33,-83,2,0,2,53,2,7,3,0,4,2,270,2,0,2,14,2,0,2,271,2,20,3,86,2,2,0,-16,2,87,2,272,2,4,2,0,2,273,2,4,2,0,2,15,2,77,2,16,3,0,2,2,47,2,0,-1,2,17,-16,3,0,206,-2,3,0,655,2,18,3,0,36,2,68,-1,2,17,2,9,3,0,8,2,89,2,121,2,0,2,274,3,0,3,2,19,2,90,2,91,3,0,2,2,92,2,0,2,93,2,94,2,0,2,275,2,0,2,8,3,0,2,2,276,2,277,2,0,2,22,2,8,2,18,3,0,2,2,278,2,7,2,0,2,20,2,279,2,280,3,0,2,2,281,2,282,2,97,2,98,2,15,2,21,3,0,3,2,283,3,0,349,2,99,2,100,2,6,-264,3,0,11,2,22,3,0,2,2,31,-1,2,284,2,101,2,102,3,0,2,2,19,2,103,3,0,10,2,9,2,17,2,0,2,45,2,0,2,30,2,104,2,23,2,285,2,172,2,105,3,0,3,2,18,2,24,2,25,2,5,2,26,2,0,2,7,2,106,-1,2,107,2,108,2,109,-1,3,0,3,2,11,-2,2,0,2,27,-3,2,150,-4,2,18,2,0,2,35,0,1,2,0,2,62,2,28,2,11,2,9,2,0,2,110,-1,3,0,4,2,9,2,21,2,111,2,6,2,0,2,112,2,0,2,48,-4,3,0,9,2,20,2,29,2,30,-4,2,113,2,114,2,29,2,20,2,7,-2,2,115,2,29,2,31,-2,2,0,2,116,-2,2,286,2,287,-1,3,18,2,-1,2,32,2,36,2,0,3,29,2,2,34,2,19,-3,3,0,2,2,33,-1,2,0,2,34,2,0,2,34,2,0,2,46,-10,2,0,2,288,-2,2,18,2,43,2,35,-2,2,17,2,117,2,20,3,0,2,2,36,2,289,2,0,2,11,2,17,2,135,2,0,2,37,2,52,2,290,3,0,2,2,291,-1,2,120,2,292,-2,2,122,2,38,2,0,2,293,2,39,2,294,2,295,2,296,-4,3,0,2,2,297,0,3,3,0,2,2,298,-5,2,0,2,299,2,300,-1,3,0,2,2,301,-1,2,0,2,40,2,41,-1,2,10,2,42,-6,2,0,2,11,-3,3,0,2,2,302,2,125,2,303,2,50,-2,2,126,2,304,2,305,2,0,2,7,2,43,2,0,2,63,-1,2,0,2,40,-8,2,54,2,44,2,306,2,127,2,45,2,307,-2,2,128,2,308,2,46,2,130,2,309,2,41,-9,2,20,-5,2,64,-2,3,0,28,2,31,-3,3,0,3,2,47,3,0,6,2,48,-85,3,0,33,2,47,-126,3,0,18,2,36,-269,3,0,17,2,40,2,7,2,41,-2,2,17,2,49,2,0,2,20,2,50,2,132,2,23,-21,3,0,2,-4,3,0,2,2,310,2,0,2,311,-2,2,312,3,0,191,2,51,3,0,38,2,29,-1,2,33,-279,3,0,8,2,7,-1,2,133,2,52,3,0,11,2,6,-72,3,0,3,2,134,2,313,-166,2,314,2,315,2,316,-4,2,317,-13,3,0,2,2,37,2,0,2,136,2,137,2,55,2,0,2,138,2,139,2,140,3,0,10,2,141,2,142,2,15,3,37,2,3,53,2,3,54,2,2,318,2,0,-16,2,0,2,88,2,0,2,319,2,320,2,321,-42,2,322,2,323,-6,2,0,2,324,2,325,-11,2,0,2,31,-40,3,0,6,2,326,-1,3,0,2,2,42,-37,2,55,2,144,2,145,2,146,2,147,2,148,-105,2,24,-32,3,0,1334,2,9,-1,3,0,129,2,27,3,0,6,2,9,3,0,180,2,149,3,0,233,0,1,-96,3,0,16,2,9,-47,3,0,154,2,56,-22381,3,0,7,2,23,-6130,3,5,2,-1,0,69207040,3,44,2,3,0,14,2,57,2,58,-3,0,3168731136,0,4294956864,2,1,2,0,2,59,3,0,4,0,4294966275,3,0,4,2,16,2,60,2,0,2,33,-1,2,17,2,61,-1,2,0,2,56,0,4294885376,3,0,2,0,3145727,0,2617294944,0,4294770688,2,23,2,62,3,0,2,0,131135,2,95,0,70256639,0,71303167,0,272,2,40,2,56,-1,2,37,2,30,-1,2,96,2,63,0,4278255616,0,4294836227,0,4294549473,0,600178175,0,2952806400,0,268632067,0,4294543328,0,57540095,0,1577058304,0,1835008,0,4294688736,2,65,2,64,0,33554435,2,123,2,65,2,151,0,131075,0,3594373096,0,67094296,2,64,-1,0,4294828e3,0,603979263,2,160,0,3,0,4294828001,0,602930687,2,183,0,393219,0,4294828016,0,671088639,0,2154840064,0,4227858435,0,4236247008,2,66,2,36,-1,2,4,0,917503,2,36,-1,2,67,0,537788335,0,4026531935,-1,0,1,-1,2,32,2,68,0,7936,-3,2,0,0,2147485695,0,1010761728,0,4292984930,0,16387,2,0,2,14,2,15,3,0,10,2,69,2,0,2,70,2,71,2,72,2,0,2,73,2,0,2,11,-1,2,23,3,0,2,2,12,2,4,3,0,18,2,74,2,5,3,0,2,2,75,0,253951,3,19,2,0,122879,2,0,2,8,0,276824064,-2,3,0,2,2,40,2,0,0,4294903295,2,0,2,29,2,7,-1,2,17,2,49,2,0,2,76,2,41,-1,2,20,2,0,2,27,-2,0,128,-2,2,77,2,8,0,4064,-1,2,119,0,4227907585,2,0,2,118,2,0,2,48,2,173,2,9,2,38,2,10,-1,0,74440192,3,0,6,-2,3,0,8,2,12,2,0,2,78,2,9,2,0,2,79,2,80,2,81,-3,2,82,2,13,-3,2,83,2,84,2,85,2,0,2,33,-83,2,0,2,53,2,7,3,0,4,0,817183,2,0,2,14,2,0,0,33023,2,20,3,86,2,-17,2,87,0,524157950,2,4,2,0,2,88,2,4,2,0,2,15,2,77,2,16,3,0,2,2,47,2,0,-1,2,17,-16,3,0,206,-2,3,0,655,2,18,3,0,36,2,68,-1,2,17,2,9,3,0,8,2,89,0,3072,2,0,0,2147516415,2,9,3,0,2,2,23,2,90,2,91,3,0,2,2,92,2,0,2,93,2,94,0,4294965179,0,7,2,0,2,8,2,91,2,8,-1,0,1761345536,2,95,0,4294901823,2,36,2,18,2,96,2,34,2,166,0,2080440287,2,0,2,33,2,143,0,3296722943,2,0,0,1046675455,0,939524101,0,1837055,2,97,2,98,2,15,2,21,3,0,3,0,7,3,0,349,2,99,2,100,2,6,-264,3,0,11,2,22,3,0,2,2,31,-1,0,2700607615,2,101,2,102,3,0,2,2,19,2,103,3,0,10,2,9,2,17,2,0,2,45,2,0,2,30,2,104,-3,2,105,3,0,3,2,18,-1,3,5,2,2,26,2,0,2,7,2,106,-1,2,107,2,108,2,109,-1,3,0,3,2,11,-2,2,0,2,27,-8,2,18,2,0,2,35,-1,2,0,2,62,2,28,2,29,2,9,2,0,2,110,-1,3,0,4,2,9,2,17,2,111,2,6,2,0,2,112,2,0,2,48,-4,3,0,9,2,20,2,29,2,30,-4,2,113,2,114,2,29,2,20,2,7,-2,2,115,2,29,2,31,-2,2,0,2,116,-2,0,4277075969,2,29,-1,3,18,2,-1,2,32,2,117,2,0,3,29,2,2,34,2,19,-3,3,0,2,2,33,-1,2,0,2,34,2,0,2,34,2,0,2,48,-10,2,0,0,197631,-2,2,18,2,43,2,118,-2,2,17,2,117,2,20,2,119,2,51,-2,2,119,2,23,2,17,2,33,2,119,2,36,0,4294901904,0,4718591,2,119,2,34,0,335544350,-1,2,120,2,121,-2,2,122,2,38,2,7,-1,2,123,2,65,0,3758161920,0,3,-4,2,0,2,27,0,2147485568,0,3,2,0,2,23,0,176,-5,2,0,2,47,2,186,-1,2,0,2,23,2,197,-1,2,0,0,16779263,-2,2,11,-7,2,0,2,121,-3,3,0,2,2,124,2,125,0,2147549183,0,2,-2,2,126,2,35,0,10,0,4294965249,0,67633151,0,4026597376,2,0,0,536871935,-1,2,0,2,40,-8,2,54,2,47,0,1,2,127,2,23,-3,2,128,2,35,2,129,2,130,0,16778239,-10,2,34,-5,2,64,-2,3,0,28,2,31,-3,3,0,3,2,47,3,0,6,2,48,-85,3,0,33,2,47,-126,3,0,18,2,36,-269,3,0,17,2,40,2,7,-3,2,17,2,131,2,0,2,23,2,48,2,132,2,23,-21,3,0,2,-4,3,0,2,0,67583,-1,2,103,-2,0,11,3,0,191,2,51,3,0,38,2,29,-1,2,33,-279,3,0,8,2,7,-1,2,133,2,52,3,0,11,2,6,-72,3,0,3,2,134,2,135,-187,3,0,2,2,37,2,0,2,136,2,137,2,55,2,0,2,138,2,139,2,140,3,0,10,2,141,2,142,2,15,3,37,2,3,53,2,3,54,2,2,143,-73,2,0,0,1065361407,0,16384,-11,2,0,2,121,-40,3,0,6,2,117,-1,3,0,2,0,2063,-37,2,55,2,144,2,145,2,146,2,147,2,148,-138,3,0,1334,2,9,-1,3,0,129,2,27,3,0,6,2,9,3,0,180,2,149,3,0,233,0,1,-96,3,0,16,2,9,-47,3,0,154,2,56,-28517,2,0,0,1,-1,2,124,2,0,0,8193,-21,2,193,0,10255,0,4,-11,2,64,2,171,-1,0,71680,-1,2,161,0,4292900864,0,805306431,-5,2,150,-1,2,157,-1,0,6144,-2,2,127,-1,2,154,-1,0,2147532800,2,151,2,165,2,0,2,164,0,524032,0,4,-4,2,190,0,205128192,0,1333757536,0,2147483696,0,423953,0,747766272,0,2717763192,0,4286578751,0,278545,2,152,0,4294886464,0,33292336,0,417809,2,152,0,1327482464,0,4278190128,0,700594195,0,1006647527,0,4286497336,0,4160749631,2,153,0,469762560,0,4171219488,0,8323120,2,153,0,202375680,0,3214918176,0,4294508592,2,153,-1,0,983584,0,48,0,58720273,0,3489923072,0,10517376,0,4293066815,0,1,0,2013265920,2,177,2,0,0,2089,0,3221225552,0,201375904,2,0,-2,0,256,0,122880,0,16777216,2,150,0,4160757760,2,0,-6,2,167,-11,0,3263218176,-1,0,49664,0,2160197632,0,8388802,-1,0,12713984,-1,2,154,2,159,2,178,-2,2,162,-20,0,3758096385,-2,2,155,0,4292878336,2,90,2,169,0,4294057984,-2,2,163,2,156,2,175,-2,2,155,-1,2,182,-1,2,170,2,124,0,4026593280,0,14,0,4292919296,-1,2,158,0,939588608,-1,0,805306368,-1,2,124,0,1610612736,2,156,2,157,2,4,2,0,-2,2,158,2,159,-3,0,267386880,-1,2,160,0,7168,-1,0,65024,2,154,2,161,2,179,-7,2,168,-8,2,162,-1,0,1426112704,2,163,-1,2,164,0,271581216,0,2149777408,2,23,2,161,2,124,0,851967,2,180,-1,2,23,2,181,-4,2,158,-20,2,195,2,165,-56,0,3145728,2,185,-4,2,166,2,124,-4,0,32505856,-1,2,167,-1,0,2147385088,2,90,1,2155905152,2,-3,2,103,2,0,2,168,-2,2,169,-6,2,170,0,4026597375,0,1,-1,0,1,-1,2,171,-3,2,117,2,64,-2,2,166,-2,2,176,2,124,-878,2,159,-36,2,172,-1,2,201,-10,2,188,-5,2,174,-6,0,4294965251,2,27,-1,2,173,-1,2,174,-2,0,4227874752,-3,0,2146435072,2,159,-2,0,1006649344,2,124,-1,2,90,0,201375744,-3,0,134217720,2,90,0,4286677377,0,32896,-1,2,158,-3,2,175,-349,2,176,0,1920,2,177,3,0,264,-11,2,157,-2,2,178,2,0,0,520617856,0,2692743168,0,36,-3,0,524284,-11,2,23,-1,2,187,-1,2,184,0,3221291007,2,178,-1,2,202,0,2158720,-3,2,159,0,1,-4,2,124,0,3808625411,0,3489628288,2,200,0,1207959680,0,3221274624,2,0,-3,2,179,0,120,0,7340032,-2,2,180,2,4,2,23,2,163,3,0,4,2,159,-1,2,181,2,177,-1,0,8176,2,182,2,179,2,183,-1,0,4290773232,2,0,-4,2,163,2,189,0,15728640,2,177,-1,2,161,-1,0,4294934512,3,0,4,-9,2,90,2,170,2,184,3,0,4,0,704,0,1849688064,2,185,-1,2,124,0,4294901887,2,0,0,130547712,0,1879048192,2,199,3,0,2,-1,2,186,2,187,-1,0,17829776,0,2025848832,0,4261477888,-2,2,0,-1,0,4286580608,-1,0,29360128,2,192,0,16252928,0,3791388672,2,38,3,0,2,-2,2,196,2,0,-1,2,103,-1,0,66584576,-1,2,191,3,0,9,2,124,-1,0,4294755328,3,0,2,-1,2,161,2,178,3,0,2,2,23,2,188,2,90,-2,0,245760,0,2147418112,-1,2,150,2,203,0,4227923456,-1,2,164,2,161,2,90,-3,0,4292870145,0,262144,2,124,3,0,2,0,1073758848,2,189,-1,0,4227921920,2,190,0,68289024,0,528402016,0,4292927536,3,0,4,-2,0,268435456,2,91,-2,2,191,3,0,5,-1,2,192,2,163,2,0,-2,0,4227923936,2,62,-1,2,155,2,95,2,0,2,154,2,158,3,0,6,-1,2,177,3,0,3,-2,0,2146959360,0,9440640,0,104857600,0,4227923840,3,0,2,2,327,2,193,2,77,-2,2,161,-2,2,119,-1,2,155,3,0,8,0,512,0,8388608,2,194,2,172,2,187,0,4286578944,3,0,2,0,1152,0,1266679808,2,191,0,576,0,4261707776,2,95,3,0,9,2,155,3,0,5,2,16,-1,0,2147221504,-28,2,178,3,0,3,-3,0,4292902912,-6,2,96,3,0,85,-33,0,4294934528,3,0,126,-18,2,195,3,0,269,-17,2,155,2,124,2,198,3,0,2,2,23,0,4290822144,-2,0,67174336,0,520093700,2,17,3,0,21,-2,2,179,3,0,3,-2,0,30720,-1,0,32512,3,0,2,0,4294770656,-191,2,174,-38,2,170,2,0,2,196,3,0,279,-8,2,124,2,0,0,4294508543,0,65295,-11,2,177,3,0,72,-3,0,3758159872,0,201391616,3,0,155,-7,2,170,-1,0,384,-1,0,133693440,-3,2,196,-2,2,26,3,0,4,2,169,-2,2,90,2,155,3,0,4,-2,2,164,-1,2,150,0,335552923,2,197,-1,0,538974272,0,2214592512,0,132e3,-10,0,192,-8,0,12288,-21,0,134213632,0,4294901761,3,0,42,0,100663424,0,4294965284,3,0,6,-1,0,3221282816,2,198,3,0,11,-1,2,199,3,0,40,-6,0,4286578784,2,0,-2,0,1006694400,3,0,24,2,35,-1,2,94,3,0,2,0,1,2,163,3,0,6,2,197,0,4110942569,0,1432950139,0,2701658217,0,4026532864,0,4026532881,2,0,2,45,3,0,8,-1,2,158,-2,2,169,0,98304,0,65537,2,170,-5,0,4294950912,2,0,2,118,0,65528,2,177,0,4294770176,2,26,3,0,4,-30,2,174,0,3758153728,-3,2,169,-2,2,155,2,188,2,158,-1,2,191,-1,2,161,0,4294754304,3,0,2,-3,0,33554432,-2,2,200,-3,2,169,0,4175478784,2,201,0,4286643712,0,4286644216,2,0,-4,2,202,-1,2,165,0,4227923967,3,0,32,-1334,2,163,2,0,-129,2,94,-6,2,163,-180,2,203,-233,2,4,3,0,96,-16,2,163,3,0,47,-154,2,165,3,0,22381,-7,2,17,3,0,6128,-1,2,24,2,25,2,5,-1,2,204,3,44,2,3,0,14,2,57,2,58,3,0,3,2,205,2,206,2,1,2,0,2,59,3,0,4,2,207,3,0,4,2,16,2,60,2,0,2,208,2,209,2,210,2,61,2,211,3,0,2,2,212,3,0,2,2,213,2,214,2,17,2,0,2,215,3,0,2,2,19,2,0,2,216,2,0,2,131,2,6,2,56,-1,2,37,2,217,2,1,3,0,3,2,218,2,39,2,219,2,220,2,221,2,222,2,223,2,224,2,225,2,226,2,2,2,227,2,228,2,229,2,2,2,230,2,231,2,232,2,233,2,234,2,194,2,3,2,235,2,236,2,237,2,238,2,239,2,240,2,241,2,3,2,0,2,242,2,243,2,244,2,66,2,245,2,246,2,4,2,11,2,247,-1,2,67,2,248,2,249,-1,2,250,2,251,2,32,2,252,2,253,2,18,2,129,-1,3,0,2,2,21,2,0,2,9,2,0,2,14,2,15,3,0,10,2,69,2,0,2,70,2,71,2,72,2,0,2,73,2,0,2,10,2,254,2,23,3,0,2,2,12,2,4,3,0,18,2,74,2,5,3,0,2,2,75,2,255,2,27,2,8,2,256,3,0,2,2,257,2,41,2,258,3,0,2,2,40,2,0,2,28,2,0,2,29,2,7,2,259,2,26,2,49,2,0,2,76,2,260,-1,2,6,2,0,2,7,2,261,2,262,2,263,0,1,-1,3,0,2,2,42,2,264,3,0,3,2,8,2,0,2,51,2,265,2,9,2,38,2,10,2,266,2,11,3,0,7,2,267,3,0,8,2,12,2,0,2,78,2,9,2,0,2,79,2,80,2,81,2,200,2,124,2,268,2,82,2,13,-1,2,13,2,269,2,83,2,84,2,85,2,0,2,33,-83,2,0,2,53,2,7,3,0,4,2,270,2,0,2,14,2,0,2,271,2,20,3,86,2,2,0,-16,2,87,2,272,2,4,2,0,2,273,2,4,2,0,2,15,2,77,2,16,3,0,2,2,47,2,0,-1,2,17,-16,3,0,206,-2,3,0,655,2,18,3,0,36,2,68,-1,2,17,2,9,3,0,8,2,89,2,121,2,0,2,274,3,0,3,2,19,2,90,2,91,3,0,2,2,92,2,0,2,93,2,94,2,0,2,275,2,0,2,8,3,0,2,2,276,2,277,2,0,2,22,2,8,2,18,3,0,2,2,278,2,7,2,0,2,20,2,279,2,280,3,0,2,2,281,2,282,2,97,2,98,2,15,2,21,3,0,3,2,283,3,0,349,2,99,2,100,2,6,-264,3,0,11,2,22,3,0,2,2,31,-1,2,284,2,101,2,102,3,0,2,2,19,2,103,3,0,10,2,9,2,17,2,0,2,45,2,0,2,30,2,104,2,23,2,285,2,172,2,105,3,0,3,2,18,2,24,2,25,2,5,2,26,2,0,2,7,2,106,-1,2,107,2,108,2,109,-1,3,0,3,2,11,-2,2,0,2,27,-3,2,150,-4,2,18,2,0,2,35,0,1,2,0,2,62,2,28,2,11,2,9,2,0,2,110,-1,3,0,4,2,9,2,21,2,111,2,6,2,0,2,112,2,0,2,48,-4,3,0,9,2,20,2,29,2,30,-4,2,113,2,114,2,29,2,20,2,7,-2,2,115,2,29,2,31,-2,2,0,2,116,-2,2,286,2,287,-1,3,18,2,-1,2,32,2,36,2,0,3,29,2,2,34,2,19,-3,3,0,2,2,33,-1,2,0,2,34,2,0,2,34,2,0,2,46,-10,2,0,2,288,-2,2,18,2,43,2,35,-2,2,17,2,117,2,20,3,0,2,2,36,2,289,2,0,2,11,2,17,2,135,2,0,2,37,2,52,2,290,3,0,2,2,291,-1,2,120,2,292,-2,2,122,2,38,2,0,2,293,2,39,2,294,2,295,2,296,-4,3,0,2,2,297,0,3,3,0,2,2,298,-5,2,0,2,299,2,300,-1,3,0,2,2,301,-1,2,0,2,40,2,41,-1,2,10,2,42,-6,2,0,2,11,-3,3,0,2,2,302,2,125,2,303,2,50,-2,2,126,2,304,2,305,2,0,2,7,2,43,2,0,2,63,-1,2,0,2,40,-8,2,54,2,44,2,306,2,127,2,45,2,307,-2,2,128,2,308,2,46,2,130,2,309,2,41,-9,2,20,-5,2,64,-2,3,0,28,2,31,-3,3,0,3,2,47,3,0,6,2,48,-85,3,0,33,2,47,-126,3,0,18,2,36,-269,3,0,17,2,40,2,7,2,41,-2,2,17,2,49,2,0,2,20,2,50,2,132,2,23,-21,3,0,2,-4,3,0,2,2,310,2,0,2,311,-2,2,312,3,0,191,2,51,3,0,38,2,29,-1,2,33,-279,3,0,8,2,7,-1,2,133,2,52,3,0,11,2,6,-72,3,0,3,2,134,2,313,-166,2,314,2,315,2,316,-4,2,317,-13,3,0,2,2,37,2,0,2,136,2,137,2,55,2,0,2,138,2,139,2,140,3,0,10,2,141,2,142,2,15,3,37,2,3,53,2,3,54,2,2,318,2,0,-16,2,0,2,88,2,0,2,319,2,320,2,321,-42,2,322,2,323,-6,2,0,2,324,2,325,-11,2,0,2,31,-40,3,0,6,2,326,-1,3,0,2,2,42,-37,2,55,2,144,2,145,2,146,2,147,2,148,-105,2,24,-32,3,0,1334,2,9,-1,3,0,129,2,27,3,0,6,2,9,3,0,180,2,149,3,0,233,0,1,-96,3,0,16,2,9,-47,3,0,154,2,56,-22381,3,0,7,2,23,-6132,0,32,0,1,-174,0,1,-75,2,131,0,33536,2,124,-125,0,1,-1654,2,124,-7,2,166,-32768,0,9216,-256,2,327,-34558],[4294967295,4294967291,4092460543,4294828031,4294967294,134217726,268435455,2147483647,1048575,1073741823,3892314111,134217727,1061158911,536805376,4294910143,4160749567,4294901759,4294901760,536870911,262143,8388607,4294902783,4294918143,65535,67043328,2281701374,4294967232,2097151,4294903807,4194303,255,67108863,4294967039,511,524287,131071,127,4292870143,4294902271,4294549487,33554431,1023,67047423,4294901888,4286578687,4294770687,67043583,32767,15,2047999,67043343,16777215,4294902e3,4294934527,4294966783,4294967279,2047,262083,20511,4290772991,41943039,493567,4294959104,603979775,65536,602799615,805044223,4294965206,8191,1031749119,4294917631,2134769663,4286578493,4282253311,4294942719,33540095,4294905855,4294967264,2868854591,1608515583,265232348,534519807,2147614720,1060109444,4093640016,17376,2139062143,224,4169138175,4294909951,4286578688,4294967292,4294965759,2044,4292870144,4294966272,4294967280,8289918,4294934399,4294901775,4294965375,1602223615,4294967259,4294443008,268369920,4292804608,486341884,4294963199,3087007615,1073692671,4128527,4279238655,4294902015,4294966591,2445279231,3670015,3238002687,31,63,4294967288,4294705151,4095,3221208447,4294549472,2147483648,4285526655,4294966527,4294705152,4294966143,64,4294966719,16383,3774873592,458752,536807423,67043839,3758096383,3959414372,3755993023,2080374783,4294835295,4294967103,4160749565,4087,184024726,2862017156,1593309078,268434431,268434414,4294901763,536870912,2952790016,202506752,139264,402653184,4261412864,4227922944,49152,61440,3758096384,117440512,65280,3233808384,3221225472,2097152,4294965248,32768,57152,67108864,4293918720,4290772992,25165824,57344,4227915776,4278190080,4227907584,65520,4026531840,4227858432,4160749568,3758129152,4294836224,63488,1073741824,4294967040,4194304,251658240,196608,4294963200,64512,417808,4227923712,12582912,50331648,65472,4294967168,4294966784,16,4294917120,2080374784,4096,65408,524288,65532,77595648,3168796671,4294956992,4294966523,4294836735,3221225471,4294901942,134152192,4294951935,2683305983,2684354047,4294961151,608174079,4294443263,4294901711,4089839103,2961209759,1342439375,4294543342,3547201023,1577204103,4194240,4294688750,80831,4261478351,4294549486,2967484831,196559,3594373100,3288319768,8469959,3825204735,123747807,65487,4294828015,4092591615,1080049119,458703,2163244511,4227923919,4236247022,4284449919,851904,67076095,1073741743,4093591391,50331649,3265266687,4294844415,4278190047,261632,2088959,909311,814743551,67057664,268374015,134153215,2684354559,67044351,3221160064,1046528,4294960127,4294377472,4227858431,1048577,131042,1046559,2147516671,524222462,4269801471,3220242431,4351,67043391,3909091327,67076097,67059711,4236247039,939524103,8191999,67057663,3774349439,1638399,4277137519,2269118463,203775,2147549120,5242879,402644511,1090519039,67045375,4226678271,3766565279,2039759,3288270847,67043519,4282384383,1056964609,67043345,2147484671,4190109695,4244635647,27,67043329,8388351,3028287487,33259519,4294936575,4294934783,196635,1677656575,4161266656,4071,15360,28,4294954999,2105343,4160749584,65534,4194303871,2011,1073684479,17407,8323103,768]);function f(e){return e<=127?2&l[e]:1&d$1[104448+(e>>>5)]>>>e}function p(e){return e<=57?e-48:(e|=32)<97?-1:e<=102?e-97+10:-1}function x(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(e>>>10)+String.fromCharCode(1023&e)}const k=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,43,-1,45,46,-1,48,49,50,51,52,53,54,55,56,57,-1,-1,-1,-1,-1,-1,-1,65,66,67,68,69,70,-1,-1,-1,-1,-1,-1,-1,-1,79,-1,-1,-1,-1,-1,-1,-1,-1,88,-1,-1,-1,-1,-1,-1,95,-1,97,98,99,100,101,102,-1,-1,-1,-1,-1,-1,-1,110,111,-1,-1,-1,-1,-1,-1,-1,-1,120,-1,-1,-1,-1,-1,-1,-1];function m$1(e,n,t,r){let i=0,a="";for(;48&l[r];)if(95!==r)i=0,e.index++,r=e.source.charCodeAt(e.index);else {const{index:s}=e;e.index++,95===(r=e.source.charCodeAt(e.index))&&o(e,n,s,s,72),i=1,a+=e.source.substring(t,s),t=e.index;}return i&&o(e,n,e.index,e.index,70),a+e.source.substring(t,e.index)}const h$1=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,48,49,50,51,52,53,54,55,56,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,98,-1,-1,-1,102,-1,-1,-1,-1,-1,-1,-1,110,-1,-1,-1,114,-1,116,117,118,-1,120,-1,-1,-1,-1,-1,-1,-1];function g(e,n){e.index++;let t="",r=0,i=e.source.charCodeAt(e.index);const o=e.index;for(;e.index<e.length;){if(96===i)return e.tokenValue=t,e.index++,e.tokenRaw=e.source.slice(o,e.index-1),6299657;if(36===i){if(123===e.source.charCodeAt(e.index+1))return e.tokenRaw=e.source.slice(o,e.index),e.index=e.index+=2,e.tokenValue=t,6299658;t+="$";}if(92===i){if(e.index++,i=e.source.charCodeAt(e.index),1&d$1[69632+(i>>>5)]>>>i)13===i&&(e.index++,10===e.source.charCodeAt(e.index)&&e.index++),e.columnOffset=e.index,e.line++;else {const r=b(e,n,e.source,65536==(65536&n),i);t=r<0?null:t+r;}}else e.index++,i-14&8192&&(13===i?(r=1,e.line++,e.columnOffset=e.index):(10===i||(8232^i)<=1)&&(1===r&&e.line++,e.columnOffset=e.index,r=0)),null!=t&&(t+=x(i));i=e.source.charCodeAt(e.index);}return s$1(e,n,0,52,2),e.tokenValue=t,6299657}function b(e,n,t,r,i){switch(e.index++,h$1[i]){case 98:return "\b";case 116:return "\t";case 110:return "\n";case 118:return "\x0B";case 102:return "\f";case 114:return "\r";case 120:{const i=t.charCodeAt(e.index);if(0==(128&l[i])||0==(128&l[t.charCodeAt(e.index+1)]))return r||s$1(e,n,0,50,2),128&l[i]&&e.index++,-1;e.index++;const o=p(i)<<4|p(t.charCodeAt(e.index));return e.index++,o}case 117:if(123===(i=t.charCodeAt(e.index))){let o=p(i=t.charCodeAt(++e.index));if(o<0)return r||s$1(e,n,0,50,2),-1;let a=0;do{if(a=a<<4|o,a>1114111)return r||s$1(e,n,0,49,2),-1;o=p(t.charCodeAt(++e.index));}while(o>=0);return 0<o||125!==t.charCodeAt(e.index)?(r||s$1(e,n,0,53,2),-1):(e.index++,x(a))}if(0==(128&l[i]))return -1;let o=0;for(let a=0;a<4;a++){const a=p(i);if(a<0)return r||s$1(e,n,0,50,2),-1;i=t.charCodeAt(++e.index),o=o<<4|a;}return x(o);case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:const a=t.charCodeAt(e.index);return 48===i&&(a<48||a>57)?"\0":(r||s$1(e,n,0,54,2),a>=48&&a<=57&&e.index++,-1);case 56:case 57:return r||s$1(e,n,0,54,2),-1;}return x(i)}function y$1(e,n){return e.index--,g(e,n)}const C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0," ","!","\"","#","$","%","&","'","(",")","*","+",",","-",".","/",0,0,0,0,0,0,0,0,0,0,":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","\b","c","d","e","\f","g","h","i","j","k","l","m","\n","o","p","q","\r","s","\t",0,"\x0B","w",0,"y","z","{","|","}","~",0];function I(e,n,t,r){switch(e.index++,r){case 48:case 49:case 50:case 51:let i=r-48,o=e.index;if(o<t.length){const r=t.charCodeAt(o);if(r<48||r>55){if(0!==i&&1024&n)return s$1(e,n,0,50,2),""}else {if(1024&n)return s$1(e,n,0,50,2),"";if(i=i<<3|r-48,o++,o<t.length){const e=t.charCodeAt(o);e>=48&&e<=55&&(i=i<<3|e-48,o++);}e.index=o;}}return x(i);case 52:case 53:case 54:case 55:{if(1024&n)return s$1(e,n,0,56,2),"";let i=r-48;const o=e.index;if(o<t.length){const n=t.charCodeAt(o);n>=48&&n<=55&&(i=i<<3|n-48,e.index=o+1);}return x(i)}case 56:case 57:return s$1(e,n,0,57,2),"";case 117:if(123===(r=t.charCodeAt(e.index))){e.index++;let i=p(r=t.charCodeAt(e.index));if(i<0)return s$1(e,n,0,50,2),"";for(r=t.charCodeAt(++e.index);125!==r;){const o=p(r);if(o<0)return s$1(e,n,0,50,2),"";if(i=i<<4|o,i>1114111)return s$1(e,n,0,49,2),"";r=t.charCodeAt(++e.index);}return e.index++,x(i)}{let i=p(r);if(i<0)return s$1(e,n,0,50,2),"";for(let o=0;o<3;o++){const o=p(r=t.charCodeAt(++e.index));if(o<0)return s$1(e,n,0,50,2),"";i=i<<4|o;}return e.index++,x(i)}case 120:const a=p(t.charCodeAt(e.index));if(a<0)return s$1(e,n,0,50,2),"";const c=p(t.charCodeAt(++e.index));return c<0?(s$1(e,n,0,50,2),""):(e.index++,x(a<<4|c));default:return x(r);}}function A(e,t){let r=e.index;const i=e.source;let a=i.charCodeAt(e.index),s=null;do{if(f(a))e.index++;else if(92===a){if(e.tokenValue+=i.slice(r,e.index),s=E(e,t),s<0)break;e.tokenValue+=x(s),r=e.index;}else {if(55296!=(4294966272&a))break;e.index++;const n=i.charCodeAt(e.index);56320==(4294966272&n)&&(a=((1023&a)<<10)+(1023&n)+65536,f(a)||o(e,t,r,e.index,51,x(a)),e.index++);}a=i.charCodeAt(e.index);}while(e.index<e.length);e.tokenValue+=i.slice(r,e.index);const c=e.tokenValue.length;if(c>=2&&c<=11){const t=n.get(e.tokenValue);return null==t?73729:t}return 73729}function E(e,n){let t=e.index;const r=t;if(117!==e.source.charCodeAt(t+1))return o(e,n,r,t,48),-1;t+=2;let i=e.source.charCodeAt(t);if(123===i){t++;let a=p(e.source.charCodeAt(t)),s=0;for(;a>=0;){if(s=s<<4|a,s>1114111)return o(e,n,r,t,49),-1;i=e.source.charCodeAt(++t),a=p(i);}return 0<a||125!==i?(o(e,n,r,t,50),-1):(e.index=t+1,s)}let a=0;for(let s=0;s<4;s++){const s=p(i);if(s<0)return o(e,n,r,t,50),-1;a=a<<4|s,i=e.source.charCodeAt(++t);}return f(a)?(e.index=t,a):(o(e,n,r,t,50),-1)}function w$1(e,n,t){let r=n.charCodeAt(e.index);for(;e.index<e.length&&0==(1&d$1[174080+(r>>>5)]>>>r);)r=n.charCodeAt(++e.index);return 8^(8|t)}function v(e,n,t,r){for(;e.index<e.length;){let n=t.charCodeAt(e.index);if(42===n){for(;42===n;)n=t.charCodeAt(++e.index);if(47===n)return e.index++,8^(8|r)}e.index++,1&d$1[174080+(n>>>5)]>>>n&&(13===n&&(r|=5,e.columnOffset=e.index,e.line++),10!==n&&8232!=(-2&n)||(0==(4&r)&&e.line++,e.columnOffset=e.index,r=12^(13|r)));}return s$1(e,n,0,86,2),r}function S(e,n){33===n.charCodeAt(e.index+1)&&35===n.charCodeAt(e.index)&&(e.index=e.index+=2,w$1(e,n,0));}const B=[-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,32,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,45,-1,47,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,60,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];function T(e,n,t,r){0===n&&(r|=24);const i=[];e:for(;n<e.length;){const o=e.charCodeAt(n);switch(B[o]){case 13:if(48&(r|=5))break e;break;case 10:if(n++,48&r)break e;r=4^(5|r);break;case 9:case 11:case 12:case 32:n++;break;case 47:{const t=e.charCodeAt(n+1);if(47===t){const t=n;let o=e.charCodeAt(n);for(;n<e.length;){if(1&d$1[174080+(o>>>5)]>>>o||(8232^o)<=1){r|=1;break}n++,o=e.charCodeAt(n);}16&(r=8^(8|r))&&i.push({type:"SingleLine",start:t,end:n,newLine:1==(1&r)});break}if(42===t){const t=n;for(;n<e.length;){if(42===e.charCodeAt(n)&&47===e.charCodeAt(n+1)){n+=2;break}n++;}16&(r=8^(8|r))&&i.push({type:"MultiLine",start:t,end:n,newLine:1==(1&r)});break}break e}case 60:if(t)break e;if(45===e.charCodeAt(n+3)&&45===e.charCodeAt(n+2)&&33===e.charCodeAt(n+1)){const t=n;let o=e.charCodeAt(n);for(;n<e.length;){if(1&d$1[174080+(o>>>5)]>>>o||(8232^o)<=1){r|=1;break}n++,o=e.charCodeAt(n);}16&r&&i.push({type:"HTMLOpen",start:t,end:n,newLine:1==(1&r)});break}break e;case 45:if(t||0==(9&r))break e;if(62===e.charCodeAt(n+2)&&45===e.charCodeAt(n+1)){const t=n;let o=e.charCodeAt(n);for(;n<e.length;){if(1&d$1[174080+(o>>>5)]>>>o||(8232^o)<=1){r|=1;break}n++,o=e.charCodeAt(n);}16&r&&i.push({type:"HTMLClose",start:t,end:n,newLine:1==(1&r)});break}default:if(1&d$1[174080+(o>>>5)]>>>o){n++,8232==(-2&o)&&(r=4^(5|r));break}break e;}}return i}const N=[124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,124,8241,16785412,124,73729,273208,271944,16785412,2105356,17,17049143,271667,33554451,272948,6291470,273209,16785410,16785410,16785410,16785410,16785410,16785410,16785410,16785410,16785410,16785410,22,1140871186,272451,131102,272452,23,124,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,73729,23109652,125,21,271690,73729,6299657,126,126,126,126,126,126,126,73729,126,73729,73729,126,126,126,126,126,73729,126,126,126,126,126,126,73729,126,126,40973,271433,16400,8242];function V(e,t){if(function(e,n,t){0===e.index&&(t|=8);const r=e.source;e:for(;e.index<e.length;){const i=r.charCodeAt(e.index);switch(B[i]){case 13:t|=5,e.columnOffset=++e.index,e.line++;break;case 10:0==(4&t)&&e.line++,t=4^(5|t),e.columnOffset=++e.index;break;case 9:case 11:case 12:case 32:t|=2,e.index++;break;case 47:{t|=2;const i=r.charCodeAt(e.index+1);if(47===i){t=w$1(e,r,t);break}if(42===i){t=v(e,n,r,t);break}break e}case 60:if(2048&n)break e;if(45===r.charCodeAt(e.index+3)&&45===r.charCodeAt(e.index+2)&&33===r.charCodeAt(e.index+1)){t=w$1(e,r,t);break}break e;case 45:if(2048&n||0==(9&t))break e;if(62===r.charCodeAt(e.index+2)&&45===r.charCodeAt(e.index+1)){t=w$1(e,r,t);break}default:if(1&d$1[139264+(i>>>5)]>>>i){e.index++,8232==(-2&i)&&(t=4^(5|t),e.columnOffset=e.index,e.line++);break}break e;}}1&t&&(e.lineTerminatorBeforeNextToken=!0);}(e,t,0),e.index>=e.length)return 16384;e.tokenIndex=e.index;let r=e.source.charCodeAt(e.index);if(r>127)return function(e,n){const t=e.source.charCodeAt(e.index);return 1&d$1[34816+(t>>>5)]>>>t?A(e,n):55296==(4294966272&t)?(56320!=(4294966272&e.source.charCodeAt(e.index+1))&&s$1(e,n,0,47,2,x(t)),A(e,n)):(s$1(e,n,0,9,2),e.index++,124)}(e,t);const i=N[r];switch(i){case 16400:case 40973:case 33554451:case 22:case 8242:case 2105356:case 17:case 1140871186:case 23109652:case 21:return e.index++,i;case 126:return function(e,t,r){for(;2&l[r];)r=e.source.charCodeAt(++e.index);if(e.tokenValue=e.source.slice(e.tokenIndex,e.index),r>90)return A(e,t);const i=e.tokenValue.length;if(i>=2&&i<=11){const t=n.get(e.tokenValue);return null==t?73729:t}return 73729}(e,t,r);case 73729:return function(e,n,t){for(;2&l[t]||1&d$1[0+(t>>>5)]>>>t;)t=e.source.charCodeAt(++e.index);return e.tokenValue=e.source.slice(e.tokenIndex,e.index),t>90?A(e,n):73729}(e,t,r);case 16785410:return function(e,n,t){let r=0,i=1,a=!1,s=e.index,c=16785410,u=1,d=e.source;const f=e.index;if(48===t){if(s++,t=d.charCodeAt(s),256&l[t]){let a=0;do{switch(k[t]){case 120:case 88:if(14&i){o(e,n,s-1,s,61);break}i=2;break;case 98:case 66:if(2===i){u=0,r=16*r+p(t);break}if(12&i){o(e,n,s-1,s,61);break}i=8;break;case 111:case 79:if(14&i){o(e,n,s-1,s,61);break}i=4;break;case 48:case 49:if(8&i){u=0,r=2*r+(t-48);break}case 50:case 51:case 52:case 53:case 54:case 55:if(4&i){u=0,r=8*r+(t-48);break}case 56:case 57:case 97:case 99:case 100:case 101:case 102:case 65:case 67:case 68:case 69:case 70:if(2&i){u=0,r=16*r+p(t);break}o(e,n,s,s+1,8&i?65:66);break;case 95:if(0===u){if(e.cst|=32,95===d.charCodeAt(s+1))return o(e,n,s,s+1,69),e.index+=5,e.tokenValue=r,16785410;o(e,n,s,s+1,72);}u=1;break;case 110:return e.tokenValue=r,e.index=++s,16785411;}a++,s++,t=d.charCodeAt(s);}while(416&l[t]);return 3&l[t]&&(o(e,n,s,s,58),s++),14&i&&a<=1?o(e,n,s-1,s,8&i?62:4&i?63:64):1===u&&o(e,n,f+2,s+1,70),e.index=s,e.tokenValue=r,16785410}if(t>=48&&t<=56){1024&n&&o(e,n,f,s,67),e.flags|=16,a=!0,i=1024;do{if(r=8*r+(t-48),(t=d.charCodeAt(++s))>=56){i=512;break}}while(t>=48&&t<=57);if(95===t&&o(e,n,f+1,s,71),110===t&&o(e,n,s,s,60),1024===i)return e.index=s,e.tokenValue=r,16785410}}let x=9;for(;t<=57&&t>=48;)r=10*r+(t-48),t=d.charCodeAt(++s),--x;if(x>=0&&0==(3&l[t])&&512!==i&&46!==t)return e.tokenValue=r,e.index=s,16785410;e.index=s;let h=m$1(e,n,f,t);46===(t=d.charCodeAt(e.index))&&(a=!0,c=16785535,t=d.charCodeAt(++e.index),h+="."+m$1(e,n,e.index,t),t=d.charCodeAt(e.index));const g=e.index;return 110===t?(a&&o(e,n,e.index,e.index,60),e.tokenValue=d.slice(f,e.index),++e.index,16785411):(101==(32|t)&&(43!==(t=d.charCodeAt(++e.index))&&45!==t||(t=d.charCodeAt(++e.index)),0==(16&l[t])&&(o(e,n,e.index,e.index,59),e.index++),h+=d.substring(g,e.index)+m$1(e,n,e.index,t),t=d.charCodeAt(e.index)),(3&l[t])>0&&o(e,n,e.index,e.index,58),e.tokenValue=parseFloat(h),c)}(e,t,r);case 6291470:let a=e.index+1;if(a<e.length){if(r=e.source.charCodeAt(a),r>=48&&r<=57)return function(e,n,t){const r=e.index;let i=m$1(e,n,e.index,t),a=e.index,s=e.source;return 101==(32|(t=s.charCodeAt(e.index)))&&(e.index++,t=s.charCodeAt(e.index),e.cst|=64,43!==t&&45!==t||(e.index++,t=s.charCodeAt(e.index)),0==(16&l[t])&&(o(e,n,e.index,e.index,59),e.index++),i+=s.substring(a,e.index)+m$1(e,n,e.index,t),t=s.charCodeAt(e.index)),(3&l[t])>0&&o(e,n,e.index,e.index,58),e.tokenValue=parseFloat(s.slice(r,e.index)),16785535}(e,t,r);if(46===r&&(a++,a<e.length&&46===e.source.charCodeAt(a)))return e.index=a+1,8388623}return e.index++,6291470;case 16785412:return function(e,n,t){let r="";const i=e.source;e.index++;let o=e.index,a=i.charCodeAt(e.index);for(;0==(64&l[a]);){if(92===a){r+=i.substring(o,e.index),e.index++,a=i.charCodeAt(e.index);const t=C[a];t?(e.index++,r+=t):r+=I(e,n,i,a),o=e.index;}else {if(a===t)return r+=i.substring(o,e.index),e.index++,e.tokenValue=r,16785412;e.index++;}if(e.index>=e.length)break;a=i.charCodeAt(e.index);}return s$1(e,n,0,55,2),e.tokenValue=r,16785412}(e,t,r);case 131102:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,272189):272191):62===r?(e.index++,11):131102;case 271667:return e.index++,r=e.source.charCodeAt(e.index),43===r?(e.index++,2105372):61===r?(e.index++,131107):271667;case 6299657:return g(e,t);case 23:return e.index++,r=e.source.charCodeAt(e.index),46===r?(e.index++,r=e.source.charCodeAt(e.index),r>=48&&r<=57?23:2097177):63===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131117):262424):23;case 8241:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,272190):272192):8241;case 17049143:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,131109):42===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131106):273466):17049143;case 273209:return e.index++,r=e.source.charCodeAt(e.index),4096&t?function(e,n){e.index>=e.length&&s$1(e,n,0,14,2);const t=e.index;let r=0;for(;;){const t=e.source.charCodeAt(e.index);if(e.index++,1&r)r&=-2;else if(t<=94){if(47===t){if(!r)break}else if(92===t)r|=1;else if(91===t)r|=2;else if(93===t)r&=1;else if(64&l[t]){s$1(e,n,0,14,2);break}}else if(8232==(-2&t)){s$1(e,n,0,12,2);break}if(e.index>=e.length){s$1(e,n,0,12,2);break}}const i=e.index-1;let o=0;const a=e.index;let c=e.source.charCodeAt(e.index);for(;f(c);){switch(c){case 103:1&o&&s$1(e,n,0,13,2),o|=1;break;case 105:2&o&&s$1(e,n,0,13,2),o|=2;break;case 109:4&o&&s$1(e,n,0,13,2),o|=4;break;case 117:8&o&&s$1(e,n,0,13,2),o|=8;break;case 121:16&o&&s$1(e,n,0,13,2),o|=16;break;case 115:32&o&&s$1(e,n,0,13,2),o|=32;break;default:s$1(e,n,0,14,2);}e.index++,c=e.source.charCodeAt(e.index);}return e.regExpPattern=e.source.slice(t,i),e.regExpFlags=e.source.slice(a,e.index),8197}(e,t):61===r?(e.index++,131110):273209;case 272948:return e.index++,r=e.source.charCodeAt(e.index),45===r?(e.index++,2105373):61===r?(e.index++,131108):272948;case 272451:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,272449):60===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131103):272709):272451;case 271944:return e.index++,r=e.source.charCodeAt(e.index),38===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131116):271163):61===r?(e.index++,131114):271944;case 272452:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,272450):62===r?(e.index++,62===e.source.charCodeAt(e.index)?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131105):272711):61===e.source.charCodeAt(e.index)?(e.index++,131104):272710):272452;case 271433:return e.index++,r=e.source.charCodeAt(e.index),124===r?(e.index++,61===e.source.charCodeAt(e.index)?(e.index++,131115):270908):61===r?(e.index++,131113):271433;case 273208:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,131111):273208;case 271690:return e.index++,r=e.source.charCodeAt(e.index),61===r?(e.index++,131112):271690;case 125:return function(e,n){const t=E(e,n);return t>0?(e.tokenValue=x(t),A(e,n)):(92===e.source.charCodeAt(e.index)&&e.index++,e.tokenValue=x(t),73729)}(e,t);default:s$1(e,t,0,9,2),e.index++;}return 16384}function L(e,n){e.startIndex=e.index,e.lineTerminatorBeforeNextToken=!1,e.endIndex=e.index,e.line=e.lineForNextToken,e.endColumn=e.columnForNextToken,e.token=V(e,n),0==(33554432&n)&&(e.startIndex=e.tokenIndex,e.columnForNextToken=e.index-e.columnOffset,e.lineForNextToken=e.line);}function P(e){return {type:"IdentifierReference",name:e}}function F(e){return {type:"IdentifierName",name:e}}const O={Module:function(e,n,t){return {type:"Module",webCompat:t,directives:e,leafs:n}},Script:function(e,n,t){return {type:"Script",webCompat:t,directives:e,leafs:n}},Target:function(){return {type:"NewTarget"}},Semicolon:function(){return {type:"Semicolon"}},ArrayAssignmentPattern:function(e){return {type:"ArrayAssignmentPattern",elements:e}},AssignmentElement:function(e,n){return {type:"AssignmentElement",left:e,right:n}},NumericLiteral:function(e){return {type:"NumericLiteral",value:e}},FloatingPointLiteral:function(e){return {type:"FloatingPointLiteral",value:e}},BigInt:function(e){return {type:"BigIntLiteral",value:e}},AwaitExpression:function(e){return {type:"AwaitExpression",expression:e}},YieldExpression:function(e,n){return {type:"YieldExpression",delegate:e,argument:n}},LabelIdentifier:function(e){return {type:"LabelIdentifier",name:e}},ComputedPropertyName:function(e){return {type:"ComputedPropertyName",expression:e}},StringLiteral:function(e){return {type:"StringLiteral",value:e}},ArrowFunction:function(e,n,t,r){return {type:"ArrowFunction",params:e,contents:n,arrowParameters:t,async:r}},DefaultClause:function(e){return {type:"DefaultClause",leafs:e}},SwitchStatement:function(e,n){return {type:"SwitchStatement",expression:e,clauses:n}},WhileStatement:function(e,n){return {type:"WhileStatement",expression:e,statement:n}},DoWhileStatement:function(e,n){return {type:"DoWhileStatement",expression:e,statement:n}},IfStatement:function(e,n,t){return {type:"IfStatement",expression:e,consequent:n,alternate:t}},CommaOperator:function(e){return {type:"CommaOperator",expressions:e}},RegularExpressionLiteral:function(e,n){return {type:"RegularExpressionLiteral",pattern:e,flag:n}},MemberExpression:function(e,n,t){return {type:"MemberExpression",member:e,expression:n,computed:t}},CallExpression:function(e,n){return {type:"CallExpression",expression:e,arguments:n}},IdentifierReference:P,OptionalExpression:function(e,n){return {type:"OptionalExpression",member:e,chain:n}},OptionalChain:function(e){return {type:"OptionalChain",chain:e}},AssignmentRestElement:function(e){return {type:"AssignmentRestElement",argument:e}},AssignmentRestProperty:function(e){return {type:"AssignmentRestProperty",argument:e}},ObjectBindingPattern:function(e){return {type:"ObjectBindingPattern",properties:e}},FunctionExpression:function(e,n,t,r,i){return {type:"FunctionExpression",name:e,generator:n,async:t,params:r,contents:i}},FunctionDeclaration:function(e,n,t,r,i){return {type:"FunctionDeclaration",name:e,generator:n,async:t,params:r,contents:i}},ForBinding:function(e){return {type:"ForBinding",declarations:e}},BindingElement:function(e,n){return {type:"BindingElement",left:e,right:n}},ArrayBindingPattern:function(e){return {type:"ArrayBindingPattern",elements:e}},ClassElement:function(e,n){return {type:"ClassElement",static:e,method:n}},ClassExpression:function(e,n,t){return {type:"ClassExpression",name:e,heritage:n,elements:t}},ClassDeclaration:function(e,n,t){return {type:"ClassDeclaration",name:e,heritage:n,elements:t}},ForInStatement:function(e,n,t){return {type:"ForInStatement",initializer:e,expression:n,statement:t}},ForStatement:function(e,n,t,r,i){return {type:"ForStatement",initializer:e,condition:n,incrementor:t,variableDeclarationList:r,statement:i}},ParenthesizedExpression:function(e){return {type:"ParenthesizedExpression",expression:e}},ArrayLiteral:function(e){return {type:"ArrayLiteral",elements:e}},BindingRestElement:function(e){return {type:"BindingRestElement",argument:e}},SuperCall:function(e){return {type:"SuperCall",arguments:e}},SuperProperty:function(e,n){return {type:"SuperProperty",super:e,computed:n}},SpreadElement:function(e){return {type:"SpreadElement",argument:e}},SpreadProperty:function(e){return {type:"SpreadProperty",argument:e}},MethodDefinition:function(e,n,t,r,i,o,a,s){return {type:"MethodDefinition",async:e,generator:n,getter:t,setter:r,propertySetParameterList:i,uniqueFormalParameters:o,name:a,contents:s}},Elison:function(){return {type:"Elison"}},FunctionBody:function(e,n){return {type:"FunctionBody",directives:e,leafs:n}},CoverInitializedName:function(e,n){return {type:"CoverInitializedName",left:e,right:n}},ObjectLiteral:function(e){return {type:"ObjectLiteral",properties:e}},MemberChain:function(e,n,t){return {type:"MemberChain",chain:e,member:n,computed:t}},ThisExpression:function(){return {type:"ThisExpression"}},NullExpression:function(){return {type:"NullLiteral",value:null}},BooleanLiteral:function(e){return {type:"BooleanLiteral",value:e}},CallChain:function(e,n){return {type:"CallChain",chain:e,arguments:n}},NewExpression:function(e,n){return {type:"NewExpression",expression:e,arguments:n}},IdentifierName:F,BindingIdentifier:function(e){return {type:"BindingIdentifier",name:e}},BindingRestProperty:function(e){return {type:"BindingRestProperty",argument:e}},ExpressionStatement:function(e){return {type:"ExpressionStatement",expression:e}},AssignmentExpression:function(e,n,t){return {type:"AssignmentExpression",left:e,operator:n,right:t}},UnaryExpression:function(e,n){return {type:"UnaryExpression",operator:e,operand:n}},PrefixUpdateExpression:function(e,n){return {type:"PrefixUpdateExpression",operator:e,operand:n}},PostfixUpdateExpression:function(e,n){return {type:"PostfixUpdateExpression",operator:e,operand:n}},BlockStatement:function(e){return {type:"BlockStatement",leafs:e}},EmptyStatement:function(){return {type:"EmptyStatement"}},DebuggerStatement:function(){return {type:"DebuggerStatement"}},ReturnStatement:function(e){return {type:"ReturnStatement",expression:e}},BreakStatement:function(e){return {type:"BreakStatement",label:e}},ContinueStatement:function(e){return {type:"ContinueStatement",label:e}},LabelledStatement:function(e,n){return {type:"LabelledStatement",label:e,labelledItem:n}},WithStatement:function(e,n){return {type:"WithStatement",expression:e,statement:n}},ThrowStatement:function(e){return {type:"ThrowStatement",expression:e}},TryStatement:function(e,n,t){return {type:"TryStatement",block:e,catchClause:n,finalizer:t}},CatchClause:function(e,n){return {type:"CatchClause",binding:e,block:n}},ConditionalExpression:function(e,n,t){return {type:"ConditionalExpression",shortCircuit:e,consequent:n,alternate:t}},BinaryExpression:function(e,n,t){return {type:"BinaryExpression",left:e,operator:n,right:t}},LexicalBinding:function(e,n){return {type:"LexicalBinding",binding:e,initializer:n}},LexicalDeclaration:function(e,n){return {type:"LexicalDeclaration",isConst:e,declarations:n}},VariableStatement:function(e){return {type:"VariableStatement",declarations:e}},VariableDeclaration:function(e,n){return {type:"VariableDeclaration",binding:e,initializer:n}},CaseClause:function(e,n){return {type:"CaseClause",expression:e,leafs:n}},PropertyName:function(e,n){return {type:"PropertyName",key:e,value:n}},ObjectAssignmentPattern:function(e){return {type:"ObjectAssignmentPattern",properties:e}},ImportCall:function(e){return {type:"ImportCall",import:e}},ImportMeta:function(){return {type:"ImportMeta"}},Directive:function(e,n){return {type:"Directive",value:e,raw:n}},ForOfStatement:function(e,n,t,r){return {type:"ForOfStatement",initializer:e,expression:n,statement:t,await:r}},ImportDeclaration:function(e,n,t){return {type:"ImportDeclaration",fromClause:e,moduleSpecifier:n,importClause:t}},ImportClause:function(e,n,t){return {type:"ImportClause",defaultBinding:e,nameSpaceImport:n,namedImports:t}},ImportSpecifier:function(e,n,t){return {type:"ImportSpecifier",moduleExportName:e,name:n,binding:t}},NamedImports:function(e){return {type:"NamedImports",importsList:e}},ExportDeclaration:function(e,n,t,r,i,o,a){return i?{type:"ExportDeclaration",declaration:e,namedExports:n,exportFromClause:r,fromClause:t,exportedNames:o,boundNames:a}:{type:"ExportDeclaration",declaration:e,namedExports:n,exportFromClause:r,fromClause:t}},ExportFromClause:function(e,n){return {type:"ExportFromClause",moduleExportName:n,namedBinding:e}},ExportDefault:function(e){return {type:"ExportDefault",declaration:e}},ExportSpecifier:function(e,n,t){return {type:"ExportSpecifier",moduleExportName:n,name:e,binding:t}},TemplateElement:function(e,n,t){return {type:"TemplateElement",raw:e,value:n,expression:t}},TemplateExpression:function(e){return {type:"TemplateExpression",elements:e}},TemplateLiteral:function(e,n){return {type:"TemplateLiteral",raw:e,value:n}},TaggedTemplate:function(e,n){return {type:"TaggedTemplate",member:e,literal:n}}};function D(e){return 16785410===e.token||0==(2105344&e.token)&&R(e)}function R(e){return e.lineTerminatorBeforeNextToken||16384==(16384&e.token)}function U(e,n){return 16384&e.token||e.lineTerminatorBeforeNextToken?z(e,4096|n,1140871186):(s$1(e,n,2,92,2),!1)}function M(n,t,r){return n.token===r?(L(n,t),!0):(s$1(n,t,2,5,2,e[255&r]),!1)}function z(e,n,t){return e.token===t&&(L(e,n),!0)}function j(e,n,t){return e.token===t?(L(e,n),1):0}function q(e){return 0===e.length?void 0:e[e.length-1]}function W(e,n,t,r){return 33554434&n&&(r.start=t,r.end=e.endIndex,33554432==(33554432&n)&&(r.flags=0)),256&n&&(r.meta={},r.meta.asi=0!=(16384&e.token),r.meta.newlineBeforeNextToken=e.lineTerminatorBeforeNextToken),r}function _(e){if(e)switch(e.type){case"IdentifierName":case"IdentifierReference":return void(e.type="BindingIdentifier");case"Elison":return;case"ArrayLiteral":{e.type="ArrayBindingPattern";const n=e.elements;let t=n.length;for(;t--;)_(n[t]);return}case"ObjectLiteral":{e.type="ObjectBindingPattern";const n=e.properties;let t=n.length;for(;t--;)_(n[t]);return}case"PropertyName":return _(e.value),e;case"CoverInitializedName":return e.type="BindingElement",H(e.left),e;case"SpreadElement":return e.type="BindingRestProperty",_(e.argument),e;case"AssignmentExpression":return e.type="BindingElement",delete e.operator,_(e.left),e;}}function H(e){switch(e.type){case"IdentifierReference":case"Elison":return;case"ArrayLiteral":{e.type="ArrayAssignmentPattern";const n=e.elements;let t=n.length;for(;t--;)H(n[t]);return}case"ObjectLiteral":{e.type="ObjectAssignmentPattern";const n=e.properties;let t=n.length;for(;t--;)H(n[t]);return}case"PropertyName":return void H(e.value);case"CoverInitializedName":return e.type="AssignmentElement",void H(e.left);case"SpreadElement":return e.type="AssignmentRestProperty",void H(e.argument);case"AssignmentExpression":return e.type="AssignmentElement",delete e.operator,void H(e.left);}}function Y(e,n){const{tokenValue:t,startIndex:r,token:i}=e;return 2098176&n&&1056878===i?a(e,n,88):(4196352&n)>0&&73841===i?a(e,n,89):1024&n&&(1048576&i)>0?s$1(e,n,0,18,2):134217728==(134217728&i)&&s$1(e,n,0,19,2),L(e,n),W(e,n,r,O.BindingIdentifier(t))}function $(e,n,t,r){2098176&n&&1056878===t&&i(e,n,r,21),4196352&n&&73841===t&&i(e,n,r,22),1024&n&&1048576&t&&i(e,n,r,18),134217728&t&&i(e,n,r,131),0==(1114112&t)&&i(e,n,r,131);}function G(e,n,t){if(1056878===e.token)2098176&n&&i(e,n,t,21);else {if(4196352&n&&73841===e.token)return i(e,n,t,22),"";if(1024&n){if(537923660===e.token)return i(e,n,t,85),"";if(1024&n&&1048576&e.token)return i(e,n,t,18),""}}return e.tokenValue}function J(e,n){return e.lineTerminatorBeforeNextToken&&e.startIndex-n==13||e.lineTerminatorBeforeNextToken&&e.startIndex-n==14||e.startIndex-n==12}function K(e,n){return {parent:e,type:n,scopeError:void 0}}function Q(e,n,t,r,i){64&i?X(e,n,t,r,i):Z(e,n,t,r,i);}function X(e,n,t,r,i){if(t){let o=t;for(;o&&0==(256&o.type);)1072&o["#"+r]?a(e,n,123,r):384&o["#"+r]&&(1028&n||0==(128&o["#"+r]))&&a(e,n,122,r),o["#"+r]=i,o=o.parent;}}function Z(e,n,t,r,i){if(void 0===t)return;const o=t["#"+r];if(o)0==(8192&o)&&(8&i?t.scopeError={start:e.startIndex,name:r,code:118}:(4&n||0==(1024&o)||0==(268435456&n))&&a(e,n,124,r));else {const s=t.parent;128&t.type&&s["#"+r]&&0==(8192&s["#"+r])&&a(e,n,124,r),1024&t.type&&o&&0==(8192&o)&&8&i&&(t.scopeError={start:e.startIndex,name:r,code:118}),64&t.type&&384&s["#"+r]&&a(e,n,125,r);}t["#"+r]=i;}function ee(e,n,t){void 0!==e.exportedNames&&""!==t&&(e.exportedNames["#"+t]&&a(e,n,134,t),e.exportedNames["#"+t]=1);}function ne(e,n,t=7){s$1(e,n,2,t,2);const r=W(e,n,e.startIndex,O.IdentifierReference(""));return r.flags|=2,r}function te(e,n,t,r=!0){s$1(e,n,2,t,3);const i=e.startIndex;return r&&L(e,n),W(e,n,i,O.BindingIdentifier(""))}function re(e,n,t,r,i,o){const a=se(e);return a?ce(e,n,a):o(e,n,t,r,i)}function ie(e,n,t,r,i,o,a){const s=se(e);return s?ce(e,n,s):a(e,n,t,r,i,o)}function oe(e,n,t,r,i){const o=se(e);return o?ce(e,n,o):i(e,n,t,r)}function ae(e,n,t){const r=se(e);return r?ce(e,n,r):t(e,n)}function se(e){if(!e.nodeCursor)return;return e.nodeCursor(e.endIndex)}function ce(e,n,t){return t}function ue(e,n){return {source:e,flags:0,cst:0,index:0,line:1,columnOffset:0,lineTerminatorBeforeNextToken:!1,lineForNextToken:0,columnForNextToken:0,startIndex:0,endIndex:0,endColumn:0,regExpPattern:"",regExpFlags:"",nodeHasError:!1,tokenIndex:0,length:e.length,token:0,tokenValue:"",tokenRaw:"",tokenRegExp:void 0,destructible:0,assignable:!0,exportedNames:[],exportedBindings:[],diagnostics:[],nodeCursor:n}}function le(e,n,t,r,i){for(;16384!==e.token;)537997312&e.token?r.push(re(e,n,t,null,null,i)):(s$1(e,n,2,8,2),L(e,4096|n));return r}function de(e,n,t,r,i){switch(e.token){case 201334875:case 67182704:return gn(e,n,t,!1);case 201334865:return An(e,n,t);case 671092813:return Le(e,n,t,32,r,i);case 537923660:return Le(e,n,t,16,r,i);case 201334877:const o=e.startIndex;return L(e,4096|n),z(e,4096|n,2105356)?Sn(e,n,o):z(e,n,6291470)?Bn(e,n,o):(s$1(e,n,2,95,2),xe(e,n,t,o));case 134221911:return s$1(e,n,2,94,2),Vn(e,n,t);default:return fe(e,n,t,r,i,!0);}}function fe(e,n,t,r,o,c){switch(e.token){case 40973:return ge(e,n,t,!1,r,o);case 1140871186:return function(e,n){const t=e.startIndex;return L(e,4096|n),W(e,n,t,O.EmptyStatement())}(e,n);case 201330780:return function(e,n,t,r){const i=e.startIndex;L(e,4096|n),M(e,4096|n,2105356);const o=we(e,n);M(e,4096|n,17);const a=he(e,n,t,r),s=z(e,n,134217814)?he(e,n,t,r):null;return W(e,n,i,O.IfStatement(o,a,s))}(e,n,t,r);case 201330773:return function(e,n,t,r,i){const o=e.startIndex;L(e,4096|n);const a=fe(e,131072|n,t,r,i,!1);M(e,n,201330789),M(e,4096|n,2105356);const s=we(e,n);return M(e,4096|n,17),z(e,4096|n,1140871186),W(e,n,o,O.DoWhileStatement(s,a))}(e,n,t,r,o);case 201330789:return function(e,n,t,r,i){const o=e.startIndex;L(e,4096|n),M(e,4096|n,2105356);const a=we(e,n);M(e,4096|n,17);const s=fe(e,131072|n,t,r,i,!1);return W(e,n,o,O.WhileStatement(a,s))}(e,n,t,r,o);case 201330778:return function(e,n,t,r){const o=e.startIndex;let s,c=!1;M(e,n,201330778);const u=4194304==(4194304&n)&&z(e,n,73841);M(e,4096|n,2105356);let l=null;const d=e.startIndex;if(1140871186!==e.token)if(536870912&e.token){if(t=K(t,1),537923660===e.token)L(e,n),1146880&e.token?(l=W(e,n,d,O.LexicalDeclaration(!1,be(e,8192|n,t,16,ye))),e.assignable=!0):(1024&n&&a(e,n,73),l=Re(e,n,W(e,n,d,O.IdentifierReference("let")),!0,o),589942===e.token&&a(e,n,73));else if(z(e,n,671092813))l=W(e,n,d,O.LexicalDeclaration(!0,be(e,8192|n,t,32,ye))),e.assignable=!0;else {L(e,n);const r=be(e,8192|n,t,64,Ce);l=524288&e.token?W(e,n,d,O.ForBinding(r)):r,c=!0,e.assignable=!0;}}else 32768&e.token?(l=(40973===e.token?ln:an)(e,n,void 0,2,512),32&e.flags&&i(e,n,d,137),s=e.destructible,e.assignable=4!=(4&s),l=Re(e,n,l,!0,e.startIndex)):l=De(e,8192|n,!0);if(u?M(e,4096|n,589942):z(e,4096|n,589942)){e.assignable||i(e,n,d,104),H(l);const a=Ee(e,n);return M(e,4096|n,17),W(e,n,o,O.ForOfStatement(l,a,fe(e,131072|n,t,r,null,!1),u))}if(z(e,4096|n,135014453)){e.assignable||i(e,n,d,104),H(l);const a=we(e,n);return M(e,4096|n,17),W(e,n,o,O.ForInStatement(l,a,fe(e,131072|n,t,r,null,!1)))}let f=null,p=null;8&e.destructible&&a(e,n,100);l=vn(e,n,l,e.startIndex),M(e,4096|n,1140871186),1140871186!==e.token&&(f=we(e,n));M(e,4096|n,1140871186),17!==e.token&&(p=we(e,n));return M(e,n,17),W(e,n,o,O.ForStatement(l,p,f,c,fe(e,131072|n,t,r,null,!1)))}(e,n,t,r);case 671092811:return Ne(e,n,t,64);case 201330770:return function(e,n,t){0==(131072&n)&&a(e,n,42);const r=e.startIndex;L(e,4096|n);let i=null;if(!e.lineTerminatorBeforeNextToken&&1114112&e.token){const r=e.tokenValue;i=Se(e,4096|n),0===function(e,n){let t;for(;e;){if(e.iterationLabels){t=e.iterationLabels;for(let e=0;e<t.length;e++)if(t[e]===n)return 1}e=e.parentLabels;}return 0}(t,r)&&a(e,n,126,r);}return U(e,n),W(e,n,r,O.ContinueStatement(i))}(e,n,r);case 201330766:return function(e,n,t){const r=e.startIndex;L(e,4096|n);let i=null;if(!e.lineTerminatorBeforeNextToken&&1114112&e.token){const r=e.tokenValue;i=Se(e,4096|n),0===function(e,n,t,r){if(null==t)return s$1(e,n,2,92,2),1;if(t["#"+r])return 1;for(;t=t.parentLabels;)if(t["#"+r])return 1;return 0}(e,n,t,r)&&a(e,n,126,r);}else 0==(1179648&n)&&a(e,n,41);return U(e,n),W(e,n,r,O.BreakStatement(i))}(e,n,r);case 201330783:return function(e,n){0==(64&n)&&a(e,n,26);const t=e.startIndex;L(e,4096|n);const r=R(e)?null:we(e,n);return U(e,n),W(e,n,t,O.ReturnStatement(r))}(e,n);case 201330787:return function(e,n){const t=e.startIndex;L(e,4096|n),e.lineTerminatorBeforeNextToken&&a(e,n,25);const r=we(e,n);return U(e,n),W(e,n,t,O.ThrowStatement(r))}(e,n);case 201330788:case 134221904:case 201330777:return function(e,n,t,r){const i=e.startIndex;M(e,4096|n,201330788);const o=ge(e,n,t,!1,r,null),a=134221904===e.token?function(e,n,t,r){const i=e.startIndex;let o=t,a=null;if(M(e,4096|n,134221904),z(e,n,2105356)){a=rn(e,4096|n,t=K(t,2),32768&e.token?256:128),M(e,4096|n,17),o=K(t,64);}const s=ge(e,n,o,!0,r,null);return W(e,n,i,O.CatchClause(a,s))}(e,n,t,r):null,c=z(e,4096|n,201330777)?ge(e,n,t,!1,r,null):null;a||c||s$1(e,n,2,120,2);return W(e,n,i,O.TryStatement(o,a,c))}(e,n,t,r);case 201330771:return function(e,n){const t=e.startIndex;return L(e,4096|n),U(e,n),W(e,n,t,O.DebuggerStatement())}(e,n);case 201330785:return function(e,n,t,r,i){const o=e.startIndex;M(e,n,201330785),M(e,4096|n,2105356);const a=we(e,n);M(e,n,17),M(e,n,40973);const s=function(e,n,t,r,i){const o=[];t=K(t,8);const a=33554432&(n=536870912^(806354944|n))?605102080:1681334272;for(;268435456&e.token;)o.push(ie(e,n,t,a,r,i,me));return o}(e,n,t,r,i);return M(e,4096|n,16400),W(e,n,o,O.SwitchStatement(a,s))}(e,n,t,r,o);case 201330790:return function(e,n,t,r,i){1024&n&&a(e,n,43);const o=e.startIndex;L(e,4096|n),M(e,4096|n,2105356);const s=we(e,n);M(e,4096|n,17);const c=fe(e,131072|n,t,r,i,!1);return W(e,n,o,O.WithStatement(s,c))}(e,n,t,r,o);case 67182704:return function(e,n,t){const r=e.startIndex;if(L(e,4096|n),201334875===e.token)return a(e,n,79),gn(e,4194304|n,t,!1);const i=W(e,n,r,O.IdentifierReference("async"));return e.assignable=!0,Ae(e,n,vn(e,n,i,r),r)}(e,n,t);case 201334875:return a(e,n,1024&n?75:4&n?76:77),gn(e,n,t,!1);case 201334865:return a(e,n,78),An(e,n,t);default:return function(e,n,t,r,i,o){const{startIndex:s,token:c,tokenValue:u}=e;let l=He(e,n,!0);if(c&(33554432&n?1114112:135331840)&&22===e.token)return Ie(e,n,t,c,u,r,i,o,s);537923660===c&&23109652===e.token&&a(e,n,111);return l=vn(e,n,l,s),Ae(e,n,l,s)}(e,n,t,r,o,c);}}function pe(e,n,t){switch(e.token){case 134221911:return Vn(e,n,t);case 201334877:const r=e.startIndex;return L(e,4096|n),z(e,4096|n,2105356)?Sn(e,n,r):z(e,n,6291470)?Bn(e,n,r):xe(e,n,t,r);default:return de(e,n,t,null,null);}}function xe(n,t,r,i){let o=null,a=null,c=null;return 16785412===n.token?o=Ke(n,t,!1):1114112&n.token||17049143===n.token||40973===n.token?(a=function(n,t,r){const i=n.startIndex;let o=null,a=null,c=null;if(1114112&n.token&&(o=Te(n,t,r,16),!z(n,t,33554451)))return W(n,t,i,O.ImportClause(o,a,c));17049143===n.token?a=function(e,n,t){return M(e,n,17049143),M(e,n,65647),Te(e,n,t,16)}(n,t,r):40973===n.token?c=function(e,n,t){const r=e.startIndex;M(e,n,40973);const i=[];for(;135331840&e.token&&(i.push(ke(e,n,t)),16400!==e.token);)M(e,n,33554451);return M(e,4096|n,16400),W(e,n,r,O.NamedImports(i))}(n,t,r):s$1(n,t,2,6,2,e[255&n.token]);return W(n,t,i,O.ImportClause(o,a,c))}(n,t,r),c=Nn(n,t)):s$1(n,t,2,6,2,e[255&n.token]),U(n,t),W(n,t,i,O.ImportDeclaration(c,o,a))}function ke(e,n,t){const{startIndex:r,tokenValue:i,token:o}=e,a=Be(e,n);let s=null,c=null,u=null;return 16785412===o?(s=Tn(e,n),M(e,n,65647),c=Te(e,n,t,16)):z(e,n,65647)?(u=a,c=Te(e,n,t,16)):($(e,n,o,e.startIndex),Z(e,n,t,i,16),c=a),W(e,n,r,O.ImportSpecifier(s,u,c))}function me(e,n,t,r,i,o){const a=[],s=e.startIndex;if(z(e,4096|n,402653263)){const c=we(e,n);for(M(e,4096|n,22);e.token&r;)a.push(de(e,n,t,i,o));return W(e,n,s,O.CaseClause(c,a))}for(M(e,n,402653268),M(e,4096|n,22);e.token&r;)a.push(de(e,n,t,i,o));return W(e,n,s,O.DefaultClause(a))}function he(e,n,t,r){return 1028&n||201334875!==e.token?fe(e,n,t,r,null,!1):gn(e,n,K(t,2),!0)}function ge(e,n,t,r,i,o){const a=e.startIndex,s=[];if(M(e,4096|(n=536870912^(806354944|n)),40973)){for(r||(t=K(t,2));537997312&e.token;)s.push(re(e,n,t,i,o,de));M(e,4096|n,16400);}return W(e,n,a,O.BlockStatement(s))}function be(e,n,t,r,i){const o=[];let c=0;for(;1146880&e.token;)if(o.push(oe(e,n,t,r,i)),c++,!z(e,n,33554451)){if(540672&e.token||e.lineTerminatorBeforeNextToken)break;s$1(e,n,2,17,2);}if(c>1&&524288&e.token){a(e,n,589942===e.token?114:115);}return o}function ye(e,n,t,r){const i=e.startIndex;let o=null;const s=32768&e.token,c=rn(e,n,t,r);if(z(e,4096|n,131102)){if(o=Ee(e,n),524288&e.token){a(e,n,589942===e.token?113:112);}}else !s&&32!==r||524288==(524288&e.token)||a(e,n,45);return W(e,n,i,O.LexicalBinding(c,o))}function Ce(e,n,t,r){const i=e.startIndex;let o,s=null;if(32768&e.token){if(o=tn(e,n,t,r),z(e,4096|n,131102)){if(s=Ee(e,n),524288&e.token){a(e,n,(e.token,112));}}else 524288!=(524288&e.token)&&a(e,n,45);}else if(o=Te(e,n,t,r),z(e,4096|n,131102)&&(s=Ee(e,n),589942===e.token||135014453===e.token&&1028&n)){a(e,n,(e.token,112));}return W(e,n,i,O.VariableDeclaration(o,s))}function Ie(e,n,t,r,i,o,a,c,u){o=function(e,n,t,r,i){let o=r;for(;o;)o["#"+t]&&s$1(e,n,2,92,2),o=o.parentLabels;return (r={parentLabels:r,iterationLabels:null})["#"+t]=!0,i?i.push(t):i=[t],r}(e,n,i,o,a),L(e,4096|n),$(e,n,r,u),a=function(e,n,t,r){return r?r.push(n):r=[n],function(e){return 201330778===e||201330789===e||201330773===e}(e)&&(t.iterationLabels=r),r}(e.token,i,o,a);const l=W(e,n,u,O.LabelIdentifier(i)),d=!c||1028&n||201334875!==e.token?fe(e,n,t,o,a,c):gn(e,n,t,!0);return W(e,n,u,O.LabelledStatement(l,d))}function Ae(e,n,t,r){return U(e,n),W(e,n,r,O.ExpressionStatement(t))}function Ee(e,n){const t=e.startIndex;return Fe(e,n,De(e,n,!0),t)}function we(e,n){const t=e.startIndex;return ve(e,n,Ee(e,8192^(8192|n)),t)}function ve(e,n,t,r){if(33554451!==e.token)return t;const i=[t];for(;z(e,4096|n,33554451);)i.push(Ee(e,n));return W(e,n,r,O.CommaOperator(i))}function Se(e,n){const t=e.startIndex,r=G(e,n,t);return L(e,n),e.assignable=!0,W(e,n,t,O.IdentifierReference(r))}function Be(e,n){if(33554432&n&&0==(135331840&e.token))return a(e,n,20),L(e,n),W(e,n,e.endIndex,O.IdentifierName(""));const t=e.startIndex,r=e.tokenValue;return L(e,n),e.assignable=!0,W(e,n,t,O.IdentifierName(r))}function Te(e,n,t,r){let i=e.tokenValue;2098176&n&&1056878===e.token?a(e,n,90):(4196352&n)>0&&73841===e.token?a(e,n,91):(134217728&e.token||0==(135331840&e.token))&&(s$1(e,n,2,19,2),i=""),1024&n&&1048576&e.token&&(s$1(e,n,2,18,2),i=""),48&r&&537923660===e.token&&a(e,n,87),Q(e,n,t,e.tokenValue,r),16384&r&&ee(e,n,e.tokenValue);const o=e.startIndex;return L(e,n),e.assignable=!0,W(e,n,o,O.BindingIdentifier(i))}function Ne(e,n,t,r){const i=e.startIndex;M(e,4096|n,671092811);const o=function(e,n,t,r){const i=[],o=33554432&n?1146880:1163264;for(;e.token&o&&(i.push(oe(e,n,t,r,Ve)),!R(e));)z(e,n,33554451)?0==(e.token&o)&&s$1(e,n,2,116,2):z(e,n,6291470)?s$1(e,n,2,5,2,","):s$1(e,n,2,116,2);return i}(e,n,t,r);return U(e,n),W(e,n,i,O.VariableStatement(o))}function Ve(e,n,t,r){const i=e.startIndex;let o,s=null;return 32768&e.token?(o=tn(e,n,t,r),131102===e.token?(L(e,4096|n),s=Ee(e,n)):a(e,n,45)):(o=Te(e,4096|n,t,r),z(e,4096|n,131102)&&(s=Ee(e,n))),W(e,n,i,O.VariableDeclaration(o,s))}function Le(e,n,t,r,i,o){const c=e.startIndex;if(L(e,n),16&r&&0==(135364608&e.token))return function(e,n,t,r,i){let o;1024&n&&a(e,n,85);if(11===e.token)return o=Cn(e,n,{},!1,W(e,n,t,O.BindingIdentifier("let")),0,t),Ae(e,n,vn(e,n,o,t),t);if(e.assignable=!0,o=W(e,n,t,O.IdentifierReference("let")),22===e.token)return Ie(e,n,void 0,537923660,"let",r,i,!1,t);return Ae(e,n,vn(e,n,o,t),t)}(e,n,c,i,o);const u=function(e,n,t,r){const i=[],o=33554432&n?1146880:1163264;for(;e.token&o&&(i.push(oe(e,n,t,r,Pe)),!R(e));)z(e,n,33554451)?0==(e.token&o)&&s$1(e,n,2,16,2):z(e,n,6291470)?s$1(e,n,2,5,2,","):s$1(e,n,2,16,2);return i}(e,268435456^(268435456|n),t,r);return U(e,n),W(e,n,c,O.LexicalDeclaration(32==(32&r),u))}function Pe(e,n,t,r){const i=e.startIndex;let o,s=null;return 32768&e.token?(o=tn(e,n,t,r),131102===e.token?(L(e,4096|n),s=Ee(e,n)):a(e,n,45)):(o=Te(e,n,t,r),z(e,4096|n,131102)?s=Ee(e,n):32===r&&a(e,n,45)),W(e,n,i,O.LexicalBinding(o,s))}function Fe(n,t,r,i){if(131072==(131072&n.token)){n.assignable||a(n,t,97);const o=e[255&n.token];L(n,4096|t);const s=Ee(n,t);return n.assignable=!1,n.destructible=0,W(n,t,i,O.AssignmentExpression(r,o,s))}return Oe(n,t,r,i)}function Oe(n,t,r,i){const o=function n(t,r,i,o,a){const s=135014453&-((8192&r)>0);let c,u;for(;(262144&t.token)>0;){if(c=t.token,u=3840&c,u+((273466===c)<<8)-((s===c)<<12)<=o)return i;L(t,4096|r),i=W(t,r,a,O.BinaryExpression(i,e[255&c],n(t,r,De(t,r,!1),u,t.startIndex))),t.assignable=!1;}return i}(n,t,r,4,i);if(23!==n.token)return o;L(n,4096|t);const a=Ee(n,8192^(8192|t));M(n,4096|t,22);const s=Ee(n,t);return n.assignable=!1,W(n,t,i,O.ConditionalExpression(o,a,s))}function De(e,n,t){const r=e.startIndex;return Re(e,n,He(e,n,t),!0,r)}function Re(e,n,t,r,i){const o=r?2097152:4194304;for(;e.token&o;)switch(e.token){case 2105373:case 2105372:return _e(e,n,t);case 23109652:{L(e,4096|n);const r=we(e,n);M(e,n,21),e.assignable=!0,t=W(e,n,i,O.MemberExpression(t,r,!0));break}case 6291470:e.assignable=!0,L(e,4096|n),t=W(e,n,i,O.MemberExpression(t,Ue(e,n),!1));break;case 2105356:t=W(e,n,i,O.CallExpression(t,qe(e,8192^(8192|n)))),e.assignable=!1;break;case 2097177:t=W(e,n,i,O.OptionalExpression(t,Me(e,n))),e.assignable=!1;break;default:const r=6299657===e.token?Je(e,n):Qe(e,65536|n);t=W(e,n,i,O.TaggedTemplate(t,r));}return t}function Ue(e,n){if(135331840&e.token){const{startIndex:t,tokenValue:r}=e;return L(e,n),W(e,n,t,O.IdentifierName(r))}return ne(e,n)}function Me(e,n){M(e,n,2097177);let t=null,r=e.startIndex;for(z(e,4096|n,23109652)?(t=Ee(e,n),z(e,n,21)):2105356===e.token?t=qe(e,n):135331840&e.token?t=Ue(e,n):a(e,n,80),e.assignable=!1,t=W(e,n,r,O.OptionalChain(t));;)if(r=e.startIndex,z(e,4096|n,6291470))t=ze(e,n,t,Be(e,n),!1,r),t=W(e,n,r,O.OptionalChain(t)),e.assignable=!1;else if(2105356===e.token)t=je(e,n,t,qe(e,n),r),t=W(e,n,r,O.OptionalChain(t));else if(z(e,4096|n,23109652))e.assignable=!1,t=ze(e,n,t,Ee(e,n),!0,r),z(e,n,21),t=W(e,n,r,O.OptionalChain(t)),e.assignable=!1;else {if(!(135331840&e.token))return 6299658!==e.token&&6299657!==e.token||a(e,n,80),t;t=ze(e,n,t,Be(e,n),!1,r),t=W(e,n,r,O.OptionalChain(t)),e.assignable=!1;}}function ze(e,n,t,r,i,o){return W(e,n,o,O.MemberChain(t,r,i))}function je(e,n,t,r,i){return W(e,8192^(8192|n),i,O.CallChain(t,r))}function qe(e,n){const t=[];M(e,4096|n,2105356);const r=33554432&n?11640832:704110592;for(;e.token&r;)if(t.push(ae(e,n,We)),!z(e,4096|n,33554451)){if(17===e.token)break;s$1(e,n,2,5,2,",");}return M(e,n,17),t}function We(e,n){if(8388623===e.token){L(e,4096|n);return W(e,n,e.startIndex,O.AssignmentRestElement(Ee(e,n)))}return Ee(e,n)}function _e(n,t,r){if(n.lineTerminatorBeforeNextToken)return r;n.assignable||a(n,t,98);const i=n.startIndex,o=e[255&n.token];return L(n,t),n.assignable=!1,W(n,t,i,O.PostfixUpdateExpression(o,r))}function He(n,t,r){if(1114112&n.token){if(2097152&t&&1056878===n.token)return function(e,n){8388608&n&&a(e,n,24);const t=e.startIndex;L(e,4096|n);let r=null,i=!1;const o=e.token;return 17049143===o?(e.lineTerminatorBeforeNextToken&&(a(e,n,7),e.flags|=4),L(e,4096|n),r=Ee(e,n),i=!0):8192&o&&(r=Ee(e,n)),e.assignable=!1,W(e,n,t,O.YieldExpression(i,r))}(n,t);if(4194304&t&&73841===n.token)return function(e,n){8388608&n&&a(e,n,23);const t=e.startIndex;return L(e,4096|n),e.assignable=!1,W(e,n,t,O.AwaitExpression(Ee(e,n)))}(n,t);if(67182704===n.token)return hn(n,t,r);const e=n.startIndex,i=G(n,t,e);return L(n,65536|t),11===n.token?bn(n,t,W(n,t,e,O.BindingIdentifier(i)),i,r,0,e):(n.assignable=!0,W(n,t,e,O.IdentifierReference(i)))}switch(n.token){case 2105373:case 2105372:return function(n,t){const r=n.startIndex,i=e[255&n.token];L(n,4096|t);const o=De(n,t,!1);return n.assignable||a(n,t,99),n.assignable=!1,W(n,t,r,O.PrefixUpdateExpression(i,o))}(n,t);case 134225966:case 134225967:case 134225968:case 8241:case 8242:case 271667:case 272948:return function(n,t){const r=n.startIndex,i=n.token,o=e[255&i];L(n,4096|t);const s=De(n,t,!1);return 273466===n.token&&a(n,t,34),1024==(1024&t)&&134225967===i&&"IdentifierReference"===s.type&&a(n,t,35),n.assignable=!1,W(n,t,r,O.UnaryExpression(o,s))}(n,t);case 16785410:return Ye(n,t);case 16785535:return $e(n,t);case 16785411:return Ge(n,t);case 16785412:return Ke(n,t,!1);case 151003144:return function(e,n){const t=e.startIndex;return L(e,n),e.assignable=!1,W(e,n,t,O.NullExpression())}(n,t);case 134226018:return function(e,n){const t=e.startIndex;return L(e,n),e.assignable=!1,W(e,n,t,O.ThisExpression())}(n,t);case 151003143:case 151003142:return function(n,t){const r=n.startIndex,i="true"===e[255&n.token];return n.assignable=!1,L(n,t),W(n,t,r,O.BooleanLiteral(i))}(n,t);case 2105356:return function(e,n,t){const r=e.startIndex;M(e,4096|(n=8192^(8192|n)),2105356);const i=K({parent:void 0,type:2},1024);let o=[],a=0,c=!1,u=e.startIndex;if(z(e,n,17)){if(11===e.token)return In(e,n,i,t,a,0,o,r);o=ne(e,n,46);}else {if(8388623===e.token){const t=on(e,n,i,8);return M(e,n,17),Cn(e,n,i,!0,[t],0,r)}if(135331840&e.token)Z(e,n,i,e.tokenValue,8),o=He(e,n,!0),33554451===e.token||17===e.token?e.assignable||(a|=4):(131102!==e.token&&(a|=4),o=Re(e,n,o,!0,u),17!==e.token&&33554451!==e.token&&(o=Fe(e,n,o,u)));else {if(!(32768&e.token))return a|=4,o=Ee(e,n),o=ve(e,n,o,r),M(e,n,17),e.destructible=a,W(e,n,r,O.ParenthesizedExpression(o));o=23109652===e.token?an(e,n,i,0,8):ln(e,n,i,0,8),a|=e.destructible,e.assignable=!1,33554451!==e.token&&17!==e.token&&(8&a&&s$1(e,n,2,96,2),o=Re(e,n,o,!0,u),a|=4,33554451===e.token&&2105356===e.token||(o=Fe(e,n,o,u),a|=e.assignable?2:4));}if(z(e,4096|n,33554451)){const t=[o];c=!0,17===e.token&&(a|=16);const l=33554432&n?9543680:704110592;for(;e.token&l;){if(u=e.startIndex,135331840&e.token)Z(e,n,i,e.tokenValue,8),o=He(e,n,!0),33554451===e.token||17===e.token?e.assignable||(a|=4):(131102!==e.token&&(a|=4),o=Re(e,n,o,!0,u),17!==e.token&&33554451!==e.token&&(o=Fe(e,n,o,u)));else {if(!(32768&e.token)){if(8388623===e.token){t.push(on(e,n,i,8)),4&e.destructible&&s$1(e,n,2,96,2);break}for(a|=4,t.push(Ee(e,n));z(e,4096|n,33554451);)t.push(Ee(e,n));return o=W(e,n,r,O.CommaOperator(t)),M(e,n,17),e.destructible=a,W(e,n,r,O.ParenthesizedExpression(o))}o=23109652===e.token?an(e,n,i,0,8):ln(e,n,i,0,8),a|=e.destructible,e.assignable=!1,33554451!==e.token&&17!==e.token&&(8&a&&s$1(e,n,2,96,2),o=Re(e,n,o,!0,u),a|=4,33554451===e.token&&2105356===e.token||(o=Fe(e,n,o,u),a|=e.assignable?2:4));}if(t.push(o),!z(e,n,33554451)&&17===e.token)break}e.assignable=!1,o=W(e,n,r,O.CommaOperator(t));}if(M(e,n,17),33554432&n&&4&a)return e.destructible=a,W(e,n,r,O.ParenthesizedExpression(o));if(11===e.token){return In(e,n,i,t,a,0,c?o.expressions:[o],r)}24&a&&s$1(e,n,2,16&a?101:96,2);}return e.destructible=a,W(e,n,r,O.ParenthesizedExpression(o))}(n,t,r);case 201334875:return hn(n,t,r);case 201334865:return function(e,n){const t=e.startIndex;M(e,n,201334865);let r=16777216^(16777216|n);n|=1024;let i=null,o=null;e.token&(33554432&n?1114112:135331840)&&134217816!==e.token&&(i=Te(e,n,void 0,0));z(e,4096|n,134217816)?(o=De(e,n,!1),r|=524288):r=524288^(524288|r);return e.assignable=!1,W(e,n,t,O.ClassExpression(i,o,En(e,r,n)))}(n,t);case 134221918:return function(e,n){const t=e.startIndex;if(L(e,4096|n),67108864&n&&6291470===e.token)return L(e,n),65655!==e.token&&a(e,n,93,e.tokenValue),L(e,n),W(e,n,t,O.Target());let r=He(e,n,!0);2097177===e.token&&a(e,n,129);r=Re(e,n,r,!1,t);const i=2105356===e.token?qe(e,n):[];return e.assignable=!1,W(e,n,t,O.NewExpression(r,i))}(n,t);case 201334877:return function(e,n){const t=e.startIndex;if(L(e,n),134217728&n&&z(e,n,6291470))return M(e,n,65656),W(e,n,t,O.ImportMeta());M(e,4096|n,2105356);const r=Ee(e,n);return M(e,n,17),W(e,n,t,O.ImportCall(r))}(n,t);case 23109652:const o=an(n,t,void 0,0,512);return 32&n.flags&&i(n,t,1,137),8==(8&n.destructible)&&s$1(n,t,2,100,2),o;case 40973:{const e=ln(n,t,void 0,0,512);return 32&n.flags&&i(n,t,1,137),8==(8&n.destructible)&&s$1(n,t,2,100,2),e}case 134226016:return function(e,n){const t=e.startIndex;if(L(e,n),2105356===e.token){0==(524288&n)&&a(e,n,32);const r=qe(e,n);return W(e,n,t,O.SuperCall(r))}0==(262144&n)&&a(e,n,31);let r,i=!1;z(e,4096|n,23109652)?(r=Ee(e,n),M(e,n,21),i=!0):(6291470!==e.token&&a(e,n,2097177===e.token?33:136),z(e,n,6291470),r=Be(e,n));return e.assignable=!0,W(e,n,t,O.SuperProperty(r,i))}(n,t);case 8197:return function(e,n){const t=e.startIndex,r=e.regExpFlags,i=e.regExpPattern;return L(e,n),e.assignable=!1,W(e,n,t,O.RegularExpressionLiteral(i,r))}(n,t);case 6299657:return Je(n,t);case 6299658:return Qe(n,t);default:return ne(n,t);}}function Ye(e,n){const t=e.startIndex,r=e.tokenValue;return e.assignable=!1,L(e,n),W(e,n,t,O.NumericLiteral(r))}function $e(e,n){const t=e.startIndex,r=e.tokenValue;return e.assignable=!1,L(e,n),W(e,n,t,O.FloatingPointLiteral(r))}function Ge(e,n){const t=e.startIndex,r=e.tokenValue;return e.assignable=!1,L(e,n),W(e,n,t,O.BigInt(r))}function Je(e,n){const t=e.startIndex;L(e,n);const r=e.tokenValue,i=e.tokenRaw;return e.assignable=!1,W(e,n,t,O.TemplateLiteral(r,i))}function Ke(e,n,t){const r=e.startIndex,i=e.tokenValue;if(L(e,n),e.assignable=!1,t&&D(e)){const t=e.source.slice(r+1,e.endIndex-1);return W(e,n,r,O.Directive(i,t))}return W(e,n,r,O.StringLiteral(i))}function Qe(e,n){const t=e.startIndex,r=[];do{r.push(Xe(e,n));}while(6299658===(e.token=y$1(e,n)));return r.push(function(e,n){const t=e.startIndex,r=e.tokenValue,i=e.tokenRaw;return W(e,n,t,O.TemplateElement(i,r,null))}(e,n)),M(e,4096|n,6299657),W(e,n,t,O.TemplateExpression(r))}function Xe(e,n){const t=e.startIndex,r=e.tokenValue,i=e.tokenRaw;M(e,4096|n,6299658);const o=we(e,n);return W(e,n,t,O.TemplateElement(i,r,o))}function Ze(e,n,t){const r=e.startIndex;let i;return L(e,n),135331840&e.token?(i=Te(e,n,void 0,t),W(e,n,r,O.BindingRestProperty(i))):(s$1(e,n,2,19,2),i=W(e,n,r,O.BindingIdentifier("")),131102===e.token&&a(e,n,106),W(e,n,r,O.BindingRestProperty(i)))}function en(e,n,t,r){const i=e.startIndex;let o;if(135331840&e.token){const a=e.tokenValue,s=e.token;if(L(e,n),z(e,n,22)){o=W(e,n,i,O.IdentifierName(a));const s=nn(e,n,t,r);return W(e,n,i,O.PropertyName(o,s))}if($(e,n,s,i),Q(e,n,t,a,r),o=W(e,n,i,O.BindingIdentifier(a)),!z(e,4096|n,131102))return o;const c=Ee(e,n);return W(e,n,i,O.BindingElement(o,c))}o=pn(e,n),z(e,n,22);const a=nn(e,n,t,r);return W(e,n,i,O.PropertyName(o,a))}function nn(e,n,t,r){const i=e.startIndex,o=32768&e.token?tn(e,n,t,r):Te(e,n,t,r);if(!z(e,4096|n,131102))return o;const a=Ee(e,n);return W(e,n,i,O.BindingElement(o,a))}function tn(e,n,t,r){return 40973===e.token?function(e,n,t,r){const i=e.startIndex;M(e,n,40973);const o=[],c=33554432&n?160497664:160538624;for(;e.token&c;){if(8388623===e.token){if(o.push(Ze(e,n,r)),!z(e,n,33554451))break;a(e,n,16400===e.token?105:107);}if(o.push(en(e,n,t,r)),16400===e.token)break;z(e,n,33554451)||s$1(e,n,2,5,2,",");}return M(e,n,16400),W(e,n,i,O.ObjectBindingPattern(o))}(e,n,t,r):function(e,n,t,r){const i=e.startIndex;L(e,4096|(n=8192^(8192|n)));const o=[],c=33554432&n?43089920:177315840;for(;e.token&c;)if(z(e,4096|n,33554451))o.push(W(e,n,i,O.Elison()));else {if(8388623===e.token){if(o.push(on(e,n,t,r)),33554451!==e.token)break;L(e,n),a(e,n,16400===e.token?105:107);}if(o.push(nn(e,n,t,r)),21===e.token)break;if(z(e,4096|n,33554451))continue;s$1(e,n,2,5,2,",");}return M(e,n,21),W(e,n,i,O.ArrayBindingPattern(o))}(e,n,t,r)}function rn(e,n,t,r){return 32768&e.token?tn(e,n,t,r):Te(e,n,t,r)}function on(e,n,t,r){const i=e.startIndex;let o;return L(e,n),1146880&e.token?o=rn(e,n,t,r):(s$1(e,n,2,19,2),o=W(e,n,i,O.BindingIdentifier(""))),131102===e.token&&a(e,n,106),e.destructible=0,W(e,n,i,O.BindingRestElement(o))}function an(e,n,t,r,i){const o=e.startIndex;L(e,4096|n);const a=[];let c=0;const u=33554432&(n=8192^(8192|n))?43098112:177315840;for(;e.token&u;)if(z(e,4096|n,33554451))a.push(W(e,n,e.startIndex,O.Elison()));else {if(a.push(sn(e,n,t,i)),c|=e.destructible,21===e.token)break;if(z(e,4096|n,33554451))continue;s$1(e,n,2,5,2,",");}M(e,n,21);const l=W(e,n,o,O.ArrayLiteral(a));return 131072&e.token?dn(e,n,c,l,r,o):(e.destructible=c,l)}function sn(e,n,t,r){const i=e.startIndex,o=e.tokenValue;if(8388623===e.token)return function(e,n,t,r,i){const o=un(e,n,21,!1,t,r,i);return W(e,n,i,O.SpreadElement(o))}(e,n,t,r,i);if(135331840&e.token){let a=He(e,n,!0);if(131102===e.token)return Fe(e,n,a,i);if(21===e.token||33554451===e.token){let i=0;return e.assignable?Q(e,n,t,o,r):i|=4,e.destructible=i,a}let s=8&r?2:512!=(512&r)?4:0;return a=Re(e,n,a,!0,i),(!e.assignable||131102!==e.token&&33554451!==e.token&&21!==e.token)&&(s|=4),a=Fe(e,n,a,i),e.destructible=s,a}if(32768&e.token){let o=23109652===e.token?an(e,n,t,0,r):ln(e,n,t,0,r),a=e.destructible;return 2105344&e.token?(8&a&&s$1(e,n,2,102,2),o=Re(e,n,o,!0,i),a=e.assignable?0:4,o=Fe(e,n,o,i)):23===e.token&&(o=Oe(e,n,o,i),a=4),e.destructible=a,o}const a=e.token;let c=0,u=De(e,n,!0);return 33554451!==e.token&&21!==e.token?u=Fe(e,n,u,i):e.assignable?2105356===a&&(c|=e.assignable?2:4):c|=4,e.destructible=c,u}function cn(e,n,t,r,i){const o=un(e,n,17,!1,t,r,i);return W(e,n,i,O.AssignmentRestElement(o))}function un(e,n,t,r,i,o,s){L(e,4096|n);const c=e.startIndex;if(135331840&e.token){const r=e.tokenValue;let a=He(e,n,!0);if(e.token===t)return e.destructible=e.assignable?1:4,a;if(33554451===e.token)return e.destructible=4,a;a=Re(e,n,a,!0,c);let s=0;return 33554451!==e.token&&e.token!==t&&(s|=4,a=Fe(e,n,a,c)),e.assignable?33554451===e.token||e.token===t?Q(e,n,i,r,o):s|=2:s|=4,e.destructible=s|=e.assignable?2:4,a}if(32768&e.token){let c=23109652===e.token?an(e,n,i,1,o):ln(e,n,i,1,o);return e.token===t?(r&&(e.destructible|=4),c):33554451===e.token?(e.destructible=4,c):(8&e.destructible&&a(e,n,96),c=Re(e,n,c,!0,s),c=Fe(e,n,c,s),e.destructible=e.assignable?2:4,c)}let u=De(e,n,!0);return 8192&e.token?(u=Fe(e,n,u,c),e.destructible|=4,u):33554451===e.token?(e.destructible=4,u):(u=Fe(e,n,u,c),e.destructible=e.assignable?2:4,u)}function ln(e,n,t,r,i){const o=e.startIndex;M(e,4096|n,40973);const a=[];let c=0,u=0;for(e.flags=32^(32|e.flags);160497664&e.token&&(a.push(fn(e,n,t,i)),c|=e.destructible,32&e.destructible&&u++,16400!==e.token);)z(e,4096|n,33554451)||s$1(e,n,2,5,2,",");M(e,n,16400);const l=W(e,n,o,O.ObjectLiteral(a));return 131072&e.token?dn(e,n,c,l,r,o):(u>1&&(e.flags|=32),e.destructible=c,l)}function dn(e,n,t,r,i,o){131102!==e.token&&a(e,n,27),4&t&&a(e,n,96),L(e,4096|n),H(r),2===i&&(n|=8192);const s=Ee(e,n);return e.destructible=40^(40|t|(0!==i?4:0)),W(e,n,o,O.AssignmentElement(r,s))}function fn(e,n,t,r){const{startIndex:i,token:o}=e;if(8388623===o)return function(e,n,t,r,i){const o=un(e,n,16400,!0,t,r,i);return W(e,n,i,O.SpreadProperty(o))}(e,n,t,r,i);let a,c=0,u=0;const l=e.tokenValue;if(135331840&o){if(L(e,n),33701888&e.token){if("eval"===l||"arguments"===l?u|=4:$(e,n,o,i),a=W(e,n,i,P(l)),Q(e,n,t,l,r),z(e,4096|n,131102)){const t=Ee(e,n);return e.destructible=8,W(e,n,i,O.CoverInitializedName(a,t))}return e.destructible=u,a}if(152109056&e.token)return 67182704!==o||e.lineTerminatorBeforeNextToken?65651===o?c|=2:65652===o&&(c|=4):(c|=1,j(e,n,17049143)&&(c|=16)),23&c?mn(e,n,pn(e,n),c):W(e,n,i,P(l));a=W(e,n,i,F(l));}else j(e,4096|n,17049143)&&(c|=16),a=pn(e,n);if(2105356===e.token)return mn(e,n,a,c);if(z(e,4096|n,22)){let o;const c=e.startIndex;if(135331840&e.token){0==(4&n)&&"__proto__"===l&&(u|=32);const i=e.tokenValue;o=He(e,n,!0);const a=e.token;o=Re(e,n,o,!0,c),33570816&e.token?33701888&a?e.assignable||(u|=4):u|=e.assignable?2:4:131102===e.token?(e.assignable?(Q(e,n,t,i,r),u|=0):u|=4,o=Fe(e,n,o,c)):(u|=4,o=Fe(e,n,o,c));}else if(32768&e.token)o=40973===e.token?ln(e,n,t,0,r):an(e,n,t,0,r),u=e.destructible,0==(33570816&e.token)&&(8&e.destructible&&s$1(e,n,2,96,2),o=Re(e,n,o,!0,i),u=e.assignable?2:4,o=Fe(e,n,o,i));else {o=De(e,n,!0);const t=131102===e.token;o=Fe(e,n,o,i),u|=e.assignable||t?2:4,0==(4&n)&&"__proto__"===l&&(u|=32);}return e.destructible=u,W(e,n,i,O.PropertyName(a,o))}return s$1(e,n,2,36,2),a}function pn(e,n){const t=e.startIndex;if(z(e,4096|n,23109652)){const r=Ee(e,8192^(8192|n));return M(e,n,21),W(e,n,t,O.ComputedPropertyName(r))}return 16785412===e.token?Ke(e,n,!1):16785410===e.token?Ye(e,n):16785535===e.token?$e(e,n):16785411===e.token?Ge(e,n):Be(e,n)}function xn(e,n,t){const i=[];let o=!1;if(M(e,n=8192^(8192|n),2105356)){const r=33554432&n?9535488:704110592;for(;e.token&r;){if(8388623===e.token){if(i.push(on(e,n,t,0)),o=!0,33554451!==e.token)break;L(e,n),a(e,n,16400===e.token?105:108);}if(32768&e.token)o=!0,i.push(oe(e,n,t,8,nn));else {const r=e.startIndex;1048576&e.token&&(e.flags|=128);const a=Te(e,n,t,8);if(z(e,4096|n,131102)){const t=Ee(e,n);o=!0,i.push(W(e,n,r,O.BindingElement(a,t)));}else i.push(a);}if(!z(e,n,33554451)){if(17===e.token)break;s$1(e,n,2,5,2,",");}}M(e,n,17);}return (o||1024&n)&&r(e,n,t,124),o&&(e.flags|=256),i}function kn(e,n,t,i,o){const s=e.startIndex,c=[],u=[];if(M(e,4096|n,40973)){const s=0==(1024&n);for(;16785412===e.token;){const t=e.startIndex,r=Ke(e,n,!0);D(e)?(J(e,t)&&(256&e.flags&&a(e,n,140),n|=1024),U(e,n),c.push(r)):u.push(Ae(e,n,vn(e,n,r,t),t));}for(1024&n&&(s&&r(e,n,t,124),i&&1048576&i&&a(e,n,139),128&e.flags&&a(e,n,18),16&e.flags&&a(e,n,67)),t=K(t,128),e.flags=400^(400|e.flags),n=128^(268435520|n);537997312&e.token;)u.push(re(e,n,t,null,null,de));M(e,o?4096|n:n,16400),e.flags=256^(256|e.flags);}return W(e,n,s,O.FunctionBody(c,u))}function mn(e,n,t,i){const o=32&i?15867968:33169472;n=(67371008|n|o)^o|(1&i?4194304:0)|(16&i?2097152:0);const a=e.startIndex;let c=null,u=[];const l=K({parent:void 0,type:2},512);return 2&i?(M(e,n,2105356),function(e,n,t,r){e.token===t?L(e,n):s$1(e,n,2,r,2);}(e,n,17,138)):4&i?(M(e,n,2105356),c=nn(e,n,l,8),r(e,n,l,124),M(e,n,17)):u=function(e,n,t){const i=xn(e,8388608|n,t);return r(e,n,t,124),i}(e,n,l),e.destructible=4,W(e,n=128^(67109056|n),a,O.MethodDefinition(1==(1&i),16==(16&i),2==(2&i),4==(4&i),c,u,t,kn(e,n,l,void 0,!1)))}function hn(e,n,t){const r=e.startIndex;let i=0;if(z(e,n,67182704)){if(201334875!==e.token||e.lineTerminatorBeforeNextToken)return function(e,n,t,r){const i=e.lineTerminatorBeforeNextToken;if(!i&&1114112&e.token)return Cn(e,n,{},!1,Te(e,n,{},0),1,r);const o=W(e,n,r,O.IdentifierReference("async"));if(2105356===e.token)return yn(e,n,o,i,t,r);if(11===e.token)return Cn(e,n,{},!1,W(e,n,r,O.BindingIdentifier("async")),0,r);return e.assignable=!0,o}(e,n,t,r);i=2;}M(e,4096|n,201334875),n=33464320^(100573184|n)|i+j(e,n,17049143)<<21;let o,a={parent:void 0,type:2},s=null;if(e.token&(33554432&n?1114112:135331840)){o=e.token;const t=e.tokenValue;s=Y(e,n),X(e,n,a,t,64);}else 2105356!==e.token&&(s=te(e,n,19,!1),a=K(a,256));a=K(a,512);const c=xn(e,8388608|n,a),u=kn(e,n,a,o,!1);return e.assignable=!1,W(e,n,r,O.FunctionExpression(s,0!=(2097152&n),0!=(4194304&n),c,u))}function gn(e,n,t,r,i=!1){const o=e.startIndex;let s=0;if(z(e,n,67182704)){if(201334875!==e.token||e.lineTerminatorBeforeNextToken)return function(e,n,t){const r=e.lineTerminatorBeforeNextToken;if(!r&&1114112&e.token){const r=e.tokenValue;let i=bn(e,n,Te(e,n,{},0),r,!0,1,t);return i=ve(e,n,i,t),Ae(e,n,i,t)}let i=W(e,n,t,O.IdentifierReference("async"));if(22===e.token)return Ie(e,n,void 0,67182704,"async",[],null,!1,t);11===e.token?i=bn(e,n,W(e,n,t,O.BindingIdentifier("async")),"async",!0,0,t):2105356===e.token&&(i=yn(e,n,i,r,!0,t));return e.assignable=!0,i=vn(e,n,i,t),Ae(e,n,i,t)}(e,n,o);s=2;}M(e,4096|n,201334875),z(e,n,17049143)&&(r&&a(e,n,132),s++),s<<=21;let c,u={parent:void 0,type:2},l=null;if(e.token&(33554432&n?1114112:135331840)){const r=e.tokenValue;c=e.token,l=Y(e,n|(3072&n)<<11),536870912&n&&2048!=(2048&n)?X(e,n,t,r,64):Z(e,n,t,r,1024),i&&ee(e,n,r),u=K(u,256);}else 32768!=(32768&n)&&(8192&e.token?(c=e.token,l=te(e,n,19,!1)):(a(e,n,10),u=K(u,256)));n=33464320^(100573184|n)|s,u=K(u,512);const d=xn(e,8388608|n,u),f=kn(e,n,u,c,!0);return W(e,n,o,O.FunctionDeclaration(l,0!=(2097152&n),0!=(4194304&n),d,f))}function bn(e,n,t,r,i,o,s){i||(a(e,n,7),e.flags|=4);const c=K({parent:void 0,type:2},1024);return Z(e,n,c,r,8),Cn(e,n,c,!1,t,o,s)}function yn(e,n,t,r,i,o){L(e,4096|n);const c=K({parent:void 0,type:2},1024);if(z(e,n,17))return 11===e.token?(r&&a(e,n,130),Cn(e,n,c,!0,[],1,o)):W(e,n,o,O.CallExpression(t,[]));const u=33554432&n?9543680:704110592;let l,d=0;const f=[];for(;e.token&u;){const r=e.startIndex;if(135331840&e.token)l=He(e,n,!0),33554451===e.token||17===e.token?e.assignable||(d|=4):(131102!==e.token&&(d|=4),l=Re(e,n,l,!0,r),17!==e.token&&33554451!==e.token&&(l=Fe(e,n,l,r)));else if(32768&e.token)l=23109652===e.token?an(e,n,c,0,8):ln(e,n,c,0,8),d|=e.destructible,e.assignable=!1,33554451!==e.token&&17!==e.token&&(8&d&&s$1(e,n,2,96,2),l=Re(e,n,l,!0,r),d|=4,33554451===e.token&&2105356===e.token||(l=Fe(e,n,l,r),d|=e.assignable?2:4));else {if(8388623!==e.token){do{f.push(We(e,n));}while(z(e,4096|n,33554451));return M(e,n,17),e.assignable=!1,W(e,n,o,O.CallExpression(t,f))}l=cn(e,n,c,8,r),d|=e.destructible,d|=17===e.token?0:4;}if(f.push(l),!z(e,4096|n,33554451)&&17===e.token)break}return M(e,n,17),33554432&n&&4&d?(e.assignable=!1,W(e,n,o,O.CallExpression(t,f))):11===e.token?(r&&a(e,n,130),In(e,n,c,i,d,1,f,o)):(8&d&&s$1(e,n,2,96,2),e.assignable=!1,W(e,n,o,O.CallExpression(t,f)))}function Cn(e,n,t,i,o,a,c){if(M(e,4096|n,11),n=15728640^(15728640|n)|a<<22|64,i){let e=o.length;for(;e--;)_(o[e]);}return e.assignable=!1,W(e,n,c,O.ArrowFunction(o,function(e,n,t){if(r(e,n,t,124),40973===e.token){const r=kn(e,67108864|n,t,void 0,!0);if(e.lineTerminatorBeforeNextToken)switch(e.token){case 6291470:s$1(e,n,2,81,2);break;case 23:case 273466:case 17049143:s$1(e,n,2,82,2);}else if(262144&e.token)s$1(e,n,2,82,2);else switch(e.token){case 6291470:s$1(e,n,2,81,2);break;case 2105356:case 23109652:s$1(e,n,2,83,2);break;case 6299657:s$1(e,n,2,84,2);break;case 23:s$1(e,n,2,82,2);}return r}return Ee(e,n)}(e,n,t),i,1===a))}function In(e,n,t,r,i,o,s,c){return r||(a(e,n,7),e.flags|=4),6&i&&a(e,n,103),Cn(e,n,t,!0,s,o,c)}function An(e,n,t,r=!1){const i=e.startIndex;M(e,4096|n,201334865);let o=16777216^(16777216|n);n|=1024;let s=null,c=null;return e.token&(33554432&n?1114112:135331840)&&134217816!==e.token?(r&&ee(e,n,e.tokenValue),s=Te(e,268435456^(268435456|n),t,32)):32768!=(32768&n)&&a(e,n,11),z(e,4096|n,134217816)?(c=De(e,n,!1),o|=524288):o=524288^(524288|o),e.assignable=!1,W(e,n,i,O.ClassDeclaration(s,c,En(e,o,n)))}function En(e,n,t){const r=[];if(M(e,4096|n,40973)){const i=33554432&n?1209073664:695283712;for(;e.token&i&&(r.push(wn(e,n,t,!1,0)),z(e,n,33554451),16400!==e.token););M(e,n,16400);}return r}function wn(e,n,t,r,i){const o=e.startIndex;if(1140871186===e.token)return L(e,n),W(e,n,o,O.Semicolon());if(135331840&e.token){const c=e.token;let u=Be(e,n);if(!r&&1048685===c){if(2105356===e.token){const t=mn(e,n,u,i);return W(e,n,o,O.ClassElement(r,t))}return wn(e,n,t,!0,i)}if(134283264&c&&152109056&e.token){if(e.lineTerminatorBeforeNextToken||67182704!==c?65651===c?i|=2:65652===c&&(i|=4):(i|=1,z(e,n,17049143)&&(i|=16)),0==(23&i)&&s$1(e,n,2,39,2),17049143===e.token&&a(e,n,39),23109652===e.token){z(e,4096|n,23109652);const r=Ee(e,8192^(8192|t));M(e,n,21),u=W(e,n,o,O.ComputedPropertyName(r));}else r&&"prototype"===e.tokenValue&&a(e,n,40),r||"constructor"!==e.tokenValue||a(e,n,39),u=pn(e,t);}else r&&"prototype"===e.tokenValue&&a(e,n,40),"constructor"===e.tokenValue&&(i|=32);const l=mn(e,n,u,i);return W(e,n,o,O.ClassElement(r,l))}z(e,n,17049143)&&(i|=16),"constructor"===e.tokenValue&&(!r&&16&i&&a(e,n,39),i|=32);const c=mn(e,n,pn(e,t),i);return W(e,n,o,O.ClassElement(r,c))}function vn(e,n,t,r){return ve(e,n,t=Fe(e,n,t=Re(e,n,t,!0,r),r),r)}function Sn(e,n,t){let r=Ee(e,n);return M(e,n,17),r=W(e,n,t,O.ImportCall(r)),r=vn(e,n,r,t),U(e,n),W(e,n,t,O.ExpressionStatement(r))}function Bn(e,n,t){M(e,n,65656);let r=W(e,n,t,O.ImportMeta());return e.assignable=!1,r=vn(e,n,r,t),U(e,n),W(e,n,t,O.ExpressionStatement(r))}function Tn(e,n){return Ke(e,n,!1)}function Nn(e,n){return M(e,n,65653),16785412!==e.token&&a(e,n,133),Ke(e,n,!1)}function Vn(e,n,t){const r=e.startIndex;if(L(e,4096|n),z(e,4096|n,402653268))return function(e,n,t,r){let i;switch(e.token){case 201334875:case 67182704:i=gn(e,32768|n,r,!1,!1);break;case 201334865:i=An(e,32768|n,r,!1);break;default:i=Ee(e,n),U(e,n);}return ee(e,n,"default"),W(e,n,t,O.ExportDefault(i))}(e,n,r,t);let i=null,o=null,c=[],u=null;const l=[],d=[],f=256==(256&n);switch(e.token){case 537923660:i=Le(e,n,t,16400,[],null);break;case 671092813:i=Le(e,n,t,16416,[],null);break;case 201334865:i=An(e,n,t,!0);break;case 201334875:case 67182704:i=gn(e,n,t,!1,!0);break;case 671092811:i=Ne(e,n,t,16448);break;case 40973:if(c=function(e,n,t,r){M(e,n,40973);const i=[];for(;135331840&e.token&&(i.push(Ln(e,n,t,r)),16400!==e.token);)M(e,n,33554451);return M(e,4096|n,16400),i}(e,n,l,d),65653===e.token)o=Nn(e,n);else for(let t=l.length-1;t>=0;t-=1){const r="#"+l[t];e.exportedNames[r]&&a(e,n,134,l[t]),e.exportedNames[r]=1,e.exportedBindings["#"+d[t]]=1;}U(e,n);break;case 17049143:u=function(e,n,t){L(e,n);let r=null,i=null;z(e,n,65647)&&(16785412===e.token?r=Tn(e,n):(ee(e,n,e.tokenValue),i=Be(e,n)));return W(e,n,t,O.ExportFromClause(i,r))}(e,n,r),o=Nn(e,n),U(e,n);break;default:s$1(e,n,2,30,2);}return W(e,n,r,O.ExportDeclaration(i,c,o,u,f,l,d))}function Ln(e,n,t,r){const i=e.startIndex,o=e.tokenValue;let a=o,s=null;if(16785412===e.token){const c=Tn(e,n);let u=null;return z(e,n,65647)&&(16785412===e.token?s=Tn(e,n):(a=e.tokenValue,u=Be(e,n))),t.push(a),r.push(o),W(e,n,i,O.ExportSpecifier(c,s,u))}const c=Be(e,n);let u=null;return z(e,n,65647)&&(16785412===e.token?s=Tn(e,n):(a=e.tokenValue,u=Be(e,n))),t.push(a),r.push(o),W(e,n,i,O.ExportSpecifier(c,s,u))}function Pn(e,n,t){null!=t&&(t.next&&(n|=1),t.loc&&(n|=2),t.impliedStrict&&(n|=1024),t.cst&&(n|=256),t.ts&&(n|=512),t.disableWebCompat&&(n|=4));const r=ue(e);S(r,e),L(r,4096|n);const i={parent:void 0,type:2},o=[];let s=[];for(;16785412===r.token;){const e=r.startIndex,t=Ke(r,n,!0);D(r)?(J(r,e)&&(n|=1024),U(r,n),o.push(t)):s.push(Ae(r,n,vn(r,n,t,e),e));}s=2048&n?function(e,n,t,r){for(;16384!==e.token;)r.push(pe(e,n,t));const i=e.exportedBindings;for(const r in i)"#"!==r[0]||t[r]||a(e,n,135,r);return r}(r,n,i,s):function(e,n,t,r){for(;16384!==e.token;)r.push(de(e,n,t,null,null));return r}(r,n,i,s);const c=4!=(4&n),u=2048&n?O.Module(o,s,c):O.Script(o,s,c);return 2&n&&(u.start=0,u.end=e.length),u}function Fn(e,n,t,r){const i=ue(e,r);S(i,e),L(i,4096|t);const o={parent:void 0,type:2},a=[];let s=[];for(;16785412===i.token;){const e=i.startIndex,n=Ke(i,t,!0);D(i)?(J(i,e)&&(t|=1024),U(i,t),a.push(n)):s.push(Ae(i,t,vn(i,t,n,e),e));}s=le(i,t,o,s,2048&t?pe:de);return function(e,n,t,r,i,o){return {type:"RootNode",directives:e,leafs:n,text:r,fileName:i,context:0,mutualFlags:0,diagnostics:o,detached:!1,incremental:!1,parent:null,children:[],start:0,length:r.length,webCompat:t,end:r.length}}(a,s,4!=(4&t),e,n,i.diagnostics)}function On(e,n,t){return Pn(e,n,t)}function Dn(e,n,t,r){return r&&Object.assign(O,r),Pn(e,n,t)}function Rn(e,n){return On(e,536870912,n)}function Un(e,n){return On(e,671091712,n)}function Mn(e,n,t){return Dn(e,536871040,t,n)}function zn(e,n,t){return Dn(e,134218624,t,n)}function jn(e,n,t){return function(e,n,t,r){return null!=r&&(r.next&&(t|=1),r.impliedStrict&&(t|=1024),r.module&&(t|=3072),r.disableWebCompat&&(t|=4),r.cst&&(t|=256),r.ts&&(t|=512)),Fn(e,n,33554432|t)}(e,n,536871040,t)}function qn(e,n,t,r){return function(e,n,t,r){return Fn(e,n,33554432)}(e,n)}function Wn(e,n,t){return T(e,n,!1,t?48:0)}function _n(e,n,t){return T(e,n,!0,t?48:0)}const Hn="0.60";

var escaya_esm_min = /*#__PURE__*/Object.freeze({
  __proto__: null,
  DictionaryMap: O,
  extractCommentsModule: _n,
  extractCommentsScript: Wn,
  parseCustomModule: zn,
  parseCustomScript: Mn,
  parseModule: Un,
  parseScript: Rn,
  recovery: jn,
  update: qn,
  version: Hn
});

var require$$6 = /*@__PURE__*/getAugmentedNamespace(escaya_esm_min);

var name="@mikro-orm/core";var version="4.5.9";var description="TypeScript ORM for Node.js based on Data Mapper, Unit of Work and Identity Map patterns. Supports MongoDB, MySQL, PostgreSQL and SQLite databases as well as usage with vanilla JavaScript.";var main$1="index.js";var typings="index.d.ts";var repository={type:"git",url:"git+ssh://git@github.com/mikro-orm/mikro-orm.git"};var keywords=["orm","mongo","mongodb","mysql","mariadb","postgresql","sqlite","sqlite3","ts","typescript","js","javascript","entity","ddd","mikro-orm","unit-of-work","data-mapper","identity-map"];var author="Martin Ad\xE1mek";var license="MIT";var bugs={url:"https://github.com/mikro-orm/mikro-orm/issues"};var homepage="https://mikro-orm.io";var engines={node:">= 10.13.0"};var scripts={build:"yarn clean && yarn compile && yarn copy",clean:"rimraf ./dist",compile:"tsc -p tsconfig.build.json",copy:"ts-node -T ../../scripts/copy.ts"};var publishConfig={access:"public"};var dependencies={"ansi-colors":"4.1.1",clone:"2.1.2",dotenv:"8.2.0",escaya:"0.0.61","fs-extra":"9.1.0",globby:"11.0.3","reflect-metadata":"0.1.13","strip-json-comments":"3.1.1"};var peerDependencies={"@mikro-orm/entity-generator":"^4.0.0","@mikro-orm/mariadb":"^4.0.0","@mikro-orm/migrations":"^4.0.0","@mikro-orm/mongodb":"^4.0.0","@mikro-orm/mysql":"^4.0.0","@mikro-orm/postgresql":"^4.0.0","@mikro-orm/sqlite":"^4.0.0"};var peerDependenciesMeta={"@mikro-orm/entity-generator":{optional:true},"@mikro-orm/migrations":{optional:true},"@mikro-orm/mongodb":{optional:true},"@mikro-orm/mysql":{optional:true},"@mikro-orm/mariadb":{optional:true},"@mikro-orm/postgresql":{optional:true},"@mikro-orm/sqlite":{optional:true}};var require$$9 = {name:name,version:version,description:description,main:main$1,typings:typings,repository:repository,keywords:keywords,author:author,license:license,bugs:bugs,homepage:homepage,engines:engines,scripts:scripts,publishConfig:publishConfig,dependencies:dependencies,peerDependencies:peerDependencies,peerDependenciesMeta:peerDependenciesMeta};

(function(exports){var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.Utils=exports.equals=exports.compareBuffers=exports.compareArrays=exports.compareObjects=exports.ObjectBindingPattern=void 0;const module_1=Module__default["default"];const clone_1=__importDefault(clone.exports);const globby_1=__importDefault(globby$1.exports);const path_1=require$$0__default$1["default"];const fs_extra_1=lib$1.exports;const crypto_1=crypto__default["default"];const escaya_1=require$$6;const typings_1=typings$1;const enums_1=enums;exports.ObjectBindingPattern=Symbol("ObjectBindingPattern");function compareObjects(a,b){if(a===b||a==null&&b==null){return true}if(!a||!b||typeof a!=="object"||typeof b!=="object"||a.constructor!==b.constructor){return false}if(a.valueOf!==Object.prototype.valueOf){return a.valueOf()===b.valueOf()}if(a.toString!==Object.prototype.toString){return a.toString()===b.toString()}const keys=Object.keys(a);const length=keys.length;if(length!==Object.keys(b).length){return false}for(let i=length;i--!==0;){if(!Object.prototype.hasOwnProperty.call(b,keys[i])){return false}}for(let i=length;i--!==0;){const key=keys[i];if(!equals(a[key],b[key])){return false}}return true}exports.compareObjects=compareObjects;function compareArrays(a,b){const length=a.length;if(length!==b.length){return false}for(let i=length;i--!==0;){if(!equals(a[i],b[i])){return false}}return true}exports.compareArrays=compareArrays;function compareBuffers(a,b){const length=a.length;if(length!==b.length){return false}for(let i=length;i--!==0;){if(a[i]!==b[i]){return false}}return true}exports.compareBuffers=compareBuffers;function equals(a,b){if(a===b){return true}if(a&&b&&typeof a==="object"&&typeof b==="object"){if(Array.isArray(a)){return compareArrays(a,b)}if(ArrayBuffer.isView(a)&&ArrayBuffer.isView(b)){return compareBuffers(a,b)}return compareObjects(a,b)}return false}exports.equals=equals;const equalsFn=equals;class Utils{static isDefined(data,considerNullUndefined=false){return typeof data!=="undefined"&&!(considerNullUndefined&&data===null)}static isObject(o){return !!o&&typeof o==="object"&&!Array.isArray(o)}static isNotObject(o,not){return this.isObject(o)&&!not.some(cls=>o instanceof cls)}static getObjectKeysSize(object){let size=0;for(const key in object){if(object.hasOwnProperty(key)){size++;}}return size}static hasObjectKeys(object){for(const key in object){if(object.hasOwnProperty(key)){return true}}return false}static isString(s){return typeof s==="string"}static isNumber(s){return typeof s==="number"}static equals(a,b){return equalsFn(a,b)}static unique(items){return [...new Set(items)]}static merge(target,...sources){if(!sources.length){return target}const source=sources.shift();if(Utils.isObject(target)&&Utils.isPlainObject(source)){Object.entries(source).forEach(([key,value])=>{if(Utils.isPlainObject(value)){if(!(key in target)){Object.assign(target,{[key]:{}});}Utils.merge(target[key],value);}else {Object.assign(target,{[key]:value});}});}return Utils.merge(target,...sources)}static getRootEntity(metadata,meta){const base=meta.extends&&metadata.find(meta.extends);if(!base||base===meta){return meta}const root=Utils.getRootEntity(metadata,base);if(root.discriminatorColumn){return root}return meta}static diff(a,b){const ret={};Object.keys(b).forEach(k=>{if(Utils.equals(a[k],b[k])){return}ret[k]=b[k];});return ret}static copy(entity){return clone_1.default(entity)}static asArray(data,strict=false){if(typeof data==="undefined"&&!strict){return []}if(data instanceof Set){return Array.from(data)}return Array.isArray(data)?data:[data]}static renameKey(payload,from,to){if(Utils.isObject(payload)&&from in payload&&!(to in payload)){Object.keys(payload).forEach(key=>{const value=payload[key];delete payload[key];payload[from===key?to:key]=value;},payload);}}static getParamNames(func,methodName){const ret=[];const parsed=escaya_1.recovery(func.toString(),"entity.js",{next:true,module:true});const checkNode=node=>{var _a,_b;if(methodName&&((_a=node.name)===null||_a===void 0?void 0:_a.name)!==methodName){return}const params=(_b=node.uniqueFormalParameters)!==null&&_b!==void 0?_b:node.params;ret.push(...params.map(p=>{switch(p.type){case"BindingElement":if(p.left.type==="ObjectBindingPattern"){return exports.ObjectBindingPattern}return p.left.name;case"BindingRestElement":return "..."+p.argument.name;default:return p.name;}}));};Utils.walkNode(parsed,checkNode);return ret}static walkNode(node,checkNode){if(["MethodDefinition","FunctionDeclaration"].includes(node.type)){checkNode(node);}if(Array.isArray(node.leafs)){node.leafs.forEach(row=>Utils.walkNode(row,checkNode));}if(Array.isArray(node.elements)){node.elements.forEach(element=>Utils.walkNode(element,checkNode));}if(node.method){Utils.walkNode(node.method,checkNode);}}static isPrimaryKey(key,allowComposite=false){if(allowComposite&&Array.isArray(key)&&key.every((v,i)=>Utils.isPrimaryKey(v,true))){return true}if(Utils.isObject(key)&&!Utils.isPlainObject(key)&&!Utils.isEntity(key,true)){return true}return ["string","number","bigint"].includes(typeof key)||Utils.isObjectID(key)||key instanceof Date||key instanceof Buffer}static extractPK(data,meta,strict=false){if(Utils.isPrimaryKey(data)){return data}if(Utils.isEntity(data,true)){return data.__helper.getPrimaryKey()}if(strict&&meta&&Utils.getObjectKeysSize(data)!==meta.primaryKeys.length){return null}if(Utils.isPlainObject(data)&&meta){if(meta.compositePK){return Utils.getCompositeKeyHash(data,meta)}return data[meta.primaryKeys[0]]||data[meta.serializedPrimaryKey]||null}return null}static getCompositeKeyHash(entity,meta){const pks=meta.primaryKeys.map(pk=>{const value=entity[pk];const prop=meta.properties[pk];if(Utils.isEntity(value,true)){return value.__helper.getSerializedPrimaryKey()}if(prop.targetMeta&&Utils.isPlainObject(value)){return this.getCompositeKeyHash(value,prop.targetMeta)}return value});return Utils.getPrimaryKeyHash(pks)}static getPrimaryKeyHash(pks){return pks.join(this.PK_SEPARATOR)}static splitPrimaryKeys(key){return key.split(this.PK_SEPARATOR)}static getPrimaryKeyValues(entity,primaryKeys,allowScalar=false,convertCustomTypes=false){if(allowScalar&&primaryKeys.length===1){if(Utils.isEntity(entity[primaryKeys[0]],true)){return entity[primaryKeys[0]].__helper.getPrimaryKey(convertCustomTypes)}return entity[primaryKeys[0]]}return primaryKeys.reduce((ret,pk)=>{if(Utils.isEntity(entity[pk],true)){const childPk=entity[pk].__helper.getPrimaryKey(convertCustomTypes);if(entity[pk].__meta.compositePK){ret.push(...Object.values(childPk));}else {ret.push(childPk);}}else {ret.push(entity[pk]);}return ret},[])}static getPrimaryKeyCond(entity,primaryKeys){const cond=primaryKeys.reduce((o,pk)=>{o[pk]=Utils.extractPK(entity[pk]);return o},{});if(Object.values(cond).some(v=>v===null)){return null}return cond}static getPrimaryKeyCondFromArray(pks,primaryKeys){return primaryKeys.reduce((o,pk,idx)=>{o[pk]=Utils.extractPK(pks[idx]);return o},{})}static getOrderedPrimaryKeys(id,meta,platform,convertCustomTypes){const data=Utils.isPrimaryKey(id)?{[meta.primaryKeys[0]]:id}:id;return meta.primaryKeys.map((pk,idx)=>{const prop=meta.properties[pk];let value=Array.isArray(data)?data[idx]:data[pk];if(prop.reference!==enums_1.ReferenceType.SCALAR&&prop.targetMeta){const value2=this.getOrderedPrimaryKeys(value,prop.targetMeta,platform);value=value2[0];}if(prop.customType&&platform&&convertCustomTypes){return prop.customType.convertToJSValue(value,platform)}return value})}static isEntity(data,allowReference=false){if(!Utils.isObject(data)){return false}if(allowReference&&!!data.__reference){return true}return !!data.__entity}static isObjectID(key){return Utils.isObject(key)&&key.constructor.name.toLowerCase()==="objectid"}static isEmpty(data){if(Array.isArray(data)){return data.length===0}if(Utils.isObject(data)){return !Utils.hasObjectKeys(data)}return !data}static className(classOrName){if(Utils.isString(classOrName)){return classOrName}return classOrName.name}static detectTsNode(){return process.argv[0].endsWith("ts-node")||!!process[Symbol.for("ts-node.register.instance")]||!!process.env.TS_JEST||process.argv.slice(1).some(arg=>arg.includes("ts-node"))||commonjsRequire.extensions&&!!commonjsRequire.extensions[".ts"]||!!new Error().stack.split("\n").find(line=>line.match(/\w\.ts:\d/))}static lookupPathFromDecorator(name,stack){stack=stack||new Error().stack.split("\n");let line=stack.findIndex(line=>line.includes("__decorate"));if(line===-1){return name}if(Utils.normalizePath(stack[line]).includes("node_modules/tslib/tslib")){line++;}try{const re=stack[line].match(/\(.+\)/i)?/\((.*):\d+:\d+\)/:/at\s*(.*):\d+:\d+$/;return Utils.normalizePath(stack[line].match(re)[1])}catch(_a){return name}}static getObjectType(value){const objectType=Object.prototype.toString.call(value);return objectType.match(/\[object (\w+)]/)[1].toLowerCase()}static isPlainObject(value){return value!==null&&typeof value==="object"&&typeof value.constructor==="function"&&value.constructor.prototype.hasOwnProperty("isPrototypeOf")||value instanceof typings_1.PlainObject}static async runSerial(items,cb){const ret=[];for(const item of items){ret.push(await cb(item));}return ret}static isCollection(item,prop,type){if(!(item===null||item===void 0?void 0:item.__collection)){return false}return !(prop&&type)||prop.reference===type}static normalizePath(...parts){let path=parts.join("/").replace(/\\/g,"/").replace(/\/$/,"");path=path_1.normalize(path).replace(/\\/g,"/");return path.match(/^[/.]|[a-zA-Z]:/)||path.startsWith("!")?path:"./"+path}static relativePath(path,relativeTo){if(!path){return path}path=Utils.normalizePath(path);if(path.startsWith(".")){return path}path=path_1.relative(relativeTo,path);return Utils.normalizePath(path)}static absolutePath(path,baseDir=process.cwd()){if(!path){return Utils.normalizePath(baseDir)}if(!path_1.isAbsolute(path)){path=baseDir+"/"+path;}return Utils.normalizePath(path)}static hash(data){return crypto_1.createHash("md5").update(data).digest("hex")}static runIfNotEmpty(clause,data){if(!Utils.isEmpty(data)){clause();}}static defaultValue(prop,option,defaultValue){prop[option]=option in prop?prop[option]:defaultValue;}static findDuplicates(items){return items.reduce((acc,v,i,arr)=>{return arr.indexOf(v)!==i&&acc.indexOf(v)===-1?acc.concat(v):acc},[])}static randomInt(min,max){return Math.round(Math.random()*(max-min))+min}static async pathExists(path,options={}){if(globby_1.default.hasMagic(path)){const found=await globby_1.default(path,options);return found.length>0}return fs_extra_1.pathExists(path)}static extractEnumValues(target){const keys=Object.keys(target);const values=Object.values(target);const numeric=!!values.find(v=>typeof v==="number");const constEnum=values.length%2===0&&values.slice(0,values.length/2).every(v=>typeof v==="string")&&values.slice(values.length/2).every(v=>typeof v==="number")&&this.equals(keys,values.slice(values.length/2).concat(values.slice(0,values.length/2)).map(v=>""+v));if(numeric||constEnum){return values.filter(val=>!keys.includes(val))}return values}static flatten(arrays){return [].concat.apply([],arrays)}static isOperator(key,includeGroupOperators=true){if(!includeGroupOperators){return !!enums_1.QueryOperator[key]}return !!enums_1.GroupOperator[key]||!!enums_1.QueryOperator[key]}static isGroupOperator(key){return !!enums_1.GroupOperator[key]}static getGlobalStorage(namespace){const key=`mikro-orm-${namespace}`;commonjsGlobal[key]=commonjsGlobal[key]||{};return commonjsGlobal[key]}static requireFrom(id,from){if(!path_1.extname(from)){from=path_1.join(from,"__fake.js");}return (module_1.createRequire||module_1.createRequireFromPath)(path_1.resolve(from))(id)}static getORMVersion(){try{return require("../../package.json").version}catch(_a){return require$$9.version}}static createFunction(context,code){try{return new Function(...context.keys(),code)(...context.values())}catch(e){console.error(code);throw e}}static callCompiledFunction(fn,...args){try{return fn(...args)}catch(e){if([SyntaxError,TypeError,EvalError,ReferenceError].some(t=>e instanceof t)){console.error(`JIT runtime error: ${e.message}\n\n${fn.toString()}`);}throw e}}static propertyDecoratorReturnValue(){if(process.env.BABEL_DECORATORS_COMPAT){return {}}}static tryRequire({module,from,allowError,warning}){allowError=allowError!==null&&allowError!==void 0?allowError:`Cannot find module '${module}'`;from=from!==null&&from!==void 0?from:process.cwd();try{return Utils.requireFrom(module,from)}catch(err){if(err.message.includes(allowError)){console.warn(warning);return undefined}throw err}}}exports.Utils=Utils;Utils.PK_SEPARATOR="~~~";})(Utils);getDefaultExportFromCjs(Utils);

var __importDefault$8=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(FileCacheAdapter$1,"__esModule",{value:true});FileCacheAdapter$1.FileCacheAdapter=void 0;const globby_1$1=__importDefault$8(globby$1.exports);const fs_extra_1$1=lib$1.exports;const Utils_1$m=Utils;class FileCacheAdapter{constructor(options,baseDir,pretty=false){this.options=options;this.baseDir=baseDir;this.pretty=pretty;this.VERSION=Utils_1$m.Utils.getORMVersion();}async get(name){const path=await this.path(name);if(!(await fs_extra_1$1.pathExists(path))){return null}const payload=await fs_extra_1$1.readJSON(path);const hash=await this.getHash(payload.origin);if(!hash||payload.hash!==hash){return null}return payload.data}async set(name,data,origin){const[path,hash]=await Promise.all([this.path(name),this.getHash(origin)]);const opts=this.pretty?{spaces:2}:{};await fs_extra_1$1.writeJSON(path,{data,origin,hash,version:this.VERSION},opts);}async clear(){const path=await this.path("*");const files=await globby_1$1.default(path);await Promise.all(files.map(file=>fs_extra_1$1.unlink(file)));}async path(name){await fs_extra_1$1.ensureDir(this.options.cacheDir);return `${this.options.cacheDir}/${name}.json`}async getHash(origin){origin=Utils_1$m.Utils.absolutePath(origin,this.baseDir);if(!(await fs_extra_1$1.pathExists(origin))){return null}const contents=await fs_extra_1$1.readFile(origin);return Utils_1$m.Utils.hash(contents.toString()+this.VERSION)}}FileCacheAdapter$1.FileCacheAdapter=FileCacheAdapter;

var MemoryCacheAdapter$1 = {};

Object.defineProperty(MemoryCacheAdapter$1,"__esModule",{value:true});MemoryCacheAdapter$1.MemoryCacheAdapter=void 0;class MemoryCacheAdapter{constructor(options){this.options=options;this.data=new Map;}async get(name){const data=this.data.get(name);if(data){if(data.expiration<Date.now()){this.data.delete(name);}else {return data.data}}return undefined}async set(name,data,origin,expiration){this.data.set(name,{data,expiration:Date.now()+(expiration!==null&&expiration!==void 0?expiration:this.options.expiration)});}async clear(){this.data.clear();}}MemoryCacheAdapter$1.MemoryCacheAdapter=MemoryCacheAdapter;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(CacheAdapter,exports);__exportStar(NullCacheAdapter$1,exports);__exportStar(FileCacheAdapter$1,exports);__exportStar(MemoryCacheAdapter$1,exports);})(cache$1);getDefaultExportFromCjs(cache$1);

var hydration = {};

var Hydrator$1 = {};

Object.defineProperty(Hydrator$1,"__esModule",{value:true});Hydrator$1.Hydrator=void 0;class Hydrator{constructor(metadata,platform,config){this.metadata=metadata;this.platform=platform;this.config=config;}hydrate(entity,meta,data,factory,type,newEntity=false,convertCustomTypes=false){const props=this.getProperties(meta,type);for(const prop of props){this.hydrateProperty(entity,prop,data,factory,newEntity,convertCustomTypes);}}hydrateReference(entity,meta,data,factory,convertCustomTypes){meta.primaryKeys.forEach(pk=>{this.hydrateProperty(entity,meta.properties[pk],data,factory,false,convertCustomTypes);});}getProperties(meta,type){if(type==="reference"){return meta.primaryKeys.map(pk=>meta.properties[pk])}if(type==="returning"){return meta.hydrateProps.filter(prop=>prop.primary||prop.defaultRaw)}return meta.hydrateProps}hydrateProperty(entity,prop,data,factory,newEntity,convertCustomTypes){entity[prop.name]=data[prop.name];}}Hydrator$1.Hydrator=Hydrator;

var ObjectHydrator$1 = {};

var Collection$1 = {};

var ArrayCollection$1 = {};

var Reference$1 = {};

var wrap$1 = {};

Object.defineProperty(wrap$1,"__esModule",{value:true});wrap$1.wrap=void 0;function wrap(entity,preferHelper=false){if((entity===null||entity===void 0?void 0:entity.__baseEntity)&&!preferHelper){return entity}if(entity){return entity.__helper}return entity}wrap$1.wrap=wrap;

Object.defineProperty(Reference$1,"__esModule",{value:true});Reference$1.Reference=void 0;const wrap_1$3=wrap$1;class Reference{constructor(entity){this.entity=entity;this.set(entity);const meta=this.entity.__meta;Object.defineProperty(this,"__reference",{value:true});meta.primaryKeys.forEach(primaryKey=>{Object.defineProperty(this,primaryKey,{get(){return this.entity[primaryKey]}});});if(meta.serializedPrimaryKey&&meta.primaryKeys[0]!==meta.serializedPrimaryKey){Object.defineProperty(this,meta.serializedPrimaryKey,{get(){return this.entity.__helper.getSerializedPrimaryKey()}});}}static create(entity){if(Reference.isReference(entity)){return entity}return new Reference(entity)}static isReference(data){return data&&!!data.__reference}static wrapReference(entity,prop){if(entity&&prop.wrappedReference&&!Reference.isReference(entity)){return Reference.create(entity)}return entity}static unwrapReference(ref){return Reference.isReference(ref)?ref.unwrap():ref}async load(prop){if(!this.isInitialized()){await this.entity.__helper.init();}if(prop){return this.entity[prop]}return this.entity}set(entity){if(entity instanceof Reference){entity=entity.unwrap();}this.entity=entity;Object.defineProperty(this,"__meta",{value:this.entity.__meta,writable:true});Object.defineProperty(this,"__platform",{value:this.entity.__platform,writable:true});Object.defineProperty(this,"__helper",{value:this.entity.__helper,writable:true});Object.defineProperty(this,"$",{value:this.entity,writable:true});Object.defineProperty(this,"get",{value:()=>this.entity,writable:true});}unwrap(){return this.entity}getEntity(){if(!this.isInitialized()){throw new Error(`Reference<${this.entity.__meta.name}> ${this.entity.__helper.getPrimaryKey()} not initialized`)}return this.entity}getProperty(prop){return this.getEntity()[prop]}isInitialized(){return this.entity.__helper.__initialized}populated(populated){this.entity.__helper.populated(populated);}toJSON(...args){return wrap_1$3.wrap(this.entity).toJSON(...args)}}Reference$1.Reference=Reference;

Object.defineProperty(ArrayCollection$1,"__esModule",{value:true});ArrayCollection$1.ArrayCollection=void 0;const Reference_1$8=Reference$1;const wrap_1$2=wrap$1;const enums_1$w=enums;const Utils_1$l=Utils;class ArrayCollection{constructor(owner,items){this.owner=owner;this.items=new Set;this.initialized=true;if(items){let i=0;this.items=new Set(items);this.items.forEach(item=>this[i++]=item);}Object.defineProperty(this,"items",{enumerable:false});Object.defineProperty(this,"owner",{enumerable:false,writable:true});Object.defineProperty(this,"_property",{enumerable:false,writable:true});Object.defineProperty(this,"_count",{enumerable:false,writable:true});Object.defineProperty(this,"__collection",{value:true});}async loadCount(){return this.items.size}getItems(){return [...this.items]}toArray(){if(this.items.size===0){return []}const meta=this.property.targetMeta;const args=[...meta.toJsonParams.map(()=>undefined),[this.property.name]];return this.getItems().map(item=>wrap_1$2.wrap(item).toJSON(...args))}toJSON(){return this.toArray()}getIdentifiers(field){const items=this.getItems();if(items.length===0){return []}field=field!==null&&field!==void 0?field:this.property.targetMeta.serializedPrimaryKey;return items.map(i=>{if(Utils_1$l.Utils.isEntity(i[field],true)){return wrap_1$2.wrap(i[field],true).getPrimaryKey()}return i[field]})}add(...items){for(const item of items){const entity=Reference_1$8.Reference.unwrapReference(item);if(!this.contains(entity,false)){this.incrementCount(1);this[this.items.size]=entity;this.items.add(entity);this.propagate(entity,"add");}}}set(items){this.remove(...this.items);this.add(...items);}hydrate(items){for(let i=0;i<this.items.size;i++){delete this[i];}this.items.clear();this._count=0;this.add(...items);}remove(...items){this.incrementCount(-items.length);for(const item of items){if(!item){continue}const entity=Reference_1$8.Reference.unwrapReference(item);delete this[this.items.size-1];this.items.delete(entity);Object.assign(this,[...this.items]);this.propagate(entity,"remove");}}removeAll(){this.remove(...this.items);}contains(item,check){const entity=Reference_1$8.Reference.unwrapReference(item);return this.items.has(entity)}count(){return this.items.size}isInitialized(fully=false){if(fully){return this.initialized&&[...this.items].every(item=>item.__helper.__initialized)}return this.initialized}get length(){return this.count()}*[Symbol.iterator](){for(const item of this.items){yield item;}}get property(){if(!this._property){const meta=this.owner.__meta;const field=Object.keys(meta.properties).find(k=>this.owner[k]===this);this._property=meta.properties[field];}return this._property}propagate(item,method){if(this.property.owner&&this.property.inversedBy){this.propagateToInverseSide(item,method);}else if(!this.property.owner&&this.property.mappedBy){this.propagateToOwningSide(item,method);}}propagateToInverseSide(item,method){const collection=item[this.property.inversedBy];if(this.shouldPropagateToCollection(collection,method)){collection[method](this.owner);}}propagateToOwningSide(item,method){const collection=item[this.property.mappedBy];if(this.property.reference===enums_1$w.ReferenceType.MANY_TO_MANY&&this.shouldPropagateToCollection(collection,method)){collection[method](this.owner);}else if(this.property.reference===enums_1$w.ReferenceType.ONE_TO_MANY&&!(this.property.orphanRemoval&&method==="remove")){const owner=this.property.targetMeta.properties[this.property.mappedBy].mapToPk?this.owner.__helper.getPrimaryKey():this.owner;item[this.property.mappedBy]=method==="add"?owner:null;}}shouldPropagateToCollection(collection,method){if(!collection||!collection.isInitialized()){return false}if(method==="add"){return !collection.contains(this.owner,false)}return collection.contains(this.owner,false)}incrementCount(value){if(typeof this._count==="number"){this._count+=value;}}}ArrayCollection$1.ArrayCollection=ArrayCollection;

var errors = {};

Object.defineProperty(errors,"__esModule",{value:true});errors.NotFoundError=errors.MetadataError=errors.OptimisticLockError=errors.ValidationError=void 0;const util_1$6=require$$0__default$2["default"];class ValidationError extends Error{constructor(message,entity){super(message);this.entity=entity;Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name;this.message=message;}getEntity(){return this.entity}static fromWrongPropertyType(entity,property,expectedType,givenType,givenValue){const entityName=entity.constructor.name;const msg=`Trying to set ${entityName}.${property} of type '${expectedType}' to '${givenValue}' of type '${givenType}'`;return new ValidationError(msg)}static fromCollectionNotInitialized(entity,prop){const entityName=entity.constructor.name;const msg=`${entityName}.${prop.name} is not initialized, define it as '${prop.name} = new Collection<${prop.type}>(this);'`;return new ValidationError(msg)}static fromMergeWithoutPK(meta){throw new ValidationError(`You cannot merge entity '${meta.className}' without identifier!`)}static transactionRequired(){return new ValidationError("An open transaction is required for this operation")}static entityNotManaged(entity){return new ValidationError(`Entity ${entity.constructor.name} is not managed. An entity is managed if its fetched from the database or registered as new through EntityManager.persist()`)}static notEntity(owner,prop,data){const type=Object.prototype.toString.call(data).match(/\[object (\w+)]/)[1].toLowerCase();return new ValidationError(`Entity of type ${prop.type} expected for property ${owner.constructor.name}.${prop.name}, ${util_1$6.inspect(data)} of type ${type} given. If you are using Object.assign(entity, data), use em.assign(entity, data) instead.`)}static notDiscoveredEntity(data,meta){var _a;const type=(_a=meta===null||meta===void 0?void 0:meta.className)!==null&&_a!==void 0?_a:Object.prototype.toString.call(data).match(/\[object (\w+)]/)[1].toLowerCase();let err=`Trying to persist not discovered entity of type ${type}.`;if(meta){err+=` Entity with this name was discovered, but not the prototype you are passing to the ORM. If using EntitySchema, be sure to point to the implementation via \`class\`.`;}return new ValidationError(err)}static invalidPropertyName(entityName,invalid){return new ValidationError(`Entity '${entityName}' does not have property '${invalid}'`)}static invalidType(type,value,mode){const valueType=Object.prototype.toString.call(value).match(/\[object (\w+)]/)[1].toLowerCase();if(value instanceof Date){value=value.toISOString();}return new ValidationError(`Could not convert ${mode} value '${value}' of type '${valueType}' to type ${type.name}`)}static cannotModifyInverseCollection(owner,property){const inverseCollection=`${owner.constructor.name}.${property.name}`;const ownerCollection=`${property.type}.${property.mappedBy}`;const error=`You cannot modify inverse side of M:N collection ${inverseCollection} when the owning side is not initialized. `+`Consider working with the owning side instead (${ownerCollection}).`;return new ValidationError(error,owner)}static cannotModifyReadonlyCollection(owner,property){return new ValidationError(`You cannot modify collection ${owner.constructor.name}.${property.name} as it is marked as readonly.`,owner)}static invalidCompositeIdentifier(meta){return new ValidationError(`Composite key required for entity ${meta.className}.`)}static cannotCommit(){return new ValidationError("You cannot call em.flush() from inside lifecycle hook handlers")}static cannotUseOperatorsInsideEmbeddables(className,propName,payload){return new ValidationError(`Using operators inside embeddables is not allowed, move the operator above. (property: ${className}.${propName}, payload: ${util_1$6.inspect(payload)})`)}static invalidEmbeddableQuery(className,propName,embeddableType){return new ValidationError(`Invalid query for entity '${className}', property '${propName}' does not exist in embeddable '${embeddableType}'`)}}errors.ValidationError=ValidationError;class OptimisticLockError extends ValidationError{static notVersioned(meta){return new OptimisticLockError(`Cannot obtain optimistic lock on unversioned entity ${meta.className}`)}static lockFailed(entityOrName){const name=typeof entityOrName==="string"?entityOrName:entityOrName.constructor.name;const entity=typeof entityOrName==="string"?undefined:entityOrName;return new OptimisticLockError(`The optimistic lock on entity ${name} failed`,entity)}static lockFailedVersionMismatch(entity,expectedLockVersion,actualLockVersion){expectedLockVersion=expectedLockVersion instanceof Date?expectedLockVersion.getTime():expectedLockVersion;actualLockVersion=actualLockVersion instanceof Date?actualLockVersion.getTime():actualLockVersion;return new OptimisticLockError(`The optimistic lock failed, version ${expectedLockVersion} was expected, but is actually ${actualLockVersion}`,entity)}}errors.OptimisticLockError=OptimisticLockError;class MetadataError extends ValidationError{static fromMissingPrimaryKey(meta){return new MetadataError(`${meta.className} entity is missing @PrimaryKey()`)}static fromWrongReference(meta,prop,key,owner){if(owner){return MetadataError.fromMessage(meta,prop,`has wrong '${key}' reference type: ${owner.type} instead of ${meta.className}`)}return MetadataError.fromMessage(meta,prop,`has unknown '${key}' reference: ${prop.type}.${prop[key]}`)}static fromWrongTypeDefinition(meta,prop){if(!prop.type){return MetadataError.fromMessage(meta,prop,`is missing type definition`)}return MetadataError.fromMessage(meta,prop,`has unknown type: ${prop.type}`)}static fromWrongOwnership(meta,prop,key){const type=key==="inversedBy"?"owning":"inverse";const other=key==="inversedBy"?"mappedBy":"inversedBy";return new MetadataError(`Both ${meta.className}.${prop.name} and ${prop.type}.${prop[key]} are defined as ${type} sides, use '${other}' on one of them`)}static fromWrongReferenceType(meta,owner,prop){return new MetadataError(`${meta.className}.${prop.name} is of type ${prop.reference} which is incompatible with its owning side ${prop.type}.${owner.name} of type ${owner.reference}`)}static entityNotFound(name,path){return new MetadataError(`Entity '${name}' not found in ${path}`)}static unknownIndexProperty(meta,prop,type){return new MetadataError(`Entity ${meta.className} has wrong ${type} definition: '${prop}' does not exist. You need to use property name, not column name.`)}static multipleVersionFields(meta,fields){return new MetadataError(`Entity ${meta.className} has multiple version properties defined: '${fields.join("', '")}'. Only one version property is allowed per entity.`)}static invalidVersionFieldType(meta){const prop=meta.properties[meta.versionProperty];return new MetadataError(`Version property ${meta.className}.${prop.name} has unsupported type '${prop.type}'. Only 'number' and 'Date' are allowed.`)}static fromUnknownEntity(className,source){return new MetadataError(`Entity '${className}' was not discovered, please make sure to provide it in 'entities' array when initializing the ORM (used in ${source})`)}static noEntityDiscovered(){return new MetadataError("No entities were discovered")}static onlyAbstractEntitiesDiscovered(){return new MetadataError("Only abstract entities were discovered, maybe you forgot to use @Entity() decorator?")}static duplicateEntityDiscovered(paths){return new MetadataError(`Duplicate entity names are not allowed: ${paths.join(", ")}`)}static multipleDecorators(entityName,propertyName){return new MetadataError(`Multiple property decorators used on '${entityName}.${propertyName}' property`)}static missingMetadata(entity){return new MetadataError(`Metadata for entity ${entity} not found`)}static conflictingPropertyName(className,name,embeddedName){return new MetadataError(`Property ${className}:${name} is being overwritten by its child property ${embeddedName}:${name}. Consider using a prefix to overcome this issue.`)}static fromMessage(meta,prop,message){return new MetadataError(`${meta.className}.${prop.name} ${message}`)}}errors.MetadataError=MetadataError;class NotFoundError extends ValidationError{static findOneFailed(name,where){return new NotFoundError(`${name} not found (${util_1$6.inspect(where)})`)}}errors.NotFoundError=NotFoundError;

var __rest=commonjsGlobal&&commonjsGlobal.__rest||function(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]];}return t};Object.defineProperty(Collection$1,"__esModule",{value:true});Collection$1.Collection=void 0;const ArrayCollection_1=ArrayCollection$1;const Utils_1$k=Utils;const errors_1$f=errors;const enums_1$v=enums;const Reference_1$7=Reference$1;class Collection extends ArrayCollection_1.ArrayCollection{constructor(owner,items,initialized=true){super(owner,items);this.snapshot=[];this.dirty=false;this._populated=false;this._lazyInitialized=false;this.initialized=!!items||initialized;Object.defineProperty(this,"snapshot",{enumerable:false});Object.defineProperty(this,"_populated",{enumerable:false});Object.defineProperty(this,"_lazyInitialized",{enumerable:false});Object.defineProperty(this,"$",{get:()=>super.getItems()});Object.defineProperty(this,"get",{value:()=>super.getItems()});}static create(owner,prop,items,initialized){const coll=new Collection(owner,items,initialized);owner[prop]=coll;if(items){coll.set(items);}return coll}async loadItems(){if(!this.isInitialized(true)){await this.init();}return super.getItems()}async loadCount(refresh=false){if(!refresh&&Utils_1$k.Utils.isDefined(this._count)){return this._count}const em=this.getEntityManager();const pivotMeta=em.getMetadata().find(this.property.pivotTable);if(!em.getPlatform().usesPivotTable()&&this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY){this._count=this.length;}else if(this.property.pivotTable&&!(this.property.inversedBy||this.property.mappedBy)){this._count=await em.count(this.property.type,this.createLoadCountCondition({},pivotMeta),{populate:[{field:this.property.pivotTable}]});}else {this._count=await em.count(this.property.type,this.createLoadCountCondition({},pivotMeta));}return this._count}async matching(options){const em=this.getEntityManager();const{where,ctx}=options,opts=__rest(options,["where","ctx"]);opts.orderBy=this.createOrderBy(opts.orderBy);let items;if(this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY&&em.getPlatform().usesPivotTable()){const map=await em.getDriver().loadFromPivotTable(this.property,[this.owner.__helper.__primaryKeys],where,opts.orderBy,ctx,options);items=map[this.owner.__helper.getSerializedPrimaryKey()].map(item=>em.merge(this.property.type,item,false,true));}else {items=await em.find(this.property.type,this.createCondition(where),opts);}if(options.store){this.hydrate(items);this.populated();this.readonly=true;}return items}getItems(check=true){if(check){this.checkInitialized();}return super.getItems()}toJSON(){if(!this.isInitialized()){return []}return super.toJSON()}add(...items){const unwrapped=items.map(i=>Reference_1$7.Reference.unwrapReference(i));unwrapped.forEach(item=>this.validateItemType(item));this.modify("add",unwrapped);this.cancelOrphanRemoval(unwrapped);}set(items){const unwrapped=items.map(i=>Reference_1$7.Reference.unwrapReference(i));unwrapped.forEach(item=>this.validateItemType(item));this.validateModification(unwrapped);if(!this.initialized){this.initialized=true;this.snapshot=undefined;}super.set(unwrapped);this.setDirty();this.cancelOrphanRemoval(unwrapped);}hydrate(items){this.initialized=true;super.hydrate(items);this.takeSnapshot();}removeAll(){const em=this.getEntityManager([],false);if(this.property.reference===enums_1$v.ReferenceType.ONE_TO_MANY&&this.property.orphanRemoval&&em){em.getUnitOfWork().scheduleCollectionDeletion(this);const unwrapped=this.getItems(false).map(i=>Reference_1$7.Reference.unwrapReference(i));this.modify("remove",unwrapped);}else {super.removeAll();}}remove(...items){const unwrapped=items.map(i=>Reference_1$7.Reference.unwrapReference(i));this.modify("remove",unwrapped);const em=this.getEntityManager(unwrapped,false);if(this.property.orphanRemoval&&em){for(const item of unwrapped){em.getUnitOfWork().scheduleOrphanRemoval(item);}}}contains(item,check=true){if(check){this.checkInitialized();}return super.contains(item)}count(){this.checkInitialized();return super.count()}shouldPopulate(){return this._populated&&!this._lazyInitialized}populated(populated=true){this._populated=populated;this._lazyInitialized=false;}isDirty(){return this.dirty}setDirty(dirty=true){this.dirty=dirty;}async init(populate=[],where,orderBy){const options=Utils_1$k.Utils.isObject(populate)?populate:{populate,where,orderBy};const em=this.getEntityManager();if(!this.initialized&&this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY&&em.getPlatform().usesPivotTable()){const map=await em.getDriver().loadFromPivotTable(this.property,[this.owner.__helper.__primaryKeys],options.where,options.orderBy);this.hydrate(map[this.owner.__helper.getSerializedPrimaryKey()].map(item=>em.merge(this.property.type,item,false,true)));this._lazyInitialized=true;return this}if(this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY&&(this.property.owner||em.getPlatform().usesPivotTable())&&this.length===0){this.initialized=true;this.dirty=false;this._lazyInitialized=true;return this}where=this.createCondition(options.where);const order=[...this.items];const customOrder=!!options.orderBy;orderBy=this.createOrderBy(options.orderBy);const items=await em.find(this.property.type,where,options.populate,orderBy);if(!customOrder){this.reorderItems(items,order);}this.items.clear();let i=0;items.forEach(item=>{this.items.add(item);this[i++]=item;});this.initialized=true;this.dirty=false;this._lazyInitialized=true;return this}takeSnapshot(){this.snapshot=[...this.items];this.setDirty(false);}getSnapshot(){return this.snapshot}getEntityManager(items=[],required=true){let em=this.owner.__helper.__em;if(!em){const item=items.concat(...this.items).find(i=>i===null||i===void 0?void 0:i.__helper.__em);em=item===null||item===void 0?void 0:item.__helper.__em;}if(!em&&required){throw errors_1$f.ValidationError.entityNotManaged(this.owner)}return em}createCondition(cond={}){if(this.property.reference===enums_1$v.ReferenceType.ONE_TO_MANY){cond[this.property.mappedBy]=this.owner.__helper.getPrimaryKey();}else {this.createManyToManyCondition(cond);}return cond}createOrderBy(orderBy={}){if(Utils_1$k.Utils.isEmpty(orderBy)&&this.property.reference===enums_1$v.ReferenceType.ONE_TO_MANY){const defaultOrder=this.property.referencedColumnNames.reduce((o,name)=>{o[name]=enums_1$v.QueryOrder.ASC;return o},{});orderBy=this.property.orderBy||defaultOrder;}return orderBy}createManyToManyCondition(cond){if(this.property.owner||this.property.pivotTable){const pk=this.property.targetMeta.primaryKeys[0];cond[pk]={$in:[]};this.items.forEach(item=>cond[pk].$in.push(item.__helper.getPrimaryKey()));}else {cond[this.property.mappedBy]=this.owner.__helper.getPrimaryKey();}}createLoadCountCondition(cond,pivotMeta){const val=this.owner.__meta.compositePK?{$in:this.owner.__helper.__primaryKeys}:this.owner.__helper.getPrimaryKey();if(this.property.reference===enums_1$v.ReferenceType.ONE_TO_MANY){cond[this.property.mappedBy]=val;}else if(pivotMeta&&this.property.owner&&!this.property.inversedBy){const pivotProp1=pivotMeta.properties[this.property.type+"_inverse"];const inverse=pivotProp1.mappedBy;const key=`${this.property.pivotTable}.${pivotMeta.properties[inverse].name}`;cond[key]=val;}else {const key=this.property.owner?this.property.inversedBy:this.property.mappedBy;cond[key]=val;}return cond}modify(method,items){if(method==="remove"){this.checkInitialized();}this.validateModification(items);super[method](...items);this.setDirty();}checkInitialized(){if(!this.isInitialized()){throw new Error(`Collection<${this.property.type}> of entity ${this.owner.constructor.name}[${this.owner.__helper.getPrimaryKey()}] not initialized`)}}reorderItems(items,order){if(this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY&&this.property.owner){items.sort((a,b)=>order.indexOf(a)-order.indexOf(b));}}cancelOrphanRemoval(items){const em=this.getEntityManager(items,false);if(!em){return}for(const item of items){em.getUnitOfWork().cancelOrphanRemoval(item);}}validateItemType(item){if(!Utils_1$k.Utils.isEntity(item)){throw errors_1$f.ValidationError.notEntity(this.owner,this.property,item)}}validateModification(items){if(this.readonly){throw errors_1$f.ValidationError.cannotModifyReadonlyCollection(this.owner,this.property)}if(this.property.pivotTable||!this.property.mappedBy){return}const check=item=>{if(!item||item.__helper.__initialized){return false}return !item[this.property.mappedBy]&&this.property.reference===enums_1$v.ReferenceType.MANY_TO_MANY};if(items.find(item=>check(item))){throw errors_1$f.ValidationError.cannotModifyInverseCollection(this.owner,this.property)}}}Collection$1.Collection=Collection;

Object.defineProperty(ObjectHydrator$1,"__esModule",{value:true});ObjectHydrator$1.ObjectHydrator=void 0;const Hydrator_1=Hydrator$1;const Collection_1=Collection$1;const Reference_1$6=Reference$1;const Utils_1$j=Utils;const enums_1$u=enums;class ObjectHydrator extends Hydrator_1.Hydrator{constructor(){super(...arguments);this.hydrators={full:new Map,reference:new Map,returning:new Map};this.tmpIndex=0;}hydrate(entity,meta,data,factory,type,newEntity=false,convertCustomTypes=false){const hydrate=this.getEntityHydrator(meta,type);Utils_1$j.Utils.callCompiledFunction(hydrate,entity,data,factory,newEntity,convertCustomTypes);}hydrateReference(entity,meta,data,factory,convertCustomTypes=false){const hydrate=this.getEntityHydrator(meta,"reference");Utils_1$j.Utils.callCompiledFunction(hydrate,entity,data,factory,false,convertCustomTypes);}getEntityHydrator(meta,type){const exists=this.hydrators[type].get(meta.className);if(exists){return exists}const lines=[];const context=new Map;const props=this.getProperties(meta,type);context.set("isPrimaryKey",Utils_1$j.Utils.isPrimaryKey);context.set("Collection",Collection_1.Collection);context.set("Reference",Reference_1$6.Reference);const preCondition=dataKey=>{const path=dataKey.split(".");path.pop();if(path.length===0){return ""}let ret="";let prev="";for(const p of path){const key=prev?prev+"."+p:p;ret+=`data.${key} && `;prev=key;}return ret};const hydrateScalar=(prop,object,path,dataKey)=>{const entityKey=path.join(".");const preCond=preCondition(dataKey);const convertorKey=path.join("_").replace(/\[idx_\d+]/g,"");const ret=[];if(prop.type.toLowerCase()==="date"){ret.push(`  if (${preCond}data.${dataKey}) entity.${entityKey} = new Date(data.${dataKey});`,`  else if (${preCond}data.${dataKey} === null) entity.${entityKey} = null;`);}else if(prop.customType){context.set(`convertToJSValue_${convertorKey}`,val=>prop.customType.convertToJSValue(val,this.platform));context.set(`convertToDatabaseValue_${convertorKey}`,val=>prop.customType.convertToDatabaseValue(val,this.platform));ret.push(`  if (${preCond}typeof data.${dataKey} !== 'undefined') {`,`    if (convertCustomTypes) {`,`      const value = convertToJSValue_${convertorKey}(data.${dataKey});`,`      data.${dataKey} = convertToDatabaseValue_${convertorKey}(value);`,`      entity.${entityKey} = value;`,`    } else {`,`      entity.${entityKey} = data.${dataKey};`,`    }`,`  }`);}else if(prop.type.toLowerCase()==="boolean"){ret.push(`  if (${preCond}typeof data.${dataKey} !== 'undefined') entity.${entityKey} = data.${dataKey} === null ? null : !!data.${dataKey};`);}else {ret.push(`  if (${preCond}typeof data.${dataKey} !== 'undefined') entity.${entityKey} = data.${dataKey};`);}return ret};const hydrateToOne=prop=>{const ret=[];ret.push(`  if (data.${prop.name} === null) {\n    entity.${prop.name} = null;`);ret.push(`  } else if (typeof data.${prop.name} !== 'undefined') {`);ret.push(`    if (isPrimaryKey(data.${prop.name}, true)) {`);if(prop.mapToPk){ret.push(`      entity.${prop.name} = data.${prop.name};`);}else if(prop.wrappedReference){ret.push(`      entity.${prop.name} = new Reference(factory.createReference('${prop.type}', data.${prop.name}, { merge: true, convertCustomTypes }));`);}else {ret.push(`      entity.${prop.name} = factory.createReference('${prop.type}', data.${prop.name}, { merge: true, convertCustomTypes });`);}ret.push(`    } else if (data.${prop.name} && typeof data.${prop.name} === 'object') {`);if(prop.mapToPk){ret.push(`      entity.${prop.name} = data.${prop.name};`);}else if(prop.wrappedReference){ret.push(`      entity.${prop.name} = new Reference(factory.create('${prop.type}', data.${prop.name}, { initialized: true, merge: true, newEntity, convertCustomTypes }));`);}else {ret.push(`      entity.${prop.name} = factory.create('${prop.type}', data.${prop.name}, { initialized: true, merge: true, newEntity, convertCustomTypes });`);}ret.push(`    }`);ret.push(`  }`);if(prop.reference===enums_1$u.ReferenceType.ONE_TO_ONE&&!prop.mapToPk){const meta2=this.metadata.get(prop.type);const prop2=meta2.properties[prop.inversedBy||prop.mappedBy];if(prop2){ret.push(`  if (entity.${prop.name} && !entity.${prop.name}.${prop2.name}) {`);ret.push(`    entity.${prop.name}.${prop.wrappedReference?"unwrap().":""}${prop2.name} = ${prop2.wrappedReference?"new Reference(entity)":"entity"};`);ret.push(`  }`);}}if(prop.customType){context.set(`convertToDatabaseValue_${prop.name}`,val=>prop.customType.convertToDatabaseValue(val,this.platform));ret.push(`  if (data.${prop.name} != null && convertCustomTypes) {`);ret.push(`    data.${prop.name} = convertToDatabaseValue_${prop.name}(entity.${prop.name}.__helper.getPrimaryKey());`);ret.push(`  }`);}return ret};const hydrateToMany=prop=>{const ret=[];ret.push(...this.createCollectionItemMapper(prop));ret.push(`  if (Array.isArray(data.${prop.name})) {`);ret.push(`     const items = data.${prop.name}.map(value => createCollectionItem_${prop.name}(value));`);ret.push(`     const coll = Collection.create(entity, '${prop.name}', items, newEntity);`);ret.push(`     if (newEntity) {`);ret.push(`       coll.setDirty();`);ret.push(`     } else {`);ret.push(`       coll.takeSnapshot();`);ret.push(`     }`);ret.push(`  } else if (!entity.${prop.name} && data.${prop.name} instanceof Collection) {`);ret.push(`     entity.${prop.name} = data.${prop.name};`);ret.push(`  } else if (!entity.${prop.name}) {`);const items=this.platform.usesPivotTable()||!prop.owner?"undefined":"[]";ret.push(`    const coll = Collection.create(entity, '${prop.name}', ${items}, !!data.${prop.name} || newEntity);`);ret.push(`    coll.setDirty(false);`);ret.push(`  }`);return ret};const hydrateEmbedded=(prop,path,dataKey)=>{const entityKey=path.join(".");const convertorKey=path.join("_").replace(/\[idx_\d+]/g,"");const ret=[];const conds=[];context.set(`prototype_${convertorKey}`,prop.embeddable.prototype);if(prop.object){conds.push(`data.${dataKey} != null`);}else {meta.props.filter(p=>{var _a;return ((_a=p.embedded)===null||_a===void 0?void 0:_a[0])===prop.name}).forEach(p=>conds.push(`data.${p.name} != null`));}ret.push(`  if (${conds.join(" || ")}) {`);ret.push(`    entity.${entityKey} = Object.create(prototype_${convertorKey});`);meta.props.filter(p=>{var _a;return ((_a=p.embedded)===null||_a===void 0?void 0:_a[0])===prop.name}).forEach(childProp=>{const childDataKey=prop.object?dataKey+"."+childProp.embedded[1]:childProp.name;ret.push(...hydrateProperty(childProp,prop.object,[...path,childProp.embedded[1]],childDataKey).map(l=>"  "+l));});ret.push(`  }`);return ret};const hydrateEmbeddedArray=(prop,path,dataKey)=>{const entityKey=path.join(".");const convertorKey=path.join("_").replace(/\[idx_\d+]/g,"");const ret=[];const idx=this.tmpIndex++;context.set(`prototype_${convertorKey}`,prop.embeddable.prototype);ret.push(`  if (Array.isArray(data.${dataKey})) {`);ret.push(`    entity.${entityKey} = [];`);ret.push(`    data.${dataKey}.forEach((_, idx_${idx}) => {`);const last=path.pop();ret.push(...hydrateEmbedded(prop,[...path,`${last}[idx_${idx}]`],`${dataKey}[idx_${idx}]`).map(l=>"    "+l));ret.push(`    });`);ret.push(`  }`);return ret};const hydrateProperty=(prop,object=prop.object,path=[prop.name],dataKey)=>{const entityKey=path.join(".");dataKey=dataKey!==null&&dataKey!==void 0?dataKey:object?entityKey:prop.name;const ret=[];if(prop.reference===enums_1$u.ReferenceType.MANY_TO_ONE||prop.reference===enums_1$u.ReferenceType.ONE_TO_ONE){ret.push(...hydrateToOne(prop));}else if(prop.reference===enums_1$u.ReferenceType.ONE_TO_MANY||prop.reference===enums_1$u.ReferenceType.MANY_TO_MANY){ret.push(...hydrateToMany(prop));}else if(prop.reference===enums_1$u.ReferenceType.EMBEDDED){if(prop.array){ret.push(...hydrateEmbeddedArray(prop,path,dataKey));}else {ret.push(...hydrateEmbedded(prop,path,dataKey));if(!prop.object){ret.push(...hydrateEmbedded(Object.assign(Object.assign({},prop),{object:true}),path,dataKey));}}}else {ret.push(...hydrateScalar(prop,object,path,dataKey));}if(this.config.get("forceUndefined")){ret.push(`  if (data.${dataKey} === null) entity.${entityKey} = undefined;`);}return ret};for(const prop of props){lines.push(...hydrateProperty(prop));}const code=`return function(entity, data, factory, newEntity, convertCustomTypes) {\n${lines.join("\n")}\n}`;const hydrator=Utils_1$j.Utils.createFunction(context,code);this.hydrators[type].set(meta.className,hydrator);return hydrator}createCollectionItemMapper(prop){const meta=this.metadata.find(prop.type);const lines=[];lines.push(`  const createCollectionItem_${prop.name} = value => {`);lines.push(`    if (isPrimaryKey(value, ${meta.compositePK})) return factory.createReference('${prop.type}', value, { convertCustomTypes, merge: true });`);lines.push(`    if (value && value.__entity) return value;`);lines.push(`    return factory.create('${prop.type}', value, { newEntity, convertCustomTypes, merge: true });`);lines.push(`  }`);return lines}}ObjectHydrator$1.ObjectHydrator=ObjectHydrator;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(Hydrator$1,exports);__exportStar(ObjectHydrator$1,exports);})(hydration);getDefaultExportFromCjs(hydration);

var NullHighlighter$1 = {};

Object.defineProperty(NullHighlighter$1,"__esModule",{value:true});NullHighlighter$1.NullHighlighter=void 0;class NullHighlighter{highlight(text){return text}}NullHighlighter$1.NullHighlighter=NullHighlighter;

var Logger$1 = {};

var ansiColors = {exports: {}};

var symbols = {exports: {}};

(function(module){const isHyper=process.env.TERM_PROGRAM==="Hyper";const isWindows=process.platform==="win32";const isLinux=process.platform==="linux";const common={ballotDisabled:"\u2612",ballotOff:"\u2610",ballotOn:"\u2611",bullet:"\u2022",bulletWhite:"\u25E6",fullBlock:"\u2588",heart:"\u2764",identicalTo:"\u2261",line:"\u2500",mark:"\u203B",middot:"\xB7",minus:"\uFF0D",multiplication:"\xD7",obelus:"\xF7",pencilDownRight:"\u270E",pencilRight:"\u270F",pencilUpRight:"\u2710",percent:"%",pilcrow2:"\u2761",pilcrow:"\xB6",plusMinus:"\xB1",section:"\xA7",starsOff:"\u2606",starsOn:"\u2605",upDownArrow:"\u2195"};const windows=Object.assign({},common,{check:"\u221A",cross:"\xD7",ellipsisLarge:"...",ellipsis:"...",info:"i",question:"?",questionSmall:"?",pointer:">",pointerSmall:"\xBB",radioOff:"( )",radioOn:"(*)",warning:"\u203C"});const other=Object.assign({},common,{ballotCross:"\u2718",check:"\u2714",cross:"\u2716",ellipsisLarge:"\u22EF",ellipsis:"\u2026",info:"\u2139",question:"?",questionFull:"\uFF1F",questionSmall:"\uFE56",pointer:isLinux?"\u25B8":"\u276F",pointerSmall:isLinux?"\u2023":"\u203A",radioOff:"\u25EF",radioOn:"\u25C9",warning:"\u26A0"});module.exports=isWindows&&!isHyper?windows:other;Reflect.defineProperty(module.exports,"common",{enumerable:false,value:common});Reflect.defineProperty(module.exports,"windows",{enumerable:false,value:windows});Reflect.defineProperty(module.exports,"other",{enumerable:false,value:other});})(symbols);

const isObject$1=val=>val!==null&&typeof val==="object"&&!Array.isArray(val);const ANSI_REGEX=/[\u001b\u009b][[\]#;?()]*(?:(?:(?:[^\W_]*;?[^\W_]*)\u0007)|(?:(?:[0-9]{1,4}(;[0-9]{0,4})*)?[~0-9=<>cf-nqrtyA-PRZ]))/g;const create=()=>{const colors={enabled:true,visible:true,styles:{},keys:{}};if("FORCE_COLOR"in process.env){colors.enabled=process.env.FORCE_COLOR!=="0";}const ansi=style=>{let open=style.open=`\u001b[${style.codes[0]}m`;let close=style.close=`\u001b[${style.codes[1]}m`;let regex=style.regex=new RegExp(`\\u001b\\[${style.codes[1]}m`,"g");style.wrap=(input,newline)=>{if(input.includes(close))input=input.replace(regex,close+open);let output=open+input+close;return newline?output.replace(/\r*\n/g,`${close}$&${open}`):output};return style};const wrap=(style,input,newline)=>{return typeof style==="function"?style(input):style.wrap(input,newline)};const style=(input,stack)=>{if(input===""||input==null)return "";if(colors.enabled===false)return input;if(colors.visible===false)return "";let str=""+input;let nl=str.includes("\n");let n=stack.length;if(n>0&&stack.includes("unstyle")){stack=[...new Set(["unstyle",...stack])].reverse();}while(n-->0)str=wrap(colors.styles[stack[n]],str,nl);return str};const define=(name,codes,type)=>{colors.styles[name]=ansi({name,codes});let keys=colors.keys[type]||(colors.keys[type]=[]);keys.push(name);Reflect.defineProperty(colors,name,{configurable:true,enumerable:true,set(value){colors.alias(name,value);},get(){let color=input=>style(input,color.stack);Reflect.setPrototypeOf(color,colors);color.stack=this.stack?this.stack.concat(name):[name];return color}});};define("reset",[0,0],"modifier");define("bold",[1,22],"modifier");define("dim",[2,22],"modifier");define("italic",[3,23],"modifier");define("underline",[4,24],"modifier");define("inverse",[7,27],"modifier");define("hidden",[8,28],"modifier");define("strikethrough",[9,29],"modifier");define("black",[30,39],"color");define("red",[31,39],"color");define("green",[32,39],"color");define("yellow",[33,39],"color");define("blue",[34,39],"color");define("magenta",[35,39],"color");define("cyan",[36,39],"color");define("white",[37,39],"color");define("gray",[90,39],"color");define("grey",[90,39],"color");define("bgBlack",[40,49],"bg");define("bgRed",[41,49],"bg");define("bgGreen",[42,49],"bg");define("bgYellow",[43,49],"bg");define("bgBlue",[44,49],"bg");define("bgMagenta",[45,49],"bg");define("bgCyan",[46,49],"bg");define("bgWhite",[47,49],"bg");define("blackBright",[90,39],"bright");define("redBright",[91,39],"bright");define("greenBright",[92,39],"bright");define("yellowBright",[93,39],"bright");define("blueBright",[94,39],"bright");define("magentaBright",[95,39],"bright");define("cyanBright",[96,39],"bright");define("whiteBright",[97,39],"bright");define("bgBlackBright",[100,49],"bgBright");define("bgRedBright",[101,49],"bgBright");define("bgGreenBright",[102,49],"bgBright");define("bgYellowBright",[103,49],"bgBright");define("bgBlueBright",[104,49],"bgBright");define("bgMagentaBright",[105,49],"bgBright");define("bgCyanBright",[106,49],"bgBright");define("bgWhiteBright",[107,49],"bgBright");colors.ansiRegex=ANSI_REGEX;colors.hasColor=colors.hasAnsi=str=>{colors.ansiRegex.lastIndex=0;return typeof str==="string"&&str!==""&&colors.ansiRegex.test(str)};colors.alias=(name,color)=>{let fn=typeof color==="string"?colors[color]:color;if(typeof fn!=="function"){throw new TypeError("Expected alias to be the name of an existing color (string) or a function")}if(!fn.stack){Reflect.defineProperty(fn,"name",{value:name});colors.styles[name]=fn;fn.stack=[name];}Reflect.defineProperty(colors,name,{configurable:true,enumerable:true,set(value){colors.alias(name,value);},get(){let color=input=>style(input,color.stack);Reflect.setPrototypeOf(color,colors);color.stack=this.stack?this.stack.concat(fn.stack):fn.stack;return color}});};colors.theme=custom=>{if(!isObject$1(custom))throw new TypeError("Expected theme to be an object");for(let name of Object.keys(custom)){colors.alias(name,custom[name]);}return colors};colors.alias("unstyle",str=>{if(typeof str==="string"&&str!==""){colors.ansiRegex.lastIndex=0;return str.replace(colors.ansiRegex,"")}return ""});colors.alias("noop",str=>str);colors.none=colors.clear=colors.noop;colors.stripColor=colors.unstyle;colors.symbols=symbols.exports;colors.define=define;return colors};ansiColors.exports=create();ansiColors.exports.create=create;

var __importDefault$7=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(Logger$1,"__esModule",{value:true});Logger$1.Logger=void 0;const ansi_colors_1$3=__importDefault$7(ansiColors.exports);class Logger{constructor(logger,debugMode=false){this.logger=logger;this.debugMode=debugMode;}log(namespace,message){if(!this.isEnabled(namespace)){return}message=message.replace(/\n/g,"").replace(/ +/g," ").trim();this.logger(ansi_colors_1$3.default.grey(`[${namespace}] `)+message);}setDebugMode(debugMode){this.debugMode=debugMode;}isEnabled(namespace){return this.debugMode&&(!Array.isArray(this.debugMode)||this.debugMode.includes(namespace))}}Logger$1.Logger=Logger;

var MetadataStorage$1 = {};

var EntityHelper$1 = {};

var EntityTransformer$1 = {};

Object.defineProperty(EntityTransformer$1,"__esModule",{value:true});EntityTransformer$1.EntityTransformer=EntityTransformer$1.SerializationContext=void 0;const wrap_1$1=wrap$1;const Utils_1$i=Utils;class SerializationContext{constructor(populate){this.populate=populate;this.path=[];}visit(entityName,prop){if(!this.path.find(([cls,item])=>entityName===cls&&prop===item)){this.path.push([entityName,prop]);return false}if(!this.isMarkedAsPopulated(prop)){return true}this.path.push([entityName,prop]);return false}leave(entityName,prop){const last=this.path.pop();if(!last||last[0]!==entityName||last[1]!==prop){throw new Error(`Trying to leave wrong property: ${entityName}.${prop} instead of ${last}`)}}static propagate(root,entity){entity.__helper.__serializationContext.root=root;const items=[];Object.keys(entity).forEach(key=>{if(Utils_1$i.Utils.isEntity(entity[key],true)){items.push(entity[key]);}else if(Utils_1$i.Utils.isCollection(entity[key])){items.push(...entity[key].getItems(false));}});items.filter(item=>!item.__helper.__serializationContext.root).forEach(item=>this.propagate(root,item));}isMarkedAsPopulated(prop){let populate=this.populate;for(const segment of this.path){if(!populate){return false}const exists=populate.find(p=>p.field===segment[1]);if(exists){populate=exists.children;}}return !!(populate===null||populate===void 0?void 0:populate.find(p=>p.field===prop))}}EntityTransformer$1.SerializationContext=SerializationContext;class EntityTransformer{static toObject(entity,ignoreFields=[],raw=false){var _a;const wrapped=entity.__helper;let contextCreated=false;if(!wrapped.__serializationContext.root){const root=new SerializationContext((_a=wrapped.__serializationContext.populate)!==null&&_a!==void 0?_a:[]);SerializationContext.propagate(root,entity);contextCreated=true;}const root=wrapped.__serializationContext.root;const meta=entity.__meta;const ret={};meta.primaryKeys.filter(pk=>!Utils_1$i.Utils.isDefined(entity[pk],true)||!(meta.properties[pk].hidden||ignoreFields.includes(pk))).map(pk=>{let value;if(meta.properties[pk].serializer){value=meta.properties[pk].serializer(entity[pk]);}else if(Utils_1$i.Utils.isEntity(entity[pk],true)){value=EntityTransformer.processEntity(pk,entity,entity.__platform,raw);}else {value=entity.__platform.normalizePrimaryKey(entity[pk]);}return [pk,value]}).forEach(([pk,value])=>ret[this.propertyName(meta,pk,entity.__platform)]=value);if(!wrapped.isInitialized()&&wrapped.hasPrimaryKey()){return ret}Object.keys(entity).filter(prop=>this.isVisible(meta,prop,ignoreFields)).map(prop=>{const cycle=root.visit(meta.className,prop);if(cycle){return [prop,undefined]}const val=EntityTransformer.processProperty(prop,entity,raw);root.leave(meta.className,prop);return [prop,val]}).filter(([,value])=>typeof value!=="undefined").forEach(([prop,value])=>ret[this.propertyName(meta,prop)]=value);meta.props.filter(prop=>prop.getter&&!prop.hidden&&typeof entity[prop.name]!=="undefined").forEach(prop=>ret[this.propertyName(meta,prop.name)]=entity[prop.name]);meta.props.filter(prop=>prop.getterName&&!prop.hidden&&entity[prop.getterName]instanceof Function).forEach(prop=>ret[this.propertyName(meta,prop.name)]=entity[prop.getterName]());if(contextCreated){delete wrapped.__serializationContext.root;}return ret}static isVisible(meta,prop,ignoreFields){const visible=meta.properties[prop]&&!meta.properties[prop].hidden;return visible&&!meta.primaryKeys.includes(prop)&&!prop.startsWith("_")&&!ignoreFields.includes(prop)}static propertyName(meta,prop,platform){if(meta.properties[prop].serializedName){return meta.properties[prop].serializedName}if(meta.properties[prop].primary&&platform){return platform.getSerializedPrimaryKeyField(prop)}return prop}static processProperty(prop,entity,raw){const property=entity.__meta.properties[prop];const serializer=property===null||property===void 0?void 0:property.serializer;if(serializer){return serializer(entity[prop])}if(Utils_1$i.Utils.isCollection(entity[prop])){return EntityTransformer.processCollection(prop,entity,raw)}const customType=property===null||property===void 0?void 0:property.customType;if(customType){return customType.toJSON(entity[prop],entity.__platform)}if(Utils_1$i.Utils.isEntity(entity[prop],true)){return EntityTransformer.processEntity(prop,entity,entity.__platform,raw)}return entity[prop]}static processEntity(prop,entity,platform,raw){const child=entity[prop];const wrapped=child.__helper;if(raw&&wrapped.isInitialized()&&child!==entity){return wrapped.toPOJO()}if(wrapped.isInitialized()&&wrapped.__populated&&child!==entity&&!wrapped.__lazyInitialized){const args=[...wrapped.__meta.toJsonParams.map(()=>undefined)];return wrap_1$1.wrap(child).toJSON(...args)}return platform.normalizePrimaryKey(wrapped.getPrimaryKey())}static processCollection(prop,entity,raw){const col=entity[prop];if(raw&&col.isInitialized(true)){return col.getItems().map(item=>wrap_1$1.wrap(item).toPOJO())}if(col.isInitialized(true)&&col.shouldPopulate()){return col.toArray()}if(col.isInitialized()){return col.getIdentifiers()}}}EntityTransformer$1.EntityTransformer=EntityTransformer;

var WrappedEntity$1 = {};

var EntityAssigner$1 = {};

var EntityValidator$1 = {};

Object.defineProperty(EntityValidator$1,"__esModule",{value:true});EntityValidator$1.EntityValidator=void 0;const enums_1$t=enums;const Utils_1$h=Utils;const errors_1$e=errors;class EntityValidator{constructor(strict){this.strict=strict;}validate(entity,payload,meta){meta.props.forEach(prop=>{if(prop.inherited){return}if([enums_1$t.ReferenceType.ONE_TO_MANY,enums_1$t.ReferenceType.MANY_TO_MANY].includes(prop.reference)){this.validateCollection(entity,prop);}const SCALAR_TYPES=["string","number","boolean","Date"];if(prop.reference!==enums_1$t.ReferenceType.SCALAR||!SCALAR_TYPES.includes(prop.type)){return}const newValue=this.validateProperty(prop,this.getValue(payload,prop),entity);if(this.getValue(payload,prop)===newValue){return}this.setValue(payload,prop,newValue);if(entity[prop.name]){entity[prop.name]=payload[prop.name];}});}validateProperty(prop,givenValue,entity){if(givenValue===null||givenValue===undefined){return givenValue}const expectedType=prop.type.toLowerCase();let givenType=Utils_1$h.Utils.getObjectType(givenValue);let ret=givenValue;if(!this.strict){ret=this.fixTypes(expectedType,givenType,givenValue);givenType=Utils_1$h.Utils.getObjectType(ret);}if(givenType!==expectedType){throw errors_1$e.ValidationError.fromWrongPropertyType(entity,prop.name,expectedType,givenType,givenValue)}return ret}validateParams(params,type="search condition",field){if(Utils_1$h.Utils.isPrimaryKey(params)||Utils_1$h.Utils.isEntity(params)){return}if(Array.isArray(params)){return params.forEach(item=>this.validateParams(item,type,field))}if(Utils_1$h.Utils.isPlainObject(params)){Object.keys(params).forEach(k=>{this.validateParams(params[k],type,k);});}}validatePrimaryKey(entity,meta){const pkExists=meta.primaryKeys.every(pk=>Utils_1$h.Utils.isDefined(entity[pk],true))||Utils_1$h.Utils.isDefined(entity[meta.serializedPrimaryKey],true);if(!entity||!pkExists){throw errors_1$e.ValidationError.fromMergeWithoutPK(meta)}}validateEmptyWhere(where){if(Utils_1$h.Utils.isEmpty(where)){throw new Error(`You cannot call 'EntityManager.findOne()' with empty 'where' parameter`)}}getValue(o,prop){if(prop.embedded&&prop.embedded[0]in o){return o[prop.embedded[0]][prop.embedded[1]]}return o[prop.name]}setValue(o,prop,v){if(prop.embedded&&prop.embedded[0]in o){return o[prop.embedded[0]][prop.embedded[1]]=v}o[prop.name]=v;}validateCollection(entity,prop){if(entity.__helper.__initialized&&!entity[prop.name]){throw errors_1$e.ValidationError.fromCollectionNotInitialized(entity,prop)}}fixTypes(expectedType,givenType,givenValue){if(expectedType==="date"&&["string","number"].includes(givenType)){givenValue=this.fixDateType(givenValue);}if(expectedType==="number"&&givenType==="string"){givenValue=this.fixNumberType(givenValue);}if(expectedType==="boolean"&&givenType==="number"){givenValue=this.fixBooleanType(givenValue);}return givenValue}fixDateType(givenValue){let date;if(Utils_1$h.Utils.isString(givenValue)&&givenValue.match(/^-?\d+(\.\d+)?$/)){date=new Date(+givenValue);}else {date=new Date(givenValue);}return date.toString()!=="Invalid Date"?date:givenValue}fixNumberType(givenValue){const num=+givenValue;return ""+num===givenValue?num:givenValue}fixBooleanType(givenValue){const bool=!!givenValue;return +bool===givenValue?bool:givenValue}}EntityValidator$1.EntityValidator=EntityValidator;

Object.defineProperty(EntityAssigner$1,"__esModule",{value:true});EntityAssigner$1.assign=EntityAssigner$1.EntityAssigner=void 0;const util_1$5=require$$0__default$2["default"];const Utils_1$g=Utils;const Reference_1$5=Reference$1;const enums_1$s=enums;const EntityValidator_1=EntityValidator$1;const wrap_1=wrap$1;const validator=new EntityValidator_1.EntityValidator(false);class EntityAssigner{static assign(entity,data,onlyProperties=false){const options=typeof onlyProperties==="boolean"?{onlyProperties}:onlyProperties;const wrapped=entity.__helper;const meta=entity.__meta;const em=options.em||wrapped.__em;const props=meta.properties;Object.keys(data).forEach(prop=>{var _a,_b,_c,_d;if(options.onlyProperties&&!(prop in props)){return}let value=data[prop];if(props[prop]&&!props[prop].nullable&&value==null){throw new Error(`You must pass a non-${value} value to the property ${prop} of entity ${entity.constructor.name}.`)}if(props[prop]&&Utils_1$g.Utils.isCollection(entity[prop],props[prop])&&Array.isArray(value)&&EntityAssigner.validateEM(em)){return EntityAssigner.assignCollection(entity,entity[prop],value,props[prop],em,options)}const customType=(_a=props[prop])===null||_a===void 0?void 0:_a.customType;if(options.convertCustomTypes&&customType&&props[prop].reference===enums_1$s.ReferenceType.SCALAR&&!Utils_1$g.Utils.isEntity(data)){value=props[prop].customType.convertToJSValue(value,entity.__platform);}if([enums_1$s.ReferenceType.MANY_TO_ONE,enums_1$s.ReferenceType.ONE_TO_ONE].includes((_b=props[prop])===null||_b===void 0?void 0:_b.reference)&&Utils_1$g.Utils.isDefined(value,true)&&EntityAssigner.validateEM(em)){if(options.updateNestedEntities&&entity.hasOwnProperty(prop)&&(Utils_1$g.Utils.isEntity(entity[prop])||Reference_1$5.Reference.isReference(entity[prop]))&&Utils_1$g.Utils.isPlainObject(value)){const unwrappedEntity=Reference_1$5.Reference.unwrapReference(entity[prop]);if(wrap_1.wrap(unwrappedEntity).isInitialized()){return EntityAssigner.assign(unwrappedEntity,value,options)}}return EntityAssigner.assignReference(entity,value,props[prop],em,options)}if(((_c=props[prop])===null||_c===void 0?void 0:_c.reference)===enums_1$s.ReferenceType.SCALAR&&enums_1$s.SCALAR_TYPES.includes(props[prop].type)&&(props[prop].setter||!props[prop].getter)){return entity[prop]=validator.validateProperty(props[prop],value,entity)}if(((_d=props[prop])===null||_d===void 0?void 0:_d.reference)===enums_1$s.ReferenceType.EMBEDDED){return EntityAssigner.assignEmbeddable(entity,value,props[prop],em,options)}if(options.mergeObjects&&Utils_1$g.Utils.isPlainObject(value)){Utils_1$g.Utils.merge(entity[prop],value);}else if(!props[prop]||props[prop].setter||!props[prop].getter){entity[prop]=value;}});return entity}static autoWireOneToOne(prop,entity){if(prop.reference!==enums_1$s.ReferenceType.ONE_TO_ONE){return}const meta2=entity[prop.name].__meta;const prop2=meta2.properties[prop.inversedBy||prop.mappedBy];if(prop2&&!entity[prop.name][prop2.name]){if(Reference_1$5.Reference.isReference(entity[prop.name])){entity[prop.name].unwrap()[prop2.name]=Reference_1$5.Reference.wrapReference(entity,prop2);}else {entity[prop.name][prop2.name]=Reference_1$5.Reference.wrapReference(entity,prop2);}}}static validateEM(em){if(!em){throw new Error(`To use assign() on not managed entities, explicitly provide EM instance: wrap(entity).assign(data, { em: orm.em })`)}return true}static assignReference(entity,value,prop,em,options){if(Utils_1$g.Utils.isEntity(value,true)){entity[prop.name]=value;}else if(Utils_1$g.Utils.isPrimaryKey(value,true)){entity[prop.name]=Reference_1$5.Reference.wrapReference(em.getReference(prop.type,value,false,options.convertCustomTypes),prop);}else if(Utils_1$g.Utils.isPlainObject(value)&&options.merge){entity[prop.name]=Reference_1$5.Reference.wrapReference(em.merge(prop.type,value),prop);}else if(Utils_1$g.Utils.isPlainObject(value)){entity[prop.name]=Reference_1$5.Reference.wrapReference(em.create(prop.type,value),prop);}else {const name=entity.constructor.name;throw new Error(`Invalid reference value provided for '${name}.${prop.name}' in ${name}.assign(): ${JSON.stringify(value)}`)}EntityAssigner.autoWireOneToOne(prop,entity);}static assignCollection(entity,collection,value,prop,em,options){const invalid=[];const items=value.map((item,idx)=>{var _a;if(options.updateNestedEntities&&((_a=collection[idx])===null||_a===void 0?void 0:_a.__helper.isInitialized())){return EntityAssigner.assign(collection[idx],item,options)}return this.createCollectionItem(item,em,prop,invalid,options)});if(invalid.length>0){const name=entity.constructor.name;throw new Error(`Invalid collection values provided for '${name}.${prop.name}' in ${name}.assign(): ${util_1$5.inspect(invalid)}`)}collection.set(items);}static assignEmbeddable(entity,value,prop,em,options){const Embeddable=prop.embeddable;const propName=prop.embedded?prop.embedded[1]:prop.name;entity[propName]=prop.array||options.mergeObjects?entity[propName]||Object.create(Embeddable.prototype):Object.create(Embeddable.prototype);if(!value){entity[propName]=value;return}if(prop.array&&(Array.isArray(value)||entity[propName]==null)){entity[propName]=[];}if(prop.array){return Utils_1$g.Utils.asArray(value).forEach(item=>{const tmp={};this.assignEmbeddable(tmp,item,Object.assign(Object.assign({},prop),{array:false}),em,options);entity[propName].push(...Object.values(tmp));})}Object.keys(value).forEach(key=>{const childProp=prop.embeddedProps[key];if(childProp&&childProp.reference===enums_1$s.ReferenceType.EMBEDDED){return EntityAssigner.assignEmbeddable(entity[propName],value[key],childProp,em,options)}entity[propName][key]=value[key];});}static createCollectionItem(item,em,prop,invalid,options){if(Utils_1$g.Utils.isEntity(item)){return item}if(Utils_1$g.Utils.isPrimaryKey(item)){return em.getReference(prop.type,item)}if(Utils_1$g.Utils.isPlainObject(item)&&options.merge){return em.merge(prop.type,item)}if(Utils_1$g.Utils.isPlainObject(item)){return em.create(prop.type,item)}invalid.push(item);return item}}EntityAssigner$1.EntityAssigner=EntityAssigner;EntityAssigner$1.assign=EntityAssigner.assign;

Object.defineProperty(WrappedEntity$1,"__esModule",{value:true});WrappedEntity$1.WrappedEntity=void 0;const util_1$4=require$$0__default$2["default"];const Reference_1$4=Reference$1;const EntityTransformer_1$1=EntityTransformer$1;const EntityAssigner_1$1=EntityAssigner$1;const Utils_1$f=Utils;const errors_1$d=errors;class WrappedEntity{constructor(entity,pkGetter,pkSerializer,pkGetterConverted){this.entity=entity;this.pkGetter=pkGetter;this.pkSerializer=pkSerializer;this.pkGetterConverted=pkGetterConverted;this.__initialized=true;this.__serializationContext={};}isInitialized(){return this.__initialized}populated(populated=true){this.__populated=populated;this.__lazyInitialized=false;}toReference(){return Reference_1$4.Reference.create(this.entity)}toObject(ignoreFields=[]){return EntityTransformer_1$1.EntityTransformer.toObject(this.entity,ignoreFields)}toPOJO(){return EntityTransformer_1$1.EntityTransformer.toObject(this.entity,[],true)}toJSON(...args){return this.entity.toJSON(...args)}assign(data,options){if("assign"in this.entity){return this.entity.assign(data,options)}return EntityAssigner_1$1.EntityAssigner.assign(this.entity,data,options)}async init(populated=true,populate,lockMode){if(!this.__em){throw errors_1$d.ValidationError.entityNotManaged(this.entity)}await this.__em.findOne(this.entity.constructor.name,this.entity,{refresh:true,lockMode,populate});this.populated(populated);this.__lazyInitialized=true;return this.entity}hasPrimaryKey(){const pk=this.getPrimaryKey();return pk!==undefined&&pk!==null}getPrimaryKey(convertCustomTypes=false){if(convertCustomTypes){return this.pkGetterConverted(this.entity)}return this.pkGetter(this.entity)}getPrimaryKeys(convertCustomTypes=false){const pk=this.getPrimaryKey(convertCustomTypes);if(!pk){return null}if(this.__meta.compositePK){return this.__meta.primaryKeys.reduce((ret,pk)=>{const child=this.entity[pk];if(Utils_1$f.Utils.isEntity(child,true)){const childPk=child.__helper.getPrimaryKeys(convertCustomTypes);ret.push(...childPk);}else {ret.push(child);}return ret},[])}return [pk]}setPrimaryKey(id){this.entity[this.entity.__meta.primaryKeys[0]]=id;}getSerializedPrimaryKey(){return this.pkSerializer(this.entity)}get __meta(){return this.entity.__meta}get __platform(){return this.entity.__platform}get __primaryKeys(){return Utils_1$f.Utils.getPrimaryKeyValues(this.entity,this.entity.__meta.primaryKeys)}get __primaryKeyCond(){if(this.entity.__meta.compositePK){return this.__primaryKeys}return this.getPrimaryKey()}[util_1$4.inspect.custom](){return `[WrappedEntity<${this.entity.__meta.className}>]`}}WrappedEntity$1.WrappedEntity=WrappedEntity;

Object.defineProperty(EntityHelper$1,"__esModule",{value:true});EntityHelper$1.EntityHelper=void 0;const util_1$3=require$$0__default$2["default"];const EntityTransformer_1=EntityTransformer$1;const Reference_1$3=Reference$1;const Utils_1$e=Utils;const WrappedEntity_1=WrappedEntity$1;const enums_1$r=enums;const entityHelperSymbol=Symbol("helper");class EntityHelper{static decorate(meta,em){if(meta.embeddable){return}const pk=meta.properties[meta.primaryKeys[0]];if(pk.name==="_id"&&meta.serializedPrimaryKey==="id"){EntityHelper.defineIdProperty(meta,em.getPlatform());}EntityHelper.defineBaseProperties(meta,meta.prototype,em);const prototype=meta.prototype;if(em.config.get("propagateToOneOwner")){EntityHelper.defineReferenceProperties(meta);}if(!prototype.toJSON){prototype.toJSON=function(...args){return EntityTransformer_1.EntityTransformer.toObject(this,...args.slice(meta.toJsonParams.length))};}}static defineIdProperty(meta,platform){Object.defineProperty(meta.prototype,"id",{get(){return this._id?platform.normalizePrimaryKey(this._id):null},set(id){this._id=id?platform.denormalizePrimaryKey(id):null;}});}static defineBaseProperties(meta,prototype,em){Object.defineProperties(prototype,{__entity:{value:true},__meta:{value:meta},__platform:{value:em.getPlatform()},[entityHelperSymbol]:{value:null,writable:true,enumerable:false},__helper:{get(){if(!this[entityHelperSymbol]){Object.defineProperty(this,entityHelperSymbol,{value:new WrappedEntity_1.WrappedEntity(this,em.getComparator().getPkGetter(meta),em.getComparator().getPkSerializer(meta),em.getComparator().getPkGetterConverted(meta)),enumerable:false});}return this[entityHelperSymbol]}}});}static defineReferenceProperties(meta){Object.values(meta.properties).filter(prop=>[enums_1$r.ReferenceType.ONE_TO_ONE,enums_1$r.ReferenceType.MANY_TO_ONE].includes(prop.reference)&&(prop.inversedBy||prop.mappedBy)&&!prop.mapToPk).forEach(prop=>{Object.defineProperty(meta.prototype,prop.name,{set(val){if(!("__data"in this)){Object.defineProperty(this,"__data",{value:{}});}EntityHelper.defineReferenceProperty(prop,this,val);}});});if(!meta.prototype[util_1$3.inspect.custom]){meta.prototype[util_1$3.inspect.custom]=function(depth){const object=Object.assign({},this);delete object[entityHelperSymbol];const ret=util_1$3.inspect(object,{depth});let name=this.constructor.name;if(!this.__helper.__initialized){name=`Ref<${name}>`;}return ret==="[Object]"?`[${name}]`:name+" "+ret};}}static defineReferenceProperty(prop,ref,val){Object.defineProperty(ref,prop.name,{get(){return this.__data[prop.name]},set(val){const entity=Reference_1$3.Reference.unwrapReference(val!==null&&val!==void 0?val:this.__data[prop.name]);this.__data[prop.name]=Reference_1$3.Reference.wrapReference(val,prop);EntityHelper.propagate(entity,this,prop,Reference_1$3.Reference.unwrapReference(val));},enumerable:true,configurable:true});ref[prop.name]=val;}static propagate(entity,owner,prop,value){const inverse=value&&value[prop.inversedBy||prop.mappedBy];if(prop.reference===enums_1$r.ReferenceType.MANY_TO_ONE&&Utils_1$e.Utils.isCollection(inverse)&&inverse.isInitialized()){inverse.add(owner);}if(prop.reference===enums_1$r.ReferenceType.ONE_TO_ONE&&entity&&entity.__helper.__initialized&&Reference_1$3.Reference.unwrapReference(inverse)!==owner&&value!=null){EntityHelper.propagateOneToOne(entity,owner,prop);}if(prop.reference===enums_1$r.ReferenceType.ONE_TO_ONE&&entity&&entity.__helper.__initialized&&entity[prop.inversedBy||prop.mappedBy]!=null&&value==null){entity[prop.inversedBy||prop.mappedBy]=value;}}static propagateOneToOne(entity,owner,prop){const inverse=entity[prop.inversedBy||prop.mappedBy];if(Reference_1$3.Reference.isReference(inverse)){inverse.set(owner);}else {entity[prop.inversedBy||prop.mappedBy]=Reference_1$3.Reference.wrapReference(owner,prop);}}}EntityHelper$1.EntityHelper=EntityHelper;

Object.defineProperty(MetadataStorage$1,"__esModule",{value:true});MetadataStorage$1.MetadataStorage=void 0;const typings_1$2=typings$1;const Utils_1$d=Utils;const errors_1$c=errors;const EntityHelper_1=EntityHelper$1;class MetadataStorage{constructor(metadata={}){this.metadata=Utils_1$d.Utils.copy(metadata);}static getMetadata(entity,path){const key=entity&&path?entity+"-"+Utils_1$d.Utils.hash(path):null;if(key&&!MetadataStorage.metadata[key]){MetadataStorage.metadata[key]=new typings_1$2.EntityMetadata({className:entity,path});}if(key){return MetadataStorage.metadata[key]}return MetadataStorage.metadata}static isKnownEntity(name){return !!Object.values(this.metadata).find(meta=>meta.className===name)}static getMetadataFromDecorator(target){const path=Utils_1$d.Utils.lookupPathFromDecorator(target.name);const meta=MetadataStorage.getMetadata(target.name,path);Object.defineProperty(target,"__path",{value:path,writable:true});return meta}static getSubscriberMetadata(){return MetadataStorage.subscribers}static init(){return new MetadataStorage(MetadataStorage.metadata)}static clear(){Object.keys(this.metadata).forEach(k=>delete this.metadata[k]);Object.keys(this.subscribers).forEach(k=>delete this.subscribers[k]);}getAll(){return this.metadata}getByDiscriminatorColumn(meta,data){const value=data[meta.root.discriminatorColumn];if(!value){return undefined}const type=meta.root.discriminatorMap[value];return this.metadata[type]}get(entity,init=false,validate=true){if(validate&&!init&&entity&&!this.has(entity)){throw errors_1$c.MetadataError.missingMetadata(entity)}if(init&&!this.has(entity)){this.metadata[entity]=new typings_1$2.EntityMetadata;}return this.metadata[entity]}find(entity){return this.metadata[entity]}has(entity){return entity in this.metadata}set(entity,meta){return this.metadata[entity]=meta}reset(entity){delete this.metadata[entity];}decorate(em){Object.values(this.metadata).filter(meta=>meta.prototype&&!Utils_1$d.Utils.isEntity(meta.prototype)).forEach(meta=>EntityHelper_1.EntityHelper.decorate(meta,em));}}MetadataStorage$1.MetadataStorage=MetadataStorage;MetadataStorage.metadata=Utils_1$d.Utils.getGlobalStorage("metadata");MetadataStorage.subscribers=Utils_1$d.Utils.getGlobalStorage("subscribers");

var ReflectMetadataProvider$1 = {};

var Reflect$1;(function(Reflect){(function(factory){var root=typeof commonjsGlobal==="object"?commonjsGlobal:typeof self==="object"?self:typeof this==="object"?this:Function("return this;")();var exporter=makeExporter(Reflect);if(typeof root.Reflect==="undefined"){root.Reflect=Reflect;}else {exporter=makeExporter(root.Reflect,exporter);}factory(exporter);function makeExporter(target,previous){return function(key,value){if(typeof target[key]!=="function"){Object.defineProperty(target,key,{configurable:true,writable:true,value:value});}if(previous)previous(key,value);}}})(function(exporter){var hasOwn=Object.prototype.hasOwnProperty;var supportsSymbol=typeof Symbol==="function";var toPrimitiveSymbol=supportsSymbol&&typeof Symbol.toPrimitive!=="undefined"?Symbol.toPrimitive:"@@toPrimitive";var iteratorSymbol=supportsSymbol&&typeof Symbol.iterator!=="undefined"?Symbol.iterator:"@@iterator";var supportsCreate=typeof Object.create==="function";var supportsProto={__proto__:[]}instanceof Array;var downLevel=!supportsCreate&&!supportsProto;var HashMap={create:supportsCreate?function(){return MakeDictionary(Object.create(null))}:supportsProto?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:downLevel?function(map,key){return hasOwn.call(map,key)}:function(map,key){return key in map},get:downLevel?function(map,key){return hasOwn.call(map,key)?map[key]:undefined}:function(map,key){return map[key]}};var functionPrototype=Object.getPrototypeOf(Function);var usePolyfill=typeof process==="object"&&process.env&&process.env["REFLECT_METADATA_USE_MAP_POLYFILL"]==="true";var _Map=!usePolyfill&&typeof Map==="function"&&typeof Map.prototype.entries==="function"?Map:CreateMapPolyfill();var _Set=!usePolyfill&&typeof Set==="function"&&typeof Set.prototype.entries==="function"?Set:CreateSetPolyfill();var _WeakMap=!usePolyfill&&typeof WeakMap==="function"?WeakMap:CreateWeakMapPolyfill();var Metadata=new _WeakMap;function decorate(decorators,target,propertyKey,attributes){if(!IsUndefined(propertyKey)){if(!IsArray(decorators))throw new TypeError;if(!IsObject(target))throw new TypeError;if(!IsObject(attributes)&&!IsUndefined(attributes)&&!IsNull(attributes))throw new TypeError;if(IsNull(attributes))attributes=undefined;propertyKey=ToPropertyKey(propertyKey);return DecorateProperty(decorators,target,propertyKey,attributes)}else {if(!IsArray(decorators))throw new TypeError;if(!IsConstructor(target))throw new TypeError;return DecorateConstructor(decorators,target)}}exporter("decorate",decorate);function metadata(metadataKey,metadataValue){function decorator(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey)&&!IsPropertyKey(propertyKey))throw new TypeError;OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey);}return decorator}exporter("metadata",metadata);function defineMetadata(metadataKey,metadataValue,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey)}exporter("defineMetadata",defineMetadata);function hasMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryHasMetadata(metadataKey,target,propertyKey)}exporter("hasMetadata",hasMetadata);function hasOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryHasOwnMetadata(metadataKey,target,propertyKey)}exporter("hasOwnMetadata",hasOwnMetadata);function getMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryGetMetadata(metadataKey,target,propertyKey)}exporter("getMetadata",getMetadata);function getOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryGetOwnMetadata(metadataKey,target,propertyKey)}exporter("getOwnMetadata",getOwnMetadata);function getMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryMetadataKeys(target,propertyKey)}exporter("getMetadataKeys",getMetadataKeys);function getOwnMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);return OrdinaryOwnMetadataKeys(target,propertyKey)}exporter("getOwnMetadataKeys",getOwnMetadataKeys);function deleteMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey))propertyKey=ToPropertyKey(propertyKey);var metadataMap=GetOrCreateMetadataMap(target,propertyKey,false);if(IsUndefined(metadataMap))return false;if(!metadataMap.delete(metadataKey))return false;if(metadataMap.size>0)return true;var targetMetadata=Metadata.get(target);targetMetadata.delete(propertyKey);if(targetMetadata.size>0)return true;Metadata.delete(target);return true}exporter("deleteMetadata",deleteMetadata);function DecorateConstructor(decorators,target){for(var i=decorators.length-1;i>=0;--i){var decorator=decorators[i];var decorated=decorator(target);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsConstructor(decorated))throw new TypeError;target=decorated;}}return target}function DecorateProperty(decorators,target,propertyKey,descriptor){for(var i=decorators.length-1;i>=0;--i){var decorator=decorators[i];var decorated=decorator(target,propertyKey,descriptor);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsObject(decorated))throw new TypeError;descriptor=decorated;}}return descriptor}function GetOrCreateMetadataMap(O,P,Create){var targetMetadata=Metadata.get(O);if(IsUndefined(targetMetadata)){if(!Create)return undefined;targetMetadata=new _Map;Metadata.set(O,targetMetadata);}var metadataMap=targetMetadata.get(P);if(IsUndefined(metadataMap)){if(!Create)return undefined;metadataMap=new _Map;targetMetadata.set(P,metadataMap);}return metadataMap}function OrdinaryHasMetadata(MetadataKey,O,P){var hasOwn=OrdinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return true;var parent=OrdinaryGetPrototypeOf(O);if(!IsNull(parent))return OrdinaryHasMetadata(MetadataKey,parent,P);return false}function OrdinaryHasOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return false;return ToBoolean(metadataMap.has(MetadataKey))}function OrdinaryGetMetadata(MetadataKey,O,P){var hasOwn=OrdinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return OrdinaryGetOwnMetadata(MetadataKey,O,P);var parent=OrdinaryGetPrototypeOf(O);if(!IsNull(parent))return OrdinaryGetMetadata(MetadataKey,parent,P);return undefined}function OrdinaryGetOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return undefined;return metadataMap.get(MetadataKey)}function OrdinaryDefineOwnMetadata(MetadataKey,MetadataValue,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,true);metadataMap.set(MetadataKey,MetadataValue);}function OrdinaryMetadataKeys(O,P){var ownKeys=OrdinaryOwnMetadataKeys(O,P);var parent=OrdinaryGetPrototypeOf(O);if(parent===null)return ownKeys;var parentKeys=OrdinaryMetadataKeys(parent,P);if(parentKeys.length<=0)return ownKeys;if(ownKeys.length<=0)return parentKeys;var set=new _Set;var keys=[];for(var _i=0,ownKeys_1=ownKeys;_i<ownKeys_1.length;_i++){var key=ownKeys_1[_i];var hasKey=set.has(key);if(!hasKey){set.add(key);keys.push(key);}}for(var _a=0,parentKeys_1=parentKeys;_a<parentKeys_1.length;_a++){var key=parentKeys_1[_a];var hasKey=set.has(key);if(!hasKey){set.add(key);keys.push(key);}}return keys}function OrdinaryOwnMetadataKeys(O,P){var keys=[];var metadataMap=GetOrCreateMetadataMap(O,P,false);if(IsUndefined(metadataMap))return keys;var keysObj=metadataMap.keys();var iterator=GetIterator(keysObj);var k=0;while(true){var next=IteratorStep(iterator);if(!next){keys.length=k;return keys}var nextValue=IteratorValue(next);try{keys[k]=nextValue;}catch(e){try{IteratorClose(iterator);}finally{throw e}}k++;}}function Type(x){if(x===null)return 1;switch(typeof x){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return x===null?1:6;default:return 6;}}function IsUndefined(x){return x===undefined}function IsNull(x){return x===null}function IsSymbol(x){return typeof x==="symbol"}function IsObject(x){return typeof x==="object"?x!==null:typeof x==="function"}function ToPrimitive(input,PreferredType){switch(Type(input)){case 0:return input;case 1:return input;case 2:return input;case 3:return input;case 4:return input;case 5:return input;}var hint=PreferredType===3?"string":PreferredType===5?"number":"default";var exoticToPrim=GetMethod(input,toPrimitiveSymbol);if(exoticToPrim!==undefined){var result=exoticToPrim.call(input,hint);if(IsObject(result))throw new TypeError;return result}return OrdinaryToPrimitive(input,hint==="default"?"number":hint)}function OrdinaryToPrimitive(O,hint){if(hint==="string"){var toString_1=O.toString;if(IsCallable(toString_1)){var result=toString_1.call(O);if(!IsObject(result))return result}var valueOf=O.valueOf;if(IsCallable(valueOf)){var result=valueOf.call(O);if(!IsObject(result))return result}}else {var valueOf=O.valueOf;if(IsCallable(valueOf)){var result=valueOf.call(O);if(!IsObject(result))return result}var toString_2=O.toString;if(IsCallable(toString_2)){var result=toString_2.call(O);if(!IsObject(result))return result}}throw new TypeError}function ToBoolean(argument){return !!argument}function ToString(argument){return ""+argument}function ToPropertyKey(argument){var key=ToPrimitive(argument,3);if(IsSymbol(key))return key;return ToString(key)}function IsArray(argument){return Array.isArray?Array.isArray(argument):argument instanceof Object?argument instanceof Array:Object.prototype.toString.call(argument)==="[object Array]"}function IsCallable(argument){return typeof argument==="function"}function IsConstructor(argument){return typeof argument==="function"}function IsPropertyKey(argument){switch(Type(argument)){case 3:return true;case 4:return true;default:return false;}}function GetMethod(V,P){var func=V[P];if(func===undefined||func===null)return undefined;if(!IsCallable(func))throw new TypeError;return func}function GetIterator(obj){var method=GetMethod(obj,iteratorSymbol);if(!IsCallable(method))throw new TypeError;var iterator=method.call(obj);if(!IsObject(iterator))throw new TypeError;return iterator}function IteratorValue(iterResult){return iterResult.value}function IteratorStep(iterator){var result=iterator.next();return result.done?false:result}function IteratorClose(iterator){var f=iterator["return"];if(f)f.call(iterator);}function OrdinaryGetPrototypeOf(O){var proto=Object.getPrototypeOf(O);if(typeof O!=="function"||O===functionPrototype)return proto;if(proto!==functionPrototype)return proto;var prototype=O.prototype;var prototypeProto=prototype&&Object.getPrototypeOf(prototype);if(prototypeProto==null||prototypeProto===Object.prototype)return proto;var constructor=prototypeProto.constructor;if(typeof constructor!=="function")return proto;if(constructor===O)return proto;return constructor}function CreateMapPolyfill(){var cacheSentinel={};var arraySentinel=[];var MapIterator=function(){function MapIterator(keys,values,selector){this._index=0;this._keys=keys;this._values=values;this._selector=selector;}MapIterator.prototype["@@iterator"]=function(){return this};MapIterator.prototype[iteratorSymbol]=function(){return this};MapIterator.prototype.next=function(){var index=this._index;if(index>=0&&index<this._keys.length){var result=this._selector(this._keys[index],this._values[index]);if(index+1>=this._keys.length){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel;}else {this._index++;}return {value:result,done:false}}return {value:undefined,done:true}};MapIterator.prototype.throw=function(error){if(this._index>=0){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel;}throw error};MapIterator.prototype.return=function(value){if(this._index>=0){this._index=-1;this._keys=arraySentinel;this._values=arraySentinel;}return {value:value,done:true}};return MapIterator}();return function(){function Map(){this._keys=[];this._values=[];this._cacheKey=cacheSentinel;this._cacheIndex=-2;}Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:true,configurable:true});Map.prototype.has=function(key){return this._find(key,false)>=0};Map.prototype.get=function(key){var index=this._find(key,false);return index>=0?this._values[index]:undefined};Map.prototype.set=function(key,value){var index=this._find(key,true);this._values[index]=value;return this};Map.prototype.delete=function(key){var index=this._find(key,false);if(index>=0){var size=this._keys.length;for(var i=index+1;i<size;i++){this._keys[i-1]=this._keys[i];this._values[i-1]=this._values[i];}this._keys.length--;this._values.length--;if(key===this._cacheKey){this._cacheKey=cacheSentinel;this._cacheIndex=-2;}return true}return false};Map.prototype.clear=function(){this._keys.length=0;this._values.length=0;this._cacheKey=cacheSentinel;this._cacheIndex=-2;};Map.prototype.keys=function(){return new MapIterator(this._keys,this._values,getKey)};Map.prototype.values=function(){return new MapIterator(this._keys,this._values,getValue)};Map.prototype.entries=function(){return new MapIterator(this._keys,this._values,getEntry)};Map.prototype["@@iterator"]=function(){return this.entries()};Map.prototype[iteratorSymbol]=function(){return this.entries()};Map.prototype._find=function(key,insert){if(this._cacheKey!==key){this._cacheIndex=this._keys.indexOf(this._cacheKey=key);}if(this._cacheIndex<0&&insert){this._cacheIndex=this._keys.length;this._keys.push(key);this._values.push(undefined);}return this._cacheIndex};return Map}();function getKey(key,_){return key}function getValue(_,value){return value}function getEntry(key,value){return [key,value]}}function CreateSetPolyfill(){return function(){function Set(){this._map=new _Map;}Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:true,configurable:true});Set.prototype.has=function(value){return this._map.has(value)};Set.prototype.add=function(value){return this._map.set(value,value),this};Set.prototype.delete=function(value){return this._map.delete(value)};Set.prototype.clear=function(){this._map.clear();};Set.prototype.keys=function(){return this._map.keys()};Set.prototype.values=function(){return this._map.values()};Set.prototype.entries=function(){return this._map.entries()};Set.prototype["@@iterator"]=function(){return this.keys()};Set.prototype[iteratorSymbol]=function(){return this.keys()};return Set}()}function CreateWeakMapPolyfill(){var UUID_SIZE=16;var keys=HashMap.create();var rootKey=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey();}WeakMap.prototype.has=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?HashMap.has(table,this._key):false};WeakMap.prototype.get=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?HashMap.get(table,this._key):undefined};WeakMap.prototype.set=function(target,value){var table=GetOrCreateWeakMapTable(target,true);table[this._key]=value;return this};WeakMap.prototype.delete=function(target){var table=GetOrCreateWeakMapTable(target,false);return table!==undefined?delete table[this._key]:false};WeakMap.prototype.clear=function(){this._key=CreateUniqueKey();};return WeakMap}();function CreateUniqueKey(){var key;do key="@@WeakMap@@"+CreateUUID();while(HashMap.has(keys,key));keys[key]=true;return key}function GetOrCreateWeakMapTable(target,create){if(!hasOwn.call(target,rootKey)){if(!create)return undefined;Object.defineProperty(target,rootKey,{value:HashMap.create()});}return target[rootKey]}function FillRandomBytes(buffer,size){for(var i=0;i<size;++i)buffer[i]=Math.random()*255|0;return buffer}function GenRandomBytes(size){if(typeof Uint8Array==="function"){if(typeof crypto!=="undefined")return crypto.getRandomValues(new Uint8Array(size));if(typeof msCrypto!=="undefined")return msCrypto.getRandomValues(new Uint8Array(size));return FillRandomBytes(new Uint8Array(size),size)}return FillRandomBytes(new Array(size),size)}function CreateUUID(){var data=GenRandomBytes(UUID_SIZE);data[6]=data[6]&79|64;data[8]=data[8]&191|128;var result="";for(var offset=0;offset<UUID_SIZE;++offset){var byte=data[offset];if(offset===4||offset===6||offset===8)result+="-";if(byte<16)result+="0";result+=byte.toString(16).toLowerCase();}return result}}function MakeDictionary(obj){obj.__=undefined;delete obj.__;return obj}});})(Reflect$1||(Reflect$1={}));

var MetadataProvider$1 = {};

Object.defineProperty(MetadataProvider$1,"__esModule",{value:true});MetadataProvider$1.MetadataProvider=void 0;const Utils_1$c=Utils;class MetadataProvider{constructor(config){this.config=config;}loadFromCache(meta,cache){Utils_1$c.Utils.merge(meta,cache);}useCache(){var _a;return (_a=this.config.get("cache").enabled)!==null&&_a!==void 0?_a:false}async initProperties(meta,fallback){for(const prop of Object.values(meta.properties)){if(Utils_1$c.Utils.isString(prop.entity)){prop.type=prop.entity;}else if(prop.entity){prop.type=Utils_1$c.Utils.className(prop.entity());}else if(!prop.type){await fallback(prop);}}}}MetadataProvider$1.MetadataProvider=MetadataProvider;

Object.defineProperty(ReflectMetadataProvider$1,"__esModule",{value:true});ReflectMetadataProvider$1.ReflectMetadataProvider=void 0;const MetadataProvider_1$1=MetadataProvider$1;const enums_1$q=enums;class ReflectMetadataProvider extends MetadataProvider_1$1.MetadataProvider{async loadEntityMetadata(meta,name){await this.initProperties(meta,prop=>this.initPropertyType(meta,prop));}initPropertyType(meta,prop){const type=Reflect.getMetadata("design:type",meta.prototype,prop.name);if(!type||type===Object&&prop.reference!==enums_1$q.ReferenceType.SCALAR){throw new Error(`Please provide either 'type' or 'entity' attribute in ${meta.className}.${prop.name}`)}prop.type=type.name;if(["string","number","boolean","array","object"].includes(prop.type.toLowerCase())){prop.type=prop.type.toLowerCase();}}}ReflectMetadataProvider$1.ReflectMetadataProvider=ReflectMetadataProvider;

var RequestContext$1 = {};

var __importDefault$6=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(RequestContext$1,"__esModule",{value:true});RequestContext$1.RequestContext=void 0;const domain_1$1=__importDefault$6(require$$0__default$6["default"]);class RequestContext{constructor(map){this.map=map;this.id=RequestContext.counter++;}get em(){return this.map.get("default")}static create(em,next){const d=this.createDomain(em);d.run(next);}static async createAsync(em,next){const d=this.createDomain(em);await new Promise((resolve,reject)=>{d.run(()=>next().then(resolve).catch(reject));});}static currentRequestContext(){const active=domain_1$1.default.active;return active?active.__mikro_orm_context:undefined}static getEntityManager(name="default"){const context=RequestContext.currentRequestContext();return context?context.map.get(name):undefined}static createDomain(em){const forks=new Map;if(Array.isArray(em)){em.forEach(em=>forks.set(em.name,em.fork(true,true)));}else {forks.set(em.name,em.fork(true,true));}const context=new RequestContext(forks);const d=domain_1$1.default.create();d.__mikro_orm_context=context;return d}}RequestContext$1.RequestContext=RequestContext;RequestContext.counter=1;

Object.defineProperty(Configuration$1,"__esModule",{value:true});var Configuration_2=Configuration$1.Configuration=void 0;const util_1$2=require$$0__default$2["default"];const cache_1$1=cache$1;const hydration_1=hydration;const NullHighlighter_1=NullHighlighter$1;const Logger_1=Logger$1;const Utils_1$b=Utils;const MetadataStorage_1$1=MetadataStorage$1;const ReflectMetadataProvider_1=ReflectMetadataProvider$1;const errors_1$b=errors;const RequestContext_1=RequestContext$1;const enums_1$p=enums;const MemoryCacheAdapter_1=MemoryCacheAdapter$1;class Configuration{constructor(options,validate=true){this.cache={};this.options=Utils_1$b.Utils.merge({},Configuration.DEFAULTS,options);this.options.baseDir=Utils_1$b.Utils.absolutePath(this.options.baseDir);if(validate){this.validateOptions();}this.logger=new Logger_1.Logger(this.options.logger,this.options.debug);this.driver=this.initDriver();this.platform=this.driver.getPlatform();this.platform.setConfig(this);this.init();}get(key,defaultValue){return Utils_1$b.Utils.isDefined(this.options[key])?this.options[key]:defaultValue}getAll(){return this.options}set(key,value){this.options[key]=value;}reset(key){this.options[key]=Configuration.DEFAULTS[key];}getLogger(){return this.logger}getClientUrl(hidePassword=false){if(hidePassword){return this.options.clientUrl.replace(/\/\/([^:]+):(.+)@/,"//$1:*****@")}return this.options.clientUrl}getDriver(){return this.driver}getNamingStrategy(){return this.cached(this.options.namingStrategy||this.platform.getNamingStrategy())}getHydrator(metadata){return this.cached(this.options.hydrator,metadata,this.platform,this)}getMetadataProvider(){return this.cached(this.options.metadataProvider,this)}getCacheAdapter(){return this.cached(this.options.cache.adapter,this.options.cache.options,this.options.baseDir,this.options.cache.pretty)}getResultCacheAdapter(){return this.cached(this.options.resultCache.adapter,Object.assign({expiration:this.options.resultCache.expiration},this.options.resultCache.options))}getRepositoryClass(customRepository){if(customRepository){return customRepository()}if(this.options.entityRepository){return this.options.entityRepository}return this.platform.getRepositoryClass()}init(){if(!this.getMetadataProvider().useCache()){this.options.cache.adapter=cache_1$1.NullCacheAdapter;}if(!("enabled"in this.options.cache)){this.options.cache.enabled=this.getMetadataProvider().useCache();}if(!this.options.clientUrl){this.options.clientUrl=this.driver.getConnection().getDefaultClientUrl();}if(!("implicitTransactions"in this.options)){this.set("implicitTransactions",this.platform.usesImplicitTransactions());}const url=this.getClientUrl().match(/:\/\/.+\/([^?]+)/);if(url){this.options.dbName=this.get("dbName",url[1]);}if(!this.options.charset){this.options.charset=this.platform.getDefaultCharset();}Object.keys(this.options.filters).forEach(key=>{var _a;this.options.filters[key].default=(_a=this.options.filters[key].default)!==null&&_a!==void 0?_a:true;});const subscribers=Object.values(MetadataStorage_1$1.MetadataStorage.getSubscriberMetadata());this.options.subscribers=[...new Set([...this.options.subscribers,...subscribers])];}validateOptions(){if(!this.options.type&&!this.options.driver){throw new Error("No platform type specified, please fill in `type` or provide custom driver class in `driver` option. Available platforms types: "+util_1$2.inspect(Object.keys(Configuration.PLATFORMS)))}if(this.options.type&&!(this.options.type in Configuration.PLATFORMS)){throw new Error(`Invalid platform type specified: '${this.options.type}', please fill in valid \`type\` or provide custom driver class in \`driver\` option. Available platforms types: ${util_1$2.inspect(Object.keys(Configuration.PLATFORMS))}`)}if(!this.options.dbName&&!this.options.clientUrl){throw new Error("No database specified, please fill in `dbName` or `clientUrl` option")}if(this.options.entities.length===0&&this.options.discovery.warnWhenNoEntities){throw new Error("No entities found, please use `entities` option")}}initDriver(){if(!this.options.driver){const{className,module}=Configuration.PLATFORMS[this.options.type];this.options.driver=module()[className];}return new this.options.driver(this)}cached(cls,...args){if(!this.cache[cls.name]){const Class=cls;this.cache[cls.name]=new Class(...args);}return this.cache[cls.name]}}Configuration_2=Configuration$1.Configuration=Configuration;Configuration.DEFAULTS={pool:{},entities:[],entitiesTs:[],subscribers:[],filters:{},discovery:{warnWhenNoEntities:true,requireEntitiesArray:false,alwaysAnalyseProperties:true,disableDynamicFileAccess:false},strict:false,validate:false,context:name=>RequestContext_1.RequestContext.getEntityManager(name),contextName:"default",logger:console.log.bind(console),findOneOrFailHandler:(entityName,where)=>errors_1$b.NotFoundError.findOneFailed(entityName,where),baseDir:process.cwd(),hydrator:hydration_1.ObjectHydrator,loadStrategy:enums_1$p.LoadStrategy.SELECT_IN,autoJoinOneToOneOwner:true,propagateToOneOwner:true,populateAfterFlush:false,forceEntityConstructor:false,forceUndefined:false,forceUtcTimezone:false,ensureIndexes:false,batchSize:300,debug:false,verbose:false,driverOptions:{},migrations:{tableName:"mikro_orm_migrations",path:"./migrations",pattern:/^[\w-]+\d+\.ts$/,transactional:true,disableForeignKeys:true,allOrNothing:true,dropTables:true,safe:false,emit:"ts",fileName:timestamp=>`Migration${timestamp}`},cache:{pretty:false,adapter:cache_1$1.FileCacheAdapter,options:{cacheDir:process.cwd()+"/temp"}},resultCache:{adapter:MemoryCacheAdapter_1.MemoryCacheAdapter,expiration:1000,options:{}},metadataProvider:ReflectMetadataProvider_1.ReflectMetadataProvider,highlighter:new NullHighlighter_1.NullHighlighter};Configuration.PLATFORMS={mongo:{className:"MongoDriver",module:()=>require("@mikro-orm/mongodb")},mysql:{className:"MySqlDriver",module:()=>require("@mikro-orm/mysql")},mariadb:{className:"MariaDbDriver",module:()=>require("@mikro-orm/mariadb")},postgresql:{className:"PostgreSqlDriver",module:()=>require("@mikro-orm/postgresql")},sqlite:{className:"SqliteDriver",module:()=>require("@mikro-orm/sqlite")}};

var ConfigurationLoader$1 = {};

var main = {};

const fs$4=require$$0__default$3["default"];const path$1=require$$0__default$1["default"];function log$3(message){console.log(`[dotenv][DEBUG] ${message}`);}const NEWLINE="\n";const RE_INI_KEY_VAL=/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/;const RE_NEWLINES=/\\n/g;const NEWLINES_MATCH=/\n|\r|\r\n/;function parse$9(src,options){const debug=Boolean(options&&options.debug);const obj={};src.toString().split(NEWLINES_MATCH).forEach(function(line,idx){const keyValueArr=line.match(RE_INI_KEY_VAL);if(keyValueArr!=null){const key=keyValueArr[1];let val=keyValueArr[2]||"";const end=val.length-1;const isDoubleQuoted=val[0]==="\""&&val[end]==="\"";const isSingleQuoted=val[0]==="'"&&val[end]==="'";if(isSingleQuoted||isDoubleQuoted){val=val.substring(1,end);if(isDoubleQuoted){val=val.replace(RE_NEWLINES,NEWLINE);}}else {val=val.trim();}obj[key]=val;}else if(debug){log$3(`did not match key and value when parsing line ${idx+1}: ${line}`);}});return obj}function config(options){let dotenvPath=path$1.resolve(process.cwd(),".env");let encoding="utf8";let debug=false;if(options){if(options.path!=null){dotenvPath=options.path;}if(options.encoding!=null){encoding=options.encoding;}if(options.debug!=null){debug=true;}}try{const parsed=parse$9(fs$4.readFileSync(dotenvPath,{encoding}),{debug});Object.keys(parsed).forEach(function(key){if(!Object.prototype.hasOwnProperty.call(process.env,key)){process.env[key]=parsed[key];}else if(debug){log$3(`"${key}" is already defined in \`process.env\` and will not be overwritten`);}});return {parsed}}catch(e){return {error:e}}}main.config=config;main.parse=parse$9;

var __importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(ConfigurationLoader$1,"__esModule",{value:true});ConfigurationLoader$1.ConfigurationLoader=void 0;const dotenv_1=__importDefault$5(main);const fs_extra_1=lib$1.exports;const path_1$1=require$$0__default$1["default"];const Configuration_1=Configuration$1;const Utils_1$a=Utils;class ConfigurationLoader{static async getConfiguration(validate=true,options){const paths=await ConfigurationLoader.getConfigPaths();const env=ConfigurationLoader.loadEnvironmentVars(options);for(let path of paths){path=Utils_1$a.Utils.absolutePath(path);path=Utils_1$a.Utils.normalizePath(path);if(await fs_extra_1.pathExists(path)){const config=commonjsRequire(path);return new Configuration_1.Configuration(Object.assign(Object.assign(Object.assign({},await(config.default||config)),options),env),validate)}}if(Utils_1$a.Utils.hasObjectKeys(env)){return new Configuration_1.Configuration(Object.assign(Object.assign({},options),env),validate)}throw new Error(`MikroORM config file not found in ['${paths.join(`', '`)}']`)}static async getPackageConfig(){if(await fs_extra_1.pathExists(process.cwd()+"/package.json")){return commonjsRequire(process.cwd()+"/package.json")}return {}}static async getSettings(){const config=await ConfigurationLoader.getPackageConfig();return config["mikro-orm"]||{}}static async getConfigPaths(){const paths=[];const settings=await ConfigurationLoader.getSettings();if(process.env.MIKRO_ORM_CLI){paths.push(process.env.MIKRO_ORM_CLI);}paths.push(...(settings.configPaths||[]));if(settings.useTsNode){paths.push("./mikro-orm.config.ts");}paths.push("./mikro-orm.config.js");const tsNode=Utils_1$a.Utils.detectTsNode();return paths.filter(p=>p.endsWith(".js")||tsNode)}static async registerTsNode(configPath="tsconfig.json"){var _a;const tsConfigPath=path_1$1.isAbsolute(configPath)?configPath:path_1$1.join(process.cwd(),configPath);const tsNode=Utils_1$a.Utils.tryRequire({module:"ts-node",from:tsConfigPath,warning:"ts-node not installed, support for working with TS files might not work"});if(!tsNode){return}const{options}=tsNode.register({project:tsConfigPath,transpileOnly:true}).config;if(Object.entries((_a=options===null||options===void 0?void 0:options.paths)!==null&&_a!==void 0?_a:{}).length>0){Utils_1$a.Utils.requireFrom("tsconfig-paths",tsConfigPath).register({baseUrl:options.baseUrl,paths:options.paths});}}static loadEnvironmentVars(options){var _a;const baseDir=options instanceof Configuration_1.Configuration?options.get("baseDir"):options===null||options===void 0?void 0:options.baseDir;const path=(_a=process.env.MIKRO_ORM_ENV)!==null&&_a!==void 0?_a:(baseDir!==null&&baseDir!==void 0?baseDir:process.cwd())+"/.env";dotenv_1.default.config({path});const ret={};const array=v=>v.split(",").map(vv=>vv.trim());const bool=v=>["true","t","1"].includes(v.toLowerCase());const re=v=>new RegExp(v);const num=v=>+v;const read=(o,envKey,key,mapper=v=>v)=>{if(!(envKey in process.env)){return}const val=process.env[envKey];o[key]=mapper(val);};const cleanup=(o,k)=>Utils_1$a.Utils.hasObjectKeys(o[k])?{}:delete o[k];read(ret,"MIKRO_ORM_BASE_DIR","baseDir");read(ret,"MIKRO_ORM_TYPE","type");read(ret,"MIKRO_ORM_ENTITIES","entities",array);read(ret,"MIKRO_ORM_ENTITIES_TS","entitiesTs",array);read(ret,"MIKRO_ORM_CLIENT_URL","clientUrl");read(ret,"MIKRO_ORM_HOST","host");read(ret,"MIKRO_ORM_PORT","port",num);read(ret,"MIKRO_ORM_USER","user");read(ret,"MIKRO_ORM_PASSWORD","password");read(ret,"MIKRO_ORM_DB_NAME","dbName");read(ret,"MIKRO_ORM_LOAD_STRATEGY","loadStrategy");read(ret,"MIKRO_ORM_BATCH_SIZE","batchSize",num);read(ret,"MIKRO_ORM_USE_BATCH_INSERTS","useBatchInserts",bool);read(ret,"MIKRO_ORM_USE_BATCH_UPDATES","useBatchUpdates",bool);read(ret,"MIKRO_ORM_STRICT","strict",bool);read(ret,"MIKRO_ORM_VALIDATE","validate",bool);read(ret,"MIKRO_ORM_AUTO_JOIN_ONE_TO_ONE_OWNER","autoJoinOneToOneOwner",bool);read(ret,"MIKRO_ORM_PROPAGATE_TO_ONE_OWNER","propagateToOneOwner",bool);read(ret,"MIKRO_ORM_POPULATE_AFTER_FLUSH","populateAfterFlush",bool);read(ret,"MIKRO_ORM_FORCE_ENTITY_CONSTRUCTOR","forceEntityConstructor",bool);read(ret,"MIKRO_ORM_FORCE_UNDEFINED","forceUndefined",bool);read(ret,"MIKRO_ORM_FORCE_UTC_TIMEZONE","forceUtcTimezone",bool);read(ret,"MIKRO_ORM_TIMEZONE","timezone");read(ret,"MIKRO_ORM_ENSURE_INDEXES","ensureIndexes",bool);read(ret,"MIKRO_ORM_IMPLICIT_TRANSACTIONS","implicitTransactions",bool);read(ret,"MIKRO_ORM_DEBUG","debug",bool);read(ret,"MIKRO_ORM_VERBOSE","verbose",bool);ret.discovery={};read(ret.discovery,"MIKRO_ORM_DISCOVERY_WARN_WHEN_NO_ENTITIES","warnWhenNoEntities",bool);read(ret.discovery,"MIKRO_ORM_DISCOVERY_REQUIRE_ENTITIES_ARRAY","requireEntitiesArray",bool);read(ret.discovery,"MIKRO_ORM_DISCOVERY_ALWAYS_ANALYSE_PROPERTIES","alwaysAnalyseProperties",bool);read(ret.discovery,"MIKRO_ORM_DISCOVERY_DISABLE_DYNAMIC_FILE_ACCESS","disableDynamicFileAccess",bool);cleanup(ret,"discovery");ret.migrations={};read(ret.migrations,"MIKRO_ORM_MIGRATIONS_TABLE_NAME","tableName");read(ret.migrations,"MIKRO_ORM_MIGRATIONS_PATH","path");read(ret.migrations,"MIKRO_ORM_MIGRATIONS_PATTERN","pattern",re);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_TRANSACTIONAL","transactional",bool);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_DISABLE_FOREIGN_KEYS","disableForeignKeys",bool);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_ALL_OR_NOTHING","allOrNothing",bool);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_DROP_TABLES","dropTables",bool);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_SAFE","safe",bool);read(ret.migrations,"MIKRO_ORM_MIGRATIONS_EMIT","emit");cleanup(ret,"migrations");return ret}}ConfigurationLoader$1.ConfigurationLoader=ConfigurationLoader;

var TransactionContext$1 = {};

var __importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(TransactionContext$1,"__esModule",{value:true});TransactionContext$1.TransactionContext=void 0;const domain_1=__importDefault$4(require$$0__default$6["default"]);class TransactionContext{constructor(em){this.em=em;this.id=this.em.id;}static async createAsync(em,next){const context=new TransactionContext(em);const old=domain_1.default.active||{};const d=domain_1.default.create();const ignore=["_events","_eventsCount","_maxListeners","members"];Object.keys(old).filter(k=>!ignore.includes(k)).forEach(k=>d[k]=old[k]);d.__mikro_orm_tx_context=context;return new Promise((resolve,reject)=>{d.run(()=>next().then(resolve).catch(reject));})}static currentTransactionContext(){const active=domain_1.default.active;return active?active.__mikro_orm_tx_context:undefined}static getEntityManager(){const context=TransactionContext.currentTransactionContext();return context?context.em:undefined}}TransactionContext$1.TransactionContext=TransactionContext;

var QueryHelper$1 = {};

var types = {};

var Type$1 = {};

Object.defineProperty(Type$1,"__esModule",{value:true});Type$1.Type=void 0;class Type{convertToDatabaseValue(value,platform,fromQuery){return value}convertToJSValue(value,platform){return value}compareAsType(){return "any"}toJSON(value,platform){return value}getColumnType(prop,platform){var _a;return (_a=prop.columnTypes)===null||_a===void 0?void 0:_a[0]}static getType(cls){const key=cls.name;if(!Type.types.has(key)){Type.types.set(key,new cls);}return Type.types.get(key)}}Type$1.Type=Type;Type.types=new Map;

var DateType$1 = {};

Object.defineProperty(DateType$1,"__esModule",{value:true});DateType$1.DateType=void 0;const Type_1$5=Type$1;const errors_1$a=errors;class DateType extends Type_1$5.Type{convertToDatabaseValue(value,platform){if(value instanceof Date){return value.toISOString().substr(0,10)}if(!value||value.toString().match(/^\d{4}-\d{2}-\d{2}$/)){return value}throw errors_1$a.ValidationError.invalidType(DateType,value,"JS")}convertToJSValue(value,platform){if(!value||value instanceof Date){return value}const date=new Date(value);if(date.toString()==="Invalid Date"){throw errors_1$a.ValidationError.invalidType(DateType,value,"database")}return date}compareAsType(){return "date"}getColumnType(prop,platform){return platform.getDateTypeDeclarationSQL(prop.length)}toJSON(value,platform){return this.convertToDatabaseValue(value,platform)}}DateType$1.DateType=DateType;

var TimeType$1 = {};

Object.defineProperty(TimeType$1,"__esModule",{value:true});TimeType$1.TimeType=void 0;const Type_1$4=Type$1;const errors_1$9=errors;class TimeType extends Type_1$4.Type{convertToDatabaseValue(value,platform){if(value&&!value.toString().match(/^\d{2,}:(?:[0-5]\d):(?:[0-5]\d)$/)){throw errors_1$9.ValidationError.invalidType(TimeType,value,"JS")}return super.convertToDatabaseValue(value,platform)}compareAsType(){return "string"}getColumnType(prop,platform){return platform.getTimeTypeDeclarationSQL(prop.length)}}TimeType$1.TimeType=TimeType;

var BigIntType$1 = {};

Object.defineProperty(BigIntType$1,"__esModule",{value:true});BigIntType$1.BigIntType=void 0;const Type_1$3=Type$1;class BigIntType extends Type_1$3.Type{convertToDatabaseValue(value){if(!value){return value}return ""+value}convertToJSValue(value){if(!value){return value}return ""+value}getColumnType(prop,platform){return platform.getBigIntTypeDeclarationSQL()}}BigIntType$1.BigIntType=BigIntType;

var BlobType$1 = {};

Object.defineProperty(BlobType$1,"__esModule",{value:true});BlobType$1.BlobType=void 0;const Type_1$2=Type$1;class BlobType extends Type_1$2.Type{convertToDatabaseValue(value,platform){return value}convertToJSValue(value,platform){if(value instanceof Buffer||!value){return value}if(value.buffer instanceof Buffer){return value.buffer}return Buffer.from(value)}compareAsType(){return "buffer"}getColumnType(prop,platform){return platform.getBlobDeclarationSQL()}}BlobType$1.BlobType=BlobType;

var ArrayType$1 = {};

Object.defineProperty(ArrayType$1,"__esModule",{value:true});ArrayType$1.ArrayType=void 0;const Type_1$1=Type$1;const utils_1$i=utils$m;const errors_1$8=errors;class ArrayType extends Type_1$1.Type{constructor(hydrate=i=>i){super();this.hydrate=hydrate;}convertToDatabaseValue(value,platform,fromQuery){if(!value){return value}if(Array.isArray(value)){return platform.marshallArray(value)}if(fromQuery){return value}throw errors_1$8.ValidationError.invalidType(ArrayType,value,"JS")}convertToJSValue(value,platform){if(!utils_1$i.Utils.isDefined(value,true)){return value}if(utils_1$i.Utils.isString(value)){value=platform.unmarshallArray(value);}return value.map(i=>this.hydrate(i))}compareAsType(){return "array"}toJSON(value){return value}getColumnType(prop,platform){return platform.getArrayDeclarationSQL()}}ArrayType$1.ArrayType=ArrayType;

var EnumArrayType$1 = {};

Object.defineProperty(EnumArrayType$1,"__esModule",{value:true});EnumArrayType$1.EnumArrayType=void 0;const util_1$1=require$$0__default$2["default"];const ArrayType_1=ArrayType$1;const errors_1$7=errors;function mapHydrator(items,hydrate){if(items&&items.length>0&&typeof items[0]==="number"){return i=>+i}return hydrate}class EnumArrayType extends ArrayType_1.ArrayType{constructor(owner,items,hydrate=i=>i){super(mapHydrator(items,hydrate));this.owner=owner;this.items=items;}convertToDatabaseValue(value,platform,fromQuery){if(Array.isArray(value)&&Array.isArray(this.items)){const invalid=value.filter(v=>!this.items.includes(v));if(invalid.length>0){throw new errors_1$7.ValidationError(`Invalid enum array items provided in ${this.owner}: ${util_1$1.inspect(invalid)}`)}}return super.convertToDatabaseValue(value,platform,fromQuery)}}EnumArrayType$1.EnumArrayType=EnumArrayType;

var JsonType$1 = {};

Object.defineProperty(JsonType$1,"__esModule",{value:true});JsonType$1.JsonType=void 0;const Type_1=Type$1;const utils_1$h=utils$m;class JsonType extends Type_1.Type{convertToDatabaseValue(value,platform){if(platform.convertsJsonAutomatically(true)||value===null){return value}return JSON.stringify(value)}convertToJSValue(value,platform){if(!platform.convertsJsonAutomatically()&&utils_1$h.Utils.isString(value)){return JSON.parse(value)}return value}getColumnType(prop,platform){return platform.getJsonDeclarationSQL()}}JsonType$1.JsonType=JsonType;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(Type$1,exports);__exportStar(DateType$1,exports);__exportStar(TimeType$1,exports);__exportStar(BigIntType$1,exports);__exportStar(BlobType$1,exports);__exportStar(ArrayType$1,exports);__exportStar(EnumArrayType$1,exports);__exportStar(JsonType$1,exports);})(types);getDefaultExportFromCjs(types);

Object.defineProperty(QueryHelper$1,"__esModule",{value:true});QueryHelper$1.expr=QueryHelper$1.QueryHelper=void 0;const Reference_1$2=Reference$1;const Utils_1$9=Utils;const enums_1$o=enums;const types_1$2=types;class QueryHelper{static processParams(params){if(Reference_1$2.Reference.isReference(params)){params=params.unwrap();}if(Utils_1$9.Utils.isEntity(params)){return params.__helper.__primaryKeyCond}if(params===undefined){return null}if(Array.isArray(params)){return params.map(item=>QueryHelper.processParams(item))}if(Utils_1$9.Utils.isPlainObject(params)){QueryHelper.processObjectParams(params);}return params}static processObjectParams(params={}){Object.keys(params).forEach(k=>{params[k]=QueryHelper.processParams(params[k]);});return params}static inlinePrimaryKeyObjects(where,meta,metadata,key){if(Array.isArray(where)){where.forEach((item,i)=>{if(this.inlinePrimaryKeyObjects(item,meta,metadata,key)){where[i]=Utils_1$9.Utils.getPrimaryKeyValues(item,meta.primaryKeys,false);}});}if(!Utils_1$9.Utils.isPlainObject(where)){return false}if(meta.primaryKeys.every(pk=>pk in where)&&Utils_1$9.Utils.getObjectKeysSize(where)===meta.primaryKeys.length){return !enums_1$o.GroupOperator[key]&&Object.keys(where).every(k=>!Utils_1$9.Utils.isPlainObject(where[k])||Object.keys(where[k]).every(v=>!Utils_1$9.Utils.isOperator(v,false)))}Object.keys(where).forEach(k=>{var _a;const meta2=metadata.find((_a=meta.properties[k])===null||_a===void 0?void 0:_a.type)||meta;if(this.inlinePrimaryKeyObjects(where[k],meta2,metadata,k)){where[k]=Utils_1$9.Utils.getPrimaryKeyValues(where[k],meta2.primaryKeys,true);}});return false}static processWhere(where,entityName,metadata,platform,convertCustomTypes=true,root=true){const meta=metadata.find(entityName);if(meta&&root){QueryHelper.inlinePrimaryKeyObjects(where,meta,metadata);}where=QueryHelper.processParams(where)||{};if(!root&&Utils_1$9.Utils.isPrimaryKey(where)){return where}if(meta&&Utils_1$9.Utils.isPrimaryKey(where,meta.compositePK)){where={[Utils_1$9.Utils.getPrimaryKeyHash(meta.primaryKeys)]:where};}if(Array.isArray(where)&&root){const rootPrimaryKey=meta?Utils_1$9.Utils.getPrimaryKeyHash(meta.primaryKeys):entityName;return {[rootPrimaryKey]:{$in:where.map(sub=>QueryHelper.processWhere(sub,entityName,metadata,platform,convertCustomTypes,false))}}}if(!Utils_1$9.Utils.isPlainObject(where)){return where}return Object.keys(where).reduce((o,key)=>{var _a,_b,_c;let value=where[key];const prop=meta===null||meta===void 0?void 0:meta.properties[key];const keys=(_b=(_a=prop===null||prop===void 0?void 0:prop.joinColumns)===null||_a===void 0?void 0:_a.length)!==null&&_b!==void 0?_b:0;const composite=keys>1;if(key in enums_1$o.GroupOperator){o[key]=value.map(sub=>QueryHelper.processWhere(sub,entityName,metadata,platform,convertCustomTypes,false));return o}if(Utils_1$9.Utils.isOperator(key)&&root&&meta&&key!=="$not"){const rootPrimaryKey=Utils_1$9.Utils.getPrimaryKeyHash(meta.primaryKeys);o[rootPrimaryKey]={[key]:QueryHelper.processWhere(value,entityName,metadata,platform,convertCustomTypes,false)};return o}if((prop===null||prop===void 0?void 0:prop.customType)&&convertCustomTypes&&!platform.isRaw(value)){value=QueryHelper.processCustomType(prop,value,platform,undefined,true);}if((prop===null||prop===void 0?void 0:prop.customType)instanceof types_1$2.JsonType&&Utils_1$9.Utils.isPlainObject(value)&&!platform.isRaw(value)){return this.processJsonCondition(o,value,[prop.fieldNames[0]],platform)}if(Array.isArray(value)&&!Utils_1$9.Utils.isOperator(key)&&!QueryHelper.isSupportedOperator(key)&&!key.includes("?")){if(platform.allowsComparingTuples()){const op=!value.every(v=>Array.isArray(v))&&composite?"$eq":"$in";o[key]={[op]:value};}else {if(!value.every(v=>Array.isArray(v))&&composite){o[key]={$in:[value]};}else {o[key]={$in:value};}}return o}const re="[^:]+("+this.SUPPORTED_OPERATORS.filter(op=>op.startsWith(":")).map(op=>`${op}`).join("|")+")$";const operatorExpression=new RegExp(re).exec(key);if(Utils_1$9.Utils.isPlainObject(value)){o[key]=QueryHelper.processWhere(value,(_c=prop===null||prop===void 0?void 0:prop.type)!==null&&_c!==void 0?_c:entityName,metadata,platform,convertCustomTypes,false);}else if(!QueryHelper.isSupportedOperator(key)){o[key]=value;}else if(operatorExpression){const[k,expr]=key.split(":");o[k]=QueryHelper.processExpression(expr,value);}else {const m=key.match(/([\w-]+) ?([<>=!]+)$/);if(m){o[m[1]]=QueryHelper.processExpression(m[2],value);}else {o[key]=value;}}return o},{})}static getActiveFilters(entityName,options,filters){if(options===false){return []}const opts={};if(Array.isArray(options)){options.forEach(filter=>opts[filter]=true);}else if(Utils_1$9.Utils.isPlainObject(options)){Object.keys(options).forEach(filter=>opts[filter]=options[filter]);}return Object.keys(filters).filter(f=>QueryHelper.isFilterActive(entityName,f,filters[f],opts)).map(f=>{filters[f].name=f;return filters[f]})}static isFilterActive(entityName,filterName,filter,options){if(filter.entity&&!filter.entity.includes(entityName)){return false}if(options[filterName]===false){return false}return filter.default||filterName in options}static processCustomType(prop,cond,platform,key,fromQuery){if(Utils_1$9.Utils.isPlainObject(cond)){return Object.keys(cond).reduce((o,k)=>{var _a;if(Utils_1$9.Utils.isOperator(k,true)||((_a=prop.referencedPKs)===null||_a===void 0?void 0:_a.includes(k))){o[k]=QueryHelper.processCustomType(prop,cond[k],platform,k,fromQuery);}else {o[k]=cond[k];}return o},{})}if(Array.isArray(cond)&&!(key&&enums_1$o.ARRAY_OPERATORS.includes(key))){return cond.map(v=>QueryHelper.processCustomType(prop,v,platform,key,fromQuery))}return prop.customType.convertToDatabaseValue(cond,platform,fromQuery)}static processExpression(expr,value){switch(expr){case">":return {$gt:value};case"<":return {$lt:value};case">=":return {$gte:value};case"<=":return {$lte:value};case"!=":return {$ne:value};case"!":return {$not:value};default:return {["$"+expr]:value};}}static isSupportedOperator(key){return !!QueryHelper.SUPPORTED_OPERATORS.find(op=>key.includes(op))}static processJsonCondition(o,value,path,platform){if(Utils_1$9.Utils.isPlainObject(value)&&!Object.keys(value).some(k=>Utils_1$9.Utils.isOperator(k))){Object.keys(value).forEach(k=>{this.processJsonCondition(o,value[k],[...path,k],platform);});return o}const operatorObject=Utils_1$9.Utils.isPlainObject(value)&&Object.keys(value).every(k=>Utils_1$9.Utils.isOperator(k));const type=operatorObject?typeof Object.values(value)[0]:typeof value;const k=platform.getSearchJsonPropertyKey(path,type);o[k]=value;return o}}QueryHelper$1.QueryHelper=QueryHelper;QueryHelper.SUPPORTED_OPERATORS=[">","<","<=",">=","!","!=",":in",":nin",":gt",":gte",":lt",":lte",":ne",":not"];const expr=sql=>sql;QueryHelper$1.expr=expr;

var EntityComparator$1 = {};

var __importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(EntityComparator$1,"__esModule",{value:true});EntityComparator$1.EntityComparator=void 0;const clone_1=__importDefault$3(clone.exports);const enums_1$n=enums;const Utils_1$8=Utils;class EntityComparator{constructor(metadata,platform){this.metadata=metadata;this.platform=platform;this.comparators=new Map;this.mappers=new Map;this.snapshotGenerators=new Map;this.pkGetters=new Map;this.pkGettersConverted=new Map;this.pkSerializers=new Map;this.tmpIndex=0;}diffEntities(entityName,a,b){const comparator=this.getEntityComparator(entityName);return Utils_1$8.Utils.callCompiledFunction(comparator,a,b)}prepareEntity(entity){const generator=this.getSnapshotGenerator(entity.constructor.name);return Utils_1$8.Utils.callCompiledFunction(generator,entity)}mapResult(entityName,result){const mapper=this.getResultMapper(entityName);return Utils_1$8.Utils.callCompiledFunction(mapper,result)}getPkGetter(meta){const exists=this.pkGetters.get(meta.className);if(exists){return exists}const lines=[];const context=new Map;if(meta.primaryKeys.length>1){lines.push(`  const cond = {`);meta.primaryKeys.forEach(pk=>{if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`    ${pk}: (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) ? entity.${pk}.__helper.getPrimaryKey() : entity.${pk},`);}else {lines.push(`    ${pk}: entity.${pk},`);}});lines.push(`  };`);lines.push(`  if (${meta.primaryKeys.map(pk=>`cond.${pk} == null`).join(" || ")}) return null;`);lines.push(`  return cond;`);}else {const pk=meta.primaryKeys[0];if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`  if (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) return entity.${pk}.__helper.getPrimaryKey();`);}lines.push(`  return entity.${pk};`);}const code=`return function(entity) {\n${lines.join("\n")}\n}`;const pkSerializer=Utils_1$8.Utils.createFunction(context,code);this.pkGetters.set(meta.className,pkSerializer);return pkSerializer}getPkGetterConverted(meta){const exists=this.pkGettersConverted.get(meta.className);if(exists){return exists}const lines=[];const context=new Map;if(meta.primaryKeys.length>1){lines.push(`  const cond = {`);meta.primaryKeys.forEach(pk=>{if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`    ${pk}: (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) ? entity.${pk}.__helper.getPrimaryKey(true) : entity.${pk},`);}else {lines.push(`    ${pk}: entity.${pk},`);}});lines.push(`  };`);lines.push(`  if (${meta.primaryKeys.map(pk=>`cond.${pk} == null`).join(" || ")}) return null;`);lines.push(`  return cond;`);}else {const pk=meta.primaryKeys[0];if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`  if (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) return entity.${pk}.__helper.getPrimaryKey(true);`);}if(meta.properties[pk].customType){context.set(`convertToDatabaseValue_${pk}`,val=>meta.properties[pk].customType.convertToDatabaseValue(val,this.platform));lines.push(`  return convertToDatabaseValue_${pk}(entity.${pk});`);}else {lines.push(`  return entity.${pk};`);}}const code=`return function(entity) {\n${lines.join("\n")}\n}`;const pkSerializer=Utils_1$8.Utils.createFunction(context,code);this.pkGettersConverted.set(meta.className,pkSerializer);return pkSerializer}getPkSerializer(meta){const exists=this.pkSerializers.get(meta.className);if(exists){return exists}const lines=[];const context=new Map;if(meta.primaryKeys.length>1){lines.push(`  const pks = [`);meta.primaryKeys.forEach(pk=>{if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`    (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) ? entity.${pk}.__helper.getSerializedPrimaryKey() : entity.${pk},`);}else {lines.push(`    entity.${pk},`);}});lines.push(`  ];`);lines.push(`  return pks.join('${Utils_1$8.Utils.PK_SEPARATOR}');`);}else {const pk=meta.primaryKeys[0];if(meta.properties[pk].reference!==enums_1$n.ReferenceType.SCALAR){lines.push(`  if (entity.${pk} != null && (entity.${pk}.__entity || entity.${pk}.__reference)) return entity.${pk}.__helper.getSerializedPrimaryKey();`);}lines.push(`  return '' + entity.${meta.serializedPrimaryKey};`);}const code=`return function(entity) {\n${lines.join("\n")}\n}`;const pkSerializer=Utils_1$8.Utils.createFunction(context,code);this.pkSerializers.set(meta.className,pkSerializer);return pkSerializer}getSnapshotGenerator(entityName){const exists=this.snapshotGenerators.get(entityName);if(exists){return exists}const meta=this.metadata.find(entityName);const lines=[];const context=new Map;context.set("clone",clone_1.default);context.set("cloneEmbeddable",o=>this.platform.cloneEmbeddable(o));if(meta.discriminatorValue){lines.push(`  ret.${meta.root.discriminatorColumn} = '${meta.discriminatorValue}'`);}const getRootProperty=prop=>prop.embedded?getRootProperty(meta.properties[prop.embedded[0]]):prop;meta.comparableProps.filter(prop=>{const root=getRootProperty(prop);return prop===root||root.reference!==enums_1$n.ReferenceType.EMBEDDED}).forEach(prop=>lines.push(this.getPropertySnapshot(meta,prop,context)));const code=`return function(entity) {\n  const ret = {};\n${lines.join("\n")}\n  return ret;\n}`;const snapshotGenerator=Utils_1$8.Utils.createFunction(context,code);this.snapshotGenerators.set(entityName,snapshotGenerator);return snapshotGenerator}getResultMapper(entityName){const exists=this.mappers.get(entityName);if(exists){return exists}const meta=this.metadata.get(entityName);const lines=[];const context=new Map;lines.push(`  const mapped = {};`);meta.props.forEach(prop=>{if(prop.fieldNames){if(prop.fieldNames.length>1){lines.push(`  if (${prop.fieldNames.map(field=>`result.${field} != null`).join(" && ")}) {\n    ret.${prop.name} = [${prop.fieldNames.map(field=>`result.${field}`).join(", ")}];`);lines.push(...prop.fieldNames.map(field=>`    mapped.${field} = true;`));lines.push(`  } else if (${prop.fieldNames.map(field=>`result.${field} == null`).join(" && ")}) {\n    ret.${prop.name} = null;`);lines.push(...prop.fieldNames.map(field=>`    mapped.${field} = true;`),"  }");}else {if(prop.type==="boolean"){lines.push(`  if ('${prop.fieldNames[0]}' in result) { ret.${prop.name} = result.${prop.fieldNames[0]} == null ? result.${prop.fieldNames[0]} : !!result.${prop.fieldNames[0]}; mapped.${prop.fieldNames[0]} = true; }`);}else {lines.push(`  if ('${prop.fieldNames[0]}' in result) { ret.${prop.name} = result.${prop.fieldNames[0]}; mapped.${prop.fieldNames[0]} = true; }`);}}}});lines.push(`  for (let k in result) { if (result.hasOwnProperty(k) && !mapped[k]) ret[k] = result[k]; }`);const code=`return function(result) {\n  const ret = {};\n${lines.join("\n")}\n  return ret;\n}`;const snapshotGenerator=Utils_1$8.Utils.createFunction(context,code);this.mappers.set(entityName,snapshotGenerator);return snapshotGenerator}getPropertyCondition(prop){let ret=`'${prop.name}' in entity`;const isRef=[enums_1$n.ReferenceType.ONE_TO_ONE,enums_1$n.ReferenceType.MANY_TO_ONE].includes(prop.reference)&&!prop.mapToPk;const isSetter=isRef&&!!(prop.inversedBy||prop.mappedBy);if(prop.primary||isSetter){ret+=` && entity.${prop.name} != null`;}if(isRef){ret+=` && (entity.${prop.name} == null || entity.${prop.name}.__helper.hasPrimaryKey())`;}return ret}getEmbeddedArrayPropertySnapshot(meta,prop,context,level,path=[prop.name],dataKey,object,serialize){const entityKey=path.join(".");dataKey=dataKey!==null&&dataKey!==void 0?dataKey:entityKey;const ret=[];const padding=" ".repeat(level*2);const idx=this.tmpIndex++;ret.push(`${padding}if (Array.isArray(entity.${entityKey})) {`);ret.push(`${padding}  ret.${dataKey} = [];`);ret.push(`${padding}  entity.${entityKey}.forEach((_, idx_${idx}) => {`);const last=path.pop();ret.push(this.getEmbeddedPropertySnapshot(meta,prop,context,level+2,[...path,`${last}[idx_${idx}]`],`${dataKey}[idx_${idx}]`,true));ret.push(`${padding}  });`);if(this.shouldSerialize(prop,dataKey)){ret.push(`${padding}  ret.${dataKey} = cloneEmbeddable(ret.${dataKey});`);}ret.push(`${padding}}`);return ret.join("\n")}shouldSerialize(prop,dataKey){const contains=(str,re)=>(str.match(re)||[]).length>0;const a=contains(dataKey,/\./g);const b=contains(dataKey,/\[/g);return !!prop.object&&!(a||b)}getEmbeddedPropertySnapshot(meta,prop,context,level,path=[prop.name],dataKey,object=prop.object){const entityKey=path.join(".");dataKey=dataKey!==null&&dataKey!==void 0?dataKey:object?entityKey:prop.name;const padding=" ".repeat(level*2);const cond=`entity.${path.join(".")} != null`;let ret=`${level===1?"":"\n"}${padding}if (${cond}) {\n`;if(object){ret+=`${padding}  ret.${dataKey} = {};\n`;}ret+=meta.props.filter(p=>{var _a;return ((_a=p.embedded)===null||_a===void 0?void 0:_a[0])===prop.name}).map(childProp=>{const childDataKey=prop.object?dataKey+"."+childProp.embedded[1]:childProp.name;if(childProp.reference===enums_1$n.ReferenceType.EMBEDDED){return this.getPropertySnapshot(meta,childProp,context,childDataKey,[...path,childProp.embedded[1]],level+1,prop.object)}const childEntityKey=`${path.join(".")}.${childProp.embedded[1]}`;if(childProp.customType){context.set(`convertToDatabaseValue_${childProp.name}`,val=>childProp.customType.convertToDatabaseValue(val,this.platform));if(["number","string","boolean"].includes(childProp.customType.compareAsType().toLowerCase())){return `${padding}  ret.${childDataKey} = convertToDatabaseValue_${childProp.name}(entity.${childEntityKey});`}return `${padding}  ret.${childDataKey} = clone(convertToDatabaseValue_${childProp.name}(entity.${childEntityKey}));`}return `${padding}  ret.${childDataKey} = clone(entity.${childEntityKey});`}).join("\n")+`\n`;if(this.shouldSerialize(prop,dataKey)){return `${ret+padding}  ret.${dataKey} = cloneEmbeddable(ret.${dataKey});\n${padding}}`}return `${ret}${padding}}`}getPropertySnapshot(meta,prop,context,dataKey,path,level=1,object){let ret=`  if (${this.getPropertyCondition(prop)}) {\n`;if(["number","string","boolean"].includes(prop.type.toLowerCase())){return ret+`    ret.${prop.name} = entity.${prop.name};\n  }\n`}if(prop.reference===enums_1$n.ReferenceType.EMBEDDED){if(prop.array){return this.getEmbeddedArrayPropertySnapshot(meta,prop,context,level,path,dataKey,true)+"\n"}return this.getEmbeddedPropertySnapshot(meta,prop,context,level,path,dataKey,object)+"\n"}if(prop.reference===enums_1$n.ReferenceType.ONE_TO_ONE||prop.reference===enums_1$n.ReferenceType.MANY_TO_ONE){if(prop.mapToPk){ret+=`    ret.${prop.name} = entity.${prop.name};\n`;}else {context.set(`getPrimaryKeyValues_${prop.name}`,val=>val&&Utils_1$8.Utils.getPrimaryKeyValues(val,this.metadata.find(prop.type).primaryKeys,true));ret+=`    ret.${prop.name} = getPrimaryKeyValues_${prop.name}(entity.${prop.name});\n`;}if(prop.customType){context.set(`convertToDatabaseValue_${prop.name}`,val=>prop.customType.convertToDatabaseValue(val,this.platform));if(["number","string","boolean"].includes(prop.customType.compareAsType().toLowerCase())){return ret+`    ret.${prop.name} = convertToDatabaseValue_${prop.name}(ret.${prop.name});\n  }\n`}return ret+`    ret.${prop.name} = clone(convertToDatabaseValue_${prop.name}(ret.${prop.name}));\n  }\n`}return ret+"  }\n"}if(prop.customType){context.set(`convertToDatabaseValue_${prop.name}`,val=>prop.customType.convertToDatabaseValue(val,this.platform));if(["number","string","boolean"].includes(prop.customType.compareAsType().toLowerCase())){return ret+`    ret.${prop.name} = convertToDatabaseValue_${prop.name}(entity.${prop.name});\n  }\n`}return ret+`    ret.${prop.name} = clone(convertToDatabaseValue_${prop.name}(entity.${prop.name}));\n  }\n`}if(prop.type.toLowerCase()==="date"){context.set("processDateProperty",this.platform.processDateProperty.bind(this.platform));return ret+`    ret.${prop.name} = clone(processDateProperty(entity.${prop.name}));\n  }\n`}return ret+`    ret.${prop.name} = clone(entity.${prop.name});\n  }\n`}getEntityComparator(entityName){const exists=this.comparators.get(entityName);if(exists){return exists}const meta=this.metadata.find(entityName);const lines=[];const context=new Map;context.set("compareArrays",Utils_1$8.compareArrays);context.set("compareBuffers",Utils_1$8.compareBuffers);context.set("compareObjects",Utils_1$8.compareObjects);context.set("equals",Utils_1$8.equals);meta.comparableProps.forEach(prop=>{lines.push(this.getPropertyComparator(prop));});const code=`return function(last, current) {\n  const diff = {};\n${lines.join("\n")}\n  return diff;\n}`;const comparator=Utils_1$8.Utils.createFunction(context,code);this.comparators.set(entityName,comparator);return comparator}getGenericComparator(prop,cond){return `  if (current.${prop} == null && last.${prop} == null) {\n\n`+`  } else if ((current.${prop} && last.${prop} == null) || (current.${prop} == null && last.${prop})) {\n`+`    diff.${prop} = current.${prop};\n`+`  } else if (${cond}) {\n`+`    diff.${prop} = current.${prop};\n`+`  }\n`}getPropertyComparator(prop){let type=prop.type.toLowerCase();if(prop.reference!==enums_1$n.ReferenceType.SCALAR&&prop.reference!==enums_1$n.ReferenceType.EMBEDDED){const meta2=this.metadata.find(prop.type);if(meta2.primaryKeys.length>1){type="array";}else {type=meta2.properties[meta2.primaryKeys[0]].type.toLowerCase();}}if(prop.customType){type=prop.customType.compareAsType();}if(["string","number","boolean"].includes(type)){return this.getGenericComparator(prop.name,`last.${prop.name} !== current.${prop.name}`)}if(["array"].includes(type)||type.endsWith("[]")){return this.getGenericComparator(prop.name,`!compareArrays(last.${prop.name}, current.${prop.name})`)}if(["buffer","uint8array"].includes(type)){return this.getGenericComparator(prop.name,`!compareBuffers(last.${prop.name}, current.${prop.name})`)}if(["date"].includes(type)){return this.getGenericComparator(prop.name,`last.${prop.name}.valueOf() !== current.${prop.name}.valueOf()`)}if(["objectid"].includes(type)){const cond=`last.${prop.name}.toHexString() !== current.${prop.name}.toHexString()`;return this.getGenericComparator(prop.name,cond)}return `  if (!equals(last.${prop.name}, current.${prop.name})) diff.${prop.name} = current.${prop.name};`}static isComparable(prop,root){const virtual=prop.persist===false;const inverse=prop.reference===enums_1$n.ReferenceType.ONE_TO_ONE&&!prop.owner;const discriminator=prop.name===root.discriminatorColumn;const collection=prop.reference===enums_1$n.ReferenceType.ONE_TO_MANY||prop.reference===enums_1$n.ReferenceType.MANY_TO_MANY;return !virtual&&!collection&&!inverse&&!discriminator&&!prop.version}}EntityComparator$1.EntityComparator=EntityComparator;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(Configuration$1,exports);__exportStar(ConfigurationLoader$1,exports);__exportStar(Logger$1,exports);__exportStar(Utils,exports);__exportStar(RequestContext$1,exports);__exportStar(TransactionContext$1,exports);__exportStar(QueryHelper$1,exports);__exportStar(NullHighlighter$1,exports);__exportStar(EntityComparator$1,exports);})(utils$m);getDefaultExportFromCjs(utils$m);

Object.defineProperty(typings$1,"__esModule",{value:true});typings$1.PlainObject=typings$1.EntityMetadata=typings$1.PrimaryKeyProp=typings$1.PrimaryKeyType=typings$1.EntityRepositoryType=void 0;const enums_1$m=enums;const utils_1$g=utils$m;typings$1.EntityRepositoryType=Symbol("EntityRepositoryType");typings$1.PrimaryKeyType=Symbol("PrimaryKeyType");typings$1.PrimaryKeyProp=Symbol("PrimaryKeyProp");class EntityMetadata{constructor(meta={}){this.propertyOrder=new Map;this.properties={};this.props=[];this.primaryKeys=[];this.filters={};this.hooks={};this.indexes=[];this.uniques=[];Object.assign(this,meta);}addProperty(prop,sync=true){this.properties[prop.name]=prop;this.propertyOrder.set(prop.name,this.props.length);if(sync){this.sync();}}removeProperty(name,sync=true){delete this.properties[name];this.propertyOrder.delete(name);if(sync){this.sync();}}getPrimaryProps(){return this.primaryKeys.map(pk=>this.properties[pk])}sync(initIndexes=false){var _a;this.root=(_a=this.root)!==null&&_a!==void 0?_a:this;const props=Object.values(this.properties).sort((a,b)=>this.propertyOrder.get(a.name)-this.propertyOrder.get(b.name));this.props=[...props.filter(p=>p.primary),...props.filter(p=>!p.primary)];this.relations=this.props.filter(prop=>prop.reference!==enums_1$m.ReferenceType.SCALAR&&prop.reference!==enums_1$m.ReferenceType.EMBEDDED);this.comparableProps=this.props.filter(prop=>utils_1$g.EntityComparator.isComparable(prop,this.root));this.hydrateProps=this.props.filter(prop=>{const discriminator=this.root.discriminatorColumn===prop.name&&prop.userDefined===false;const onlyGetter=prop.getter&&!prop.setter;return !prop.inherited&&!discriminator&&!prop.embedded&&!onlyGetter});this.selfReferencing=this.relations.some(prop=>[this.className,this.root.className].includes(prop.type));if(initIndexes&&this.name){this.props.forEach(prop=>this.initIndexes(prop));}}initIndexes(prop){const simpleIndex=this.indexes.find(index=>index.properties===prop.name&&!index.options&&!index.type);const simpleUnique=this.uniques.find(index=>index.properties===prop.name&&!index.options);const owner=prop.reference===enums_1$m.ReferenceType.MANY_TO_ONE||prop.reference===enums_1$m.ReferenceType.ONE_TO_ONE&&prop.owner;if(!prop.index&&simpleIndex){utils_1$g.Utils.defaultValue(simpleIndex,"name",true);prop.index=simpleIndex.name;this.indexes.splice(this.indexes.indexOf(simpleIndex),1);}if(!prop.unique&&simpleUnique){utils_1$g.Utils.defaultValue(simpleUnique,"name",true);prop.unique=simpleUnique.name;this.uniques.splice(this.uniques.indexOf(simpleUnique),1);}if(owner&&prop.fieldNames.length>1){this.indexes.push({properties:prop.name});prop.index=false;}if(owner&&prop.fieldNames.length>1&&prop.unique){this.uniques.push({properties:prop.name});prop.unique=false;}}}typings$1.EntityMetadata=EntityMetadata;class PlainObject{}typings$1.PlainObject=PlainObject;

var exceptions = {};

Object.defineProperty(exceptions,"__esModule",{value:true});exceptions.UniqueConstraintViolationException=exceptions.TableNotFoundException=exceptions.TableExistsException=exceptions.SyntaxErrorException=exceptions.ReadOnlyException=exceptions.NotNullConstraintViolationException=exceptions.NonUniqueFieldNameException=exceptions.LockWaitTimeoutException=exceptions.InvalidFieldNameException=exceptions.ForeignKeyConstraintViolationException=exceptions.DeadlockException=exceptions.DatabaseObjectNotFoundException=exceptions.DatabaseObjectExistsException=exceptions.ConstraintViolationException=exceptions.ServerException=exceptions.ConnectionException=exceptions.DriverException=void 0;class DriverException extends Error{constructor(previous){super(previous.message);Object.assign(this,previous);this.name=this.constructor.name;this.stack+="\n\n"+"previous "+previous.stack;}}exceptions.DriverException=DriverException;class ConnectionException extends DriverException{}exceptions.ConnectionException=ConnectionException;class ServerException extends DriverException{}exceptions.ServerException=ServerException;class ConstraintViolationException extends ServerException{}exceptions.ConstraintViolationException=ConstraintViolationException;class DatabaseObjectExistsException extends ServerException{}exceptions.DatabaseObjectExistsException=DatabaseObjectExistsException;class DatabaseObjectNotFoundException extends ServerException{}exceptions.DatabaseObjectNotFoundException=DatabaseObjectNotFoundException;class DeadlockException extends ServerException{}exceptions.DeadlockException=DeadlockException;class ForeignKeyConstraintViolationException extends ConstraintViolationException{}exceptions.ForeignKeyConstraintViolationException=ForeignKeyConstraintViolationException;class InvalidFieldNameException extends ServerException{}exceptions.InvalidFieldNameException=InvalidFieldNameException;class LockWaitTimeoutException extends ServerException{}exceptions.LockWaitTimeoutException=LockWaitTimeoutException;class NonUniqueFieldNameException extends ServerException{}exceptions.NonUniqueFieldNameException=NonUniqueFieldNameException;class NotNullConstraintViolationException extends ConstraintViolationException{}exceptions.NotNullConstraintViolationException=NotNullConstraintViolationException;class ReadOnlyException extends ServerException{}exceptions.ReadOnlyException=ReadOnlyException;class SyntaxErrorException extends ServerException{}exceptions.SyntaxErrorException=SyntaxErrorException;class TableExistsException extends DatabaseObjectExistsException{}exceptions.TableExistsException=TableExistsException;class TableNotFoundException extends DatabaseObjectNotFoundException{}exceptions.TableNotFoundException=TableNotFoundException;class UniqueConstraintViolationException extends ConstraintViolationException{}exceptions.UniqueConstraintViolationException=UniqueConstraintViolationException;

var MikroORM$1 = {};

var metadata = {};

var EntitySchema$1 = {};

var entity = {};

var EntityRepository$1 = {};

Object.defineProperty(EntityRepository$1,"__esModule",{value:true});EntityRepository$1.EntityRepository=void 0;class EntityRepository{constructor(_em,entityName){this._em=_em;this.entityName=entityName;}persist(entity){return this.em.persist(entity)}async persistAndFlush(entity){await this.em.persistAndFlush(entity);}persistLater(entity){this.em.persistLater(entity);}async findOne(where,populate,orderBy){return this.em.findOne(this.entityName,where,populate,orderBy)}async findOneOrFail(where,populate,orderBy){return this.em.findOneOrFail(this.entityName,where,populate,orderBy)}async find(where,populate,orderBy={},limit,offset){return this.em.find(this.entityName,where,populate,orderBy,limit,offset)}async findAndCount(where,populate,orderBy={},limit,offset){return this.em.findAndCount(this.entityName,where,populate,orderBy,limit,offset)}async findAll(populate,orderBy,limit,offset){return this.em.find(this.entityName,{},populate,orderBy,limit,offset)}remove(entity){return this.em.remove(entity)}async removeAndFlush(entity){await this.em.removeAndFlush(entity);}removeLater(entity){this.em.removeLater(entity);}async flush(){return this.em.flush()}async nativeInsert(data){return this.em.nativeInsert(this.entityName,data)}async nativeUpdate(where,data,options){return this.em.nativeUpdate(this.entityName,where,data,options)}async nativeDelete(where,options){return this.em.nativeDelete(this.entityName,where,options)}map(result){return this.em.map(this.entityName,result)}getReference(id,wrapped=false){return this.em.getReference(this.entityName,id,wrapped)}canPopulate(property){return this.em.canPopulate(this.entityName,property)}async populate(entities,populate,where={},orderBy={},refresh=false,validate=true){return this.em.populate(entities,populate,where,orderBy,refresh,validate)}create(data){return this.em.create(this.entityName,data)}assign(entity,data){return this.em.assign(entity,data)}merge(data,refresh,convertCustomTypes){return this.em.merge(this.entityName,data,refresh,convertCustomTypes)}async count(where={},options={}){return this.em.count(this.entityName,where,options)}get em(){return this._em.getContext()}}EntityRepository$1.EntityRepository=EntityRepository;

var EntityIdentifier$1 = {};

Object.defineProperty(EntityIdentifier$1,"__esModule",{value:true});EntityIdentifier$1.EntityIdentifier=void 0;class EntityIdentifier{constructor(value){this.value=value;}setValue(value){this.value=value;}getValue(){return this.value}}EntityIdentifier$1.EntityIdentifier=EntityIdentifier;

var EntityFactory$1 = {};

Object.defineProperty(EntityFactory$1,"__esModule",{value:true});EntityFactory$1.EntityFactory=void 0;const Utils_1$7=Utils;const enums_1$l=enums;class EntityFactory{constructor(unitOfWork,em){this.unitOfWork=unitOfWork;this.em=em;this.driver=this.em.getDriver();this.platform=this.driver.getPlatform();this.config=this.em.config;this.metadata=this.em.getMetadata();this.hydrator=this.config.getHydrator(this.metadata);this.eventManager=this.em.getEventManager();}create(entityName,data,options={}){var _a;options.initialized=(_a=options.initialized)!==null&&_a!==void 0?_a:true;if(data.__entity){return data}entityName=Utils_1$7.Utils.className(entityName);const meta=this.metadata.get(entityName);if(this.platform.usesDifferentSerializedPrimaryKey()){meta.primaryKeys.forEach(pk=>this.denormalizePrimaryKey(data,pk,meta.properties[pk]));}const meta2=this.processDiscriminatorColumn(meta,data);const exists=this.findEntity(data,meta2,options.convertCustomTypes);if(exists&&exists.__helper.__initialized&&!options.refresh){return exists}data=Object.assign({},data);const entity=exists!==null&&exists!==void 0?exists:this.createEntity(data,meta2,options);entity.__helper.__initialized=options.initialized;this.hydrate(entity,meta2,data,options);if(options.merge&&entity.__helper.hasPrimaryKey()){this.unitOfWork.registerManaged(entity,data,options.refresh&&options.initialized,options.newEntity);}if(this.eventManager.hasListeners(enums_1$l.EventType.onInit,meta2)){this.eventManager.dispatchEvent(enums_1$l.EventType.onInit,{entity,em:this.em});}return entity}createReference(entityName,id,options={}){var _a;options.convertCustomTypes=(_a=options.convertCustomTypes)!==null&&_a!==void 0?_a:true;entityName=Utils_1$7.Utils.className(entityName);const meta=this.metadata.get(entityName);if(Array.isArray(id)){id=Utils_1$7.Utils.getPrimaryKeyCondFromArray(id,meta.primaryKeys);}const pks=Utils_1$7.Utils.getOrderedPrimaryKeys(id,meta,this.platform,options.convertCustomTypes);if(Utils_1$7.Utils.isPrimaryKey(id)){id={[meta.primaryKeys[0]]:id};}const exists=this.unitOfWork.getById(entityName,pks);if(exists){return exists}return this.create(entityName,id,Object.assign(Object.assign({},options),{initialized:false}))}createEntity(data,meta,options){if(options.newEntity||meta.forceConstructor){const params=this.extractConstructorParams(meta,data);const Entity=meta.class;meta.constructorParams.forEach(prop=>delete data[prop]);return new Entity(...params)}const entity=Object.create(meta.class.prototype);entity.__helper.__managed=true;if(meta.selfReferencing&&!options.newEntity){this.hydrator.hydrateReference(entity,meta,data,this,options.convertCustomTypes);this.unitOfWork.registerManaged(entity);}return entity}hydrate(entity,meta,data,options){if(options.initialized){this.hydrator.hydrate(entity,meta,data,this,"full",options.newEntity,options.convertCustomTypes);}else {this.hydrator.hydrateReference(entity,meta,data,this,options.convertCustomTypes);}}findEntity(data,meta,convertCustomTypes){if(!meta.compositePK&&!meta.properties[meta.primaryKeys[0]].customType){return this.unitOfWork.getById(meta.name,data[meta.primaryKeys[0]])}if(meta.primaryKeys.some(pk=>!Utils_1$7.Utils.isDefined(data[pk],true))){return undefined}const pks=Utils_1$7.Utils.getOrderedPrimaryKeys(data,meta,this.platform,convertCustomTypes);return this.unitOfWork.getById(meta.name,pks)}processDiscriminatorColumn(meta,data){if(!meta.root.discriminatorColumn){return meta}const prop=meta.properties[meta.root.discriminatorColumn];const value=data[prop.name];const type=meta.root.discriminatorMap[value];meta=type?this.metadata.find(type):meta;if(prop.userDefined===false){delete data[prop.name];}return meta}denormalizePrimaryKey(data,primaryKey,prop){const pk=this.platform.getSerializedPrimaryKeyField(primaryKey);if(Utils_1$7.Utils.isDefined(data[pk],true)||Utils_1$7.Utils.isDefined(data[primaryKey],true)){let id=data[pk]||data[primaryKey];if(prop.type.toLowerCase()==="objectid"){id=this.platform.denormalizePrimaryKey(id);}delete data[pk];data[primaryKey]=id;}}extractConstructorParams(meta,data){return meta.constructorParams.map(k=>{if(meta.properties[k]&&[enums_1$l.ReferenceType.MANY_TO_ONE,enums_1$l.ReferenceType.ONE_TO_ONE].includes(meta.properties[k].reference)&&data[k]){const entity=this.unitOfWork.getById(meta.properties[k].type,data[k]);if(entity){return entity}if(Utils_1$7.Utils.isEntity(data[k])){return data[k]}return this.createReference(meta.properties[k].type,data[k])}if(!meta.properties[k]){return data}return data[k]})}}EntityFactory$1.EntityFactory=EntityFactory;

var EntityLoader$1 = {};

Object.defineProperty(EntityLoader$1,"__esModule",{value:true});EntityLoader$1.EntityLoader=void 0;const QueryHelper_1=QueryHelper$1;const Utils_1$6=Utils;const errors_1$6=errors;const enums_1$k=enums;const Reference_1$1=Reference$1;class EntityLoader{constructor(em){this.em=em;this.metadata=this.em.getMetadata();this.driver=this.em.getDriver();}async populate(entityName,entities,populate,options){var _a,_b,_c,_d,_e,_f,_g;if(entities.length===0||populate===false){return}options.where=(_a=options.where)!==null&&_a!==void 0?_a:{};options.orderBy=(_b=options.orderBy)!==null&&_b!==void 0?_b:{};options.filters=(_c=options.filters)!==null&&_c!==void 0?_c:{};options.lookup=(_d=options.lookup)!==null&&_d!==void 0?_d:true;options.validate=(_e=options.validate)!==null&&_e!==void 0?_e:true;options.refresh=(_f=options.refresh)!==null&&_f!==void 0?_f:false;options.convertCustomTypes=(_g=options.convertCustomTypes)!==null&&_g!==void 0?_g:true;populate=this.normalizePopulate(entityName,populate,options.lookup);const invalid=populate.find(({field})=>!this.em.canPopulate(entityName,field));if(options.validate&&invalid){throw errors_1$6.ValidationError.invalidPropertyName(entityName,invalid.field)}entities.forEach(e=>{var _a;return e.__helper.__serializationContext.populate=(_a=e.__helper.__serializationContext.populate)!==null&&_a!==void 0?_a:populate});for(const pop of populate){await this.populateField(entityName,entities,pop,options);}}normalizePopulate(entityName,populate,lookup=true){if(populate===true||populate.some(p=>p.all)){populate=this.lookupAllRelationships(entityName);}else {populate=Utils_1$6.Utils.asArray(populate);}if(lookup){populate=this.lookupEagerLoadedRelationships(entityName,populate);}populate.forEach(p=>{if(!p.field.includes(".")){return}const[f,...parts]=p.field.split(".");p.field=f;p.children=p.children||[];const prop=this.metadata.find(entityName).properties[f];p.children.push(this.expandNestedPopulate(prop.type,parts,p.strategy));});return this.mergeNestedPopulate(populate)}mergeNestedPopulate(populate){const tmp=populate.reduce((ret,item)=>{if(!ret[item.field]){ret[item.field]=item;return ret}if(!ret[item.field].children&&item.children){ret[item.field].children=item.children;}else if(ret[item.field].children&&item.children){ret[item.field].children.push(...item.children);}return ret},{});return Object.values(tmp).map(item=>{if(item.children){item.children=this.mergeNestedPopulate(item.children);}return item})}expandNestedPopulate(entityName,parts,strategy){const meta=this.metadata.find(entityName);const field=parts.shift();const prop=meta.properties[field];const ret={field,strategy};if(parts.length>0){ret.children=[this.expandNestedPopulate(prop.type,parts,strategy)];}return ret}async populateMany(entityName,entities,populate,options){const field=populate.field;const meta=this.metadata.find(entityName);const prop=meta.properties[field];if(prop.reference===enums_1$k.ReferenceType.SCALAR&&prop.lazy){return []}entities.forEach(entity=>{const value=entity[field];if(Utils_1$6.Utils.isEntity(value,true)){value.__helper.populated();}else if(Utils_1$6.Utils.isCollection(value)){value.populated();}});const filtered=this.filterCollections(entities,field,options.refresh);const innerOrderBy=Utils_1$6.Utils.isObject(options.orderBy[prop.name])?options.orderBy[prop.name]:undefined;if(prop.reference===enums_1$k.ReferenceType.MANY_TO_MANY&&this.driver.getPlatform().usesPivotTable()){return this.findChildrenFromPivotTable(filtered,prop,options,innerOrderBy,populate)}const where=await this.extractChildCondition(options,prop);const data=await this.findChildren(entities,prop,populate,Object.assign(Object.assign({},options),{where,orderBy:innerOrderBy}));this.initializeCollections(filtered,prop,field,data);return data}initializeCollections(filtered,prop,field,children){if(prop.reference===enums_1$k.ReferenceType.ONE_TO_MANY){this.initializeOneToMany(filtered,children,prop,field);}if(prop.reference===enums_1$k.ReferenceType.MANY_TO_MANY&&!prop.owner&&!this.driver.getPlatform().usesPivotTable()){this.initializeManyToMany(filtered,children,prop,field);}}initializeOneToMany(filtered,children,prop,field){for(const entity of filtered){const items=children.filter(child=>{if(prop.targetMeta.properties[prop.mappedBy].mapToPk){return child[prop.mappedBy]===entity.__helper.getPrimaryKey()}return Reference_1$1.Reference.unwrapReference(child[prop.mappedBy])===entity});entity[field].hydrate(items);}}initializeManyToMany(filtered,children,prop,field){for(const entity of filtered){const items=children.filter(child=>child[prop.mappedBy].contains(entity));entity[field].hydrate(items);}}async findChildren(entities,prop,populate,options){const children=this.getChildReferences(entities,prop,options.refresh);const meta=this.metadata.find(prop.type);let fk=Utils_1$6.Utils.getPrimaryKeyHash(meta.primaryKeys);if(prop.reference===enums_1$k.ReferenceType.ONE_TO_MANY||prop.reference===enums_1$k.ReferenceType.MANY_TO_MANY&&!prop.owner){fk=meta.properties[prop.mappedBy].name;}if(prop.reference===enums_1$k.ReferenceType.ONE_TO_ONE&&!prop.owner&&populate.strategy!==enums_1$k.LoadStrategy.JOINED&&!this.em.config.get("autoJoinOneToOneOwner")){children.length=0;children.push(...entities);fk=meta.properties[prop.mappedBy].name;}if(children.length===0){return []}const ids=Utils_1$6.Utils.unique(children.map(e=>Utils_1$6.Utils.getPrimaryKeyValues(e,e.__meta.primaryKeys,true)));const where=Object.assign(Object.assign({},QueryHelper_1.QueryHelper.processWhere({[fk]:{$in:ids}},meta.name,this.metadata,this.driver.getPlatform(),!options.convertCustomTypes)),options.where);const fields=this.buildFields(prop,options);return this.em.find(prop.type,where,{orderBy:options.orderBy||prop.orderBy||{[fk]:enums_1$k.QueryOrder.ASC},refresh:options.refresh,filters:options.filters,convertCustomTypes:options.convertCustomTypes,populate:populate.children,fields:fields.length>0?fields:undefined})}async populateField(entityName,entities,populate,options){if(!populate.children){return void(await this.populateMany(entityName,entities,populate,options))}await this.populateMany(entityName,entities,populate,options);const children=[];for(const entity of entities){if(Utils_1$6.Utils.isEntity(entity[populate.field])){children.push(entity[populate.field]);}else if(Reference_1$1.Reference.isReference(entity[populate.field])){children.push(entity[populate.field].unwrap());}else if(Utils_1$6.Utils.isCollection(entity[populate.field])){children.push(...entity[populate.field].getItems());}}const filtered=Utils_1$6.Utils.unique(children);const prop=this.metadata.find(entityName).properties[populate.field];const fields=this.buildFields(prop,options);await this.populate(prop.type,filtered,populate.children,{where:await this.extractChildCondition(options,prop,false),orderBy:options.orderBy[prop.name],refresh:options.refresh,fields:fields.length>0?fields:undefined,filters:options.filters,validate:false,lookup:false});}async findChildrenFromPivotTable(filtered,prop,options,orderBy,populate){var _a;const ids=filtered.map(e=>e.__helper.__primaryKeys);const refresh=options.refresh;const where=await this.extractChildCondition(options,prop,true);const fields=this.buildFields(prop,options);const options2=Object.assign({},options);delete options2.limit;delete options2.offset;options2.fields=fields.length>0?fields:undefined;options2.populate=(_a=populate===null||populate===void 0?void 0:populate.children)!==null&&_a!==void 0?_a:[];if(prop.customType){ids.forEach((id,idx)=>ids[idx]=QueryHelper_1.QueryHelper.processCustomType(prop,id,this.driver.getPlatform()));}const map=await this.driver.loadFromPivotTable(prop,ids,where,orderBy,this.em.getTransactionContext(),options2);const children=[];for(const entity of filtered){const items=map[entity.__helper.getSerializedPrimaryKey()].map(item=>{const entity=this.em.getEntityFactory().create(prop.type,item,{refresh,merge:true,convertCustomTypes:true});return this.em.getUnitOfWork().registerManaged(entity,item,refresh)});entity[prop.name].hydrate(items);children.push(...items);}return children}async extractChildCondition(options,prop,filters=false){var _a;const subCond=Utils_1$6.Utils.isPlainObject(options.where[prop.name])?options.where[prop.name]:{};const meta2=this.metadata.find(prop.type);const pk=Utils_1$6.Utils.getPrimaryKeyHash(meta2.primaryKeys);["$and","$or"].forEach(op=>{if(options.where[op]){const child=options.where[op].map(cond=>cond[prop.name]).filter(sub=>sub!=null&&!(Utils_1$6.Utils.isPlainObject(sub)&&Object.keys(sub).every(key=>Utils_1$6.Utils.isOperator(key,false)))).map(cond=>{if(Utils_1$6.Utils.isPrimaryKey(cond)){return {[pk]:cond}}return cond});if(child.length>0){subCond[op]=child;}}});const operators=Object.keys(subCond).filter(key=>Utils_1$6.Utils.isOperator(key,false));if(operators.length>0){operators.forEach(op=>{var _a;subCond[pk]=(_a=subCond[pk])!==null&&_a!==void 0?_a:{};subCond[pk][op]=subCond[op];delete subCond[op];});}if(filters){return this.em.applyFilters(prop.type,subCond,(_a=options.filters)!==null&&_a!==void 0?_a:{},"read")}return subCond}buildFields(prop,options){return (options.fields||[]).reduce((ret,f)=>{if(Utils_1$6.Utils.isPlainObject(f)){Object.keys(f).filter(ff=>ff===prop.name).forEach(ff=>ret.push(...f[ff]));}else if(f.toString().includes(".")){const parts=f.toString().split(".");const propName=parts.shift();const childPropName=parts.join(".");if(propName===prop.name){ret.push(childPropName);}}return ret},[])}getChildReferences(entities,prop,refresh){const filtered=this.filterCollections(entities,prop.name,refresh);const children=[];if(prop.reference===enums_1$k.ReferenceType.ONE_TO_MANY){children.push(...filtered.map(e=>e[prop.name].owner));}else if(prop.reference===enums_1$k.ReferenceType.MANY_TO_MANY&&prop.owner){children.push(...filtered.reduce((a,b)=>[...a,...b[prop.name].getItems()],[]));}else if(prop.reference===enums_1$k.ReferenceType.MANY_TO_MANY){children.push(...filtered);}else {children.push(...this.filterReferences(entities,prop.name,refresh));}return children}filterCollections(entities,field,refresh){if(refresh){return entities.filter(e=>e[field])}return entities.filter(e=>Utils_1$6.Utils.isCollection(e[field])&&!e[field].isInitialized(true))}filterReferences(entities,field,refresh){const children=entities.filter(e=>Utils_1$6.Utils.isEntity(e[field],true));if(refresh){return children.map(e=>Reference_1$1.Reference.unwrapReference(e[field]))}return children.filter(e=>!e[field].__helper.__initialized).map(e=>Reference_1$1.Reference.unwrapReference(e[field]))}lookupAllRelationships(entityName,prefix="",visited=[]){if(visited.includes(entityName)){return []}visited.push(entityName);const ret=[];const meta=this.metadata.find(entityName);meta.relations.forEach(prop=>{const prefixed=prefix?`${prefix}.${prop.name}`:prop.name;const nested=this.lookupAllRelationships(prop.type,prefixed,visited);if(nested.length>0){ret.push(...nested);}else {ret.push({field:prefixed,strategy:this.em.config.get("loadStrategy")});}});return ret}lookupEagerLoadedRelationships(entityName,populate,prefix="",visited=[]){if(visited.includes(entityName)){return []}visited.push(entityName);const meta=this.metadata.find(entityName);const ret=prefix===""?[...populate]:[];meta.relations.filter(prop=>prop.eager||populate.some(p=>p.field===prop.name)).forEach(prop=>{var _a,_b,_c;const prefixed=prefix?`${prefix}.${prop.name}`:prop.name;const nestedPopulate=(_b=(_a=populate.find(p=>p.field===prop.name))===null||_a===void 0?void 0:_a.children)!==null&&_b!==void 0?_b:[];const nested=this.lookupEagerLoadedRelationships(prop.type,nestedPopulate,prefixed,visited);if(nested.length>0){ret.push(...nested);}else {ret.push({field:prefixed,strategy:(_c=prop.strategy)!==null&&_c!==void 0?_c:this.em.config.get("loadStrategy")});}});return ret}}EntityLoader$1.EntityLoader=EntityLoader;

var BaseEntity$1 = {};

Object.defineProperty(BaseEntity$1,"__esModule",{value:true});BaseEntity$1.BaseEntity=void 0;const Reference_1=Reference$1;const EntityAssigner_1=EntityAssigner$1;class BaseEntity{constructor(){Object.defineProperty(this,"__baseEntity",{value:true});}isInitialized(){return this.__helper.__initialized}populated(populated=true){this.__helper.populated(populated);}toReference(){return Reference_1.Reference.create(this)}toObject(ignoreFields=[]){return this.__helper.toObject(ignoreFields)}toJSON(...args){return this.toObject(...args)}toPOJO(){return this.__helper.toPOJO()}assign(data,options){return EntityAssigner_1.EntityAssigner.assign(this,data,options)}init(populated=true){return this.__helper.init(populated)}}BaseEntity$1.BaseEntity=BaseEntity;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(EntityRepository$1,exports);__exportStar(EntityIdentifier$1,exports);__exportStar(EntityValidator$1,exports);__exportStar(EntityAssigner$1,exports);__exportStar(EntityTransformer$1,exports);__exportStar(EntityHelper$1,exports);__exportStar(EntityFactory$1,exports);__exportStar(ArrayCollection$1,exports);__exportStar(Collection$1,exports);__exportStar(EntityLoader$1,exports);__exportStar(Reference$1,exports);__exportStar(BaseEntity$1,exports);__exportStar(WrappedEntity$1,exports);__exportStar(wrap$1,exports);})(entity);getDefaultExportFromCjs(entity);

Object.defineProperty(EntitySchema$1,"__esModule",{value:true});EntitySchema$1.EntitySchema=void 0;const typings_1$1=typings$1;const entity_1$4=entity;const enums_1$j=enums;const types_1$1=types;const utils_1$f=utils$m;const EnumArrayType_1=EnumArrayType$1;class EntitySchema{constructor(meta){var _a;this._meta=new typings_1$1.EntityMetadata;this.internal=false;this.initialized=false;meta.name=meta.class?meta.class.name:meta.name;if(meta.tableName||meta.collection){utils_1$f.Utils.renameKey(meta,"tableName","collection");meta.tableName=meta.collection;}Object.assign(this._meta,{className:meta.name},meta);this._meta.root=(_a=this._meta.root)!==null&&_a!==void 0?_a:this._meta;}static fromMetadata(meta){const schema=new EntitySchema(meta);schema.internal=true;return schema}addProperty(name,type,options={}){const rename=(data,from,to)=>{if(options[from]&&!options[to]){options[to]=[options[from]];delete options[from];}};if(name!==options.name){utils_1$f.Utils.renameKey(options,"name","fieldName");}rename(options,"fieldName","fieldNames");rename(options,"joinColumn","joinColumns");rename(options,"inverseJoinColumn","inverseJoinColumns");rename(options,"referenceColumnName","referencedColumnNames");rename(options,"columnType","columnTypes");const prop=Object.assign(Object.assign({name,reference:enums_1$j.ReferenceType.SCALAR},options),{type:this.normalizeType(options,type)});if(type&&types_1$1.Type.isPrototypeOf(type)){prop.type=type;}if(utils_1$f.Utils.isString(prop.formula)){const formula=prop.formula;prop.formula=()=>formula;}this._meta.properties[name]=prop;}addEnum(name,type,options={}){if(options.items instanceof Function){options.items=utils_1$f.Utils.extractEnumValues(options.items());}if(options.array&&!options.customType){options.customType=new EnumArrayType_1.EnumArrayType(`${this._meta.className}.${name}`,options.items);options.enum=false;}const prop=Object.assign({enum:true},options);if(prop.array){prop.enum=false;}this.addProperty(name,this.internal?type:type||"enum",prop);}addVersion(name,type,options={}){this.addProperty(name,type,Object.assign({version:true},options));}addPrimaryKey(name,type,options={}){this.addProperty(name,type,Object.assign({primary:true},options));}addSerializedPrimaryKey(name,type,options={}){this._meta.serializedPrimaryKey=name;this.addProperty(name,type,options);}addEmbedded(name,options){utils_1$f.Utils.defaultValue(options,"prefix",true);if(options.array){options.object=true;}this._meta.properties[name]=Object.assign({name,type:this.normalizeType(options),reference:enums_1$j.ReferenceType.EMBEDDED},options);}addManyToOne(name,type,options){const prop=this.createProperty(enums_1$j.ReferenceType.MANY_TO_ONE,options);utils_1$f.Utils.defaultValue(prop,"nullable",prop.cascade.includes(enums_1$j.Cascade.REMOVE)||prop.cascade.includes(enums_1$j.Cascade.ALL));if(prop.joinColumns&&!prop.fieldNames){prop.fieldNames=prop.joinColumns;}if(prop.fieldNames&&!prop.joinColumns){prop.joinColumns=prop.fieldNames;}this.addProperty(name,type,prop);}addManyToMany(name,type,options){options.fixedOrder=options.fixedOrder||!!options.fixedOrderColumn;if(!options.owner&&!options.mappedBy){options.owner=true;}if(options.owner){utils_1$f.Utils.renameKey(options,"mappedBy","inversedBy");}const prop=this.createProperty(enums_1$j.ReferenceType.MANY_TO_MANY,options);this.addProperty(name,type,prop);}addOneToMany(name,type,options){const prop=this.createProperty(enums_1$j.ReferenceType.ONE_TO_MANY,options);this.addProperty(name,type,prop);}addOneToOne(name,type,options){const prop=this.createProperty(enums_1$j.ReferenceType.ONE_TO_ONE,options);utils_1$f.Utils.defaultValue(prop,"nullable",prop.cascade.includes(enums_1$j.Cascade.REMOVE)||prop.cascade.includes(enums_1$j.Cascade.ALL));utils_1$f.Utils.defaultValue(prop,"owner",!!prop.inversedBy||!prop.mappedBy);utils_1$f.Utils.defaultValue(prop,"unique",prop.owner);if(prop.owner&&options.mappedBy){utils_1$f.Utils.renameKey(prop,"mappedBy","inversedBy");}if(prop.joinColumns&&!prop.fieldNames){prop.fieldNames=prop.joinColumns;}if(prop.fieldNames&&!prop.joinColumns){prop.joinColumns=prop.fieldNames;}this.addProperty(name,type,prop);}addIndex(options){this._meta.indexes.push(options);}addUnique(options){this._meta.uniques.push(options);}setCustomRepository(repository){this._meta.customRepository=repository;}setExtends(base){this._meta.extends=base;}setClass(proto){this._meta.class=proto;this._meta.prototype=proto.prototype;this._meta.className=proto.name;this._meta.constructorParams=utils_1$f.Utils.getParamNames(proto,"constructor");this._meta.toJsonParams=utils_1$f.Utils.getParamNames(proto,"toJSON").filter(p=>p!=="...args");if(Object.getPrototypeOf(proto)!==entity_1$4.BaseEntity){this._meta.extends=this._meta.extends||Object.getPrototypeOf(proto).name||undefined;}}get meta(){return this._meta}get name(){return this._meta.name}init(){if(this.initialized){return this}if(!this._meta.class){const name=this.name;this._meta.class={[name]:class{}}[name];}this.setClass(this._meta.class);if(this._meta.abstract&&!this._meta.discriminatorColumn){delete this._meta.name;}this.initProperties();this.initPrimaryKeys();this._meta.props=Object.values(this._meta.properties);this._meta.relations=this._meta.props.filter(prop=>prop.reference!==enums_1$j.ReferenceType.SCALAR&&prop.reference!==enums_1$j.ReferenceType.EMBEDDED);this.initialized=true;return this}initProperties(){Object.entries(this._meta.properties).forEach(([name,options])=>{options.type="customType"in options?options.customType.constructor.name:options.type;switch(options.reference){case enums_1$j.ReferenceType.ONE_TO_ONE:this.addOneToOne(name,options.type,options);break;case enums_1$j.ReferenceType.ONE_TO_MANY:this.addOneToMany(name,options.type,options);break;case enums_1$j.ReferenceType.MANY_TO_ONE:this.addManyToOne(name,options.type,options);break;case enums_1$j.ReferenceType.MANY_TO_MANY:this.addManyToMany(name,options.type,options);break;case enums_1$j.ReferenceType.EMBEDDED:this.addEmbedded(name,options);break;default:if(options.enum){this.addEnum(name,options.type,options);}else if(options.primary){this.addPrimaryKey(name,options.type,options);}else if(options.serializedPrimaryKey){this.addSerializedPrimaryKey(name,options.type,options);}else if(options.version){this.addVersion(name,options.type,options);}else {this.addProperty(name,options.type,options);}}});}initPrimaryKeys(){const pks=Object.values(this._meta.properties).filter(prop=>prop.primary);if(pks.length>0){this._meta.primaryKeys=pks.map(prop=>prop.name);this._meta.compositePK=pks.length>1;}if(pks.length===1&&pks[0].reference!==enums_1$j.ReferenceType.SCALAR){pks[0].onDelete="cascade";}const serializedPrimaryKey=Object.values(this._meta.properties).find(prop=>prop.serializedPrimaryKey);if(serializedPrimaryKey){this._meta.serializedPrimaryKey=serializedPrimaryKey.name;}}normalizeType(options,type){if("entity"in options){if(utils_1$f.Utils.isString(options.entity)){type=options.type=options.entity;}else if(options.entity){type=options.type=utils_1$f.Utils.className(options.entity());}}if(type instanceof Function){type=type.name;}if(["String","Number","Boolean","Array"].includes(type)){type=type.toLowerCase();}return type}createProperty(reference,options){return Object.assign({reference,cascade:[enums_1$j.Cascade.PERSIST]},options)}}EntitySchema$1.EntitySchema=EntitySchema;

var MetadataDiscovery$1 = {};

var MetadataValidator$1 = {};

Object.defineProperty(MetadataValidator$1,"__esModule",{value:true});MetadataValidator$1.MetadataValidator=void 0;const utils_1$e=utils$m;const errors_1$5=errors;const enums_1$i=enums;class MetadataValidator{static validateSingleDecorator(meta,propertyName,reference){if(meta.properties[propertyName]&&meta.properties[propertyName].reference!==reference){throw errors_1$5.MetadataError.multipleDecorators(meta.className,propertyName)}}validateEntityDefinition(metadata,name){var _a,_b;const meta=metadata.get(name);if(!meta.embeddable&&(!meta.primaryKeys||meta.primaryKeys.length===0)){throw errors_1$5.MetadataError.fromMissingPrimaryKey(meta)}this.validateVersionField(meta);this.validateIndexes(meta,(_a=meta.indexes)!==null&&_a!==void 0?_a:[],"index");this.validateIndexes(meta,(_b=meta.uniques)!==null&&_b!==void 0?_b:[],"unique");const references=Object.values(meta.properties).filter(prop=>prop.reference!==enums_1$i.ReferenceType.SCALAR);for(const prop of references){this.validateReference(meta,prop,metadata);this.validateBidirectional(meta,prop,metadata);}}validateDiscovered(discovered,warnWhenNoEntities){if(discovered.length===0&&warnWhenNoEntities){throw errors_1$5.MetadataError.noEntityDiscovered()}const duplicates=utils_1$e.Utils.findDuplicates(discovered.map(meta=>meta.className));if(duplicates.length>0){throw errors_1$5.MetadataError.duplicateEntityDiscovered(duplicates)}if(discovered.filter(meta=>meta.name).length===0&&warnWhenNoEntities){throw errors_1$5.MetadataError.onlyAbstractEntitiesDiscovered()}discovered.forEach(meta=>Object.values(meta.properties).forEach(prop=>{if(prop.reference!==enums_1$i.ReferenceType.SCALAR&&!discovered.find(m=>m.className===prop.type)){throw errors_1$5.MetadataError.fromUnknownEntity(prop.type,`${meta.className}.${prop.name}`)}}));}validateReference(meta,prop,metadata){if(!prop.type){throw errors_1$5.MetadataError.fromWrongTypeDefinition(meta,prop)}if(!metadata.find(prop.type)){throw errors_1$5.MetadataError.fromWrongTypeDefinition(meta,prop)}}validateBidirectional(meta,prop,metadata){if(prop.inversedBy){const inverse=metadata.get(prop.type).properties[prop.inversedBy];this.validateOwningSide(meta,prop,inverse,metadata);}else if(prop.mappedBy){const inverse=metadata.get(prop.type).properties[prop.mappedBy];this.validateInverseSide(meta,prop,inverse,metadata);}}validateOwningSide(meta,prop,inverse,metadata){var _a;if(!inverse){throw errors_1$5.MetadataError.fromWrongReference(meta,prop,"inversedBy")}const targetClassName=(_a=metadata.find(inverse.type))===null||_a===void 0?void 0:_a.root.className;if(inverse.type!==meta.className&&targetClassName!==meta.root.className){throw errors_1$5.MetadataError.fromWrongReference(meta,prop,"inversedBy",inverse)}if(inverse.inversedBy){throw errors_1$5.MetadataError.fromWrongOwnership(meta,prop,"inversedBy")}}validateInverseSide(meta,prop,owner,metadata){var _a;if(prop.mappedBy&&!owner){throw errors_1$5.MetadataError.fromWrongReference(meta,prop,"mappedBy")}if(owner.type!==meta.className&&((_a=metadata.find(owner.type))===null||_a===void 0?void 0:_a.root.className)!==meta.root.className){throw errors_1$5.MetadataError.fromWrongReference(meta,prop,"mappedBy",owner)}if(owner.mappedBy){throw errors_1$5.MetadataError.fromWrongOwnership(meta,prop,"mappedBy")}const valid=[{owner:enums_1$i.ReferenceType.MANY_TO_ONE,inverse:enums_1$i.ReferenceType.ONE_TO_MANY},{owner:enums_1$i.ReferenceType.MANY_TO_MANY,inverse:enums_1$i.ReferenceType.MANY_TO_MANY},{owner:enums_1$i.ReferenceType.ONE_TO_ONE,inverse:enums_1$i.ReferenceType.ONE_TO_ONE}];if(!valid.find(spec=>spec.owner===owner.reference&&spec.inverse===prop.reference)){throw errors_1$5.MetadataError.fromWrongReferenceType(meta,owner,prop)}}validateIndexes(meta,indexes,type){for(const index of indexes){for(const prop of utils_1$e.Utils.asArray(index.properties)){if(!(prop in meta.properties)){throw errors_1$5.MetadataError.unknownIndexProperty(meta,prop,type)}}}}validateVersionField(meta){if(!meta.versionProperty){return}const props=Object.values(meta.properties).filter(p=>p.version);if(props.length>1){throw errors_1$5.MetadataError.multipleVersionFields(meta,props.map(p=>p.name))}const prop=meta.properties[meta.versionProperty];const type=prop.type.toLowerCase();if(type!=="number"&&type!=="date"&&!type.startsWith("timestamp")&&!type.startsWith("datetime")){throw errors_1$5.MetadataError.invalidVersionFieldType(meta)}}}MetadataValidator$1.MetadataValidator=MetadataValidator;

var __importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(MetadataDiscovery$1,"__esModule",{value:true});MetadataDiscovery$1.MetadataDiscovery=void 0;const path_1=require$$0__default$1["default"];const globby_1=__importDefault$2(globby$1.exports);const ansi_colors_1$2=__importDefault$2(ansiColors.exports);const typings_1=typings$1;const Utils_1$5=Utils;const MetadataValidator_1=MetadataValidator$1;const MetadataStorage_1=MetadataStorage$1;const EntitySchema_1=EntitySchema$1;const enums_1$h=enums;const errors_1$4=errors;const types_1=types;class MetadataDiscovery{constructor(metadata,platform,config){this.metadata=metadata;this.platform=platform;this.config=config;this.namingStrategy=this.config.getNamingStrategy();this.metadataProvider=this.config.getMetadataProvider();this.cache=this.config.getCacheAdapter();this.logger=this.config.getLogger();this.schemaHelper=this.platform.getSchemaHelper();this.validator=new MetadataValidator_1.MetadataValidator;this.discovered=[];}async discover(preferTsNode=true){const startTime=Date.now();this.logger.log("discovery",`ORM entity discovery started, using ${ansi_colors_1$2.default.cyan(this.metadataProvider.constructor.name)}`);await this.findEntities(preferTsNode);for(const meta of this.discovered){let i=1;Object.values(meta.properties).forEach(prop=>meta.propertyOrder.set(prop.name,i++));}const filtered=this.discovered.filter(meta=>meta.name);filtered.forEach(meta=>this.initSingleTableInheritance(meta,filtered));filtered.forEach(meta=>this.defineBaseEntityProperties(meta));filtered.forEach(meta=>this.metadata.set(meta.className,EntitySchema_1.EntitySchema.fromMetadata(meta).init().meta));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initEmbeddables(meta,prop)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initFactoryField(prop)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initFieldName(prop)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initVersionProperty(meta,prop)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initCustomType(meta,prop)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initColumnType(prop,meta.path)));filtered.forEach(meta=>Object.values(meta.properties).forEach(prop=>this.initUnsigned(prop)));filtered.forEach(meta=>this.autoWireBidirectionalProperties(meta));filtered.forEach(meta=>this.discovered.push(...this.processEntity(meta)));this.discovered.forEach(meta=>meta.sync(true));const diff=Date.now()-startTime;this.logger.log("discovery",`- entity discovery finished, found ${ansi_colors_1$2.default.green(""+this.discovered.length)} entities, took ${ansi_colors_1$2.default.green(`${diff} ms`)}`);const discovered=new MetadataStorage_1.MetadataStorage;this.discovered.filter(meta=>meta.name).forEach(meta=>discovered.set(meta.name,meta));return discovered}async findEntities(preferTsNode){this.discovered.length=0;const key=preferTsNode&&this.config.get("tsNode",Utils_1$5.Utils.detectTsNode())&&this.config.get("entitiesTs").length>0?"entitiesTs":"entities";const paths=this.config.get(key).filter(item=>Utils_1$5.Utils.isString(item));const refs=this.config.get(key).filter(item=>!Utils_1$5.Utils.isString(item));if(this.config.get("discovery").requireEntitiesArray&&paths.length>0){throw new Error(`[requireEntitiesArray] Explicit list of entities is required, please use the 'entities' option.`)}await this.discoverDirectories(paths);await this.discoverReferences(refs);for(const meta of Object.values(this.metadata.getAll())){if(!meta.class){continue}const parent=Object.getPrototypeOf(meta.class);if(parent.name!==""&&!this.metadata.has(parent.name)){await this.discoverReferences([parent]);}}this.validator.validateDiscovered(this.discovered,this.config.get("discovery").warnWhenNoEntities);return this.discovered}async discoverDirectories(paths){if(paths.length===0){return}paths=paths.map(path=>Utils_1$5.Utils.normalizePath(path));const files=await globby_1.default(paths,{cwd:Utils_1$5.Utils.normalizePath(this.config.get("baseDir"))});this.logger.log("discovery",`- processing ${ansi_colors_1$2.default.cyan(""+files.length)} files`);const found=[];for(const filepath of files){const filename=path_1.basename(filepath);if(!filename.match(/\.[jt]s$/)||filename.endsWith(".js.map")||filename.endsWith(".d.ts")||filename.startsWith(".")||filename.match(/index\.[jt]s$/)){this.logger.log("discovery",`- ignoring file ${filename}`);continue}const name=this.namingStrategy.getClassName(filename);const path=Utils_1$5.Utils.normalizePath(...(path_1.isAbsolute(filepath)?[filepath]:[this.config.get("baseDir"),filepath]));const targets=this.getEntityClassOrSchema(path,name);for(const target of targets){if(!(target instanceof Function)&&!(target instanceof EntitySchema_1.EntitySchema)){this.logger.log("discovery",`- ignoring file ${filename}`);continue}this.metadata.set(name,Utils_1$5.Utils.copy(MetadataStorage_1.MetadataStorage.getMetadata(name,path)));const entity=this.prepare(target);const schema=this.getSchema(entity);const meta=schema.init().meta;this.metadata.set(meta.className,meta);found.push([entity,path]);}}for(const[entity,path]of found){await this.discoverEntity(entity,path);}}async discoverReferences(refs){const found=[];for(const entity of refs){const schema=this.getSchema(this.prepare(entity));const meta=schema.init().meta;this.metadata.set(meta.className,meta);found.push(entity);}for(const entity of found){await this.discoverEntity(entity);}}prepare(entity){if("schema"in entity&&entity.schema instanceof EntitySchema_1.EntitySchema){return entity.schema}if("entity"in entity&&"schema"in entity){const meta=this.metadata.get(entity.entity.name,true);meta.path=entity.schema.path;return entity.entity}return entity}getSchema(entity){var _a;if(entity instanceof EntitySchema_1.EntitySchema){return entity}const path=entity.__path;if(path){const meta=Utils_1$5.Utils.copy(MetadataStorage_1.MetadataStorage.getMetadata(entity.name,path));meta.path=Utils_1$5.Utils.relativePath(path,this.config.get("baseDir"));this.metadata.set(entity.name,meta);}const exists=this.metadata.has(entity.name);const meta=this.metadata.get(entity.name,true);meta.abstract=(_a=meta.abstract)!==null&&_a!==void 0?_a:!(exists&&meta.name);const schema=EntitySchema_1.EntitySchema.fromMetadata(meta);schema.setClass(entity);schema.meta.useCache=this.metadataProvider.useCache();return schema}async discoverEntity(entity,path){entity=this.prepare(entity);this.logger.log("discovery",`- processing entity ${ansi_colors_1$2.default.cyan(entity.name)}${ansi_colors_1$2.default.grey(path?` (${path})`:"")}`);const schema=this.getSchema(entity);const meta=schema.init().meta;const root=Utils_1$5.Utils.getRootEntity(this.metadata,meta);this.metadata.set(meta.className,meta);schema.meta.path=Utils_1$5.Utils.relativePath(path||meta.path,this.config.get("baseDir"));const cache=meta.useCache&&meta.path&&(await this.cache.get(meta.className+path_1.extname(meta.path)));if(cache){this.logger.log("discovery",`- using cached metadata for entity ${ansi_colors_1$2.default.cyan(meta.className)}`);this.metadataProvider.loadFromCache(meta,cache);meta.root=root;this.discovered.push(meta);return}if(!(entity instanceof EntitySchema_1.EntitySchema)){await this.metadataProvider.loadEntityMetadata(meta,meta.className);}if(!meta.collection&&meta.name){const entityName=root.discriminatorColumn?root.name:meta.name;meta.collection=this.namingStrategy.classToTableName(entityName);}delete meta.root;await this.saveToCache(meta);meta.root=root;this.discovered.push(meta);}async saveToCache(meta){if(!meta.useCache){return}const copy=Object.assign({},meta);delete copy.prototype;if(meta.path){await this.cache.set(meta.className+path_1.extname(meta.path),copy,meta.path);}}applyNamingStrategy(meta,prop){if(!prop.fieldNames){this.initFieldName(prop);}if(prop.reference===enums_1$h.ReferenceType.MANY_TO_MANY){this.initManyToManyFields(meta,prop);}if([enums_1$h.ReferenceType.MANY_TO_ONE,enums_1$h.ReferenceType.ONE_TO_ONE].includes(prop.reference)){this.initManyToOneFields(prop);}if(prop.reference===enums_1$h.ReferenceType.ONE_TO_MANY){this.initOneToManyFields(prop);}}initFieldName(prop){if(prop.fieldNames&&prop.fieldNames.length>0){return}if(prop.reference===enums_1$h.ReferenceType.SCALAR||prop.reference===enums_1$h.ReferenceType.EMBEDDED&&prop.object){prop.fieldNames=[this.namingStrategy.propertyToColumnName(prop.name)];}else if([enums_1$h.ReferenceType.MANY_TO_ONE,enums_1$h.ReferenceType.ONE_TO_ONE].includes(prop.reference)){prop.fieldNames=this.initManyToOneFieldName(prop,prop.name);}else if(prop.reference===enums_1$h.ReferenceType.MANY_TO_MANY&&prop.owner){prop.fieldNames=this.initManyToManyFieldName(prop,prop.name);}}initManyToOneFieldName(prop,name){const meta2=this.metadata.get(prop.type);const ret=[];for(const primaryKey of meta2.primaryKeys){this.initFieldName(meta2.properties[primaryKey]);for(const fieldName of meta2.properties[primaryKey].fieldNames){ret.push(this.namingStrategy.joinKeyColumnName(name,fieldName,meta2.compositePK));}}return ret}initManyToManyFieldName(prop,name){const meta2=this.metadata.get(prop.type);return meta2.primaryKeys.map(()=>this.namingStrategy.propertyToColumnName(name))}initManyToManyFields(meta,prop){const meta2=this.metadata.get(prop.type);Utils_1$5.Utils.defaultValue(prop,"fixedOrder",!!prop.fixedOrderColumn);if(!prop.pivotTable&&prop.owner&&this.platform.usesPivotTable()){prop.pivotTable=this.namingStrategy.joinTableName(meta.collection,meta2.collection,prop.name);}if(prop.mappedBy){const prop2=meta2.properties[prop.mappedBy];this.initManyToManyFields(meta2,prop2);prop.pivotTable=prop2.pivotTable;prop.fixedOrder=prop2.fixedOrder;prop.fixedOrderColumn=prop2.fixedOrderColumn;prop.joinColumns=prop2.inverseJoinColumns;prop.inverseJoinColumns=prop2.joinColumns;}if(!prop.referencedColumnNames){prop.referencedColumnNames=Utils_1$5.Utils.flatten(meta.primaryKeys.map(primaryKey=>meta.properties[primaryKey].fieldNames));}if(!prop.joinColumns){prop.joinColumns=prop.referencedColumnNames.map(referencedColumnName=>this.namingStrategy.joinKeyColumnName(meta.root.className,referencedColumnName,meta.compositePK));}if(!prop.inverseJoinColumns){const meta2=this.metadata.get(prop.type);prop.inverseJoinColumns=this.initManyToOneFieldName(prop,meta2.root.className);}}initManyToOneFields(prop){const meta2=this.metadata.get(prop.type);const fieldNames=Utils_1$5.Utils.flatten(meta2.primaryKeys.map(primaryKey=>meta2.properties[primaryKey].fieldNames));Utils_1$5.Utils.defaultValue(prop,"referencedTableName",meta2.collection);if(!prop.joinColumns){prop.joinColumns=fieldNames.map(fieldName=>this.namingStrategy.joinKeyColumnName(prop.name,fieldName,fieldNames.length>1));}if(!prop.referencedColumnNames){prop.referencedColumnNames=fieldNames;}}initOneToManyFields(prop){const meta2=this.metadata.get(prop.type);if(!prop.joinColumns){prop.joinColumns=[this.namingStrategy.joinColumnName(prop.name)];}if(!prop.referencedColumnNames){meta2.getPrimaryProps().forEach(pk=>this.applyNamingStrategy(meta2,pk));prop.referencedColumnNames=Utils_1$5.Utils.flatten(meta2.getPrimaryProps().map(pk=>pk.fieldNames));}}processEntity(meta){const pks=Object.values(meta.properties).filter(prop=>prop.primary);meta.primaryKeys=pks.map(prop=>prop.name);meta.compositePK=pks.length>1;meta.forceConstructor=this.shouldForceConstructorUsage(meta);this.validator.validateEntityDefinition(this.metadata,meta.name);Object.values(meta.properties).forEach(prop=>{this.applyNamingStrategy(meta,prop);this.initDefaultValue(prop);this.initVersionProperty(meta,prop);this.initCustomType(meta,prop);this.initColumnType(prop,meta.path);this.initRelation(prop);});meta.serializedPrimaryKey=this.platform.getSerializedPrimaryKeyField(meta.primaryKeys[0]);const serializedPKProp=meta.properties[meta.serializedPrimaryKey];if(serializedPKProp&&meta.serializedPrimaryKey!==meta.primaryKeys[0]){serializedPKProp.persist=false;}const ret=[];if(this.platform.usesPivotTable()){Object.values(meta.properties).filter(prop=>prop.reference===enums_1$h.ReferenceType.MANY_TO_MANY&&prop.owner&&prop.pivotTable).map(prop=>this.definePivotTableEntity(meta,prop)).forEach(meta=>ret.push(meta));}return ret}initFactoryField(prop){["mappedBy","inversedBy"].forEach(type=>{const value=prop[type];if(value instanceof Function){const meta2=this.metadata.get(prop.type);prop[type]=value(meta2.properties).name;}});}definePivotTableEntity(meta,prop){const data=new typings_1.EntityMetadata({name:prop.pivotTable,className:prop.pivotTable,collection:prop.pivotTable,pivotTable:true});if(prop.fixedOrder){const primaryProp=this.defineFixedOrderProperty(prop);data.properties[primaryProp.name]=primaryProp;data.primaryKeys=[primaryProp.name];}else {data.primaryKeys=[meta.name+"_owner",prop.type+"_inverse"];data.compositePK=true;}if(meta.name===prop.type&&prop.joinColumns.every((joinColumn,idx)=>joinColumn===prop.inverseJoinColumns[idx])){prop.joinColumns=prop.referencedColumnNames.map(name=>this.namingStrategy.joinKeyColumnName(meta.root.className+"_1",name,meta.compositePK));prop.inverseJoinColumns=prop.referencedColumnNames.map(name=>this.namingStrategy.joinKeyColumnName(meta.root.className+"_2",name,meta.compositePK));if(prop.inversedBy){const prop2=this.metadata.get(prop.type).properties[prop.inversedBy];prop2.inverseJoinColumns=prop.joinColumns;prop2.joinColumns=prop.inverseJoinColumns;}}data.properties[meta.name+"_owner"]=this.definePivotProperty(prop,meta.name+"_owner",meta.name,prop.type+"_inverse",true);data.properties[prop.type+"_inverse"]=this.definePivotProperty(prop,prop.type+"_inverse",prop.type,meta.name+"_owner",false);return this.metadata.set(prop.pivotTable,data)}defineFixedOrderProperty(prop){const pk=prop.fixedOrderColumn||this.namingStrategy.referenceColumnName();const primaryProp={name:pk,type:"number",reference:enums_1$h.ReferenceType.SCALAR,primary:true,unsigned:true};this.initFieldName(primaryProp);this.initColumnType(primaryProp);this.initUnsigned(primaryProp);prop.fixedOrderColumn=pk;if(prop.inversedBy){const prop2=this.metadata.get(prop.type).properties[prop.inversedBy];prop2.fixedOrder=true;prop2.fixedOrderColumn=pk;}return primaryProp}definePivotProperty(prop,name,type,inverse,owner){const ret={name,type,reference:enums_1$h.ReferenceType.MANY_TO_ONE,cascade:[enums_1$h.Cascade.ALL],fixedOrder:prop.fixedOrder,fixedOrderColumn:prop.fixedOrderColumn};const meta=this.metadata.get(type);ret.targetMeta=meta;ret.joinColumns=[];ret.inverseJoinColumns=[];ret.referencedTableName=meta.collection;if(owner){ret.owner=true;ret.inversedBy=inverse;ret.referencedColumnNames=prop.referencedColumnNames;ret.fieldNames=ret.joinColumns=prop.joinColumns;ret.inverseJoinColumns=prop.referencedColumnNames;}else {ret.owner=false;ret.mappedBy=inverse;ret.fieldNames=ret.joinColumns=prop.inverseJoinColumns;ret.referencedColumnNames=[];ret.inverseJoinColumns=[];ret.referencedTableName=meta.collection;meta.primaryKeys.forEach(primaryKey=>{const prop2=meta.properties[primaryKey];ret.referencedColumnNames.push(...prop2.fieldNames);ret.inverseJoinColumns.push(...prop2.fieldNames);});}this.initColumnType(ret);this.initUnsigned(ret);return ret}autoWireBidirectionalProperties(meta){Object.values(meta.properties).filter(prop=>prop.reference!==enums_1$h.ReferenceType.SCALAR&&!prop.owner&&prop.mappedBy).forEach(prop=>{const meta2=this.metadata.get(prop.type);const prop2=meta2.properties[prop.mappedBy];if(prop2&&!prop2.inversedBy){prop2.inversedBy=prop.name;}});}defineBaseEntityProperties(meta){const base=meta.extends&&this.metadata.get(meta.extends);if(!base||base===meta){return 0}let order=this.defineBaseEntityProperties(base);const old=Object.values(meta.properties).map(x=>x.name);meta.properties=Object.assign(Object.assign({},base.properties),meta.properties);meta.filters=Object.assign(Object.assign({},base.filters),meta.filters);if(!meta.discriminatorValue){Object.values(base.properties).filter(prop=>!old.includes(prop.name)).forEach(prop=>{meta.properties[prop.name]=Object.assign({},prop);meta.propertyOrder.set(prop.name,order+=0.01);});}meta.indexes=Utils_1$5.Utils.unique([...base.indexes,...meta.indexes]);meta.uniques=Utils_1$5.Utils.unique([...base.uniques,...meta.uniques]);const pks=Object.values(meta.properties).filter(p=>p.primary).map(p=>p.name);if(pks.length>0&&meta.primaryKeys.length===0){meta.primaryKeys=pks;}Object.keys(base.hooks).forEach(type=>{meta.hooks[type]=Utils_1$5.Utils.unique([...base.hooks[type],...(meta.hooks[type]||[])]);});if(meta.constructorParams.length===0&&base.constructorParams.length>0){meta.constructorParams=[...base.constructorParams];}if(meta.toJsonParams.length===0&&base.toJsonParams.length>0){meta.toJsonParams=[...base.toJsonParams];}return order}initEmbeddables(meta,embeddedProp,visited=new WeakSet){if(embeddedProp.reference!==enums_1$h.ReferenceType.EMBEDDED||visited.has(embeddedProp)){return}visited.add(embeddedProp);const embeddable=this.discovered.find(m=>m.name===embeddedProp.type);embeddedProp.embeddable=embeddable.class;embeddedProp.embeddedProps={};let order=meta.propertyOrder.get(embeddedProp.name);const getRootProperty=prop=>prop.embedded?getRootProperty(meta.properties[prop.embedded[0]]):prop;for(const prop of Object.values(embeddable.properties)){const prefix=embeddedProp.prefix===false?"":embeddedProp.prefix===true?embeddedProp.name+"_":embeddedProp.prefix;const name=prefix+prop.name;if(meta.properties[name]!==undefined&&getRootProperty(meta.properties[name]).reference!==enums_1$h.ReferenceType.EMBEDDED){throw errors_1$4.MetadataError.conflictingPropertyName(meta.className,name,embeddedProp.name)}meta.properties[name]=Utils_1$5.Utils.copy(prop);meta.properties[name].name=name;meta.properties[name].embedded=[embeddedProp.name,prop.name];meta.propertyOrder.set(name,order+=0.01);embeddedProp.embeddedProps[prop.name]=meta.properties[name];if(embeddedProp.nullable){meta.properties[name].nullable=true;}const isParentObject=prop=>{if(prop.object){return true}return prop.embedded?isParentObject(meta.properties[prop.embedded[0]]):false};const rootProperty=getRootProperty(embeddedProp);if(isParentObject(embeddedProp)){embeddedProp.object=true;this.initFieldName(embeddedProp);let path=[];let tmp=embeddedProp;while(tmp.embedded&&tmp.object){path.unshift(tmp.embedded[1]);tmp=meta.properties[tmp.embedded[0]];}if(tmp===rootProperty){path.unshift(this.namingStrategy.propertyToColumnName(rootProperty.name));}else {path=[embeddedProp.fieldNames[0]];}path.push(prop.name);meta.properties[name].fieldNames=[path.join(".")];meta.properties[name].fieldNameRaw=this.platform.getSearchJsonPropertySQL(path.join("->"),prop.type);meta.properties[name].persist=false;}this.initEmbeddables(meta,meta.properties[name],visited);}}initSingleTableInheritance(meta,metadata){var _a;if(meta.root!==meta&&!meta.__processed){meta.root=metadata.find(m=>m.className===meta.root.className);meta.root.__processed=true;}else {delete meta.root.__processed;}if(!meta.root.discriminatorColumn){return}if(!meta.root.discriminatorMap){meta.root.discriminatorMap={};const children=metadata.filter(m=>m.root.className===meta.root.className&&!m.abstract);children.forEach(m=>{const name=m.discriminatorValue||this.namingStrategy.classToTableName(m.className);meta.root.discriminatorMap[name]=m.className;});}meta.discriminatorValue=(_a=Object.entries(meta.root.discriminatorMap).find(([,className])=>className===meta.className))===null||_a===void 0?void 0:_a[0];if(!meta.root.properties[meta.root.discriminatorColumn]){this.createDiscriminatorProperty(meta.root);}Utils_1$5.Utils.defaultValue(meta.root.properties[meta.root.discriminatorColumn],"items",Object.keys(meta.root.discriminatorMap));Utils_1$5.Utils.defaultValue(meta.root.properties[meta.root.discriminatorColumn],"index",true);if(meta.root===meta){return}Object.values(meta.properties).forEach(prop=>{const exists=meta.root.properties[prop.name];prop=Utils_1$5.Utils.copy(prop);prop.nullable=true;if(!exists){prop.inherited=true;}meta.root.addProperty(prop);});meta.root.indexes=Utils_1$5.Utils.unique([...meta.root.indexes,...meta.indexes]);meta.root.uniques=Utils_1$5.Utils.unique([...meta.root.uniques,...meta.uniques]);}createDiscriminatorProperty(meta){meta.addProperty({name:meta.discriminatorColumn,type:"string",enum:true,reference:enums_1$h.ReferenceType.SCALAR,userDefined:false});}getDefaultVersionValue(prop){if(typeof prop.defaultRaw!=="undefined"){return prop.defaultRaw}if(prop.type.toLowerCase()==="date"){prop.length=typeof prop.length==="undefined"?3:prop.length;return this.platform.getCurrentTimestampSQL(prop.length)}return "1"}initDefaultValue(prop){if(prop.defaultRaw||!("default"in prop)){return}let val=prop.default;if(prop.customType instanceof types_1.ArrayType&&Array.isArray(prop.default)){val=prop.customType.convertToDatabaseValue(prop.default,this.platform);}prop.defaultRaw=typeof val==="string"?`'${val}'`:""+val;}initVersionProperty(meta,prop){if(!prop.version){return}meta.versionProperty=prop.name;prop.defaultRaw=this.getDefaultVersionValue(prop);}initCustomType(meta,prop){var _a;if(!prop.customType&&prop.array&&prop.items){prop.customType=new types_1.EnumArrayType(`${meta.className}.${prop.name}`,prop.items);}if(!prop.customType&&!prop.columnTypes&&["string[]","array"].includes(prop.type)){prop.customType=new types_1.ArrayType;}if(!prop.customType&&!prop.columnTypes&&prop.type==="number[]"){prop.customType=new types_1.ArrayType(i=>+i);}if(!prop.customType&&!prop.columnTypes&&prop.type==="Buffer"){prop.customType=new types_1.BlobType;}if(!prop.customType&&!prop.columnTypes&&prop.type==="json"){prop.customType=new types_1.JsonType;}if(prop.type instanceof types_1.Type){prop.customType=prop.type;}if(types_1.Type.isPrototypeOf(prop.type)&&!prop.customType){prop.customType=types_1.Type.getType(prop.type);}if(prop.customType){prop.columnTypes=(_a=prop.columnTypes)!==null&&_a!==void 0?_a:[prop.customType.getColumnType(prop,this.platform)];}if(prop.customType instanceof types_1.Type&&prop.reference===enums_1$h.ReferenceType.SCALAR){prop.type=prop.customType.constructor.name;}}initRelation(prop){if(prop.reference===enums_1$h.ReferenceType.SCALAR){return}const meta2=this.discovered.find(m=>m.className===prop.type);prop.referencedPKs=meta2.primaryKeys;prop.targetMeta=meta2;}initColumnType(prop,path){if(prop.columnTypes||!this.schemaHelper){return}if(prop.enum&&!prop.items&&prop.type&&path){return this.initEnumValues(prop,path)}if(prop.reference===enums_1$h.ReferenceType.SCALAR){prop.columnTypes=[this.schemaHelper.getTypeDefinition(prop)];return}if(prop.reference===enums_1$h.ReferenceType.EMBEDDED&&prop.object&&!prop.columnTypes){prop.columnTypes=[this.platform.getJsonDeclarationSQL()];return}const meta=this.metadata.get(prop.type);prop.columnTypes=[];meta.getPrimaryProps().forEach(pk=>{this.initCustomType(meta,pk);this.initColumnType(pk);if(!pk.customType){prop.columnTypes.push(...pk.columnTypes);return}prop.columnTypes.push(pk.customType.getColumnType(pk,this.platform));if(!meta.compositePK){prop.customType=pk.customType;}});}initEnumValues(prop,path){path=Utils_1$5.Utils.normalizePath(this.config.get("baseDir"),path);const exports=commonjsRequire(path);const target=exports[prop.type]||exports.default;if(target){const items=Utils_1$5.Utils.extractEnumValues(target);Utils_1$5.Utils.defaultValue(prop,"items",items);}prop.columnTypes=[this.schemaHelper.getTypeDefinition(prop)];}initUnsigned(prop){if([enums_1$h.ReferenceType.MANY_TO_ONE,enums_1$h.ReferenceType.ONE_TO_ONE].includes(prop.reference)){const meta2=this.metadata.get(prop.type);meta2.primaryKeys.forEach(primaryKey=>{const pk=meta2.properties[primaryKey];prop.unsigned=pk.type==="number"||this.platform.isBigIntProperty(pk);});return}prop.unsigned=(prop.primary||prop.unsigned)&&(prop.type==="number"||this.platform.isBigIntProperty(prop));}getEntityClassOrSchema(path,name){const exports=commonjsRequire(path);const targets=Object.values(exports).filter(item=>item instanceof EntitySchema_1.EntitySchema||item instanceof Function&&MetadataStorage_1.MetadataStorage.isKnownEntity(item.name));for(const item of targets){if(item instanceof EntitySchema_1.EntitySchema){targets.forEach((item2,idx)=>{if(item.meta.class===item2){targets.splice(idx,1);}});}}if(targets.length>0){return targets}const target=exports.default||exports[name];if(!target){throw errors_1$4.MetadataError.entityNotFound(name,path.replace(this.config.get("baseDir"),"."))}return [target]}shouldForceConstructorUsage(meta){const forceConstructor=this.config.get("forceEntityConstructor");if(Array.isArray(forceConstructor)){return forceConstructor.some(cls=>Utils_1$5.Utils.className(cls)===meta.className)}return meta.forceConstructor=forceConstructor}}MetadataDiscovery$1.MetadataDiscovery=MetadataDiscovery;

var JavaScriptMetadataProvider$1 = {};

Object.defineProperty(JavaScriptMetadataProvider$1,"__esModule",{value:true});JavaScriptMetadataProvider$1.JavaScriptMetadataProvider=void 0;const MetadataProvider_1=MetadataProvider$1;const utils_1$d=utils$m;const enums_1$g=enums;class JavaScriptMetadataProvider extends MetadataProvider_1.MetadataProvider{async loadEntityMetadata(meta,name){const schema=this.getSchema(meta);Object.entries(schema.properties).forEach(([name,prop])=>{if(utils_1$d.Utils.isString(prop)){schema.properties[name]={type:prop};}});utils_1$d.Utils.merge(meta,schema);Object.entries(meta.properties).forEach(([name,prop])=>{this.initProperty(prop,name);});}loadFromCache(meta,cache){utils_1$d.Utils.merge(meta,cache);const schema=this.getSchema(meta);Object.entries(schema.properties).forEach(([name,prop])=>{if(utils_1$d.Utils.isObject(prop)){Object.entries(prop).forEach(([attribute,value])=>{if(!(attribute in meta.properties[name])){meta.properties[name][attribute]=value;}});}});}initProperty(prop,propName){prop.name=propName;if(typeof prop.reference==="undefined"){prop.reference=enums_1$g.ReferenceType.SCALAR;}if(prop.reference!==enums_1$g.ReferenceType.SCALAR&&typeof prop.cascade==="undefined"){prop.cascade=[enums_1$g.Cascade.PERSIST];}}getSchema(meta){if(!meta.path){return meta}const path=utils_1$d.Utils.absolutePath(meta.path,this.config.get("baseDir"));const{schema}=commonjsRequire(path);return schema}}JavaScriptMetadataProvider$1.JavaScriptMetadataProvider=JavaScriptMetadataProvider;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(EntitySchema$1,exports);__exportStar(MetadataDiscovery$1,exports);__exportStar(MetadataStorage$1,exports);__exportStar(MetadataProvider$1,exports);__exportStar(MetadataValidator$1,exports);__exportStar(JavaScriptMetadataProvider$1,exports);__exportStar(ReflectMetadataProvider$1,exports);})(metadata);getDefaultExportFromCjs(metadata);

var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(MikroORM$1,"__esModule",{value:true});MikroORM$1.MikroORM=void 0;const ansi_colors_1$1=__importDefault$1(ansiColors.exports);const metadata_1$f=metadata;const utils_1$c=utils$m;const cache_1=cache$1;class MikroORM{constructor(options){if(options instanceof utils_1$c.Configuration){this.config=options;}else {this.config=new utils_1$c.Configuration(options);}if(this.config.get("discovery").disableDynamicFileAccess){this.config.set("metadataProvider",metadata_1$f.ReflectMetadataProvider);this.config.set("cache",{adapter:cache_1.NullCacheAdapter});this.config.set("discovery",{disableDynamicFileAccess:true,requireEntitiesArray:true,alwaysAnalyseProperties:false});}this.driver=this.config.getDriver();this.logger=this.config.getLogger();}static async init(options,connect=true){const env=utils_1$c.ConfigurationLoader.loadEnvironmentVars(options);if(!options){options=await utils_1$c.ConfigurationLoader.getConfiguration();}options=options instanceof utils_1$c.Configuration?options.getAll():options;const orm=new MikroORM(utils_1$c.Utils.merge(options,env));const discovery=new metadata_1$f.MetadataDiscovery(new metadata_1$f.MetadataStorage(),orm.driver.getPlatform(),orm.config);orm.metadata=await discovery.discover(orm.config.get("tsNode"));orm.driver.setMetadata(orm.metadata);orm.em=orm.driver.createEntityManager();orm.metadata.decorate(orm.em);orm.driver.setMetadata(orm.metadata);if(connect){await orm.connect();if(orm.config.get("ensureIndexes")){await orm.driver.ensureIndexes();}}return orm}async connect(){const connection=await this.driver.connect();const clientUrl=connection.getClientUrl();const dbName=this.config.get("dbName");const db=dbName+(clientUrl?" on "+clientUrl:"");if(await this.isConnected()){this.logger.log("info",`MikroORM successfully connected to database ${ansi_colors_1$1.default.green(db)}`);}else {this.logger.log("info",ansi_colors_1$1.default.red(`MikroORM failed to connect to database ${db}`));}return this.driver}async isConnected(){return this.driver.getConnection().isConnected()}async close(force=false){return this.driver.close(force)}getMetadata(){return this.metadata}getSchemaGenerator(){return this.driver.getPlatform().getSchemaGenerator(this.em)}getEntityGenerator(){return this.driver.getPlatform().getEntityGenerator(this.em)}getMigrator(){return this.driver.getPlatform().getMigrator(this.em)}}MikroORM$1.MikroORM=MikroORM;

var events = {};

var EventSubscriber = {};

Object.defineProperty(EventSubscriber,"__esModule",{value:true});

var EventManager$1 = {};

Object.defineProperty(EventManager$1,"__esModule",{value:true});EventManager$1.EventManager=void 0;const utils_1$b=utils$m;const enums_1$f=enums;class EventManager{constructor(subscribers){this.listeners={};this.entities=new Map;subscribers.forEach(subscriber=>this.registerSubscriber(subscriber));}registerSubscriber(subscriber){this.entities.set(subscriber,this.getSubscribedEntities(subscriber));Object.keys(enums_1$f.EventType).filter(event=>event in subscriber).forEach(event=>{this.listeners[event]=this.listeners[event]||[];this.listeners[event].push(subscriber);});}dispatchEvent(event,args){const listeners=[];const entity=args.entity;const hooks=entity&&entity.__meta.hooks[event]||[];listeners.push(...hooks.map(hook=>[hook,entity]));for(const listener of this.listeners[event]||[]){const entities=this.entities.get(listener);if(entities.length===0||!entity||entities.includes(entity.constructor.name)){listeners.push([event,listener]);}}if(event===enums_1$f.EventType.onInit){return listeners.forEach(listener=>listener[1][listener[0]](args))}return utils_1$b.Utils.runSerial(listeners,listener=>listener[1][listener[0]](args))}hasListeners(event,meta){var _a,_b;const hasHooks=(_a=meta.hooks[event])===null||_a===void 0?void 0:_a.length;if(hasHooks){return true}for(const listener of (_b=this.listeners[event])!==null&&_b!==void 0?_b:[]){const entities=this.entities.get(listener);if(entities.length===0||entities.includes(meta.className)){return true}}return false}getSubscribedEntities(listener){if(!listener.getSubscribedEntities){return []}return listener.getSubscribedEntities().map(name=>utils_1$b.Utils.className(name))}}EventManager$1.EventManager=EventManager;

var TransactionEventBroadcaster$1 = {};

Object.defineProperty(TransactionEventBroadcaster$1,"__esModule",{value:true});TransactionEventBroadcaster$1.TransactionEventBroadcaster=void 0;class TransactionEventBroadcaster{constructor(em,uow){this.em=em;this.uow=uow;this.eventManager=this.em.getEventManager();}async dispatchEvent(event,transaction){await this.eventManager.dispatchEvent(event,{em:this.em,transaction,uow:this.uow});}}TransactionEventBroadcaster$1.TransactionEventBroadcaster=TransactionEventBroadcaster;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(EventSubscriber,exports);__exportStar(EventManager$1,exports);__exportStar(TransactionEventBroadcaster$1,exports);})(events);getDefaultExportFromCjs(events);

var EntityManager$1 = {};

var unitOfWork = {};

var ChangeSet = {};

(function(exports){Object.defineProperty(exports,"__esModule",{value:true});exports.ChangeSetType=exports.ChangeSet=void 0;class ChangeSet{constructor(entity,type,payload,meta){this.entity=entity;this.type=type;this.payload=payload;this.name=meta.className;this.rootName=meta.root.className;this.collection=meta.root.collection;}getPrimaryKey(){var _a;this.primaryKey=(_a=this.primaryKey)!==null&&_a!==void 0?_a:this.entity.__helper.getPrimaryKey(true);return this.primaryKey}}exports.ChangeSet=ChangeSet;(function(ChangeSetType){ChangeSetType["CREATE"]="create";ChangeSetType["UPDATE"]="update";ChangeSetType["DELETE"]="delete";})(exports.ChangeSetType||(exports.ChangeSetType={}));})(ChangeSet);getDefaultExportFromCjs(ChangeSet);

var ChangeSetComputer$1 = {};

Object.defineProperty(ChangeSetComputer$1,"__esModule",{value:true});ChangeSetComputer$1.ChangeSetComputer=void 0;const utils_1$a=utils$m;const ChangeSet_1$2=ChangeSet;const enums_1$e=enums;const EntityComparator_1$1=EntityComparator$1;class ChangeSetComputer{constructor(validator,collectionUpdates,removeStack,metadata,platform,config){this.validator=validator;this.collectionUpdates=collectionUpdates;this.removeStack=removeStack;this.metadata=metadata;this.platform=platform;this.config=config;this.comparator=new EntityComparator_1$1.EntityComparator(this.metadata,this.platform);}computeChangeSet(entity){const meta=this.metadata.find(entity.constructor.name);if(meta.readonly){return null}const type=entity.__helper.__originalEntityData?ChangeSet_1$2.ChangeSetType.UPDATE:ChangeSet_1$2.ChangeSetType.CREATE;const changeSet=new ChangeSet_1$2.ChangeSet(entity,type,this.computePayload(entity),meta);if(changeSet.type===ChangeSet_1$2.ChangeSetType.UPDATE){changeSet.originalEntity=entity.__helper.__originalEntityData;}if(this.config.get("validate")){this.validator.validate(changeSet.entity,changeSet.payload,meta);}for(const prop of meta.relations){this.processProperty(changeSet,prop);}if(changeSet.type===ChangeSet_1$2.ChangeSetType.UPDATE&&!utils_1$a.Utils.hasObjectKeys(changeSet.payload)){return null}return changeSet}computePayload(entity){const data=this.comparator.prepareEntity(entity);const entityName=entity.__meta.root.className;const originalEntityData=entity.__helper.__originalEntityData;if(originalEntityData){const comparator=this.comparator.getEntityComparator(entityName);return comparator(originalEntityData,data)}return data}processProperty(changeSet,prop){const target=changeSet.entity[prop.name];if(utils_1$a.Utils.isCollection(target)){this.processToMany(prop,changeSet);}else if(prop.reference!==enums_1$e.ReferenceType.SCALAR&&target){this.processToOne(prop,changeSet);}}processToOne(prop,changeSet){const entity=changeSet.entity[prop.name];const isToOneOwner=prop.reference===enums_1$e.ReferenceType.MANY_TO_ONE||prop.reference===enums_1$e.ReferenceType.ONE_TO_ONE&&prop.owner;if(isToOneOwner&&!prop.mapToPk&&!entity.__helper.hasPrimaryKey()){changeSet.payload[prop.name]=entity.__helper.__identifier;}}processToMany(prop,changeSet){const target=changeSet.entity[prop.name];if(target.isInitialized()&&this.removeStack.size>0){target.getItems(false).filter(item=>this.removeStack.has(item)).forEach(item=>target.remove(item));}if(!target.isDirty()){return}if(prop.owner||target.getItems(false).filter(item=>!item.__helper.__initialized).length>0){this.collectionUpdates.add(target);}else {target.setDirty(false);}}}ChangeSetComputer$1.ChangeSetComputer=ChangeSetComputer;

var ChangeSetPersister$1 = {};

Object.defineProperty(ChangeSetPersister$1,"__esModule",{value:true});ChangeSetPersister$1.ChangeSetPersister=void 0;const entity_1$3=entity;const ChangeSet_1$1=ChangeSet;const utils_1$9=utils$m;const errors_1$3=errors;class ChangeSetPersister{constructor(driver,metadata,hydrator,factory,config){this.driver=driver;this.metadata=metadata;this.hydrator=hydrator;this.factory=factory;this.config=config;this.platform=this.driver.getPlatform();}async executeInserts(changeSets,ctx){const meta=this.metadata.find(changeSets[0].name);changeSets.forEach(changeSet=>this.processProperties(changeSet));if(changeSets.length>1&&this.config.get("useBatchInserts",this.platform.usesBatchInserts())){return this.persistNewEntities(meta,changeSets,ctx)}for(const changeSet of changeSets){await this.persistNewEntity(meta,changeSet,ctx);}}async executeUpdates(changeSets,batched,ctx){const meta=this.metadata.find(changeSets[0].name);changeSets.forEach(changeSet=>this.processProperties(changeSet));if(batched&&changeSets.length>1&&this.config.get("useBatchUpdates",this.platform.usesBatchUpdates())){return this.persistManagedEntities(meta,changeSets,ctx)}for(const changeSet of changeSets){await this.persistManagedEntity(changeSet,ctx);}}async executeDeletes(changeSets,ctx){const size=this.config.get("batchSize");const meta=changeSets[0].entity.__meta;const pk=utils_1$9.Utils.getPrimaryKeyHash(meta.primaryKeys);for(let i=0;i<changeSets.length;i+=size){const chunk=changeSets.slice(i,i+size);const pks=chunk.map(cs=>cs.getPrimaryKey());await this.driver.nativeDelete(meta.className,{[pk]:{$in:pks}},ctx);}}processProperties(changeSet){const meta=this.metadata.find(changeSet.name);for(const prop of meta.props){this.processProperty(changeSet,prop);}}async persistNewEntity(meta,changeSet,ctx){const wrapped=changeSet.entity.__helper;const res=await this.driver.nativeInsert(changeSet.name,changeSet.payload,ctx,false);if(!wrapped.hasPrimaryKey()){this.mapPrimaryKey(meta,res.insertId,changeSet);}this.mapReturnedValues(changeSet,res,meta);this.markAsPopulated(changeSet,meta);wrapped.__initialized=true;wrapped.__managed=true;if(!this.platform.usesReturningStatement()){await this.reloadVersionValues(meta,[changeSet],ctx);}changeSet.persisted=true;}async persistNewEntities(meta,changeSets,ctx){const size=this.config.get("batchSize");for(let i=0;i<changeSets.length;i+=size){const chunk=changeSets.slice(i,i+size);await this.persistNewEntitiesBatch(meta,chunk,ctx);if(!this.platform.usesReturningStatement()){await this.reloadVersionValues(meta,chunk,ctx);}}}async persistNewEntitiesBatch(meta,changeSets,ctx){const res=await this.driver.nativeInsertMany(meta.className,changeSets.map(cs=>cs.payload),ctx,false,false);for(let i=0;i<changeSets.length;i++){const changeSet=changeSets[i];const wrapped=changeSet.entity.__helper;if(!wrapped.hasPrimaryKey()){const field=meta.getPrimaryProps()[0].fieldNames[0];this.mapPrimaryKey(meta,res.rows[i][field],changeSet);}this.mapReturnedValues(changeSet,res,meta);this.markAsPopulated(changeSet,meta);wrapped.__initialized=true;wrapped.__managed=true;changeSet.persisted=true;}}async persistManagedEntity(changeSet,ctx){const meta=this.metadata.find(changeSet.name);const res=await this.updateEntity(meta,changeSet,ctx);this.checkOptimisticLock(meta,changeSet,res);await this.reloadVersionValues(meta,[changeSet],ctx);changeSet.persisted=true;}async persistManagedEntities(meta,changeSets,ctx){const size=this.config.get("batchSize");for(let i=0;i<changeSets.length;i+=size){const chunk=changeSets.slice(i,i+size);await this.persistManagedEntitiesBatch(meta,chunk,ctx);await this.reloadVersionValues(meta,chunk,ctx);}}async persistManagedEntitiesBatch(meta,changeSets,ctx){await this.checkOptimisticLocks(meta,changeSets,ctx);await this.driver.nativeUpdateMany(meta.className,changeSets.map(cs=>cs.getPrimaryKey()),changeSets.map(cs=>cs.payload),ctx,false,false);changeSets.forEach(cs=>cs.persisted=true);}mapPrimaryKey(meta,value,changeSet){const prop=meta.properties[meta.primaryKeys[0]];const insertId=prop.customType?prop.customType.convertToJSValue(value,this.platform):value;const wrapped=changeSet.entity.__helper;if(!wrapped.hasPrimaryKey()){wrapped.setPrimaryKey(insertId);}value=prop.customType?prop.customType.convertToDatabaseValue(insertId,this.platform):value;changeSet.payload[wrapped.__meta.primaryKeys[0]]=value;wrapped.__identifier.setValue(value);}markAsPopulated(changeSet,meta){if(!this.config.get("populateAfterFlush")){return}changeSet.entity.__helper.populated();meta.relations.forEach(prop=>{const value=changeSet.entity[prop.name];if(utils_1$9.Utils.isEntity(value,true)){value.__helper.populated();}else if(utils_1$9.Utils.isCollection(value)){value.populated();}});}async updateEntity(meta,changeSet,ctx){if(!meta.versionProperty||!changeSet.entity[meta.versionProperty]){return this.driver.nativeUpdate(changeSet.name,changeSet.getPrimaryKey(),changeSet.payload,ctx,false)}const cond=Object.assign(Object.assign({},utils_1$9.Utils.getPrimaryKeyCond(changeSet.entity,meta.primaryKeys)),{[meta.versionProperty]:this.platform.quoteVersionValue(changeSet.entity[meta.versionProperty],meta.properties[meta.versionProperty])});return this.driver.nativeUpdate(changeSet.name,cond,changeSet.payload,ctx,false)}async checkOptimisticLocks(meta,changeSets,ctx){if(!meta.versionProperty||changeSets.every(cs=>!cs.entity[meta.versionProperty])){return}const $or=changeSets.map(cs=>Object.assign(Object.assign({},utils_1$9.Utils.getPrimaryKeyCond(cs.entity,meta.primaryKeys)),{[meta.versionProperty]:this.platform.quoteVersionValue(cs.entity[meta.versionProperty],meta.properties[meta.versionProperty])}));const res=await this.driver.find(meta.className,{$or},{fields:meta.primaryKeys},ctx);if(res.length!==changeSets.length){const compare=(a,b,keys)=>keys.every(k=>a[k]===b[k]);const entity=changeSets.find(cs=>!res.some(row=>compare(utils_1$9.Utils.getPrimaryKeyCond(cs.entity,meta.primaryKeys),row,meta.primaryKeys))).entity;throw errors_1$3.OptimisticLockError.lockFailed(entity)}}checkOptimisticLock(meta,changeSet,res){if(meta.versionProperty&&res&&!res.affectedRows){throw errors_1$3.OptimisticLockError.lockFailed(changeSet.entity)}}async reloadVersionValues(meta,changeSets,ctx){if(!meta.versionProperty){return}const pk=utils_1$9.Utils.getPrimaryKeyHash(meta.primaryKeys);const pks=changeSets.map(cs=>cs.getPrimaryKey());const data=await this.driver.find(meta.name,{[pk]:{$in:pks}},{fields:[meta.versionProperty]},ctx);const map=new Map;data.forEach(e=>map.set(utils_1$9.Utils.getCompositeKeyHash(e,meta),e[meta.versionProperty]));for(const changeSet of changeSets){const version=map.get(changeSet.entity.__helper.getSerializedPrimaryKey());if(meta.properties[meta.versionProperty].type.toLowerCase()==="date"){changeSet.entity[meta.versionProperty]=new Date(version);}else {changeSet.entity[meta.versionProperty]=version;}changeSet.payload[meta.versionProperty]=version;}}processProperty(changeSet,prop){const value=changeSet.payload[prop.name];if(value instanceof entity_1$3.EntityIdentifier){changeSet.payload[prop.name]=value.getValue();}if(prop.onCreate&&changeSet.type===ChangeSet_1$1.ChangeSetType.CREATE){changeSet.entity[prop.name]=prop.onCreate(changeSet.entity);changeSet.payload[prop.name]=prop.customType?prop.customType.convertToDatabaseValue(changeSet.entity[prop.name],this.platform):changeSet.entity[prop.name];if(prop.primary){this.mapPrimaryKey(changeSet.entity.__meta,changeSet.entity[prop.name],changeSet);}}if(prop.onUpdate&&changeSet.type===ChangeSet_1$1.ChangeSetType.UPDATE){changeSet.entity[prop.name]=prop.onUpdate(changeSet.entity);changeSet.payload[prop.name]=prop.customType?prop.customType.convertToDatabaseValue(changeSet.entity[prop.name],this.platform):changeSet.entity[prop.name];}if(changeSet.payload[prop.name]instanceof Date){changeSet.payload[prop.name]=this.platform.processDateProperty(changeSet.payload[prop.name]);}}mapReturnedValues(changeSet,res,meta){if(this.platform.usesReturningStatement()&&res.row&&utils_1$9.Utils.hasObjectKeys(res.row)){const data=meta.props.reduce((ret,prop)=>{if(prop.primary&&!changeSet.entity.__helper.hasPrimaryKey()){this.mapPrimaryKey(meta,res.row[prop.fieldNames[0]],changeSet);return ret}if(prop.fieldNames&&utils_1$9.Utils.isDefined(res.row[prop.fieldNames[0]],true)&&!utils_1$9.Utils.isDefined(changeSet.entity[prop.name],true)){ret[prop.name]=changeSet.payload[prop.name]=res.row[prop.fieldNames[0]];}return ret},{});if(utils_1$9.Utils.hasObjectKeys(data)){this.hydrator.hydrate(changeSet.entity,meta,data,this.factory,"returning",false,true);}}}}ChangeSetPersister$1.ChangeSetPersister=ChangeSetPersister;

var CommitOrderCalculator$1 = {};

Object.defineProperty(CommitOrderCalculator$1,"__esModule",{value:true});CommitOrderCalculator$1.CommitOrderCalculator=void 0;const enums_1$d=enums;class CommitOrderCalculator{constructor(){this.nodes={};this.sortedNodeList=[];}hasNode(hash){return hash in this.nodes}addNode(hash){this.nodes[hash]={hash,state:0,dependencies:{}};}addDependency(from,to,weight){this.nodes[from].dependencies[to]={from,to,weight};}discoverProperty(prop,entityName){var _a;if(!(prop.reference===enums_1$d.ReferenceType.ONE_TO_ONE&&prop.owner)&&prop.reference!==enums_1$d.ReferenceType.MANY_TO_ONE){return}const propertyType=(_a=prop.targetMeta)===null||_a===void 0?void 0:_a.root.className;if(!propertyType||!this.hasNode(propertyType)){return}this.addDependency(propertyType,entityName,prop.nullable?0:1);}sort(){for(const vertex of Object.values(this.nodes)){if(vertex.state!==0){continue}this.visit(vertex);}const sortedList=this.sortedNodeList.reverse();this.nodes={};this.sortedNodeList=[];return sortedList}visit(node){node.state=1;for(const edge of Object.values(node.dependencies)){const target=this.nodes[edge.to];switch(target.state){case 2:break;case 1:this.visitOpenNode(node,target,edge);break;case 0:this.visit(target);}}if(node.state!==2){node.state=2;this.sortedNodeList.push(node.hash);}}visitOpenNode(node,target,edge){if(!target.dependencies[node.hash]||target.dependencies[node.hash].weight>=edge.weight){return}for(const edge of Object.values(target.dependencies)){const targetNode=this.nodes[edge.to];if(targetNode.state===0){this.visit(targetNode);}}target.state=2;this.sortedNodeList.push(target.hash);}}CommitOrderCalculator$1.CommitOrderCalculator=CommitOrderCalculator;

var UnitOfWork$1 = {};

var IdentityMap$1 = {};

Object.defineProperty(IdentityMap$1,"__esModule",{value:true});IdentityMap$1.IdentityMap=void 0;class IdentityMap{constructor(){this.registry=new Map;}store(item){this.getStore(item.__meta.root).set(item.__helper.getSerializedPrimaryKey(),item);}delete(item){this.getStore(item.__meta.root).delete(item.__helper.getSerializedPrimaryKey());}getByHash(meta,hash){const store=this.getStore(meta);return store.has(hash)?store.get(hash):undefined}getStore(meta){const store=this.registry.get(meta.class);if(store){return store}const newStore=new Map;this.registry.set(meta.class,newStore);return newStore}clear(){this.registry.clear();}values(){const ret=[];for(const store of this.registry.values()){ret.push(...store.values());}return ret}*[Symbol.iterator](){for(const store of this.registry.values()){for(const item of store.values()){yield item;}}}keys(){const ret=[];for(const[cls,store]of this.registry){ret.push(...[...store.keys()].map(hash=>`${cls.name}-${hash}`));}return ret}get(hash){const[name,id]=hash.split("-",2);const cls=[...this.registry.keys()].find(k=>k.name===name);if(!cls){return undefined}const store=this.registry.get(cls);return store.has(id)?store.get(id):undefined}}IdentityMap$1.IdentityMap=IdentityMap;

Object.defineProperty(UnitOfWork$1,"__esModule",{value:true});UnitOfWork$1.UnitOfWork=void 0;const entity_1$2=entity;const ChangeSet_1=ChangeSet;const ChangeSetComputer_1=ChangeSetComputer$1;const ChangeSetPersister_1=ChangeSetPersister$1;const CommitOrderCalculator_1=CommitOrderCalculator$1;const Utils_1$4=Utils;const enums_1$c=enums;const errors_1$2=errors;const events_1$1=events;const IdentityMap_1=IdentityMap$1;class UnitOfWork{constructor(em){this.em=em;this.identityMap=new IdentityMap_1.IdentityMap;this.persistStack=new Set;this.removeStack=new Set;this.orphanRemoveStack=new Set;this.changeSets=new Map;this.collectionUpdates=new Set;this.collectionDeletions=new Set;this.extraUpdates=new Set;this.metadata=this.em.getMetadata();this.platform=this.em.getPlatform();this.eventManager=this.em.getEventManager();this.comparator=this.em.getComparator();this.changeSetComputer=new ChangeSetComputer_1.ChangeSetComputer(this.em.getValidator(),this.collectionUpdates,this.removeStack,this.metadata,this.platform,this.em.config);this.changeSetPersister=new ChangeSetPersister_1.ChangeSetPersister(this.em.getDriver(),this.metadata,this.em.config.getHydrator(this.metadata),this.em.getEntityFactory(),this.em.config);this.working=false;}merge(entity,visited){const wrapped=entity.__helper;wrapped.__em=this.em;wrapped.__populated=true;if(!wrapped.hasPrimaryKey()){return}if(!wrapped.__managed&&visited){return}this.identityMap.store(entity);wrapped.__populated=true;if(!visited||!wrapped.__originalEntityData){wrapped.__originalEntityData=this.comparator.prepareEntity(entity);}this.cascade(entity,enums_1$c.Cascade.MERGE,visited!==null&&visited!==void 0?visited:new WeakSet);}registerManaged(entity,data,refresh,newEntity){this.identityMap.store(entity);if(newEntity){return entity}const helper=entity.__helper;helper.__em=this.em;if(data&&helper.__initialized&&(refresh||!helper.__originalEntityData)){helper.__originalEntityData=this.comparator.prepareEntity(entity);}return entity}getById(entityName,id){if(!id||Array.isArray(id)&&id.length===0){return undefined}const root=this.metadata.find(entityName).root;const hash=Array.isArray(id)?Utils_1$4.Utils.getPrimaryKeyHash(id):""+id;return this.identityMap.getByHash(root,hash)}tryGetById(entityName,where,strict=true){const pk=Utils_1$4.Utils.extractPK(where,this.metadata.find(entityName),strict);if(!pk){return null}return this.getById(entityName,pk)}getIdentityMap(){return this.identityMap}getOriginalEntityData(entity){if(!entity){return this.identityMap.values().map(e=>{return e.__helper.__originalEntityData})}return entity.__helper.__originalEntityData}getPersistStack(){return this.persistStack}getRemoveStack(){return this.removeStack}getChangeSets(){return [...this.changeSets.values()]}getCollectionUpdates(){return [...this.collectionUpdates]}getExtraUpdates(){return this.extraUpdates}computeChangeSet(entity){const cs=this.changeSetComputer.computeChangeSet(entity);if(!cs||this.checkUniqueProps(cs)){return}this.initIdentifier(entity);this.checkOrphanRemoval(cs);this.changeSets.set(entity,cs);this.persistStack.delete(entity);entity.__helper.__originalEntityData=this.comparator.prepareEntity(entity);}recomputeSingleChangeSet(entity){const changeSet=this.changeSets.get(entity);if(!changeSet){return}const cs=this.changeSetComputer.computeChangeSet(entity);if(cs&&!this.checkUniqueProps(changeSet)){this.checkOrphanRemoval(cs);Object.assign(changeSet.payload,cs.payload);entity.__helper.__originalEntityData=this.comparator.prepareEntity(entity);}}persist(entity,visited=new WeakSet,checkRemoveStack=false){if(this.persistStack.has(entity)){return}if(checkRemoveStack&&this.removeStack.has(entity)){return}this.persistStack.add(entity);this.removeStack.delete(entity);this.cascade(entity,enums_1$c.Cascade.PERSIST,visited,{checkRemoveStack:true});}remove(entity,visited=new WeakSet){if(!entity||this.removeStack.has(entity)){return}if(entity.__helper.hasPrimaryKey()){this.removeStack.add(entity);}this.persistStack.delete(entity);this.cascade(entity,enums_1$c.Cascade.REMOVE,visited);}async commit(){if(this.working){throw errors_1$2.ValidationError.cannotCommit()}const oldTx=this.em.getTransactionContext();try{await this.eventManager.dispatchEvent(enums_1$c.EventType.beforeFlush,{em:this.em,uow:this});this.working=true;this.computeChangeSets();await this.eventManager.dispatchEvent(enums_1$c.EventType.onFlush,{em:this.em,uow:this});if(this.changeSets.size===0&&this.collectionUpdates.size===0&&this.collectionDeletions.size===0&&this.extraUpdates.size===0){return void(await this.eventManager.dispatchEvent(enums_1$c.EventType.afterFlush,{em:this.em,uow:this}))}const groups=this.getChangeSetGroups();const platform=this.em.getPlatform();const runInTransaction=!this.em.isInTransaction()&&platform.supportsTransactions()&&this.em.config.get("implicitTransactions");if(runInTransaction){await this.em.getConnection("write").transactional(trx=>this.persistToDatabase(groups,trx),oldTx,new events_1$1.TransactionEventBroadcaster(this.em,this));}else {await this.persistToDatabase(groups,this.em.getTransactionContext());}this.resetTransaction(oldTx);await this.eventManager.dispatchEvent(enums_1$c.EventType.afterFlush,{em:this.em,uow:this});}finally{this.postCommitCleanup();this.resetTransaction(oldTx);}}async lock(entity,mode,version){if(!this.getById(entity.constructor.name,entity.__helper.__primaryKeys)){throw errors_1$2.ValidationError.entityNotManaged(entity)}const meta=this.metadata.find(entity.constructor.name);if(mode===enums_1$c.LockMode.OPTIMISTIC){await this.lockOptimistic(entity,meta,version);}else if([enums_1$c.LockMode.NONE,enums_1$c.LockMode.PESSIMISTIC_READ,enums_1$c.LockMode.PESSIMISTIC_WRITE].includes(mode)){await this.lockPessimistic(entity,mode);}}clear(){this.identityMap.clear();this.postCommitCleanup();}unsetIdentity(entity){this.identityMap.delete(entity);const wrapped=entity.__helper;wrapped.__meta.relations.filter(prop=>prop.mappedBy&&entity[prop.name]&&entity[prop.name][prop.mappedBy]).forEach(prop=>delete entity[prop.name][prop.mappedBy]);delete wrapped.__identifier;delete wrapped.__originalEntityData;}computeChangeSets(){this.changeSets.clear();for(const entity of this.identityMap){if(!this.removeStack.has(entity)&&!this.orphanRemoveStack.has(entity)){this.persistStack.add(entity);this.cascade(entity,enums_1$c.Cascade.PERSIST,new WeakSet,{checkRemoveStack:true});}}for(const entity of this.persistStack){this.findNewEntities(entity);}for(const entity of this.orphanRemoveStack){this.remove(entity);}for(const entity of this.removeStack){const meta=this.metadata.find(entity.constructor.name);this.changeSets.set(entity,new ChangeSet_1.ChangeSet(entity,ChangeSet_1.ChangeSetType.DELETE,{},meta));}}scheduleExtraUpdate(changeSet,props){if(props.length===0){return}this.extraUpdates.add([changeSet.entity,props.map(p=>p.name),props.map(p=>changeSet.entity[p.name])]);props.forEach(p=>delete changeSet.entity[p.name]);props.forEach(p=>delete changeSet.payload[p.name]);}scheduleOrphanRemoval(entity){if(entity){this.orphanRemoveStack.add(entity);}}cancelOrphanRemoval(entity){this.orphanRemoveStack.delete(entity);}scheduleCollectionDeletion(collection){this.collectionDeletions.add(collection);}getScheduledCollectionDeletions(){return [...this.collectionDeletions]}findNewEntities(entity,visited=new WeakSet){if(visited.has(entity)){return}visited.add(entity);const wrapped=entity.__helper;if(!wrapped.__initialized||this.removeStack.has(entity)||this.orphanRemoveStack.has(entity)){return}this.initIdentifier(entity);for(const prop of entity.__meta.relations){const reference=entity_1$2.Reference.unwrapReference(entity[prop.name]);this.processReference(entity,prop,reference,visited);}const changeSet=this.changeSetComputer.computeChangeSet(entity);if(changeSet&&!this.checkUniqueProps(changeSet)){this.checkOrphanRemoval(changeSet);this.changeSets.set(entity,changeSet);this.persistStack.delete(entity);}}checkUniqueProps(changeSet){if(this.platform.allowsUniqueBatchUpdates()||changeSet.type!==ChangeSet_1.ChangeSetType.UPDATE){return false}const uniqueProps=changeSet.entity.__meta.props.filter(prop=>prop.unique&&prop.nullable&&changeSet.payload[prop.name]!=null);this.scheduleExtraUpdate(changeSet,uniqueProps);return changeSet.type===ChangeSet_1.ChangeSetType.UPDATE&&!Utils_1$4.Utils.hasObjectKeys(changeSet.payload)}checkOrphanRemoval(changeSet){const meta=this.metadata.find(changeSet.name);const props=meta.relations.filter(prop=>prop.reference===enums_1$c.ReferenceType.ONE_TO_ONE);for(const prop of props){const data=changeSet.entity.__helper.__originalEntityData;if(prop.orphanRemoval&&data&&data[prop.name]&&prop.name in changeSet.payload){const orphan=this.getById(prop.type,data[prop.name]);this.scheduleOrphanRemoval(orphan);}}}initIdentifier(entity){const wrapped=entity.__helper;if(wrapped.__identifier||wrapped.hasPrimaryKey()){return}wrapped.__identifier=new entity_1$2.EntityIdentifier;}processReference(parent,prop,reference,visited){const isToOne=prop.reference===enums_1$c.ReferenceType.MANY_TO_ONE||prop.reference===enums_1$c.ReferenceType.ONE_TO_ONE;if(isToOne&&Utils_1$4.Utils.isEntity(reference)){return this.processToOneReference(reference,visited)}if(Utils_1$4.Utils.isCollection(reference,prop,enums_1$c.ReferenceType.MANY_TO_MANY)&&reference.isDirty()){this.processToManyReference(reference,visited,parent,prop);}}processToOneReference(reference,visited){if(!reference.__helper.__managed){this.findNewEntities(reference,visited);}}processToManyReference(reference,visited,parent,prop){if(this.isCollectionSelfReferenced(reference,visited)){this.extraUpdates.add([parent,prop.name,reference]);parent[prop.name]=new entity_1$2.Collection(parent);return}reference.getItems(false).filter(item=>!item.__helper.__originalEntityData).forEach(item=>this.findNewEntities(item,visited));}async runHooks(type,changeSet,sync=false){const hasListeners=this.eventManager.hasListeners(type,changeSet.entity.__meta);if(!hasListeners){return}if(!sync){return this.eventManager.dispatchEvent(type,{entity:changeSet.entity,em:this.em,changeSet})}const copy=this.comparator.prepareEntity(changeSet.entity);await this.eventManager.dispatchEvent(type,{entity:changeSet.entity,em:this.em,changeSet});const current=this.comparator.prepareEntity(changeSet.entity);const diff=this.comparator.diffEntities(changeSet.name,copy,current);Object.assign(changeSet.payload,diff);const wrapped=changeSet.entity.__helper;if(wrapped.__identifier&&diff[wrapped.__meta.primaryKeys[0]]){wrapped.__identifier.setValue(diff[wrapped.__meta.primaryKeys[0]]);}}postCommitCleanup(){this.persistStack.clear();this.removeStack.clear();this.orphanRemoveStack.clear();this.changeSets.clear();this.collectionUpdates.clear();this.collectionDeletions.clear();this.extraUpdates.clear();this.working=false;}cascade(entity,type,visited,options={}){if(visited.has(entity)){return}visited.add(entity);switch(type){case enums_1$c.Cascade.PERSIST:this.persist(entity,visited,options.checkRemoveStack);break;case enums_1$c.Cascade.MERGE:this.merge(entity,visited);break;case enums_1$c.Cascade.REMOVE:this.remove(entity,visited);break;}for(const prop of entity.__meta.relations){this.cascadeReference(entity,prop,type,visited,options);}}cascadeReference(entity,prop,type,visited,options){this.fixMissingReference(entity,prop);if(!this.shouldCascade(prop,type)){return}const reference=entity_1$2.Reference.unwrapReference(entity[prop.name]);if([enums_1$c.ReferenceType.MANY_TO_ONE,enums_1$c.ReferenceType.ONE_TO_ONE].includes(prop.reference)&&Utils_1$4.Utils.isEntity(reference)){return this.cascade(reference,type,visited,options)}const collection=reference;const requireFullyInitialized=type===enums_1$c.Cascade.PERSIST;if([enums_1$c.ReferenceType.ONE_TO_MANY,enums_1$c.ReferenceType.MANY_TO_MANY].includes(prop.reference)&&collection){if(type===enums_1$c.Cascade.MERGE&&collection.isInitialized()){collection.populated();}collection.getItems(false).filter(item=>!requireFullyInitialized||item.__helper.__initialized).forEach(item=>this.cascade(item,type,visited,options));}}isCollectionSelfReferenced(collection,visited){const filtered=collection.getItems(false).filter(item=>!item.__helper.__originalEntityData);return filtered.some(items=>visited.has(items))}shouldCascade(prop,type){if(type===enums_1$c.Cascade.REMOVE&&prop.orphanRemoval){return true}if(type===enums_1$c.Cascade.MERGE){return true}return prop.cascade&&(prop.cascade.includes(type)||prop.cascade.includes(enums_1$c.Cascade.ALL))}async lockPessimistic(entity,mode){if(!this.em.isInTransaction()){throw errors_1$2.ValidationError.transactionRequired()}await this.em.getDriver().lockPessimistic(entity,mode,this.em.getTransactionContext());}async lockOptimistic(entity,meta,version){if(!meta.versionProperty){throw errors_1$2.OptimisticLockError.notVersioned(meta)}if(!Utils_1$4.Utils.isDefined(version)){return}const wrapped=entity.__helper;if(!wrapped.__initialized){await wrapped.init();}const previousVersion=entity[meta.versionProperty];if(previousVersion!==version){throw errors_1$2.OptimisticLockError.lockFailedVersionMismatch(entity,version,previousVersion)}}fixMissingReference(entity,prop){const reference=entity_1$2.Reference.unwrapReference(entity[prop.name]);if([enums_1$c.ReferenceType.MANY_TO_ONE,enums_1$c.ReferenceType.ONE_TO_ONE].includes(prop.reference)&&reference&&!Utils_1$4.Utils.isEntity(reference)&&!prop.mapToPk){entity[prop.name]=this.em.getReference(prop.type,reference,!!prop.wrappedReference);}const isCollection=[enums_1$c.ReferenceType.ONE_TO_MANY,enums_1$c.ReferenceType.MANY_TO_MANY].includes(prop.reference);if(isCollection&&Array.isArray(reference)){const collection=new entity_1$2.Collection(entity);entity[prop.name]=collection;collection.set(reference);}}async persistToDatabase(groups,tx){var _a,_b,_c;if(tx){this.em.setTransactionContext(tx);}const commitOrder=this.getCommitOrder();const commitOrderReversed=[...commitOrder].reverse();for(const coll of this.collectionDeletions){await this.em.getDriver().clearCollection(coll,tx);coll.takeSnapshot();}for(const name of commitOrder){await this.commitCreateChangeSets((_a=groups[ChangeSet_1.ChangeSetType.CREATE].get(name))!==null&&_a!==void 0?_a:[],tx);}for(const name of commitOrder){await this.commitUpdateChangeSets((_b=groups[ChangeSet_1.ChangeSetType.UPDATE].get(name))!==null&&_b!==void 0?_b:[],tx);}const extraUpdates=[];for(const extraUpdate of this.extraUpdates){if(Array.isArray(extraUpdate[1])){extraUpdate[1].forEach((p,i)=>extraUpdate[0][p]=extraUpdate[2][i]);}else {extraUpdate[0][extraUpdate[1]]=extraUpdate[2];}const changeSet=this.changeSetComputer.computeChangeSet(extraUpdate[0]);if(changeSet){extraUpdates.push(changeSet);}}await this.commitUpdateChangeSets(extraUpdates,tx,false);for(const coll of this.collectionUpdates){await this.em.getDriver().syncCollection(coll,tx);coll.takeSnapshot();}for(const name of commitOrderReversed){await this.commitDeleteChangeSets((_c=groups[ChangeSet_1.ChangeSetType.DELETE].get(name))!==null&&_c!==void 0?_c:[],tx);}for(const changeSet of this.changeSets.values()){this.takeCollectionSnapshots(changeSet);}}async commitCreateChangeSets(changeSets,ctx){if(changeSets.length===0){return}const meta=changeSets[0].entity.__meta;const props=meta.relations.filter(prop=>{return prop.reference===enums_1$c.ReferenceType.ONE_TO_ONE&&prop.owner||prop.reference===enums_1$c.ReferenceType.MANY_TO_ONE});for(const changeSet of changeSets){this.findExtraUpdates(changeSet,props);await this.runHooks(enums_1$c.EventType.beforeCreate,changeSet,true);}await this.changeSetPersister.executeInserts(changeSets,ctx);for(const changeSet of changeSets){this.registerManaged(changeSet.entity,changeSet.payload,true);await this.runHooks(enums_1$c.EventType.afterCreate,changeSet);}}findExtraUpdates(changeSet,props){for(const prop of props){if(!changeSet.entity[prop.name]){continue}const cs=this.changeSets.get(entity_1$2.Reference.unwrapReference(changeSet.entity[prop.name]));const isScheduledForInsert=cs&&cs.type===ChangeSet_1.ChangeSetType.CREATE&&!cs.persisted;if(isScheduledForInsert){this.scheduleExtraUpdate(changeSet,[prop]);}}}async commitUpdateChangeSets(changeSets,ctx,batched=true){if(changeSets.length===0){return}for(const changeSet of changeSets){await this.runHooks(enums_1$c.EventType.beforeUpdate,changeSet,true);}await this.changeSetPersister.executeUpdates(changeSets,batched,ctx);for(const changeSet of changeSets){changeSet.entity.__helper.__originalEntityData=this.comparator.prepareEntity(changeSet.entity);await this.runHooks(enums_1$c.EventType.afterUpdate,changeSet);}}async commitDeleteChangeSets(changeSets,ctx){if(changeSets.length===0){return}for(const changeSet of changeSets){await this.runHooks(enums_1$c.EventType.beforeDelete,changeSet,true);}await this.changeSetPersister.executeDeletes(changeSets,ctx);for(const changeSet of changeSets){this.unsetIdentity(changeSet.entity);await this.runHooks(enums_1$c.EventType.afterDelete,changeSet);}}getChangeSetGroups(){const groups={[ChangeSet_1.ChangeSetType.CREATE]:new Map,[ChangeSet_1.ChangeSetType.UPDATE]:new Map,[ChangeSet_1.ChangeSetType.DELETE]:new Map};this.changeSets.forEach(cs=>{var _a;const group=groups[cs.type];const classGroup=(_a=group.get(cs.rootName))!==null&&_a!==void 0?_a:[];classGroup.push(cs);if(!group.has(cs.rootName)){group.set(cs.rootName,classGroup);}});return groups}getCommitOrder(){const calc=new CommitOrderCalculator_1.CommitOrderCalculator;const set=new Set;this.changeSets.forEach(cs=>set.add(cs.rootName));set.forEach(entityName=>calc.addNode(entityName));for(const entityName of set){for(const prop of this.metadata.find(entityName).props){calc.discoverProperty(prop,entityName);}}return calc.sort()}resetTransaction(oldTx){if(oldTx){this.em.setTransactionContext(oldTx);}else {this.em.resetTransactionContext();}}takeCollectionSnapshots(changeSet){changeSet.entity.__meta.relations.forEach(prop=>{const value=changeSet.entity[prop.name];if(Utils_1$4.Utils.isCollection(value)){value.takeSnapshot();}});}}UnitOfWork$1.UnitOfWork=UnitOfWork;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(ChangeSet,exports);__exportStar(ChangeSetComputer$1,exports);__exportStar(ChangeSetPersister$1,exports);__exportStar(CommitOrderCalculator$1,exports);__exportStar(UnitOfWork$1,exports);__exportStar(IdentityMap$1,exports);})(unitOfWork);getDefaultExportFromCjs(unitOfWork);

Object.defineProperty(EntityManager$1,"__esModule",{value:true});EntityManager$1.EntityManager=void 0;const util_1=require$$0__default$2["default"];const utils_1$8=utils$m;const entity_1$1=entity;const unit_of_work_1=unitOfWork;const enums_1$b=enums;const events_1=events;const EntityComparator_1=EntityComparator$1;const errors_1$1=errors;class EntityManager{constructor(config,driver,metadata,useContext=true,eventManager=new events_1.EventManager(config.get("subscribers"))){this.config=config;this.driver=driver;this.metadata=metadata;this.useContext=useContext;this.eventManager=eventManager;this.id=EntityManager.counter++;this.name=this.config.get("contextName");this.validator=new entity_1$1.EntityValidator(this.config.get("strict"));this.repositoryMap={};this.entityLoader=new entity_1$1.EntityLoader(this);this.comparator=new EntityComparator_1.EntityComparator(this.metadata,this.driver.getPlatform());this.unitOfWork=new unit_of_work_1.UnitOfWork(this);this.entityFactory=new entity_1$1.EntityFactory(this.unitOfWork,this);this.resultCache=this.config.getResultCacheAdapter();this.filters={};this.filterParams={};}getDriver(){return this.driver}getConnection(type){return this.driver.getConnection(type)}getPlatform(){return this.driver.getPlatform()}getRepository(entityName){entityName=utils_1$8.Utils.className(entityName);if(!this.repositoryMap[entityName]){const meta=this.metadata.get(entityName);const RepositoryClass=this.config.getRepositoryClass(meta.customRepository);this.repositoryMap[entityName]=new RepositoryClass(this,entityName);}return this.repositoryMap[entityName]}getValidator(){return this.validator}async find(entityName,where,populate,orderBy,limit,offset){const options=utils_1$8.Utils.isObject(populate)?populate:{populate,orderBy,limit,offset};if(options.disableIdentityMap){const fork=this.fork(false);const ret=await fork.find(entityName,where,Object.assign(Object.assign({},options),{disableIdentityMap:false}));fork.clear();return ret}entityName=utils_1$8.Utils.className(entityName);where=await this.processWhere(entityName,where,options,"read");this.validator.validateParams(where);options.orderBy=options.orderBy||{};options.populate=this.preparePopulate(entityName,options.populate,options.strategy);const cached=await this.tryCache(entityName,options.cache,[entityName,"em.find",options,where],options.refresh,true);if(cached===null||cached===void 0?void 0:cached.data){await this.entityLoader.populate(entityName,cached.data,options.populate,Object.assign(Object.assign({},options),{where,convertCustomTypes:false,lookup:false}));return cached.data}const results=await this.driver.find(entityName,where,options,this.transactionContext);if(results.length===0){await this.storeCache(options.cache,cached,[]);return []}const ret=[];for(const data of results){const entity=this.getEntityFactory().create(entityName,data,{merge:true,refresh:options.refresh,convertCustomTypes:true});this.getUnitOfWork().registerManaged(entity,data,options.refresh);ret.push(entity);}const unique=utils_1$8.Utils.unique(ret);await this.entityLoader.populate(entityName,unique,options.populate,Object.assign(Object.assign({},options),{where,convertCustomTypes:false,lookup:false}));await this.storeCache(options.cache,cached,()=>unique.map(e=>e.__helper.toPOJO()));return unique}addFilter(name,cond,entityName,enabled=true){const options={name,cond,default:enabled};if(entityName){options.entity=utils_1$8.Utils.asArray(entityName).map(n=>utils_1$8.Utils.className(n));}this.filters[name]=options;}setFilterParams(name,args){this.getContext().filterParams[name]=args;}getFilterParams(name){return this.getContext().filterParams[name]}async processWhere(entityName,where,options,type){var _a;where=utils_1$8.QueryHelper.processWhere(where,entityName,this.metadata,this.driver.getPlatform(),options.convertCustomTypes);where=await this.applyFilters(entityName,where,(_a=options.filters)!==null&&_a!==void 0?_a:{},type);where=await this.applyDiscriminatorCondition(entityName,where);return where}applyDiscriminatorCondition(entityName,where){const meta=this.metadata.find(entityName);if(!meta||!meta.discriminatorValue){return where}const types=Object.values(meta.root.discriminatorMap).map(cls=>this.metadata.find(cls));const children=[];const lookUpChildren=(ret,type)=>{const children=types.filter(meta2=>meta2.extends===type);children.forEach(m=>lookUpChildren(ret,m.className));ret.push(...children.filter(c=>c.discriminatorValue));return children};lookUpChildren(children,meta.className);where[meta.root.discriminatorColumn]=children.length>0?{$in:[meta.discriminatorValue,...children.map(c=>c.discriminatorValue)]}:meta.discriminatorValue;return where}async applyFilters(entityName,where,options,type){const meta=this.metadata.find(entityName);const filters=[];const ret=[];if(!meta){return where}const active=new Set;const push=source=>{const activeFilters=utils_1$8.QueryHelper.getActiveFilters(entityName,options,source).filter(f=>!active.has(f.name));filters.push(...activeFilters);activeFilters.forEach(f=>active.add(f.name));};push(this.config.get("filters"));push(this.filters);push(meta.filters);if(filters.length===0){return where}for(const filter of filters){let cond;if(filter.cond instanceof Function){const args=utils_1$8.Utils.isPlainObject(options[filter.name])?options[filter.name]:this.getContext().filterParams[filter.name];if(!args&&filter.cond.length>0&&filter.args!==false){throw new Error(`No arguments provided for filter '${filter.name}'`)}cond=await filter.cond(args,type);}else {cond=filter.cond;}ret.push(utils_1$8.QueryHelper.processWhere(cond,entityName,this.metadata,this.driver.getPlatform()));}const conds=[...ret,where].filter(c=>utils_1$8.Utils.hasObjectKeys(c));return conds.length>1?{$and:conds}:conds[0]}async findAndCount(entityName,where,populate,orderBy,limit,offset){const options=utils_1$8.Utils.isObject(populate)?populate:{populate,orderBy,limit,offset};const[entities,count]=await Promise.all([this.find(entityName,where,populate,orderBy,limit,offset),this.count(entityName,where,options)]);return [entities,count]}async findOne(entityName,where,populate,orderBy){const options=utils_1$8.Utils.isObject(populate)?populate:{populate,orderBy};if(options.disableIdentityMap){const fork=this.fork(false);const ret=await fork.findOne(entityName,where,Object.assign(Object.assign({},options),{disableIdentityMap:false}));fork.clear();return ret}entityName=utils_1$8.Utils.className(entityName);const meta=this.metadata.get(entityName);where=await this.processWhere(entityName,where,options,"read");this.validator.validateEmptyWhere(where);this.checkLockRequirements(options.lockMode,meta);let entity=this.getUnitOfWork().tryGetById(entityName,where);const isOptimisticLocking=!utils_1$8.Utils.isDefined(options.lockMode)||options.lockMode===enums_1$b.LockMode.OPTIMISTIC;if(entity&&entity.__helper.__initialized&&!options.refresh&&isOptimisticLocking){return this.lockAndPopulate(entityName,entity,where,options)}this.validator.validateParams(where);options.populate=this.preparePopulate(entityName,options.populate,options.strategy);const cached=await this.tryCache(entityName,options.cache,[entityName,"em.findOne",options,where],options.refresh,true);if(cached===null||cached===void 0?void 0:cached.data){await this.entityLoader.populate(entityName,[cached.data],options.populate,Object.assign(Object.assign({},options),{where,convertCustomTypes:false,lookup:false}));return cached.data}const data=await this.driver.findOne(entityName,where,options,this.transactionContext);if(!data){await this.storeCache(options.cache,cached,null);return null}entity=this.getEntityFactory().create(entityName,data,{refresh:options.refresh,merge:true,convertCustomTypes:true});this.getUnitOfWork().registerManaged(entity,data,options.refresh);await this.lockAndPopulate(entityName,entity,where,options);await this.storeCache(options.cache,cached,()=>entity.__helper.toPOJO());return entity}async findOneOrFail(entityName,where,populate,orderBy){const entity=await this.findOne(entityName,where,populate,orderBy);if(!entity){const options=utils_1$8.Utils.isObject(populate)?populate:{};options.failHandler=options.failHandler||this.config.get("findOneOrFailHandler");entityName=utils_1$8.Utils.className(entityName);throw options.failHandler(entityName,where)}return entity}async transactional(cb,ctx=this.transactionContext){const em=this.fork(false);return utils_1$8.TransactionContext.createAsync(em,async()=>{return em.getConnection().transactional(async trx=>{em.transactionContext=trx;const ret=await cb(em);await em.flush();return ret},ctx,new events_1.TransactionEventBroadcaster(em))})}async begin(ctx){this.transactionContext=await this.getConnection("write").begin(ctx,new events_1.TransactionEventBroadcaster(this));}async commit(){await this.flush();await this.getConnection("write").commit(this.transactionContext,new events_1.TransactionEventBroadcaster(this));delete this.transactionContext;}async rollback(){await this.getConnection("write").rollback(this.transactionContext,new events_1.TransactionEventBroadcaster(this));delete this.transactionContext;}async lock(entity,lockMode,lockVersion){await this.getUnitOfWork().lock(entity,lockMode,lockVersion);}async nativeInsert(entityNameOrEntity,data){let entityName;if(data===undefined){entityName=entityNameOrEntity.constructor.name;data=this.comparator.prepareEntity(entityNameOrEntity);}else {entityName=utils_1$8.Utils.className(entityNameOrEntity);}data=utils_1$8.QueryHelper.processObjectParams(data);this.validator.validateParams(data,"insert data");const res=await this.driver.nativeInsert(entityName,data,this.transactionContext);return res.insertId}async nativeUpdate(entityName,where,data,options={}){entityName=utils_1$8.Utils.className(entityName);data=utils_1$8.QueryHelper.processObjectParams(data);where=await this.processWhere(entityName,where,options,"update");this.validator.validateParams(data,"update data");this.validator.validateParams(where,"update condition");const res=await this.driver.nativeUpdate(entityName,where,data,this.transactionContext);return res.affectedRows}async nativeDelete(entityName,where,options={}){entityName=utils_1$8.Utils.className(entityName);where=await this.processWhere(entityName,where,options,"delete");this.validator.validateParams(where,"delete condition");const res=await this.driver.nativeDelete(entityName,where,this.transactionContext);return res.affectedRows}map(entityName,result){entityName=utils_1$8.Utils.className(entityName);const meta=this.metadata.get(entityName);const data=this.driver.mapResult(result,meta);Object.keys(data).forEach(k=>{const prop=meta.properties[k];if(prop&&prop.reference===enums_1$b.ReferenceType.SCALAR&&enums_1$b.SCALAR_TYPES.includes(prop.type)&&(prop.setter||!prop.getter)){data[k]=this.validator.validateProperty(prop,data[k],data);}});return this.merge(entityName,data,true,true)}merge(entityName,data,refresh,convertCustomTypes){if(utils_1$8.Utils.isEntity(entityName)){return this.merge(entityName.constructor.name,entityName,data)}entityName=utils_1$8.Utils.className(entityName);this.validator.validatePrimaryKey(data,this.metadata.get(entityName));let entity=this.getUnitOfWork().tryGetById(entityName,data,false);if(entity&&entity.__helper.__initialized&&!refresh){return entity}const meta=this.metadata.find(entityName);const childMeta=this.metadata.getByDiscriminatorColumn(meta,data);entity=utils_1$8.Utils.isEntity(data)?data:this.getEntityFactory().create(entityName,data,{merge:true,refresh,convertCustomTypes});this.validator.validate(entity,data,childMeta!==null&&childMeta!==void 0?childMeta:meta);this.getUnitOfWork().merge(entity);return entity}create(entityName,data,options={}){return this.getEntityFactory().create(entityName,data,Object.assign(Object.assign({},options),{newEntity:!options.managed}))}assign(entity,data,options={}){return entity_1$1.EntityAssigner.assign(entity,data,Object.assign({em:this},options))}getReference(entityName,id,wrapped=false,convertCustomTypes=false){const meta=this.metadata.get(utils_1$8.Utils.className(entityName));if(utils_1$8.Utils.isPrimaryKey(id)){if(meta.compositePK){throw errors_1$1.ValidationError.invalidCompositeIdentifier(meta)}id=[id];}const entity=this.getEntityFactory().createReference(entityName,id,{merge:true,convertCustomTypes});if(wrapped){return entity_1$1.Reference.create(entity)}return entity}async count(entityName,where={},options={}){entityName=utils_1$8.Utils.className(entityName);where=await this.processWhere(entityName,where,options,"read");options.populate=this.preparePopulate(entityName,options.populate);this.validator.validateParams(where);const cached=await this.tryCache(entityName,options.cache,[entityName,"em.count",options,where]);if(cached===null||cached===void 0?void 0:cached.data){return cached.data}const count=await this.driver.count(entityName,where,options,this.transactionContext);await this.storeCache(options.cache,cached,()=>count);return count}persist(entity){if(utils_1$8.Utils.isEntity(entity)){this.getUnitOfWork().persist(entity);return this}const entities=utils_1$8.Utils.asArray(entity);for(const ent of entities){if(!utils_1$8.Utils.isEntity(ent,true)){const meta=typeof ent==="object"?this.metadata.find(ent.constructor.name):undefined;throw errors_1$1.ValidationError.notDiscoveredEntity(ent,meta)}this.getUnitOfWork().persist(entity_1$1.Reference.unwrapReference(ent));}return this}async persistAndFlush(entity){await this.persist(entity).flush();}persistLater(entity){this.persist(entity);}remove(entity){const entities=utils_1$8.Utils.asArray(entity,true);for(const ent of entities){if(!utils_1$8.Utils.isEntity(ent,true)){throw new Error(`You need to pass entity instance or reference to 'em.remove()'. To remove entities by condition, use 'em.nativeDelete()'.`)}this.getUnitOfWork().remove(entity_1$1.Reference.unwrapReference(ent));}return this}async removeAndFlush(entity){await this.remove(entity).flush();}removeLater(entity){this.remove(entity);}async flush(){await this.getUnitOfWork().commit();}clear(){this.getUnitOfWork().clear();}canPopulate(entityName,property){entityName=utils_1$8.Utils.className(entityName);const[p,...parts]=property.split(".");const props=this.metadata.get(entityName).properties;const ret=p in props&&(props[p].reference!==enums_1$b.ReferenceType.SCALAR||props[p].lazy);if(!ret){return false}if(parts.length>0){return this.canPopulate(props[p].type,parts.join("."))}return ret}async populate(entities,populate,where={},orderBy={},refresh=false,validate=true){const entitiesArray=utils_1$8.Utils.asArray(entities);if(entitiesArray.length===0){return entities}populate=utils_1$8.Utils.isString(populate)?utils_1$8.Utils.asArray(populate):populate;const entityName=entitiesArray[0].constructor.name;const preparedPopulate=this.preparePopulate(entityName,populate);await this.entityLoader.populate(entityName,entitiesArray,preparedPopulate,{where,orderBy,refresh,validate,convertCustomTypes:false});return entities}fork(clear=true,useContext=false){const em=new this.constructor(this.config,this.driver,this.metadata,useContext,this.eventManager);em.filters=Object.assign({},this.filters);em.filterParams=utils_1$8.Utils.copy(this.filterParams);if(!clear){for(const entity of this.getUnitOfWork().getIdentityMap()){em.merge(entity);}}return em}getUnitOfWork(){return this.getContext().unitOfWork}getEntityFactory(){return this.getContext().entityFactory}getContext(){let em=utils_1$8.TransactionContext.getEntityManager();if(!em){em=this.useContext?this.config.get("context")(this.name)||this:this;}return em}getEventManager(){return this.eventManager}isInTransaction(){return !!this.transactionContext}getTransactionContext(){return this.transactionContext}setTransactionContext(ctx){this.transactionContext=ctx;}resetTransactionContext(){delete this.transactionContext;}getMetadata(){return this.metadata}getComparator(){return this.comparator}checkLockRequirements(mode,meta){if(!mode){return}if(mode===enums_1$b.LockMode.OPTIMISTIC&&!meta.versionProperty){throw errors_1$1.OptimisticLockError.notVersioned(meta)}if([enums_1$b.LockMode.PESSIMISTIC_READ,enums_1$b.LockMode.PESSIMISTIC_WRITE].includes(mode)&&!this.isInTransaction()){throw errors_1$1.ValidationError.transactionRequired()}}async lockAndPopulate(entityName,entity,where,options){if(options.lockMode===enums_1$b.LockMode.OPTIMISTIC){await this.lock(entity,options.lockMode,options.lockVersion);}const preparedPopulate=this.preparePopulate(entityName,options.populate,options.strategy);await this.entityLoader.populate(entityName,[entity],preparedPopulate,Object.assign(Object.assign({},options),{where,convertCustomTypes:false,lookup:false}));return entity}preparePopulate(entityName,populate,strategy){const meta=this.metadata.get(entityName);if(!populate){return this.entityLoader.normalizePopulate(entityName,[])}if(utils_1$8.Utils.isPlainObject(populate)){return this.preparePopulateObject(meta,populate,strategy)}if(Array.isArray(populate)){populate=populate.map(field=>{if(utils_1$8.Utils.isString(field)){return {field}}return field});}const ret=this.entityLoader.normalizePopulate(entityName,populate);return ret.map(field=>{var _a;field.strategy=(_a=strategy!==null&&strategy!==void 0?strategy:field.strategy)!==null&&_a!==void 0?_a:this.config.get("loadStrategy");return field})}preparePopulateObject(meta,populate,strategy){return Object.keys(populate).map(field=>{var _a;const prop=meta.properties[field];const fieldStrategy=(_a=strategy!==null&&strategy!==void 0?strategy:utils_1$8.Utils.isString(populate[field])?populate[field]:prop.strategy)!==null&&_a!==void 0?_a:this.config.get("loadStrategy");if(populate[field]===true){return {field,strategy:fieldStrategy}}if(utils_1$8.Utils.isPlainObject(populate[field])){const meta2=this.metadata.get(prop.type);return {field,strategy:fieldStrategy,children:this.preparePopulateObject(meta2,populate[field],strategy)}}return {field,strategy:fieldStrategy}})}async tryCache(entityName,config,key,refresh,merge){if(!config){return undefined}const cacheKey=Array.isArray(config)?config[0]:JSON.stringify(key);const cached=await this.resultCache.get(cacheKey);if(cached){let data;if(Array.isArray(cached)&&merge){data=cached.map(item=>this.getEntityFactory().create(entityName,item,{merge:true,convertCustomTypes:true,refresh}));}else if(utils_1$8.Utils.isObject(cached)&&merge){data=this.getEntityFactory().create(entityName,cached,{merge:true,convertCustomTypes:true,refresh});}else {data=cached;}return {key:cacheKey,data}}return {key:cacheKey}}async storeCache(config,key,data){if(config){const expiration=Array.isArray(config)?config[1]:utils_1$8.Utils.isNumber(config)?config:undefined;await this.resultCache.set(key.key,data instanceof Function?data():data,"",expiration);}}[util_1.inspect.custom](){return `[EntityManager<${this.id}>]`}}EntityManager$1.EntityManager=EntityManager;EntityManager.counter=1;

var drivers = {};

var IDatabaseDriver = {};

Object.defineProperty(IDatabaseDriver,"__esModule",{value:true});IDatabaseDriver.EntityManagerType=void 0;IDatabaseDriver.EntityManagerType=Symbol("EntityManagerType");

var DatabaseDriver$1 = {};

Object.defineProperty(DatabaseDriver$1,"__esModule",{value:true});DatabaseDriver$1.DatabaseDriver=void 0;const utils_1$7=utils$m;const enums_1$a=enums;const EntityManager_1=EntityManager$1;const errors_1=errors;const exceptions_1$1=exceptions;class DatabaseDriver{constructor(config,dependencies){this.config=config;this.dependencies=dependencies;this.replicas=[];this.logger=this.config.getLogger();}async nativeUpdateMany(entityName,where,data,ctx,processCollections,convertCustomTypes){throw new Error(`Batch updates are not supported by ${this.constructor.name} driver`)}createEntityManager(useContext){return new EntityManager_1.EntityManager(this.config,this,this.metadata,useContext)}async aggregate(entityName,pipeline){throw new Error(`Aggregations are not supported by ${this.constructor.name} driver`)}async loadFromPivotTable(prop,owners,where,orderBy,ctx,options){throw new Error(`${this.constructor.name} does not use pivot tables`)}async syncCollection(coll,ctx){const pk=this.metadata.find(coll.property.type).primaryKeys[0];const data={[coll.property.name]:coll.getIdentifiers(pk)};await this.nativeUpdate(coll.owner.constructor.name,coll.owner.__helper.getPrimaryKey(),data,ctx);}async clearCollection(coll,ctx){const snapshot=coll.getSnapshot();const deleteDiff=snapshot?snapshot.map(item=>item.__helper.__primaryKeyCond):[];const cond={[utils_1$7.Utils.getPrimaryKeyHash(coll.property.targetMeta.primaryKeys)]:deleteDiff};await this.nativeDelete(coll.property.type,cond,ctx);}mapResult(result,meta,populate=[]){if(!result||!meta){return null}return this.comparator.mapResult(meta.className,result)}async connect(){await this.connection.connect();await Promise.all(this.replicas.map(replica=>replica.connect()));return this.connection}async reconnect(){await this.close(true);return this.connect()}getConnection(type="write"){if(type==="write"||this.replicas.length===0){return this.connection}const rand=utils_1$7.Utils.randomInt(0,this.replicas.length-1);return this.replicas[rand]}async close(force){var _a,_b;await Promise.all(this.replicas.map(replica=>replica.close(force)));await this.connection.close(force);if((_a=this.config.getCacheAdapter())===null||_a===void 0?void 0:_a.close){await this.config.getCacheAdapter().close();}if((_b=this.config.getResultCacheAdapter())===null||_b===void 0?void 0:_b.close){await this.config.getResultCacheAdapter().close();}}getPlatform(){return this.platform}setMetadata(metadata){this.metadata=metadata;this.comparator=new utils_1$7.EntityComparator(this.metadata,this.platform);this.connection.setMetadata(metadata);this.connection.setPlatform(this.platform);this.replicas.forEach(replica=>{replica.setMetadata(metadata);replica.setPlatform(this.platform);});}getDependencies(){return this.dependencies}async ensureIndexes(){throw new Error(`${this.constructor.name} does not use ensureIndexes`)}inlineEmbeddables(meta,data,where){Object.keys(data).forEach(k=>{if(utils_1$7.Utils.isOperator(k)){utils_1$7.Utils.asArray(data[k]).forEach(payload=>this.inlineEmbeddables(meta,payload,where));}});meta.props.forEach(prop=>{if(prop.reference===enums_1$a.ReferenceType.EMBEDDED&&prop.object&&!where&&utils_1$7.Utils.isObject(data[prop.name])){return}if(prop.reference===enums_1$a.ReferenceType.EMBEDDED&&utils_1$7.Utils.isObject(data[prop.name])){const props=prop.embeddedProps;Object.keys(data[prop.name]).forEach(kk=>{const operator=Object.keys(data[prop.name]).some(f=>utils_1$7.Utils.isOperator(f));if(operator){throw errors_1.ValidationError.cannotUseOperatorsInsideEmbeddables(meta.name,prop.name,data)}if(prop.object&&where){const inline=(payload,sub,path)=>{if(sub.reference===enums_1$a.ReferenceType.EMBEDDED&&utils_1$7.Utils.isObject(payload[sub.embedded[1]])){return Object.keys(payload[sub.embedded[1]]).forEach(kkk=>{if(!sub.embeddedProps[kkk]){throw errors_1.ValidationError.invalidEmbeddableQuery(meta.className,kkk,sub.type)}inline(payload[sub.embedded[1]],sub.embeddedProps[kkk],[...path,sub.embedded[1]]);})}data[`${path.join(".")}.${sub.embedded[1]}`]=payload[sub.embedded[1]];};inline(data[prop.name],props[kk],[prop.name]);}else if(props[kk]){data[props[kk].name]=data[prop.name][props[kk].embedded[1]];}else {throw errors_1.ValidationError.invalidEmbeddableQuery(meta.className,kk,prop.type)}});delete data[prop.name];}});}getPivotOrderBy(prop,orderBy){if(orderBy){return orderBy}if(prop.orderBy){return prop.orderBy}if(prop.fixedOrder){return {[`${prop.pivotTable}.${prop.fixedOrderColumn}`]:enums_1$a.QueryOrder.ASC}}return {}}getPrimaryKeyFields(entityName){const meta=this.metadata.find(entityName);return meta?meta.primaryKeys:[this.config.getNamingStrategy().referenceColumnName()]}getPivotInverseProperty(prop){const pivotMeta=this.metadata.find(prop.pivotTable);let inverse;if(prop.owner){const pivotProp1=pivotMeta.properties[prop.type+"_inverse"];inverse=pivotProp1.mappedBy;}else {const pivotProp1=pivotMeta.properties[prop.type+"_owner"];inverse=pivotProp1.inversedBy;}return pivotMeta.properties[inverse]}createReplicas(cb){const replicas=this.config.get("replicas",[]);const ret=[];const props=["dbName","clientUrl","host","port","user","password","multipleStatements","pool","name"];replicas.forEach(conf=>{props.forEach(prop=>conf[prop]=prop in conf?conf[prop]:this.config.get(prop));ret.push(cb(conf));});return ret}async lockPessimistic(entity,mode,ctx){throw new Error(`Pessimistic locks are not supported by ${this.constructor.name} driver`)}shouldHaveColumn(prop,populate,includeFormulas=true){if(prop.formula){return includeFormulas&&(!prop.lazy||populate.some(p=>p.field===prop.name))}if(prop.persist===false){return false}if(prop.lazy&&!populate.some(p=>p.field===prop.name)){return false}return [enums_1$a.ReferenceType.SCALAR,enums_1$a.ReferenceType.MANY_TO_ONE].includes(prop.reference)||prop.reference===enums_1$a.ReferenceType.ONE_TO_ONE&&prop.owner}convertException(exception){if(exception instanceof exceptions_1$1.DriverException){return exception}return this.platform.getExceptionConverter().convertException(exception)}rethrow(promise){return promise.catch(e=>{throw this.convertException(e)})}}DatabaseDriver$1.DatabaseDriver=DatabaseDriver;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(IDatabaseDriver,exports);__exportStar(DatabaseDriver$1,exports);})(drivers);getDefaultExportFromCjs(drivers);

var connections = {};

var Connection$1 = {};

var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(mod){return mod&&mod.__esModule?mod:{"default":mod}};Object.defineProperty(Connection$1,"__esModule",{value:true});Connection$1.Connection=void 0;const url_1=require$$0__default$7["default"];const ansi_colors_1=__importDefault(ansiColors.exports);const utils_1$6=utils$m;class Connection{constructor(config,options,type="write"){this.config=config;this.options=options;this.type=type;if(!this.options){const props=["dbName","clientUrl","host","port","user","password","multipleStatements","pool"];this.options=props.reduce((o,i)=>{o[i]=this.config.get(i);return o},{});}}async transactional(cb,ctx,eventBroadcaster){throw new Error(`Transactions are not supported by current driver`)}async begin(ctx,eventBroadcaster){throw new Error(`Transactions are not supported by current driver`)}async commit(ctx,eventBroadcaster){throw new Error(`Transactions are not supported by current driver`)}async rollback(ctx,eventBroadcaster){throw new Error(`Transactions are not supported by current driver`)}getConnectionOptions(){const ret={};const url=new url_1.URL(this.options.clientUrl||this.config.getClientUrl());this.options.host=ret.host=this.config.get("host",url.hostname);this.options.port=ret.port=this.config.get("port",+url.port);this.options.user=ret.user=this.config.get("user",url.username);this.options.password=ret.password=this.config.get("password",url.password);this.options.dbName=ret.database=this.config.get("dbName",url.pathname.replace(/^\//,""));return ret}getClientUrl(){const options=this.getConnectionOptions();const url=new url_1.URL(this.config.getClientUrl(true));return `${url.protocol}//${options.user}${options.password?":*****":""}@${options.host}:${options.port}`}setMetadata(metadata){this.metadata=metadata;}setPlatform(platform){this.platform=platform;}async executeQuery(query,cb){const now=Date.now();try{const res=await cb();this.logQuery(query,Date.now()-now);return res}catch(e){this.logQuery(ansi_colors_1.default.red(query),Date.now()-now);throw e}}logQuery(query,took){const logger=this.config.getLogger();if(!logger.isEnabled("query")){return}query=this.config.get("highlighter").highlight(query);let msg=query+(utils_1$6.Utils.isDefined(took)?ansi_colors_1.default.grey(` [took ${took} ms]`):"");if(this.config.get("replicas",[]).length>0){msg+=ansi_colors_1.default.cyan(` (via ${this.type} connection '${this.options.name||this.config.get("name")||this.options.host}')`);}logger.log("query",msg);}}Connection$1.Connection=Connection;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(Connection$1,exports);})(connections);getDefaultExportFromCjs(connections);

var platforms = {};

var Platform$1 = {};

var namingStrategy = {};

var NamingStrategy = {};

Object.defineProperty(NamingStrategy,"__esModule",{value:true});

var AbstractNamingStrategy$1 = {};

Object.defineProperty(AbstractNamingStrategy$1,"__esModule",{value:true});AbstractNamingStrategy$1.AbstractNamingStrategy=void 0;class AbstractNamingStrategy{getClassName(file,separator="-"){const name=file.split(".")[0];const ret=name.replace(new RegExp(`${separator}+(\\w)`,"g"),m=>m[1].toUpperCase());return ret.charAt(0).toUpperCase()+ret.slice(1)}classToMigrationName(timestamp){return `Migration${timestamp}`}}AbstractNamingStrategy$1.AbstractNamingStrategy=AbstractNamingStrategy;

var MongoNamingStrategy$1 = {};

Object.defineProperty(MongoNamingStrategy$1,"__esModule",{value:true});MongoNamingStrategy$1.MongoNamingStrategy=void 0;const AbstractNamingStrategy_1$2=AbstractNamingStrategy$1;class MongoNamingStrategy extends AbstractNamingStrategy_1$2.AbstractNamingStrategy{classToTableName(entityName){return entityName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}joinColumnName(propertyName){return propertyName}joinKeyColumnName(entityName,referencedColumnName){return entityName}joinTableName(sourceEntity,targetEntity,propertyName){return ""}propertyToColumnName(propertyName){return propertyName}referenceColumnName(){return "_id"}}MongoNamingStrategy$1.MongoNamingStrategy=MongoNamingStrategy;

var UnderscoreNamingStrategy$1 = {};

Object.defineProperty(UnderscoreNamingStrategy$1,"__esModule",{value:true});UnderscoreNamingStrategy$1.UnderscoreNamingStrategy=void 0;const AbstractNamingStrategy_1$1=AbstractNamingStrategy$1;class UnderscoreNamingStrategy extends AbstractNamingStrategy_1$1.AbstractNamingStrategy{classToTableName(entityName){return this.underscore(entityName)}joinColumnName(propertyName){return this.underscore(propertyName)+"_"+this.referenceColumnName()}joinKeyColumnName(entityName,referencedColumnName){return this.classToTableName(entityName)+"_"+(referencedColumnName||this.referenceColumnName())}joinTableName(sourceEntity,targetEntity,propertyName){return this.classToTableName(sourceEntity)+"_"+this.classToTableName(propertyName)}propertyToColumnName(propertyName){return this.underscore(propertyName)}referenceColumnName(){return "id"}underscore(name){return name.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()}}UnderscoreNamingStrategy$1.UnderscoreNamingStrategy=UnderscoreNamingStrategy;

var EntityCaseNamingStrategy$1 = {};

Object.defineProperty(EntityCaseNamingStrategy$1,"__esModule",{value:true});EntityCaseNamingStrategy$1.EntityCaseNamingStrategy=void 0;const AbstractNamingStrategy_1=AbstractNamingStrategy$1;class EntityCaseNamingStrategy extends AbstractNamingStrategy_1.AbstractNamingStrategy{classToTableName(entityName){return entityName}joinColumnName(propertyName){return propertyName}joinKeyColumnName(entityName,referencedColumnName,composite=false){const name=entityName.substr(0,1).toLowerCase()+entityName.substr(1);if(composite&&referencedColumnName){return name+"_"+referencedColumnName}return name}joinTableName(sourceEntity,targetEntity,propertyName){return this.classToTableName(sourceEntity)+"_"+this.propertyToColumnName(propertyName)}propertyToColumnName(propertyName){return propertyName}referenceColumnName(){return "id"}}EntityCaseNamingStrategy$1.EntityCaseNamingStrategy=EntityCaseNamingStrategy;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(NamingStrategy,exports);__exportStar(AbstractNamingStrategy$1,exports);__exportStar(MongoNamingStrategy$1,exports);__exportStar(UnderscoreNamingStrategy$1,exports);__exportStar(EntityCaseNamingStrategy$1,exports);})(namingStrategy);getDefaultExportFromCjs(namingStrategy);

var ExceptionConverter$1 = {};

Object.defineProperty(ExceptionConverter$1,"__esModule",{value:true});ExceptionConverter$1.ExceptionConverter=void 0;const exceptions_1=exceptions;class ExceptionConverter{convertException(exception){return new exceptions_1.DriverException(exception)}}ExceptionConverter$1.ExceptionConverter=ExceptionConverter;

Object.defineProperty(Platform$1,"__esModule",{value:true});Platform$1.Platform=void 0;const entity_1=entity;const naming_strategy_1=namingStrategy;const ExceptionConverter_1=ExceptionConverter$1;class Platform{constructor(){this.exceptionConverter=new ExceptionConverter_1.ExceptionConverter;}usesPivotTable(){return false}supportsTransactions(){return true}usesImplicitTransactions(){return true}getNamingStrategy(){return naming_strategy_1.UnderscoreNamingStrategy}usesReturningStatement(){return false}usesCascadeStatement(){return false}getSchemaHelper(){return undefined}requiresNullableForAlteringColumn(){return false}allowsMultiInsert(){return true}usesBatchInserts(){return true}usesBatchUpdates(){return true}usesDefaultKeyword(){return true}normalizePrimaryKey(data){return data}denormalizePrimaryKey(data){return data}getSerializedPrimaryKeyField(field){return field}usesDifferentSerializedPrimaryKey(){return false}getCurrentTimestampSQL(length){return "current_timestamp"+(length?`(${length})`:"")}getDateTypeDeclarationSQL(length){return "date"+(length?`(${length})`:"")}getTimeTypeDeclarationSQL(length){return "time"+(length?`(${length})`:"")}getRegExpOperator(){return "regexp"}quoteVersionValue(value,prop){return value}requiresValuesKeyword(){return false}allowsComparingTuples(){return true}allowsUniqueBatchUpdates(){return true}isBigIntProperty(prop){return prop.columnTypes&&prop.columnTypes[0]==="bigint"}isRaw(value){return typeof value==="object"&&value!==null&&"__raw"in value}getBigIntTypeDeclarationSQL(){return "bigint"}getArrayDeclarationSQL(){return "text"}marshallArray(values){return values.join(",")}unmarshallArray(value){if(value===""){return []}return value.split(",")}getBlobDeclarationSQL(){return "blob"}getJsonDeclarationSQL(){return "json"}getSearchJsonPropertySQL(path,type){return path}getSearchJsonPropertyKey(path,type){return path.join(".")}convertsJsonAutomatically(marshall=false){return !marshall}getRepositoryClass(){return entity_1.EntityRepository}getDefaultCharset(){return "utf8"}getExceptionConverter(){return this.exceptionConverter}getSchemaGenerator(em){throw new Error(`${this.constructor.name} does not support SchemaGenerator`)}getEntityGenerator(em){throw new Error(`${this.constructor.name} does not support EntityGenerator`)}getMigrator(em){throw new Error(`${this.constructor.name} does not support Migrator`)}processDateProperty(value){return value}quoteIdentifier(id,quote="`"){return `${quote}${id.replace(".",`${quote}.${quote}`)}${quote}`}quoteValue(value){return value}cloneEmbeddable(data){return JSON.parse(JSON.stringify(data))}setConfig(config){this.config=config;if(this.config.get("forceUtcTimezone")){this.timezone="Z";}else {this.timezone=this.config.get("timezone");}}}Platform$1.Platform=Platform;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(Platform$1,exports);__exportStar(ExceptionConverter$1,exports);})(platforms);getDefaultExportFromCjs(platforms);

var decorators = {};

var PrimaryKey$1 = {};

Object.defineProperty(PrimaryKey$1,"__esModule",{value:true});PrimaryKey$1.SerializedPrimaryKey=PrimaryKey$1.PrimaryKey=void 0;const metadata_1$e=metadata;const enums_1$9=enums;const Utils_1$3=Utils;function createDecorator$1(options,serialized){return function(target,propertyName){const meta=metadata_1$e.MetadataStorage.getMetadataFromDecorator(target.constructor);metadata_1$e.MetadataValidator.validateSingleDecorator(meta,propertyName,enums_1$9.ReferenceType.SCALAR);const k=serialized?"serializedPrimaryKey":"primary";options[k]=true;meta.properties[propertyName]=Object.assign({name:propertyName,reference:enums_1$9.ReferenceType.SCALAR},options);return Utils_1$3.Utils.propertyDecoratorReturnValue()}}function PrimaryKey(options={}){return createDecorator$1(options,false)}PrimaryKey$1.PrimaryKey=PrimaryKey;function SerializedPrimaryKey(options={}){return createDecorator$1(options,true)}PrimaryKey$1.SerializedPrimaryKey=SerializedPrimaryKey;

var Entity$1 = {};

Object.defineProperty(Entity$1,"__esModule",{value:true});Entity$1.Entity=void 0;const metadata_1$d=metadata;const utils_1$5=utils$m;function Entity(options={}){return function(target){const meta=metadata_1$d.MetadataStorage.getMetadataFromDecorator(target);utils_1$5.Utils.merge(meta,options);meta.class=target;if(!options.abstract||meta.discriminatorColumn){meta.name=target.name;}return target}}Entity$1.Entity=Entity;

var OneToOne$1 = {};

var OneToMany$1 = {};

Object.defineProperty(OneToMany$1,"__esModule",{value:true});OneToMany$1.OneToMany=OneToMany$1.createOneToDecorator=void 0;const metadata_1$c=metadata;const utils_1$4=utils$m;const enums_1$8=enums;function createOneToDecorator(entity,mappedBy,options,reference){return function(target,propertyName){var _a;options=utils_1$4.Utils.isObject(entity)?entity:Object.assign(Object.assign({},options),{entity,mappedBy});const meta=metadata_1$c.MetadataStorage.getMetadataFromDecorator(target.constructor);metadata_1$c.MetadataValidator.validateSingleDecorator(meta,propertyName,reference);const property={name:propertyName,reference};meta.properties[propertyName]=Object.assign((_a=meta.properties[propertyName])!==null&&_a!==void 0?_a:{},property,options);return utils_1$4.Utils.propertyDecoratorReturnValue()}}OneToMany$1.createOneToDecorator=createOneToDecorator;function OneToMany(entity,mappedBy,options={}){return createOneToDecorator(entity,mappedBy,options,enums_1$8.ReferenceType.ONE_TO_MANY)}OneToMany$1.OneToMany=OneToMany;

Object.defineProperty(OneToOne$1,"__esModule",{value:true});OneToOne$1.OneToOne=void 0;const enums_1$7=enums;const OneToMany_1=OneToMany$1;function OneToOne(entity,mappedBy,options={}){return OneToMany_1.createOneToDecorator(entity,mappedBy,options,enums_1$7.ReferenceType.ONE_TO_ONE)}OneToOne$1.OneToOne=OneToOne;

var ManyToOne$1 = {};

Object.defineProperty(ManyToOne$1,"__esModule",{value:true});ManyToOne$1.ManyToOne=void 0;const metadata_1$b=metadata;const utils_1$3=utils$m;const enums_1$6=enums;function ManyToOne(entity={},options={}){return function(target,propertyName){var _a;options=utils_1$3.Utils.isObject(entity)?entity:Object.assign(Object.assign({},options),{entity});const meta=metadata_1$b.MetadataStorage.getMetadataFromDecorator(target.constructor);metadata_1$b.MetadataValidator.validateSingleDecorator(meta,propertyName,enums_1$6.ReferenceType.MANY_TO_ONE);const property={name:propertyName,reference:enums_1$6.ReferenceType.MANY_TO_ONE};meta.properties[propertyName]=Object.assign((_a=meta.properties[propertyName])!==null&&_a!==void 0?_a:{},property,options);return utils_1$3.Utils.propertyDecoratorReturnValue()}}ManyToOne$1.ManyToOne=ManyToOne;

var ManyToMany$1 = {};

Object.defineProperty(ManyToMany$1,"__esModule",{value:true});ManyToMany$1.ManyToMany=void 0;const metadata_1$a=metadata;const utils_1$2=utils$m;const enums_1$5=enums;function ManyToMany(entity,mappedBy,options={}){return function(target,propertyName){var _a;options=utils_1$2.Utils.isObject(entity)?entity:Object.assign(Object.assign({},options),{entity,mappedBy});const meta=metadata_1$a.MetadataStorage.getMetadataFromDecorator(target.constructor);metadata_1$a.MetadataValidator.validateSingleDecorator(meta,propertyName,enums_1$5.ReferenceType.MANY_TO_MANY);const property={name:propertyName,reference:enums_1$5.ReferenceType.MANY_TO_MANY};meta.properties[propertyName]=Object.assign((_a=meta.properties[propertyName])!==null&&_a!==void 0?_a:{},property,options);return utils_1$2.Utils.propertyDecoratorReturnValue()}}ManyToMany$1.ManyToMany=ManyToMany;

var Property$1 = {};

Object.defineProperty(Property$1,"__esModule",{value:true});Property$1.Property=void 0;const metadata_1$9=metadata;const utils_1$1=utils$m;const enums_1$4=enums;function Property(options={}){return function(target,propertyName){const meta=metadata_1$9.MetadataStorage.getMetadataFromDecorator(target.constructor);const desc=Object.getOwnPropertyDescriptor(target,propertyName)||{};metadata_1$9.MetadataValidator.validateSingleDecorator(meta,propertyName,enums_1$4.ReferenceType.SCALAR);const name=options.name||propertyName;if(propertyName!==name&&!(desc.value instanceof Function)){utils_1$1.Utils.renameKey(options,"name","fieldName");}options.name=propertyName;const prop=Object.assign({reference:enums_1$4.ReferenceType.SCALAR},options);prop.getter=!!desc.get;prop.setter=!!desc.set;if(desc.value instanceof Function){prop.getter=true;prop.persist=false;prop.type="method";prop.getterName=propertyName;prop.name=name;}meta.properties[prop.name]=prop;return utils_1$1.Utils.propertyDecoratorReturnValue()}}Property$1.Property=Property;

var Enum$1 = {};

Object.defineProperty(Enum$1,"__esModule",{value:true});Enum$1.Enum=void 0;const metadata_1$8=metadata;const enums_1$3=enums;const Utils_1$2=Utils;function Enum(options={}){return function(target,propertyName){const meta=metadata_1$8.MetadataStorage.getMetadataFromDecorator(target.constructor);options=options instanceof Function?{items:options}:options;meta.properties[propertyName]=Object.assign({name:propertyName,reference:enums_1$3.ReferenceType.SCALAR,enum:true},options);return Utils_1$2.Utils.propertyDecoratorReturnValue()}}Enum$1.Enum=Enum;

var Formula$1 = {};

Object.defineProperty(Formula$1,"__esModule",{value:true});Formula$1.Formula=void 0;const metadata_1$7=metadata;const enums_1$2=enums;const Utils_1$1=Utils;function Formula(formula,options={}){return function(target,propertyName){const meta=metadata_1$7.MetadataStorage.getMetadataFromDecorator(target.constructor);meta.properties[propertyName]=Object.assign({name:propertyName,reference:enums_1$2.ReferenceType.SCALAR,persist:false,formula},options);return Utils_1$1.Utils.propertyDecoratorReturnValue()}}Formula$1.Formula=Formula;

var Indexed = {};

Object.defineProperty(Indexed,"__esModule",{value:true});Indexed.Unique=Indexed.Index=void 0;const metadata_1$6=metadata;const Utils_1=Utils;function createDecorator(options,unique){return function(target,propertyName){const meta=metadata_1$6.MetadataStorage.getMetadataFromDecorator(propertyName?target.constructor:target);options.properties=options.properties||propertyName;const key=unique?"uniques":"indexes";meta[key].push(options);if(!propertyName){return target}return Utils_1.Utils.propertyDecoratorReturnValue()}}function Index(options={}){return createDecorator(options,false)}Indexed.Index=Index;function Unique(options={}){return createDecorator(options,true)}Indexed.Unique=Unique;

var Repository$1 = {};

Object.defineProperty(Repository$1,"__esModule",{value:true});Repository$1.Repository=void 0;const metadata_1$5=metadata;function Repository(entity){return function(target){const meta=metadata_1$5.MetadataStorage.getMetadata(entity.name,entity.__path);meta.customRepository=()=>target;}}Repository$1.Repository=Repository;

var Embeddable$1 = {};

Object.defineProperty(Embeddable$1,"__esModule",{value:true});Embeddable$1.Embeddable=void 0;const metadata_1$4=metadata;function Embeddable(){return function(target){const meta=metadata_1$4.MetadataStorage.getMetadataFromDecorator(target);meta.class=target;meta.name=target.name;meta.embeddable=true;return target}}Embeddable$1.Embeddable=Embeddable;

var Embedded$1 = {};

Object.defineProperty(Embedded$1,"__esModule",{value:true});Embedded$1.Embedded=void 0;const metadata_1$3=metadata;const utils_1=utils$m;const enums_1$1=enums;function Embedded(type={},options={}){return function(target,propertyName){const meta=metadata_1$3.MetadataStorage.getMetadataFromDecorator(target.constructor);metadata_1$3.MetadataValidator.validateSingleDecorator(meta,propertyName,enums_1$1.ReferenceType.EMBEDDED);options=type instanceof Function?Object.assign({entity:type},options):Object.assign(Object.assign({},type),options);utils_1.Utils.defaultValue(options,"prefix",true);const property={name:propertyName,reference:enums_1$1.ReferenceType.EMBEDDED};meta.properties[propertyName]=Object.assign(property,options);return utils_1.Utils.propertyDecoratorReturnValue()}}Embedded$1.Embedded=Embedded;

var Filter$1 = {};

Object.defineProperty(Filter$1,"__esModule",{value:true});Filter$1.Filter=void 0;const metadata_1$2=metadata;function Filter(options){return function(target){const meta=metadata_1$2.MetadataStorage.getMetadataFromDecorator(target);meta.filters[options.name]=options;return target}}Filter$1.Filter=Filter;

var Subscriber$1 = {};

Object.defineProperty(Subscriber$1,"__esModule",{value:true});Subscriber$1.Subscriber=void 0;const metadata_1$1=metadata;function Subscriber(){return function(target){const subscribers=metadata_1$1.MetadataStorage.getSubscriberMetadata();subscribers[target.name]=new target;}}Subscriber$1.Subscriber=Subscriber;

var hooks = {};

Object.defineProperty(hooks,"__esModule",{value:true});hooks.AfterDelete=hooks.BeforeDelete=hooks.OnInit=hooks.AfterUpdate=hooks.BeforeUpdate=hooks.AfterCreate=hooks.BeforeCreate=void 0;const metadata_1=metadata;const enums_1=enums;function hook(type){return function(target,method){const meta=metadata_1.MetadataStorage.getMetadataFromDecorator(target.constructor);if(!meta.hooks[type]){meta.hooks[type]=[];}meta.hooks[type].push(method);}}function BeforeCreate(){return hook(enums_1.EventType.beforeCreate)}hooks.BeforeCreate=BeforeCreate;function AfterCreate(){return hook(enums_1.EventType.afterCreate)}hooks.AfterCreate=AfterCreate;function BeforeUpdate(){return hook(enums_1.EventType.beforeUpdate)}hooks.BeforeUpdate=BeforeUpdate;function AfterUpdate(){return hook(enums_1.EventType.afterUpdate)}hooks.AfterUpdate=AfterUpdate;function OnInit(){return hook(enums_1.EventType.onInit)}hooks.OnInit=OnInit;function BeforeDelete(){return hook(enums_1.EventType.beforeDelete)}hooks.BeforeDelete=BeforeDelete;function AfterDelete(){return hook(enums_1.EventType.afterDelete)}hooks.AfterDelete=AfterDelete;

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});exports.OneToMany=void 0;__exportStar(PrimaryKey$1,exports);__exportStar(Entity$1,exports);__exportStar(OneToOne$1,exports);__exportStar(ManyToOne$1,exports);__exportStar(ManyToMany$1,exports);var OneToMany_1=OneToMany$1;Object.defineProperty(exports,"OneToMany",{enumerable:true,get:function(){return OneToMany_1.OneToMany}});__exportStar(Property$1,exports);__exportStar(Enum$1,exports);__exportStar(Formula$1,exports);__exportStar(Indexed,exports);__exportStar(Repository$1,exports);__exportStar(Embeddable$1,exports);__exportStar(Embedded$1,exports);__exportStar(Filter$1,exports);__exportStar(Subscriber$1,exports);__exportStar(hooks,exports);})(decorators);getDefaultExportFromCjs(decorators);

(function(exports){var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p);};Object.defineProperty(exports,"__esModule",{value:true});exports.PlainObject=exports.EntityRepositoryType=exports.EntityMetadata=exports.PrimaryKeyProp=exports.PrimaryKeyType=void 0;var typings_1=typings$1;Object.defineProperty(exports,"PrimaryKeyType",{enumerable:true,get:function(){return typings_1.PrimaryKeyType}});Object.defineProperty(exports,"PrimaryKeyProp",{enumerable:true,get:function(){return typings_1.PrimaryKeyProp}});Object.defineProperty(exports,"EntityMetadata",{enumerable:true,get:function(){return typings_1.EntityMetadata}});Object.defineProperty(exports,"EntityRepositoryType",{enumerable:true,get:function(){return typings_1.EntityRepositoryType}});Object.defineProperty(exports,"PlainObject",{enumerable:true,get:function(){return typings_1.PlainObject}});__exportStar(enums,exports);__exportStar(errors,exports);__exportStar(exceptions,exports);__exportStar(MikroORM$1,exports);__exportStar(entity,exports);__exportStar(events,exports);__exportStar(EntityManager$1,exports);__exportStar(unitOfWork,exports);__exportStar(utils$m,exports);__exportStar(hydration,exports);__exportStar(drivers,exports);__exportStar(connections,exports);__exportStar(platforms,exports);__exportStar(types,exports);__exportStar(namingStrategy,exports);__exportStar(metadata,exports);__exportStar(cache$1,exports);__exportStar(decorators,exports);})(core);getDefaultExportFromCjs(core);

class Database extends CinnamonModule{constructor(framework,modelsPath){super(framework);_defineProperty(this,"underlyingOrm",void 0);_defineProperty(this,"modelsPath",void 0);this.modelsPath=modelsPath;}get logger(){return this.framework.getModule(Logger$2.prototype)}get isInitialized(){return this.underlyingOrm!==undefined}get entityManager(){if(!this.isInitialized){return undefined}return this.underlyingOrm.em}get em(){return this.entityManager}async initialize(databaseConfig){if(this.isInitialized){throw new Error("The database module is already initialized. You cannot initialize it again.")}this.logger.frameworkDebug("Database module is loading models now.");if(!(await cinnamonInternals$1.fs.directoryExists(this.modelsPath))){this.logger.error(`Unable to load database models due to missing controllers directory: ${cinnamonInternals$1.fs.toAbsolutePath(this.modelsPath)}`);if(databaseConfig.terminateOnInitError)await this.framework.terminate(true);else this.logger.error(`Database initialization halted. The database module has NOT been initialized.`);return}if(!databaseConfig.type||!databaseConfig.host||!databaseConfig.port||isNaN(databaseConfig.port)||!databaseConfig.database){this.logger.error(`Invalid database configuration. You must set at least:`);this.logger.error(`type, host, port, database`);if(databaseConfig.terminateOnInitError)await this.framework.terminate(true);else this.logger.error(`Database initialization halted. The database module has NOT been initialized.`);return}let validateDatabaseTypes=Object.keys(Configuration_2.PLATFORMS);if(!validateDatabaseTypes.includes(databaseConfig.type)){var _databaseConfig$type;this.logger.error(`Invalid database type specified: ${(_databaseConfig$type=databaseConfig.type)!==null&&_databaseConfig$type!==void 0?_databaseConfig$type:"<none>"}. Is there a typo?`);this.logger.error(`Please check your project's cinnamon.toml file.`);this.logger.error(`Valid database types are: ${validateDatabaseTypes}`);if(databaseConfig.terminateOnInitError)await this.framework.terminate(true);else this.logger.error(`Database initialization halted. The database module has NOT been initialized.`);return}try{let hasCredentials=databaseConfig.username!=null&&databaseConfig.password!=null;this.underlyingOrm=await core.MikroORM.init({type:databaseConfig.type,entitiesTs:[`${this.modelsPath}/**/*.ts`],host:databaseConfig.host,port:databaseConfig.port,dbName:databaseConfig.database,user:hasCredentials?databaseConfig.username:undefined,password:hasCredentials?databaseConfig.password:undefined});}catch(ex){this.logger.error(`Failed to initialize MikroORM (ORM engine).`);console.error(ex);if(databaseConfig.terminateOnInitError)await this.framework.terminate(true);else this.logger.error(`Database initialization halted. The database module has NOT been initialized.`);}}}

var application = {exports: {}};

var shams$1=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true};

var hasSymbols=shams$1;var shams=function hasToStringTagShams(){return hasSymbols()&&!!Symbol.toStringTag};

var toStr=Object.prototype.toString;var fnToStr=Function.prototype.toString;var isFnRegex=/^\s*(?:function)?\*/;var hasToStringTag=shams();var getProto=Object.getPrototypeOf;var getGeneratorFunc=function(){if(!hasToStringTag){return false}try{return Function("return function*() {}")()}catch(e){}};var GeneratorFunction;var isGeneratorFunction$2=function isGeneratorFunction(fn){if(typeof fn!=="function"){return false}if(isFnRegex.test(fnToStr.call(fn))){return true}if(!hasToStringTag){var str=toStr.call(fn);return str==="[object GeneratorFunction]"}if(!getProto){return false}if(typeof GeneratorFunction==="undefined"){var generatorFunc=getGeneratorFunc();GeneratorFunction=generatorFunc?getProto(generatorFunc):false;}return getProto(fn)===GeneratorFunction};

var src = {exports: {}};

var browser = {exports: {}};

var s=1000;var m=s*60;var h=m*60;var d=h*24;var w=d*7;var y=d*365.25;var ms=function(val,options){options=options||{};var type=typeof val;if(type==="string"&&val.length>0){return parse$8(val)}else if(type==="number"&&isFinite(val)){return options.long?fmtLong(val):fmtShort(val)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))};function parse$8(str){str=String(str);if(str.length>100){return}var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match){return}var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return undefined;}}function fmtShort(ms){var msAbs=Math.abs(ms);if(msAbs>=d){return Math.round(ms/d)+"d"}if(msAbs>=h){return Math.round(ms/h)+"h"}if(msAbs>=m){return Math.round(ms/m)+"m"}if(msAbs>=s){return Math.round(ms/s)+"s"}return ms+"ms"}function fmtLong(ms){var msAbs=Math.abs(ms);if(msAbs>=d){return plural(ms,msAbs,d,"day")}if(msAbs>=h){return plural(ms,msAbs,h,"hour")}if(msAbs>=m){return plural(ms,msAbs,m,"minute")}if(msAbs>=s){return plural(ms,msAbs,s,"second")}return ms+" ms"}function plural(ms,msAbs,n,name){var isPlural=msAbs>=n*1.5;return Math.round(ms/n)+" "+name+(isPlural?"s":"")}

function setup(env){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=ms;createDebug.destroy=destroy;Object.keys(env).forEach(key=>{createDebug[key]=env[key];});createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(namespace){let hash=0;for(let i=0;i<namespace.length;i++){hash=(hash<<5)-hash+namespace.charCodeAt(i);hash|=0;}return createDebug.colors[Math.abs(hash)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(namespace){let prevTime;let enableOverride=null;let namespacesCache;let enabledCache;function debug(...args){if(!debug.enabled){return}const self=debug;const curr=Number(new Date);const ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;args[0]=createDebug.coerce(args[0]);if(typeof args[0]!=="string"){args.unshift("%O");}let index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,(match,format)=>{if(match==="%%"){return "%"}index++;const formatter=createDebug.formatters[format];if(typeof formatter==="function"){const val=args[index];match=formatter.call(self,val);args.splice(index,1);index--;}return match});createDebug.formatArgs.call(self,args);const logFn=self.log||createDebug.log;logFn.apply(self,args);}debug.namespace=namespace;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(namespace);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(enableOverride!==null){return enableOverride}if(namespacesCache!==createDebug.namespaces){namespacesCache=createDebug.namespaces;enabledCache=createDebug.enabled(namespace);}return enabledCache},set:v=>{enableOverride=v;}});if(typeof createDebug.init==="function"){createDebug.init(debug);}return debug}function extend(namespace,delimiter){const newDebug=createDebug(this.namespace+(typeof delimiter==="undefined"?":":delimiter)+namespace);newDebug.log=this.log;return newDebug}function enable(namespaces){createDebug.save(namespaces);createDebug.namespaces=namespaces;createDebug.names=[];createDebug.skips=[];let i;const split=(typeof namespaces==="string"?namespaces:"").split(/[\s,]+/);const len=split.length;for(i=0;i<len;i++){if(!split[i]){continue}namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){createDebug.skips.push(new RegExp("^"+namespaces.substr(1)+"$"));}else {createDebug.names.push(new RegExp("^"+namespaces+"$"));}}}function disable(){const namespaces=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map(namespace=>"-"+namespace)].join(",");createDebug.enable("");return namespaces}function enabled(name){if(name[name.length-1]==="*"){return true}let i;let len;for(i=0,len=createDebug.skips.length;i<len;i++){if(createDebug.skips[i].test(name)){return false}}for(i=0,len=createDebug.names.length;i<len;i++){if(createDebug.names[i].test(name)){return true}}return false}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,"*")}function coerce(val){if(val instanceof Error){return val.stack||val.message}return val}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");}createDebug.enable(createDebug.load());return createDebug}var common=setup;

(function(module,exports){exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage=localstorage();exports.destroy=(()=>{let warned=false;return ()=>{if(!warned){warned=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");}}})();exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(args){args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff);if(!this.useColors){return}const c="color: "+this.color;args.splice(1,0,c,"color: inherit");let index=0;let lastC=0;args[0].replace(/%[a-zA-Z%]/g,match=>{if(match==="%%"){return}index++;if(match==="%c"){lastC=index;}});args.splice(lastC,0,c);}exports.log=console.debug||console.log||(()=>{});function save(namespaces){try{if(namespaces){exports.storage.setItem("debug",namespaces);}else {exports.storage.removeItem("debug");}}catch(error){}}function load(){let r;try{r=exports.storage.getItem("debug");}catch(error){}if(!r&&typeof process!=="undefined"&&"env"in process){r=process.env.DEBUG;}return r}function localstorage(){try{return localStorage}catch(error){}}module.exports=common(exports);const{formatters}=module.exports;formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return "[UnexpectedJSONParseError]: "+error.message}};})(browser,browser.exports);

var node = {exports: {}};

(function(module,exports){const tty=require$$1__default["default"];const util=require$$0__default$2["default"];exports.init=init;exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.destroy=util.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");exports.colors=[6,2,3,4,5,1];try{const supportsColor=require("supports-color");if(supportsColor&&(supportsColor.stderr||supportsColor).level>=2){exports.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221];}}catch(error){}exports.inspectOpts=Object.keys(process.env).filter(key=>{return /^debug_/i.test(key)}).reduce((obj,key)=>{const prop=key.substring(6).toLowerCase().replace(/_([a-z])/g,(_,k)=>{return k.toUpperCase()});let val=process.env[key];if(/^(yes|on|true|enabled)$/i.test(val)){val=true;}else if(/^(no|off|false|disabled)$/i.test(val)){val=false;}else if(val==="null"){val=null;}else {val=Number(val);}obj[prop]=val;return obj},{});function useColors(){return "colors"in exports.inspectOpts?Boolean(exports.inspectOpts.colors):tty.isatty(process.stderr.fd)}function formatArgs(args){const{namespace:name,useColors}=this;if(useColors){const c=this.color;const colorCode="\x1B[3"+(c<8?c:"8;5;"+c);const prefix=`  ${colorCode};1m${name} \u001B[0m`;args[0]=prefix+args[0].split("\n").join("\n"+prefix);args.push(colorCode+"m+"+module.exports.humanize(this.diff)+"\x1B[0m");}else {args[0]=getDate()+name+" "+args[0];}}function getDate(){if(exports.inspectOpts.hideDate){return ""}return new Date().toISOString()+" "}function log(...args){return process.stderr.write(util.format(...args)+"\n")}function save(namespaces){if(namespaces){process.env.DEBUG=namespaces;}else {delete process.env.DEBUG;}}function load(){return process.env.DEBUG}function init(debug){debug.inspectOpts={};const keys=Object.keys(exports.inspectOpts);for(let i=0;i<keys.length;i++){debug.inspectOpts[keys[i]]=exports.inspectOpts[keys[i]];}}module.exports=common(exports);const{formatters}=module.exports;formatters.o=function(v){this.inspectOpts.colors=this.useColors;return util.inspect(v,this.inspectOpts).split("\n").map(str=>str.trim()).join(" ")};formatters.O=function(v){this.inspectOpts.colors=this.useColors;return util.inspect(v,this.inspectOpts)};})(node,node.exports);

if(typeof process==="undefined"||process.type==="renderer"||process.browser===true||process.__nwjs){src.exports=browser.exports;}else {src.exports=node.exports;}

var onFinished$2 = {exports: {}};

var eeFirst=first$1;function first$1(stuff,done){if(!Array.isArray(stuff))throw new TypeError("arg must be an array of [ee, events...] arrays");var cleanups=[];for(var i=0;i<stuff.length;i++){var arr=stuff[i];if(!Array.isArray(arr)||arr.length<2)throw new TypeError("each array member must be [ee, events...]");var ee=arr[0];for(var j=1;j<arr.length;j++){var event=arr[j];var fn=listener(event,callback);ee.on(event,fn);cleanups.push({ee:ee,event:event,fn:fn});}}function callback(){cleanup();done.apply(null,arguments);}function cleanup(){var x;for(var i=0;i<cleanups.length;i++){x=cleanups[i];x.ee.removeListener(x.event,x.fn);}}function thunk(fn){done=fn;}thunk.cancel=cleanup;return thunk}function listener(event,done){return function onevent(arg1){var args=new Array(arguments.length);var ee=this;var err=event==="error"?arg1:null;for(var i=0;i<args.length;i++){args[i]=arguments[i];}done(err,ee,event,args);}}

onFinished$2.exports=onFinished$1;onFinished$2.exports.isFinished=isFinished;var first=eeFirst;var defer=typeof setImmediate==="function"?setImmediate:function(fn){process.nextTick(fn.bind.apply(fn,arguments));};function onFinished$1(msg,listener){if(isFinished(msg)!==false){defer(listener,null,msg);return msg}attachListener(msg,listener);return msg}function isFinished(msg){var socket=msg.socket;if(typeof msg.finished==="boolean"){return Boolean(msg.finished||socket&&!socket.writable)}if(typeof msg.complete==="boolean"){return Boolean(msg.upgrade||!socket||!socket.readable||msg.complete&&!msg.readable)}return undefined}function attachFinishedListener(msg,callback){var eeMsg;var eeSocket;var finished=false;function onFinish(error){eeMsg.cancel();eeSocket.cancel();finished=true;callback(error);}eeMsg=eeSocket=first([[msg,"end","finish"]],onFinish);function onSocket(socket){msg.removeListener("socket",onSocket);if(finished)return;if(eeMsg!==eeSocket)return;eeSocket=first([[socket,"error","close"]],onFinish);}if(msg.socket){onSocket(msg.socket);return}msg.on("socket",onSocket);if(msg.socket===undefined){patchAssignSocket(msg,onSocket);}}function attachListener(msg,listener){var attached=msg.__onFinished;if(!attached||!attached.queue){attached=msg.__onFinished=createListener(msg);attachFinishedListener(msg,attached);}attached.queue.push(listener);}function createListener(msg){function listener(err){if(msg.__onFinished===listener)msg.__onFinished=null;if(!listener.queue)return;var queue=listener.queue;listener.queue=null;for(var i=0;i<queue.length;i++){queue[i](err,msg);}}listener.queue=[];return listener}function patchAssignSocket(res,callback){var assignSocket=res.assignSocket;if(typeof assignSocket!=="function")return;res.assignSocket=function _assignSocket(socket){assignSocket.call(this,socket);callback(socket);};}

var response$1 = {exports: {}};

var contentDisposition$1 = {exports: {}};

var safeBuffer = {exports: {}};

(function(module,exports){var buffer=require$$0__default$8["default"];var Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src){dst[key]=src[key];}}if(Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow){module.exports=buffer;}else {copyProps(buffer,exports);exports.Buffer=SafeBuffer;}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}copyProps(Buffer,SafeBuffer);SafeBuffer.from=function(arg,encodingOrOffset,length){if(typeof arg==="number"){throw new TypeError("Argument must not be a number")}return Buffer(arg,encodingOrOffset,length)};SafeBuffer.alloc=function(size,fill,encoding){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}var buf=Buffer(size);if(fill!==undefined){if(typeof encoding==="string"){buf.fill(fill,encoding);}else {buf.fill(fill);}}else {buf.fill(0);}return buf};SafeBuffer.allocUnsafe=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return Buffer(size)};SafeBuffer.allocUnsafeSlow=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return buffer.SlowBuffer(size)};})(safeBuffer,safeBuffer.exports);

contentDisposition$1.exports=contentDisposition;contentDisposition$1.exports.parse=parse$7;var basename=require$$0__default$1["default"].basename;var Buffer$1=safeBuffer.exports.Buffer;var ENCODE_URL_ATTR_CHAR_REGEXP=/[\x00-\x20"'()*,/:;<=>?@[\\\]{}\x7f]/g;var HEX_ESCAPE_REGEXP=/%[0-9A-Fa-f]{2}/;var HEX_ESCAPE_REPLACE_REGEXP=/%([0-9A-Fa-f]{2})/g;var NON_LATIN1_REGEXP=/[^\x20-\x7e\xa0-\xff]/g;var QESC_REGEXP$1=/\\([\u0000-\u007f])/g;var QUOTE_REGEXP$1=/([\\"])/g;var PARAM_REGEXP$1=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g;var TEXT_REGEXP$1=/^[\x20-\x7e\x80-\xff]+$/;var TOKEN_REGEXP$1=/^[!#$%&'*+.0-9A-Z^_`a-z|~-]+$/;var EXT_VALUE_REGEXP=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/;var DISPOSITION_TYPE_REGEXP=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function contentDisposition(filename,options){var opts=options||{};var type=opts.type||"attachment";var params=createparams(filename,opts.fallback);return format$2(new ContentDisposition(type,params))}function createparams(filename,fallback){if(filename===undefined){return}var params={};if(typeof filename!=="string"){throw new TypeError("filename must be a string")}if(fallback===undefined){fallback=true;}if(typeof fallback!=="string"&&typeof fallback!=="boolean"){throw new TypeError("fallback must be a string or boolean")}if(typeof fallback==="string"&&NON_LATIN1_REGEXP.test(fallback)){throw new TypeError("fallback must be ISO-8859-1 string")}var name=basename(filename);var isQuotedString=TEXT_REGEXP$1.test(name);var fallbackName=typeof fallback!=="string"?fallback&&getlatin1(name):basename(fallback);var hasFallback=typeof fallbackName==="string"&&fallbackName!==name;if(hasFallback||!isQuotedString||HEX_ESCAPE_REGEXP.test(name)){params["filename*"]=name;}if(isQuotedString||hasFallback){params.filename=hasFallback?fallbackName:name;}return params}function format$2(obj){var parameters=obj.parameters;var type=obj.type;if(!type||typeof type!=="string"||!TOKEN_REGEXP$1.test(type)){throw new TypeError("invalid type")}var string=String(type).toLowerCase();if(parameters&&typeof parameters==="object"){var param;var params=Object.keys(parameters).sort();for(var i=0;i<params.length;i++){param=params[i];var val=param.substr(-1)==="*"?ustring(parameters[param]):qstring$2(parameters[param]);string+="; "+param+"="+val;}}return string}function decodefield(str){var match=EXT_VALUE_REGEXP.exec(str);if(!match){throw new TypeError("invalid extended field value")}var charset=match[1].toLowerCase();var encoded=match[2];var value;var binary=encoded.replace(HEX_ESCAPE_REPLACE_REGEXP,pdecode);switch(charset){case"iso-8859-1":value=getlatin1(binary);break;case"utf-8":value=Buffer$1.from(binary,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field");}return value}function getlatin1(val){return String(val).replace(NON_LATIN1_REGEXP,"?")}function parse$7(string){if(!string||typeof string!=="string"){throw new TypeError("argument string is required")}var match=DISPOSITION_TYPE_REGEXP.exec(string);if(!match){throw new TypeError("invalid type format")}var index=match[0].length;var type=match[1].toLowerCase();var key;var names=[];var params={};var value;index=PARAM_REGEXP$1.lastIndex=match[0].substr(-1)===";"?index-1:index;while(match=PARAM_REGEXP$1.exec(string)){if(match.index!==index){throw new TypeError("invalid parameter format")}index+=match[0].length;key=match[1].toLowerCase();value=match[2];if(names.indexOf(key)!==-1){throw new TypeError("invalid duplicate parameter")}names.push(key);if(key.indexOf("*")+1===key.length){key=key.slice(0,-1);value=decodefield(value);params[key]=value;continue}if(typeof params[key]==="string"){continue}if(value[0]==="\""){value=value.substr(1,value.length-2).replace(QESC_REGEXP$1,"$1");}params[key]=value;}if(index!==-1&&index!==string.length){throw new TypeError("invalid parameter format")}return new ContentDisposition(type,params)}function pdecode(str,hex){return String.fromCharCode(parseInt(hex,16))}function pencode(char){return "%"+String(char).charCodeAt(0).toString(16).toUpperCase()}function qstring$2(val){var str=String(val);return "\""+str.replace(QUOTE_REGEXP$1,"\\$1")+"\""}function ustring(val){var str=String(val);var encoded=encodeURIComponent(str).replace(ENCODE_URL_ATTR_CHAR_REGEXP,pencode);return "UTF-8''"+encoded}function ContentDisposition(type,parameters){this.type=type;this.parameters=parameters;}

var mimeTypes$1 = {};

var require$$0$2 = {"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/3gpp-ims+xml":{source:"iana",compressible:true},"application/3gpphal+json":{source:"iana",compressible:true},"application/3gpphalforms+json":{source:"iana",compressible:true},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:true},"application/alto-costmap+json":{source:"iana",compressible:true},"application/alto-costmapfilter+json":{source:"iana",compressible:true},"application/alto-directory+json":{source:"iana",compressible:true},"application/alto-endpointcost+json":{source:"iana",compressible:true},"application/alto-endpointcostparams+json":{source:"iana",compressible:true},"application/alto-endpointprop+json":{source:"iana",compressible:true},"application/alto-endpointpropparams+json":{source:"iana",compressible:true},"application/alto-error+json":{source:"iana",compressible:true},"application/alto-networkmap+json":{source:"iana",compressible:true},"application/alto-networkmapfilter+json":{source:"iana",compressible:true},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:true},"application/alto-updatestreamparams+json":{source:"iana",compressible:true},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:true,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:true,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:true,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:true,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:true,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:true,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:true},"application/atsc-rsat+xml":{source:"iana",compressible:true,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:true},"application/bacnet-xdd+zip":{source:"iana",compressible:false},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:false,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/calendar+json":{source:"iana",compressible:true},"application/calendar+xml":{source:"iana",compressible:true,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:true},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:true},"application/ccxml+xml":{source:"iana",compressible:true,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:true,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:true},"application/cellml+xml":{source:"iana",compressible:true},"application/cfw":{source:"iana"},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:true},"application/clue_info+xml":{source:"iana",compressible:true},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:true},"application/coap-group+json":{source:"iana",compressible:true},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:true},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:true},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:true},"application/cstadata+xml":{source:"iana",compressible:true},"application/csvm+json":{source:"iana",compressible:true},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:true},"application/dash+xml":{source:"iana",compressible:true,extensions:["mpd"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:true,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:true},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:true},"application/dicom+xml":{source:"iana",compressible:true},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:true},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:true,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:true},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:true,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:true,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:false},"application/edifact":{source:"iana",compressible:false},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:true},"application/elm+xml":{source:"iana",compressible:true},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/emergencycalldata.comment+xml":{source:"iana",compressible:true},"application/emergencycalldata.control+xml":{source:"iana",compressible:true},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:true},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:true},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:true},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:true},"application/emergencycalldata.veds+xml":{source:"iana",compressible:true},"application/emma+xml":{source:"iana",compressible:true,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:true,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:true},"application/epub+zip":{source:"iana",compressible:false,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:true},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:true,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:true},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/fido.trusted-apps+json":{compressible:true},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:false},"application/framework-attributes+xml":{source:"iana",compressible:true},"application/geo+json":{source:"iana",compressible:true,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:true},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:true,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:true,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:false,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:true},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:true},"application/ibe-pkg-reply+xml":{source:"iana",compressible:true},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:true,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:true,extensions:["its"]},"application/java-archive":{source:"apache",compressible:false,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:false,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:false,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:true,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:true},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:true},"application/jrd+json":{source:"iana",compressible:true},"application/jscalendar+json":{source:"iana",compressible:true},"application/json":{source:"iana",charset:"UTF-8",compressible:true,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:true},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:true,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:true},"application/jwk-set+json":{source:"iana",compressible:true},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:true},"application/kpml-response+xml":{source:"iana",compressible:true},"application/ld+json":{source:"iana",compressible:true,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:true,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:true},"application/lost+xml":{source:"iana",compressible:true,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:true},"application/lpf+zip":{source:"iana",compressible:false},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:true,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:true,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:true,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:true,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:true},"application/mathml-presentation+xml":{source:"iana",compressible:true},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:true},"application/mbms-deregister+xml":{source:"iana",compressible:true},"application/mbms-envelope+xml":{source:"iana",compressible:true},"application/mbms-msk+xml":{source:"iana",compressible:true},"application/mbms-msk-response+xml":{source:"iana",compressible:true},"application/mbms-protection-description+xml":{source:"iana",compressible:true},"application/mbms-reception-report+xml":{source:"iana",compressible:true},"application/mbms-register+xml":{source:"iana",compressible:true},"application/mbms-register-response+xml":{source:"iana",compressible:true},"application/mbms-schedule+xml":{source:"iana",compressible:true},"application/mbms-user-service-description+xml":{source:"iana",compressible:true},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:true},"application/media_control+xml":{source:"iana",compressible:true},"application/mediaservercontrol+xml":{source:"iana",compressible:true,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:true},"application/metalink+xml":{source:"apache",compressible:true,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:true,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:true,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:true,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:true,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:true,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:true},"application/mrb-publish+xml":{source:"iana",compressible:true},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/msword":{source:"iana",compressible:false,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:true},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:true},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:false,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:true},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:true,extensions:["opf"]},"application/ogg":{source:"iana",compressible:false,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:true,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:true},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:false},"application/p2p-overlay+xml":{source:"iana",compressible:true,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:true,extensions:["xer"]},"application/pdf":{source:"iana",compressible:false,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:false,extensions:["pgp"]},"application/pgp-keys":{source:"iana"},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:true,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/postscript":{source:"iana",compressible:true,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:true},"application/problem+json":{source:"iana",compressible:true},"application/problem+xml":{source:"iana",compressible:true},"application/provenance+xml":{source:"iana",compressible:true,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:false},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:true},"application/pskc+xml":{source:"iana",compressible:true,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:true},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:true,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:true},"application/rdf+xml":{source:"iana",compressible:true,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:true,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:true},"application/resource-lists+xml":{source:"iana",compressible:true,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:true,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:true},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:true},"application/rls-services+xml":{source:"iana",compressible:true,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:true,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:true,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:true,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:true,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:true,extensions:["rss"]},"application/rtf":{source:"iana",compressible:true,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:true},"application/samlmetadata+xml":{source:"iana",compressible:true},"application/sarif+json":{source:"iana",compressible:true},"application/sarif-external-properties+json":{source:"iana",compressible:true},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:true,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:true},"application/scim+json":{source:"iana",compressible:true},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:true},"application/senml+xml":{source:"iana",compressible:true,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:true},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:true},"application/sensml+xml":{source:"iana",compressible:true,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:true},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:true,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:true},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:true,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:true},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:true,extensions:["srx"]},"application/spirits-event+xml":{source:"iana",compressible:true},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:true,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:true,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:true,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:true,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:true},"application/swid+xml":{source:"iana",compressible:true,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:true},"application/taxii+json":{source:"iana",compressible:true},"application/td+json":{source:"iana",compressible:true},"application/tei+xml":{source:"iana",compressible:true,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:true,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:true},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:true,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:true,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:false,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:true},"application/urc-ressheet+xml":{source:"iana",compressible:true,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:true,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:true},"application/vcard+json":{source:"iana",compressible:true},"application/vcard+xml":{source:"iana",compressible:true},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:true,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:true},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:true},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:true},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:true},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:true},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:true},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:true},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:true},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:true},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:true},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:true},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:true},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:false,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:true,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:true},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:true},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:false,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:true},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:true},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:true},"application/vnd.apple.installer+xml":{source:"iana",compressible:true,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:false,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:true},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:true},"application/vnd.avistar+xml":{source:"iana",compressible:true},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:true,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:true},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:true},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:true},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:true},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:true},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:true,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:true,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:true},"application/vnd.collection.doc+json":{source:"iana",compressible:true},"application/vnd.collection.next+json":{source:"iana",compressible:true},"application/vnd.comicbook+zip":{source:"iana",compressible:false},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:true},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:true,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:true},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:true},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:true},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:true},"application/vnd.cyclonedx+xml":{source:"iana",compressible:true},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:false},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:true,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:true},"application/vnd.dataresource+json":{source:"iana",compressible:true},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:true,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:true},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:true},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:true},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:true},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:true},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:true},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:true},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:true},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:false},"application/vnd.eszigno3+xml":{source:"iana",compressible:true,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:true},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:false},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:false},"application/vnd.etsi.cug+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:true},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:true},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:true},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:true},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:true},"application/vnd.etsi.sci+xml":{source:"iana",compressible:true},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:true},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:true},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:false},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:false},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:true},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:true},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:true},"application/vnd.geo+json":{source:"iana",compressible:true},"application/vnd.geocube+xml":{source:"iana",compressible:true},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:false,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:false,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:false,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:true,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:false,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:true},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:false},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:true},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:true},"application/vnd.hal+xml":{source:"iana",compressible:true,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:true,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:true},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:true},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:true},"application/vnd.hyper-item+json":{source:"iana",compressible:true},"application/vnd.hyperdrive+json":{source:"iana",compressible:true},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:false},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:false},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:true},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:true},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:true},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:true},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:true},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:true},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:true},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:true},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:true},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:true},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:true,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:false},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:true},"application/vnd.las.las+xml":{source:"iana",compressible:true,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:true},"application/vnd.liberty-request+xml":{source:"iana",compressible:true},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:true,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:false},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:true},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:true},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:true},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:true},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:true},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:true},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:true,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:false,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:true,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:true},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:true},"application/vnd.ms-outlook":{compressible:false,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:true},"application/vnd.ms-powerpoint":{source:"iana",compressible:false,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:true},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:true},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:true},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:false,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:true},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:true},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:true},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:true},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:true},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:true,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:true},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:false,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:false,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:false,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:false,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:true},"application/vnd.oftn.l10n+json":{source:"iana",compressible:true},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:true},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:true},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:true},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:true},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:true},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:true},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:true},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:true},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:true},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:true},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:true},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:true},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:true},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:true},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:true},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:true,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:true},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:true},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:true},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:true},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:true},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:true},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:true},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:true},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:true},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:true},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:true},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:true,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:true,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:false,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:false,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:false,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:true},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:true},"application/vnd.oracle.resource+json":{source:"iana",compressible:true},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:true},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:true},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:true},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:true},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:true},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:true},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:true,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:true},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:true,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:true},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:true},"application/vnd.shopkick+json":{source:"iana",compressible:true},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:true},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:true,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:true,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:true,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:true},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:true,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:true,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:true,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:true},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:true},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:true},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:true},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:true,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:true},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:true},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:true},"application/vnd.wv.ssp+xml":{source:"iana",compressible:true},"application/vnd.xacml+json":{source:"iana",compressible:true},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:true},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:true,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:true,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:true,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:true},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:true,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:true},"application/webpush-options+json":{source:"iana",compressible:true},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:true,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:true,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:false,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:false,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:false,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:false,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:false,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:false},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:true,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:true,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:true,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:false,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:true,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:false,extensions:["jnlp"]},"application/x-javascript":{compressible:true},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:false,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:false},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:true,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:false,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:false,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:true,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:false,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:false,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:true,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:true,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:true,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:true,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:true,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:false,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:true,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:true,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:true,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:true,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:true},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:true,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:false,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:true},"application/xaml+xml":{source:"apache",compressible:true,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:true,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:true,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:true,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:true,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:true},"application/xcap-ns+xml":{source:"iana",compressible:true,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:true},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:true},"application/xenc+xml":{source:"iana",compressible:true,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:true,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:true},"application/xliff+xml":{source:"iana",compressible:true,extensions:["xlf"]},"application/xml":{source:"iana",compressible:true,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:true,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:true},"application/xmpp+xml":{source:"iana",compressible:true},"application/xop+xml":{source:"iana",compressible:true,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:true,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:true,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:true,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:true,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:true},"application/yang-data+xml":{source:"iana",compressible:true},"application/yang-patch+json":{source:"iana",compressible:true},"application/yang-patch+xml":{source:"iana",compressible:true},"application/yin+xml":{source:"iana",compressible:true,extensions:["yin"]},"application/zip":{source:"iana",compressible:false,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:false,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:false,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:false},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:false,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:false,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:false,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:false,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:false},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:false},"audio/vorbis":{source:"iana",compressible:false},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:false,extensions:["wav"]},"audio/wave":{compressible:false,extensions:["wav"]},"audio/webm":{source:"apache",compressible:false,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:false,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:false,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:true,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:true,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:false,extensions:["apng"]},"image/avci":{source:"iana"},"image/avcs":{source:"iana"},"image/avif":{source:"iana",compressible:false,extensions:["avif"]},"image/bmp":{source:"iana",compressible:true,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:false,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:false,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:false,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:false,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:false,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:false},"image/png":{source:"iana",compressible:false,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:true,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:false,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:true,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:true,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:true,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:false},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:false},"message/imdn+xml":{source:"iana",compressible:true},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:false},"message/rfc822":{source:"iana",compressible:true,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:true,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:true,extensions:["glb"]},"model/iges":{source:"iana",compressible:false,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:false,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:true,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:false,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:false,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:true,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:true},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:false,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:false,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:false,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:false,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:true,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:false},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:false},"multipart/form-data":{source:"iana",compressible:false},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:false},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:false},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:true,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:true},"text/cmd":{compressible:true},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:true,extensions:["css"]},"text/csv":{source:"iana",compressible:true,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:true,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:true},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:true,extensions:["jsx"]},"text/less":{compressible:true,extensions:["less"]},"text/markdown":{source:"iana",compressible:true,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:true,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:true,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:true,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:true,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:true,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:true,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:true,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:true,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:true,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:true},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:true},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:true,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:true,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:true,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:true,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:true,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:true,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:false,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:false,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:false,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:false,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:false,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:false,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:false,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:false,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:true},"x-shader/x-vertex":{compressible:true}};

var mimeDb=require$$0$2;

(function(exports){var db=mimeDb;var extname=require$$0__default$1["default"].extname;var EXTRACT_TYPE_REGEXP=/^\s*([^;\s]*)(?:;|\s|$)/;var TEXT_TYPE_REGEXP=/^text\//i;exports.charset=charset;exports.charsets={lookup:charset};exports.contentType=contentType;exports.extension=extension;exports.extensions=Object.create(null);exports.lookup=lookup;exports.types=Object.create(null);populateMaps(exports.extensions,exports.types);function charset(type){if(!type||typeof type!=="string"){return false}var match=EXTRACT_TYPE_REGEXP.exec(type);var mime=match&&db[match[1].toLowerCase()];if(mime&&mime.charset){return mime.charset}if(match&&TEXT_TYPE_REGEXP.test(match[1])){return "UTF-8"}return false}function contentType(str){if(!str||typeof str!=="string"){return false}var mime=str.indexOf("/")===-1?exports.lookup(str):str;if(!mime){return false}if(mime.indexOf("charset")===-1){var charset=exports.charset(mime);if(charset)mime+="; charset="+charset.toLowerCase();}return mime}function extension(type){if(!type||typeof type!=="string"){return false}var match=EXTRACT_TYPE_REGEXP.exec(type);var exts=match&&exports.extensions[match[1].toLowerCase()];if(!exts||!exts.length){return false}return exts[0]}function lookup(path){if(!path||typeof path!=="string"){return false}var extension=extname("x."+path).toLowerCase().substr(1);if(!extension){return false}return exports.types[extension]||false}function populateMaps(extensions,types){var preference=["nginx","apache",undefined,"iana"];Object.keys(db).forEach(function forEachMimeType(type){var mime=db[type];var exts=mime.extensions;if(!exts||!exts.length){return}extensions[type]=exts;for(var i=0;i<exts.length;i++){var extension=exts[i];if(types[extension]){var from=preference.indexOf(db[types[extension]].source);var to=preference.indexOf(mime.source);if(types[extension]!=="application/octet-stream"&&(from>to||from===to&&types[extension].substr(0,12)==="application/")){continue}}types[extension]=type;}});}})(mimeTypes$1);

class LRU$1{constructor(max){this.max=max;this.size=0;this.cache=new Map;this._cache=new Map;}get(key,options){let item=this.cache.get(key);const maxAge=options&&options.maxAge;let now;function getNow(){now=now||Date.now();return now}if(item){if(item.expired&&getNow()>item.expired){item.expired=0;item.value=undefined;}else {if(maxAge!==undefined){const expired=maxAge?getNow()+maxAge:0;item.expired=expired;}}return item.value}item=this._cache.get(key);if(item){if(item.expired&&getNow()>item.expired){item.expired=0;item.value=undefined;}else {this._update(key,item);if(maxAge!==undefined){const expired=maxAge?getNow()+maxAge:0;item.expired=expired;}}return item.value}}set(key,value,options){const maxAge=options&&options.maxAge;const expired=maxAge?Date.now()+maxAge:0;let item=this.cache.get(key);if(item){item.expired=expired;item.value=value;}else {item={value,expired};this._update(key,item);}}keys(){const cacheKeys=new Set;const now=Date.now();for(const entry of this.cache.entries()){checkEntry(entry);}for(const entry of this._cache.entries()){checkEntry(entry);}function checkEntry(entry){const key=entry[0];const item=entry[1];if(entry[1].value&&!entry[1].expired||item.expired>=now){cacheKeys.add(key);}}return Array.from(cacheKeys.keys())}_update(key,item){this.cache.set(key,item);this.size++;if(this.size>=this.max){this.size=0;this._cache=this.cache;this.cache=new Map;}}}var ylru=LRU$1;

const mimeTypes=mimeTypes$1;const LRU=ylru;const typeLRUCache=new LRU(100);var cacheContentType=type=>{let mimeType=typeLRUCache.get(type);if(!mimeType){mimeType=mimeTypes.contentType(type);typeLRUCache.set(type,mimeType);}return mimeType};

var matchHtmlRegExp=/["'&<>]/;var escapeHtml_1=escapeHtml;function escapeHtml(string){var str=""+string;var match=matchHtmlRegExp.exec(str);if(!match){return str}var escape;var html="";var index=0;var lastIndex=0;for(index=match.index;index<str.length;index++){switch(str.charCodeAt(index)){case 34:escape="&quot;";break;case 38:escape="&amp;";break;case 39:escape="&#39;";break;case 60:escape="&lt;";break;case 62:escape="&gt;";break;default:continue;}if(lastIndex!==index){html+=str.substring(lastIndex,index);}lastIndex=index+1;html+=escape;}return lastIndex!==index?html+str.substring(lastIndex,index):html}

var typeIs = {exports: {}};

var mediaTyper = {};

var paramRegExp=/; *([!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) *= *("(?:[ !\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u0020-\u007e])*"|[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) */g;var textRegExp=/^[\u0020-\u007e\u0080-\u00ff]+$/;var tokenRegExp=/^[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+$/;var qescRegExp=/\\([\u0000-\u007f])/g;var quoteRegExp=/([\\"])/g;var subtypeNameRegExp=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/;var typeNameRegExp=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/;var typeRegExp=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;mediaTyper.format=format$1;mediaTyper.parse=parse$6;function format$1(obj){if(!obj||typeof obj!=="object"){throw new TypeError("argument obj is required")}var parameters=obj.parameters;var subtype=obj.subtype;var suffix=obj.suffix;var type=obj.type;if(!type||!typeNameRegExp.test(type)){throw new TypeError("invalid type")}if(!subtype||!subtypeNameRegExp.test(subtype)){throw new TypeError("invalid subtype")}var string=type+"/"+subtype;if(suffix){if(!typeNameRegExp.test(suffix)){throw new TypeError("invalid suffix")}string+="+"+suffix;}if(parameters&&typeof parameters==="object"){var param;var params=Object.keys(parameters).sort();for(var i=0;i<params.length;i++){param=params[i];if(!tokenRegExp.test(param)){throw new TypeError("invalid parameter name")}string+="; "+param+"="+qstring$1(parameters[param]);}}return string}function parse$6(string){if(!string){throw new TypeError("argument string is required")}if(typeof string==="object"){string=getcontenttype$1(string);}if(typeof string!=="string"){throw new TypeError("argument string is required to be a string")}var index=string.indexOf(";");var type=index!==-1?string.substr(0,index):string;var key;var match;var obj=splitType(type);var params={};var value;paramRegExp.lastIndex=index;while(match=paramRegExp.exec(string)){if(match.index!==index){throw new TypeError("invalid parameter format")}index+=match[0].length;key=match[1].toLowerCase();value=match[2];if(value[0]==="\""){value=value.substr(1,value.length-2).replace(qescRegExp,"$1");}params[key]=value;}if(index!==-1&&index!==string.length){throw new TypeError("invalid parameter format")}obj.parameters=params;return obj}function getcontenttype$1(obj){if(typeof obj.getHeader==="function"){return obj.getHeader("content-type")}if(typeof obj.headers==="object"){return obj.headers&&obj.headers["content-type"]}}function qstring$1(val){var str=String(val);if(tokenRegExp.test(str)){return str}if(str.length>0&&!textRegExp.test(str)){throw new TypeError("invalid parameter value")}return "\""+str.replace(quoteRegExp,"\\$1")+"\""}function splitType(string){var match=typeRegExp.exec(string.toLowerCase());if(!match){throw new TypeError("invalid media type")}var type=match[1];var subtype=match[2];var suffix;var index=subtype.lastIndexOf("+");if(index!==-1){suffix=subtype.substr(index+1);subtype=subtype.substr(0,index);}var obj={type:type,subtype:subtype,suffix:suffix};return obj}

var typer=mediaTyper;var mime$1=mimeTypes$1;typeIs.exports=typeofrequest;typeIs.exports.is=typeis;typeIs.exports.hasBody=hasbody;typeIs.exports.normalize=normalize;typeIs.exports.match=mimeMatch;function typeis(value,types_){var i;var types=types_;var val=tryNormalizeType(value);if(!val){return false}if(types&&!Array.isArray(types)){types=new Array(arguments.length-1);for(i=0;i<types.length;i++){types[i]=arguments[i+1];}}if(!types||!types.length){return val}var type;for(i=0;i<types.length;i++){if(mimeMatch(normalize(type=types[i]),val)){return type[0]==="+"||type.indexOf("*")!==-1?val:type}}return false}function hasbody(req){return req.headers["transfer-encoding"]!==undefined||!isNaN(req.headers["content-length"])}function typeofrequest(req,types_){var types=types_;if(!hasbody(req)){return null}if(arguments.length>2){types=new Array(arguments.length-1);for(var i=0;i<types.length;i++){types[i]=arguments[i+1];}}var value=req.headers["content-type"];return typeis(value,types)}function normalize(type){if(typeof type!=="string"){return false}switch(type){case"urlencoded":return "application/x-www-form-urlencoded";case"multipart":return "multipart/*";}if(type[0]==="+"){return "*/*"+type}return type.indexOf("/")===-1?mime$1.lookup(type):type}function mimeMatch(expected,actual){if(expected===false){return false}var actualParts=actual.split("/");var expectedParts=expected.split("/");if(actualParts.length!==2||expectedParts.length!==2){return false}if(expectedParts[0]!=="*"&&expectedParts[0]!==actualParts[0]){return false}if(expectedParts[1].substr(0,2)==="*+"){return expectedParts[1].length<=actualParts[1].length+1&&expectedParts[1].substr(1)===actualParts[1].substr(1-expectedParts[1].length)}if(expectedParts[1]!=="*"&&expectedParts[1]!==actualParts[1]){return false}return true}function normalizeType(value){var type=typer.parse(value);type.parameters=undefined;return typer.format(type)}function tryNormalizeType(value){if(!value){return null}try{return normalizeType(value)}catch(err){return null}}

var require$$0$1 = {"100":"Continue","101":"Switching Protocols","102":"Processing","103":"Early Hints","200":"OK","201":"Created","202":"Accepted","203":"Non-Authoritative Information","204":"No Content","205":"Reset Content","206":"Partial Content","207":"Multi-Status","208":"Already Reported","226":"IM Used","300":"Multiple Choices","301":"Moved Permanently","302":"Found","303":"See Other","304":"Not Modified","305":"Use Proxy","306":"(Unused)","307":"Temporary Redirect","308":"Permanent Redirect","400":"Bad Request","401":"Unauthorized","402":"Payment Required","403":"Forbidden","404":"Not Found","405":"Method Not Allowed","406":"Not Acceptable","407":"Proxy Authentication Required","408":"Request Timeout","409":"Conflict","410":"Gone","411":"Length Required","412":"Precondition Failed","413":"Payload Too Large","414":"URI Too Long","415":"Unsupported Media Type","416":"Range Not Satisfiable","417":"Expectation Failed","418":"I'm a teapot","421":"Misdirected Request","422":"Unprocessable Entity","423":"Locked","424":"Failed Dependency","425":"Unordered Collection","426":"Upgrade Required","428":"Precondition Required","429":"Too Many Requests","431":"Request Header Fields Too Large","451":"Unavailable For Legal Reasons","500":"Internal Server Error","501":"Not Implemented","502":"Bad Gateway","503":"Service Unavailable","504":"Gateway Timeout","505":"HTTP Version Not Supported","506":"Variant Also Negotiates","507":"Insufficient Storage","508":"Loop Detected","509":"Bandwidth Limit Exceeded","510":"Not Extended","511":"Network Authentication Required"};

var codes=require$$0$1;var statuses$1=status;status.STATUS_CODES=codes;status.codes=populateStatusesMap(status,codes);status.redirect={300:true,301:true,302:true,303:true,305:true,307:true,308:true};status.empty={204:true,205:true,304:true};status.retry={502:true,503:true,504:true};function populateStatusesMap(statuses,codes){var arr=[];Object.keys(codes).forEach(function forEachCode(code){var message=codes[code];var status=Number(code);statuses[status]=message;statuses[message]=status;statuses[message.toLowerCase()]=status;arr.push(status);});return arr}function status(code){if(typeof code==="number"){if(!status[code])throw new Error("invalid status code: "+code);return code}if(typeof code!=="string"){throw new TypeError("code must be a number or string")}var n=parseInt(code,10);if(!isNaN(n)){if(!status[n])throw new Error("invalid status code: "+n);return n}n=status[code.toLowerCase()];if(!n)throw new Error("invalid status message: \""+code+"\"");return n}

var ReadStream=require$$0__default$3["default"].ReadStream;var Stream$1=require$$0__default["default"];var destroy_1=destroy;function destroy(stream){if(stream instanceof ReadStream){return destroyReadStream(stream)}if(!(stream instanceof Stream$1)){return stream}if(typeof stream.destroy==="function"){stream.destroy();}return stream}function destroyReadStream(stream){stream.destroy();if(typeof stream.close==="function"){stream.on("open",onOpenClose);}return stream}function onOpenClose(){if(typeof this.fd==="number"){this.close();}}

var vary$1 = {exports: {}};

vary$1.exports=vary;vary$1.exports.append=append;var FIELD_NAME_REGEXP=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function append(header,field){if(typeof header!=="string"){throw new TypeError("header argument is required")}if(!field){throw new TypeError("field argument is required")}var fields=!Array.isArray(field)?parse$5(String(field)):field;for(var j=0;j<fields.length;j++){if(!FIELD_NAME_REGEXP.test(fields[j])){throw new TypeError("field argument contains an invalid header name")}}if(header==="*"){return header}var val=header;var vals=parse$5(header.toLowerCase());if(fields.indexOf("*")!==-1||vals.indexOf("*")!==-1){return "*"}for(var i=0;i<fields.length;i++){var fld=fields[i].toLowerCase();if(vals.indexOf(fld)===-1){vals.push(fld);val=val?val+", "+fields[i]:fields[i];}}return val}function parse$5(header){var end=0;var list=[];var start=0;for(var i=0,len=header.length;i<len;i++){switch(header.charCodeAt(i)){case 32:if(start===end){start=end=i+1;}break;case 44:list.push(header.substring(start,end));start=end=i+1;break;default:end=i+1;break;}}list.push(header.substring(start,end));return list}function vary(res,field){if(!res||!res.getHeader||!res.setHeader){throw new TypeError("res argument is required")}var val=res.getHeader("Vary")||"";var header=Array.isArray(val)?val.join(", "):String(val);if(val=append(header,field)){res.setHeader("Vary",val);}}

var only$1=function(obj,keys){obj=obj||{};if("string"==typeof keys)keys=keys.split(/ +/);return keys.reduce(function(ret,key){if(null==obj[key])return ret;ret[key]=obj[key];return ret},{})};

var encodeurl=encodeUrl;var ENCODE_CHARS_REGEXP=/(?:[^\x21\x25\x26-\x3B\x3D\x3F-\x5B\x5D\x5F\x61-\x7A\x7E]|%(?:[^0-9A-Fa-f]|[0-9A-Fa-f][^0-9A-Fa-f]|$))+/g;var UNMATCHED_SURROGATE_PAIR_REGEXP=/(^|[^\uD800-\uDBFF])[\uDC00-\uDFFF]|[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/g;var UNMATCHED_SURROGATE_PAIR_REPLACE="$1\uFFFD$2";function encodeUrl(url){return String(url).replace(UNMATCHED_SURROGATE_PAIR_REGEXP,UNMATCHED_SURROGATE_PAIR_REPLACE).replace(ENCODE_CHARS_REGEXP,encodeURI)}

(function(module){const contentDisposition=contentDisposition$1.exports;const getType=cacheContentType;const onFinish=onFinished$2.exports;const escape=escapeHtml_1;const typeis=typeIs.exports.is;const statuses=statuses$1;const destroy=destroy_1;const assert=require$$5__default["default"];const extname=require$$0__default$1["default"].extname;const vary=vary$1.exports;const only=only$1;const util=require$$0__default$2["default"];const encodeUrl=encodeurl;const Stream=require$$0__default["default"];module.exports={get socket(){return this.res.socket},get header(){const{res}=this;return typeof res.getHeaders==="function"?res.getHeaders():res._headers||{}},get headers(){return this.header},get status(){return this.res.statusCode},set status(code){if(this.headerSent)return;assert(Number.isInteger(code),"status code must be a number");assert(code>=100&&code<=999,`invalid status code: ${code}`);this._explicitStatus=true;this.res.statusCode=code;if(this.req.httpVersionMajor<2)this.res.statusMessage=statuses[code];if(this.body&&statuses.empty[code])this.body=null;},get message(){return this.res.statusMessage||statuses[this.status]},set message(msg){this.res.statusMessage=msg;},get body(){return this._body},set body(val){const original=this._body;this._body=val;if(null==val){if(!statuses.empty[this.status])this.status=204;if(val===null)this._explicitNullBody=true;this.remove("Content-Type");this.remove("Content-Length");this.remove("Transfer-Encoding");return}if(!this._explicitStatus)this.status=200;const setType=!this.has("Content-Type");if("string"===typeof val){if(setType)this.type=/^\s*</.test(val)?"html":"text";this.length=Buffer.byteLength(val);return}if(Buffer.isBuffer(val)){if(setType)this.type="bin";this.length=val.length;return}if(val instanceof Stream){onFinish(this.res,destroy.bind(null,val));if(original!=val){val.once("error",err=>this.ctx.onerror(err));if(null!=original)this.remove("Content-Length");}if(setType)this.type="bin";return}this.remove("Content-Length");this.type="json";},set length(n){this.set("Content-Length",n);},get length(){if(this.has("Content-Length")){return parseInt(this.get("Content-Length"),10)||0}const{body}=this;if(!body||body instanceof Stream)return undefined;if("string"===typeof body)return Buffer.byteLength(body);if(Buffer.isBuffer(body))return body.length;return Buffer.byteLength(JSON.stringify(body))},get headerSent(){return this.res.headersSent},vary(field){if(this.headerSent)return;vary(this.res,field);},redirect(url,alt){if("back"===url)url=this.ctx.get("Referrer")||alt||"/";this.set("Location",encodeUrl(url));if(!statuses.redirect[this.status])this.status=302;if(this.ctx.accepts("html")){url=escape(url);this.type="text/html; charset=utf-8";this.body=`Redirecting to <a href="${url}">${url}</a>.`;return}this.type="text/plain; charset=utf-8";this.body=`Redirecting to ${url}.`;},attachment(filename,options){if(filename)this.type=extname(filename);this.set("Content-Disposition",contentDisposition(filename,options));},set type(type){type=getType(type);if(type){this.set("Content-Type",type);}else {this.remove("Content-Type");}},set lastModified(val){if("string"===typeof val)val=new Date(val);this.set("Last-Modified",val.toUTCString());},get lastModified(){const date=this.get("last-modified");if(date)return new Date(date)},set etag(val){if(!/^(W\/)?"/.test(val))val=`"${val}"`;this.set("ETag",val);},get etag(){return this.get("ETag")},get type(){const type=this.get("Content-Type");if(!type)return "";return type.split(";",1)[0]},is(type,...types){return typeis(this.type,type,...types)},get(field){return this.header[field.toLowerCase()]||""},has(field){return typeof this.res.hasHeader==="function"?this.res.hasHeader(field):field.toLowerCase()in this.headers},set(field,val){if(this.headerSent)return;if(2===arguments.length){if(Array.isArray(val))val=val.map(v=>typeof v==="string"?v:String(v));else if(typeof val!=="string")val=String(val);this.res.setHeader(field,val);}else {for(const key in field){this.set(key,field[key]);}}},append(field,val){const prev=this.get(field);if(prev){val=Array.isArray(prev)?prev.concat(val):[prev].concat(val);}return this.set(field,val)},remove(field){if(this.headerSent)return;this.res.removeHeader(field);},get writable(){if(this.res.writableEnded||this.res.finished)return false;const socket=this.res.socket;if(!socket)return true;return socket.writable},inspect(){if(!this.res)return;const o=this.toJSON();o.body=this.body;return o},toJSON(){return only(this,["status","message","header"])},flushHeaders(){this.res.flushHeaders();}};if(util.inspect.custom){module.exports[util.inspect.custom]=module.exports.inspect;}})(response$1);

var koaCompose=compose$3;function compose$3(middleware){if(!Array.isArray(middleware))throw new TypeError("Middleware stack must be an array!");for(const fn of middleware){if(typeof fn!=="function")throw new TypeError("Middleware must be composed of functions!")}return function(context,next){let index=-1;return dispatch(0);function dispatch(i){if(i<=index)return Promise.reject(new Error("next() called multiple times"));index=i;let fn=middleware[i];if(i===middleware.length)fn=next;if(!fn)return Promise.resolve();try{return Promise.resolve(fn(context,dispatch.bind(null,i+1)))}catch(err){return Promise.reject(err)}}}}

var context$1 = {exports: {}};

var httpErrors = {exports: {}};

var compat = {exports: {}};

var callsiteTostring=callSiteToString$1;function callSiteFileLocation(callSite){var fileName;var fileLocation="";if(callSite.isNative()){fileLocation="native";}else if(callSite.isEval()){fileName=callSite.getScriptNameOrSourceURL();if(!fileName){fileLocation=callSite.getEvalOrigin();}}else {fileName=callSite.getFileName();}if(fileName){fileLocation+=fileName;var lineNumber=callSite.getLineNumber();if(lineNumber!=null){fileLocation+=":"+lineNumber;var columnNumber=callSite.getColumnNumber();if(columnNumber){fileLocation+=":"+columnNumber;}}}return fileLocation||"unknown source"}function callSiteToString$1(callSite){var addSuffix=true;var fileLocation=callSiteFileLocation(callSite);var functionName=callSite.getFunctionName();var isConstructor=callSite.isConstructor();var isMethodCall=!(callSite.isToplevel()||isConstructor);var line="";if(isMethodCall){var methodName=callSite.getMethodName();var typeName=getConstructorName(callSite);if(functionName){if(typeName&&functionName.indexOf(typeName)!==0){line+=typeName+".";}line+=functionName;if(methodName&&functionName.lastIndexOf("."+methodName)!==functionName.length-methodName.length-1){line+=" [as "+methodName+"]";}}else {line+=typeName+"."+(methodName||"<anonymous>");}}else if(isConstructor){line+="new "+(functionName||"<anonymous>");}else if(functionName){line+=functionName;}else {addSuffix=false;line+=fileLocation;}if(addSuffix){line+=" ("+fileLocation+")";}return line}function getConstructorName(obj){var receiver=obj.receiver;return receiver.constructor&&receiver.constructor.name||null}

var eventListenerCount_1=eventListenerCount$1;function eventListenerCount$1(emitter,type){return emitter.listeners(type).length}

(function(module){var EventEmitter=require$$0__default$4["default"].EventEmitter;lazyProperty(module.exports,"callSiteToString",function callSiteToString(){var limit=Error.stackTraceLimit;var obj={};var prep=Error.prepareStackTrace;function prepareObjectStackTrace(obj,stack){return stack}Error.prepareStackTrace=prepareObjectStackTrace;Error.stackTraceLimit=2;Error.captureStackTrace(obj);var stack=obj.stack.slice();Error.prepareStackTrace=prep;Error.stackTraceLimit=limit;return stack[0].toString?toString:callsiteTostring});lazyProperty(module.exports,"eventListenerCount",function eventListenerCount(){return EventEmitter.listenerCount||eventListenerCount_1});function lazyProperty(obj,prop,getter){function get(){var val=getter();Object.defineProperty(obj,prop,{configurable:true,enumerable:true,value:val});return val}Object.defineProperty(obj,prop,{configurable:true,enumerable:true,get:get});}function toString(obj){return obj.toString()}})(compat);

var callSiteToString=compat.exports.callSiteToString;var eventListenerCount=compat.exports.eventListenerCount;var relative$2=require$$0__default$1["default"].relative;var depd_1$2=depd$2;var basePath$2=process.cwd();function containsNamespace$2(str,namespace){var vals=str.split(/[ ,]+/);var ns=String(namespace).toLowerCase();for(var i=0;i<vals.length;i++){var val=vals[i];if(val&&(val==="*"||val.toLowerCase()===ns)){return true}}return false}function convertDataDescriptorToAccessor$2(obj,prop,message){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);var value=descriptor.value;descriptor.get=function getter(){return value};if(descriptor.writable){descriptor.set=function setter(val){return value=val};}delete descriptor.value;delete descriptor.writable;Object.defineProperty(obj,prop,descriptor);return descriptor}function createArgumentsString$2(arity){var str="";for(var i=0;i<arity;i++){str+=", arg"+i;}return str.substr(2)}function createStackString$2(stack){var str=this.name+": "+this.namespace;if(this.message){str+=" deprecated "+this.message;}for(var i=0;i<stack.length;i++){str+="\n    at "+callSiteToString(stack[i]);}return str}function depd$2(namespace){if(!namespace){throw new TypeError("argument namespace is required")}var stack=getStack$2();var site=callSiteLocation$2(stack[1]);var file=site[0];function deprecate(message){log$2.call(deprecate,message);}deprecate._file=file;deprecate._ignored=isignored$2(namespace);deprecate._namespace=namespace;deprecate._traced=istraced$2(namespace);deprecate._warned=Object.create(null);deprecate.function=wrapfunction$2;deprecate.property=wrapproperty$2;return deprecate}function isignored$2(namespace){if(process.noDeprecation){return true}var str=process.env.NO_DEPRECATION||"";return containsNamespace$2(str,namespace)}function istraced$2(namespace){if(process.traceDeprecation){return true}var str=process.env.TRACE_DEPRECATION||"";return containsNamespace$2(str,namespace)}function log$2(message,site){var haslisteners=eventListenerCount(process,"deprecation")!==0;if(!haslisteners&&this._ignored){return}var caller;var callFile;var callSite;var depSite;var i=0;var seen=false;var stack=getStack$2();var file=this._file;if(site){depSite=site;callSite=callSiteLocation$2(stack[1]);callSite.name=depSite.name;file=callSite[0];}else {i=2;depSite=callSiteLocation$2(stack[i]);callSite=depSite;}for(;i<stack.length;i++){caller=callSiteLocation$2(stack[i]);callFile=caller[0];if(callFile===file){seen=true;}else if(callFile===this._file){file=this._file;}else if(seen){break}}var key=caller?depSite.join(":")+"__"+caller.join(":"):undefined;if(key!==undefined&&key in this._warned){return}this._warned[key]=true;var msg=message;if(!msg){msg=callSite===depSite||!callSite.name?defaultMessage$2(depSite):defaultMessage$2(callSite);}if(haslisteners){var err=DeprecationError$2(this._namespace,msg,stack.slice(i));process.emit("deprecation",err);return}var format=process.stderr.isTTY?formatColor$2:formatPlain$2;var output=format.call(this,msg,caller,stack.slice(i));process.stderr.write(output+"\n","utf8");}function callSiteLocation$2(callSite){var file=callSite.getFileName()||"<anonymous>";var line=callSite.getLineNumber();var colm=callSite.getColumnNumber();if(callSite.isEval()){file=callSite.getEvalOrigin()+", "+file;}var site=[file,line,colm];site.callSite=callSite;site.name=callSite.getFunctionName();return site}function defaultMessage$2(site){var callSite=site.callSite;var funcName=site.name;if(!funcName){funcName="<anonymous@"+formatLocation$2(site)+">";}var context=callSite.getThis();var typeName=context&&callSite.getTypeName();if(typeName==="Object"){typeName=undefined;}if(typeName==="Function"){typeName=context.name||typeName;}return typeName&&callSite.getMethodName()?typeName+"."+funcName:funcName}function formatPlain$2(msg,caller,stack){var timestamp=new Date().toUTCString();var formatted=timestamp+" "+this._namespace+" deprecated "+msg;if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    at "+callSiteToString(stack[i]);}return formatted}if(caller){formatted+=" at "+formatLocation$2(caller);}return formatted}function formatColor$2(msg,caller,stack){var formatted="\x1B[36;1m"+this._namespace+"\x1B[22;39m"+" \x1B[33;1mdeprecated\x1B[22;39m"+" \x1B[0m"+msg+"\x1B[39m";if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    \x1B[36mat "+callSiteToString(stack[i])+"\x1B[39m";}return formatted}if(caller){formatted+=" \x1B[36m"+formatLocation$2(caller)+"\x1B[39m";}return formatted}function formatLocation$2(callSite){return relative$2(basePath$2,callSite[0])+":"+callSite[1]+":"+callSite[2]}function getStack$2(){var limit=Error.stackTraceLimit;var obj={};var prep=Error.prepareStackTrace;Error.prepareStackTrace=prepareObjectStackTrace$2;Error.stackTraceLimit=Math.max(10,limit);Error.captureStackTrace(obj);var stack=obj.stack.slice(1);Error.prepareStackTrace=prep;Error.stackTraceLimit=limit;return stack}function prepareObjectStackTrace$2(obj,stack){return stack}function wrapfunction$2(fn,message){if(typeof fn!=="function"){throw new TypeError("argument fn must be a function")}var args=createArgumentsString$2(fn.length);var stack=getStack$2();var site=callSiteLocation$2(stack[1]);site.name=fn.name;var deprecatedfn=eval("(function ("+args+") {\n"+"\"use strict\"\n"+"log.call(deprecate, message, site)\n"+"return fn.apply(this, arguments)\n"+"})");return deprecatedfn}function wrapproperty$2(obj,prop,message){if(!obj||typeof obj!=="object"&&typeof obj!=="function"){throw new TypeError("argument obj must be object")}var descriptor=Object.getOwnPropertyDescriptor(obj,prop);if(!descriptor){throw new TypeError("must call property on owner object")}if(!descriptor.configurable){throw new TypeError("property must be configurable")}var deprecate=this;var stack=getStack$2();var site=callSiteLocation$2(stack[1]);site.name=prop;if("value"in descriptor){descriptor=convertDataDescriptorToAccessor$2(obj,prop);}var get=descriptor.get;var set=descriptor.set;if(typeof get==="function"){descriptor.get=function getter(){log$2.call(deprecate,message,site);return get.apply(this,arguments)};}if(typeof set==="function"){descriptor.set=function setter(){log$2.call(deprecate,message,site);return set.apply(this,arguments)};}Object.defineProperty(obj,prop,descriptor);}function DeprecationError$2(namespace,message,stack){var error=new Error;var stackString;Object.defineProperty(error,"constructor",{value:DeprecationError$2});Object.defineProperty(error,"message",{configurable:true,enumerable:false,value:message,writable:true});Object.defineProperty(error,"name",{enumerable:false,configurable:true,value:"DeprecationError",writable:true});Object.defineProperty(error,"namespace",{configurable:true,enumerable:false,value:namespace,writable:true});Object.defineProperty(error,"stack",{configurable:true,enumerable:false,get:function(){if(stackString!==undefined){return stackString}return stackString=createStackString$2.call(this,stack)},set:function setter(val){stackString=val;}});return error}

var setprototypeof=Object.setPrototypeOf||({__proto__:[]}instanceof Array?setProtoOf:mixinProperties);function setProtoOf(obj,proto){obj.__proto__=proto;return obj}function mixinProperties(obj,proto){for(var prop in proto){if(!Object.prototype.hasOwnProperty.call(obj,prop)){obj[prop]=proto[prop];}}return obj}

var inherits = {exports: {}};

var inherits_browser = {exports: {}};

if(typeof Object.create==="function"){inherits_browser.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}});}};}else {inherits_browser.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor;}};}

try{var util$1=require("util");if(typeof util$1.inherits!=="function")throw "";inherits.exports=util$1.inherits;}catch(e){inherits.exports=inherits_browser.exports;}

var toidentifier=toIdentifier;function toIdentifier(str){return str.split(" ").map(function(token){return token.slice(0,1).toUpperCase()+token.slice(1)}).join("").replace(/[^ _0-9a-z]/gi,"")}

(function(module){var deprecate=depd_1$2("http-errors");var setPrototypeOf=setprototypeof;var statuses=statuses$1;var inherits$1=inherits.exports;var toIdentifier=toidentifier;module.exports=createError;module.exports.HttpError=createHttpErrorConstructor();module.exports.isHttpError=createIsHttpErrorFunction(module.exports.HttpError);populateConstructorExports(module.exports,statuses.codes,module.exports.HttpError);function codeClass(status){return Number(String(status).charAt(0)+"00")}function createError(){var err;var msg;var status=500;var props={};for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(arg instanceof Error){err=arg;status=err.status||err.statusCode||status;continue}switch(typeof arg){case"string":msg=arg;break;case"number":status=arg;if(i!==0){deprecate("non-first-argument status code; replace with createError("+arg+", ...)");}break;case"object":props=arg;break;}}if(typeof status==="number"&&(status<400||status>=600)){deprecate("non-error status code; use only 4xx or 5xx status codes");}if(typeof status!=="number"||!statuses[status]&&(status<400||status>=600)){status=500;}var HttpError=createError[status]||createError[codeClass(status)];if(!err){err=HttpError?new HttpError(msg):new Error(msg||statuses[status]);Error.captureStackTrace(err,createError);}if(!HttpError||!(err instanceof HttpError)||err.status!==status){err.expose=status<500;err.status=err.statusCode=status;}for(var key in props){if(key!=="status"&&key!=="statusCode"){err[key]=props[key];}}return err}function createHttpErrorConstructor(){function HttpError(){throw new TypeError("cannot construct abstract class")}inherits$1(HttpError,Error);return HttpError}function createClientErrorConstructor(HttpError,name,code){var className=toClassName(name);function ClientError(message){var msg=message!=null?message:statuses[code];var err=new Error(msg);Error.captureStackTrace(err,ClientError);setPrototypeOf(err,ClientError.prototype);Object.defineProperty(err,"message",{enumerable:true,configurable:true,value:msg,writable:true});Object.defineProperty(err,"name",{enumerable:false,configurable:true,value:className,writable:true});return err}inherits$1(ClientError,HttpError);nameFunc(ClientError,className);ClientError.prototype.status=code;ClientError.prototype.statusCode=code;ClientError.prototype.expose=true;return ClientError}function createIsHttpErrorFunction(HttpError){return function isHttpError(val){if(!val||typeof val!=="object"){return false}if(val instanceof HttpError){return true}return val instanceof Error&&typeof val.expose==="boolean"&&typeof val.statusCode==="number"&&val.status===val.statusCode}}function createServerErrorConstructor(HttpError,name,code){var className=toClassName(name);function ServerError(message){var msg=message!=null?message:statuses[code];var err=new Error(msg);Error.captureStackTrace(err,ServerError);setPrototypeOf(err,ServerError.prototype);Object.defineProperty(err,"message",{enumerable:true,configurable:true,value:msg,writable:true});Object.defineProperty(err,"name",{enumerable:false,configurable:true,value:className,writable:true});return err}inherits$1(ServerError,HttpError);nameFunc(ServerError,className);ServerError.prototype.status=code;ServerError.prototype.statusCode=code;ServerError.prototype.expose=false;return ServerError}function nameFunc(func,name){var desc=Object.getOwnPropertyDescriptor(func,"name");if(desc&&desc.configurable){desc.value=name;Object.defineProperty(func,"name",desc);}}function populateConstructorExports(exports,codes,HttpError){codes.forEach(function forEachCode(code){var CodeError;var name=toIdentifier(statuses[code]);switch(codeClass(code)){case 400:CodeError=createClientErrorConstructor(HttpError,name,code);break;case 500:CodeError=createServerErrorConstructor(HttpError,name,code);break;}if(CodeError){exports[code]=CodeError;exports[name]=CodeError;}});exports["I'mateapot"]=deprecate.function(exports.ImATeapot,"\"I'mateapot\"; use \"ImATeapot\" instead");}function toClassName(name){return name.substr(-5)!=="Error"?name+"Error":name}})(httpErrors);

var deepEqual$1 = {exports: {}};

var keys = {exports: {}};

(function(module,exports){exports=module.exports=typeof Object.keys==="function"?Object.keys:shim;exports.shim=shim;function shim(obj){var keys=[];for(var key in obj)keys.push(key);return keys}})(keys,keys.exports);

var is_arguments = {exports: {}};

(function(module,exports){var supportsArgumentsClass=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";exports=module.exports=supportsArgumentsClass?supported:unsupported;exports.supported=supported;function supported(object){return Object.prototype.toString.call(object)=="[object Arguments]"}exports.unsupported=unsupported;function unsupported(object){return object&&typeof object=="object"&&typeof object.length=="number"&&Object.prototype.hasOwnProperty.call(object,"callee")&&!Object.prototype.propertyIsEnumerable.call(object,"callee")||false}})(is_arguments,is_arguments.exports);

var pSlice=Array.prototype.slice;var objectKeys=keys.exports;var isArguments=is_arguments.exports;var deepEqual=deepEqual$1.exports=function(actual,expected,opts){if(!opts)opts={};if(actual===expected){return true}else if(actual instanceof Date&&expected instanceof Date){return actual.getTime()===expected.getTime()}else if(!actual||!expected||typeof actual!="object"&&typeof expected!="object"){return opts.strict?actual===expected:actual==expected}else {return objEquiv(actual,expected,opts)}};function isUndefinedOrNull(value){return value===null||value===undefined}function isBuffer(x){if(!x||typeof x!=="object"||typeof x.length!=="number")return false;if(typeof x.copy!=="function"||typeof x.slice!=="function"){return false}if(x.length>0&&typeof x[0]!=="number")return false;return true}function objEquiv(a,b,opts){var i,key;if(isUndefinedOrNull(a)||isUndefinedOrNull(b))return false;if(a.prototype!==b.prototype)return false;if(isArguments(a)){if(!isArguments(b)){return false}a=pSlice.call(a);b=pSlice.call(b);return deepEqual(a,b,opts)}if(isBuffer(a)){if(!isBuffer(b)){return false}if(a.length!==b.length)return false;for(i=0;i<a.length;i++){if(a[i]!==b[i])return false}return true}try{var ka=objectKeys(a),kb=objectKeys(b);}catch(e){return false}if(ka.length!=kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!=kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!deepEqual(a[key],b[key],opts))return false}return typeof a===typeof b}

var createError=httpErrors.exports;var eql=deepEqual$1.exports;var httpAssert=assert;function assert(value,status,msg,opts){if(value)return;throw createError(status,msg,opts)}assert.fail=function(status,msg,opts){assert(false,status,msg,opts);};assert.equal=function(a,b,status,msg,opts){assert(a==b,status,msg,opts);};assert.notEqual=function(a,b,status,msg,opts){assert(a!=b,status,msg,opts);};assert.ok=function(value,status,msg,opts){assert(value,status,msg,opts);};assert.strictEqual=function(a,b,status,msg,opts){assert(a===b,status,msg,opts);};assert.notStrictEqual=function(a,b,status,msg,opts){assert(a!==b,status,msg,opts);};assert.deepEqual=function(a,b,status,msg,opts){assert(eql(a,b),status,msg,opts);};assert.notDeepEqual=function(a,b,status,msg,opts){assert(!eql(a,b),status,msg,opts);};

var delegates=Delegator;function Delegator(proto,target){if(!(this instanceof Delegator))return new Delegator(proto,target);this.proto=proto;this.target=target;this.methods=[];this.getters=[];this.setters=[];this.fluents=[];}Delegator.prototype.method=function(name){var proto=this.proto;var target=this.target;this.methods.push(name);proto[name]=function(){return this[target][name].apply(this[target],arguments)};return this};Delegator.prototype.access=function(name){return this.getter(name).setter(name)};Delegator.prototype.getter=function(name){var proto=this.proto;var target=this.target;this.getters.push(name);proto.__defineGetter__(name,function(){return this[target][name]});return this};Delegator.prototype.setter=function(name){var proto=this.proto;var target=this.target;this.setters.push(name);proto.__defineSetter__(name,function(val){return this[target][name]=val});return this};Delegator.prototype.fluent=function(name){var proto=this.proto;var target=this.target;this.fluents.push(name);proto[name]=function(val){if("undefined"!=typeof val){this[target][name]=val;return this}else {return this[target][name]}};return this};

var relative$1=require$$0__default$1["default"].relative;var depd_1$1=depd$1;var basePath$1=process.cwd();function containsNamespace$1(str,namespace){var vals=str.split(/[ ,]+/);var ns=String(namespace).toLowerCase();for(var i=0;i<vals.length;i++){var val=vals[i];if(val&&(val==="*"||val.toLowerCase()===ns)){return true}}return false}function convertDataDescriptorToAccessor$1(obj,prop,message){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);var value=descriptor.value;descriptor.get=function getter(){return value};if(descriptor.writable){descriptor.set=function setter(val){return value=val};}delete descriptor.value;delete descriptor.writable;Object.defineProperty(obj,prop,descriptor);return descriptor}function createArgumentsString$1(arity){var str="";for(var i=0;i<arity;i++){str+=", arg"+i;}return str.substr(2)}function createStackString$1(stack){var str=this.name+": "+this.namespace;if(this.message){str+=" deprecated "+this.message;}for(var i=0;i<stack.length;i++){str+="\n    at "+stack[i].toString();}return str}function depd$1(namespace){if(!namespace){throw new TypeError("argument namespace is required")}var stack=getStack$1();var site=callSiteLocation$1(stack[1]);var file=site[0];function deprecate(message){log$1.call(deprecate,message);}deprecate._file=file;deprecate._ignored=isignored$1(namespace);deprecate._namespace=namespace;deprecate._traced=istraced$1(namespace);deprecate._warned=Object.create(null);deprecate.function=wrapfunction$1;deprecate.property=wrapproperty$1;return deprecate}function eehaslisteners$1(emitter,type){var count=typeof emitter.listenerCount!=="function"?emitter.listeners(type).length:emitter.listenerCount(type);return count>0}function isignored$1(namespace){if(process.noDeprecation){return true}var str=process.env.NO_DEPRECATION||"";return containsNamespace$1(str,namespace)}function istraced$1(namespace){if(process.traceDeprecation){return true}var str=process.env.TRACE_DEPRECATION||"";return containsNamespace$1(str,namespace)}function log$1(message,site){var haslisteners=eehaslisteners$1(process,"deprecation");if(!haslisteners&&this._ignored){return}var caller;var callFile;var callSite;var depSite;var i=0;var seen=false;var stack=getStack$1();var file=this._file;if(site){depSite=site;callSite=callSiteLocation$1(stack[1]);callSite.name=depSite.name;file=callSite[0];}else {i=2;depSite=callSiteLocation$1(stack[i]);callSite=depSite;}for(;i<stack.length;i++){caller=callSiteLocation$1(stack[i]);callFile=caller[0];if(callFile===file){seen=true;}else if(callFile===this._file){file=this._file;}else if(seen){break}}var key=caller?depSite.join(":")+"__"+caller.join(":"):undefined;if(key!==undefined&&key in this._warned){return}this._warned[key]=true;var msg=message;if(!msg){msg=callSite===depSite||!callSite.name?defaultMessage$1(depSite):defaultMessage$1(callSite);}if(haslisteners){var err=DeprecationError$1(this._namespace,msg,stack.slice(i));process.emit("deprecation",err);return}var format=process.stderr.isTTY?formatColor$1:formatPlain$1;var output=format.call(this,msg,caller,stack.slice(i));process.stderr.write(output+"\n","utf8");}function callSiteLocation$1(callSite){var file=callSite.getFileName()||"<anonymous>";var line=callSite.getLineNumber();var colm=callSite.getColumnNumber();if(callSite.isEval()){file=callSite.getEvalOrigin()+", "+file;}var site=[file,line,colm];site.callSite=callSite;site.name=callSite.getFunctionName();return site}function defaultMessage$1(site){var callSite=site.callSite;var funcName=site.name;if(!funcName){funcName="<anonymous@"+formatLocation$1(site)+">";}var context=callSite.getThis();var typeName=context&&callSite.getTypeName();if(typeName==="Object"){typeName=undefined;}if(typeName==="Function"){typeName=context.name||typeName;}return typeName&&callSite.getMethodName()?typeName+"."+funcName:funcName}function formatPlain$1(msg,caller,stack){var timestamp=new Date().toUTCString();var formatted=timestamp+" "+this._namespace+" deprecated "+msg;if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    at "+stack[i].toString();}return formatted}if(caller){formatted+=" at "+formatLocation$1(caller);}return formatted}function formatColor$1(msg,caller,stack){var formatted="\x1B[36;1m"+this._namespace+"\x1B[22;39m"+" \x1B[33;1mdeprecated\x1B[22;39m"+" \x1B[0m"+msg+"\x1B[39m";if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    \x1B[36mat "+stack[i].toString()+"\x1B[39m";}return formatted}if(caller){formatted+=" \x1B[36m"+formatLocation$1(caller)+"\x1B[39m";}return formatted}function formatLocation$1(callSite){return relative$1(basePath$1,callSite[0])+":"+callSite[1]+":"+callSite[2]}function getStack$1(){var limit=Error.stackTraceLimit;var obj={};var prep=Error.prepareStackTrace;Error.prepareStackTrace=prepareObjectStackTrace$1;Error.stackTraceLimit=Math.max(10,limit);Error.captureStackTrace(obj);var stack=obj.stack.slice(1);Error.prepareStackTrace=prep;Error.stackTraceLimit=limit;return stack}function prepareObjectStackTrace$1(obj,stack){return stack}function wrapfunction$1(fn,message){if(typeof fn!=="function"){throw new TypeError("argument fn must be a function")}var args=createArgumentsString$1(fn.length);var stack=getStack$1();var site=callSiteLocation$1(stack[1]);site.name=fn.name;var deprecatedfn=new Function("fn","log","deprecate","message","site","\"use strict\"\n"+"return function ("+args+") {"+"log.call(deprecate, message, site)\n"+"return fn.apply(this, arguments)\n"+"}")(fn,log$1,this,message,site);return deprecatedfn}function wrapproperty$1(obj,prop,message){if(!obj||typeof obj!=="object"&&typeof obj!=="function"){throw new TypeError("argument obj must be object")}var descriptor=Object.getOwnPropertyDescriptor(obj,prop);if(!descriptor){throw new TypeError("must call property on owner object")}if(!descriptor.configurable){throw new TypeError("property must be configurable")}var deprecate=this;var stack=getStack$1();var site=callSiteLocation$1(stack[1]);site.name=prop;if("value"in descriptor){descriptor=convertDataDescriptorToAccessor$1(obj,prop);}var get=descriptor.get;var set=descriptor.set;if(typeof get==="function"){descriptor.get=function getter(){log$1.call(deprecate,message,site);return get.apply(this,arguments)};}if(typeof set==="function"){descriptor.set=function setter(){log$1.call(deprecate,message,site);return set.apply(this,arguments)};}Object.defineProperty(obj,prop,descriptor);}function DeprecationError$1(namespace,message,stack){var error=new Error;var stackString;Object.defineProperty(error,"constructor",{value:DeprecationError$1});Object.defineProperty(error,"message",{configurable:true,enumerable:false,value:message,writable:true});Object.defineProperty(error,"name",{enumerable:false,configurable:true,value:"DeprecationError",writable:true});Object.defineProperty(error,"namespace",{configurable:true,enumerable:false,value:namespace,writable:true});Object.defineProperty(error,"stack",{configurable:true,enumerable:false,get:function(){if(stackString!==undefined){return stackString}return stackString=createStackString$1.call(this,stack)},set:function setter(val){stackString=val;}});return error}

var crypto$2=crypto__default["default"];function bufferEqual(a,b){if(a.length!==b.length){return false}if(crypto$2.timingSafeEqual){return crypto$2.timingSafeEqual(a,b)}for(var i=0;i<a.length;i++){if(a[i]!==b[i]){return false}}return true}function timeSafeCompare(a,b){var sa=String(a);var sb=String(b);var key=crypto$2.pseudoRandomBytes(32);var ah=crypto$2.createHmac("sha256",key).update(sa).digest();var bh=crypto$2.createHmac("sha256",key).update(sb).digest();return bufferEqual(ah,bh)&&a===b}var lib=timeSafeCompare;

var compare=lib;var crypto$1=crypto__default["default"];function Keygrip$1(keys,algorithm,encoding){if(!algorithm)algorithm="sha1";if(!encoding)encoding="base64";if(!(this instanceof Keygrip$1))return new Keygrip$1(keys,algorithm,encoding);if(!keys||!(0 in keys)){throw new Error("Keys must be provided.")}function sign(data,key){return crypto$1.createHmac(algorithm,key).update(data).digest(encoding).replace(/\/|\+|=/g,function(x){return {"/":"_","+":"-","=":""}[x]})}this.sign=function(data){return sign(data,keys[0])};this.verify=function(data,digest){return this.index(data,digest)>-1};this.index=function(data,digest){for(var i=0,l=keys.length;i<l;i++){if(compare(digest,sign(data,keys[i]))){return i}}return -1};}Keygrip$1.sign=Keygrip$1.verify=Keygrip$1.index=function(){throw new Error("Usage: require('keygrip')(<array-of-keys>)")};var keygrip=Keygrip$1;

var deprecate$1=depd_1$1("cookies");var Keygrip=keygrip;var http$2=require$$2__default["default"];var cache={};var fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;var SAME_SITE_REGEXP=/^(?:lax|none|strict)$/i;function Cookies(request,response,options){if(!(this instanceof Cookies))return new Cookies(request,response,options);this.secure=undefined;this.request=request;this.response=response;if(options){if(Array.isArray(options)){deprecate$1("\"keys\" argument; provide using options {\"keys\": [...]}");this.keys=new Keygrip(options);}else if(options.constructor&&options.constructor.name==="Keygrip"){deprecate$1("\"keys\" argument; provide using options {\"keys\": keygrip}");this.keys=options;}else {this.keys=Array.isArray(options.keys)?new Keygrip(options.keys):options.keys;this.secure=options.secure;}}}Cookies.prototype.get=function(name,opts){var sigName=name+".sig",header,match,value,remote,data,index,signed=opts&&opts.signed!==undefined?opts.signed:!!this.keys;header=this.request.headers["cookie"];if(!header)return;match=header.match(getPattern(name));if(!match)return;value=match[1];if(!opts||!signed)return value;remote=this.get(sigName);if(!remote)return;data=name+"="+value;if(!this.keys)throw new Error(".keys required for signed cookies");index=this.keys.index(data,remote);if(index<0){this.set(sigName,null,{path:"/",signed:false});}else {index&&this.set(sigName,this.keys.sign(data),{signed:false});return value}};Cookies.prototype.set=function(name,value,opts){var res=this.response,req=this.request,headers=res.getHeader("Set-Cookie")||[],secure=this.secure!==undefined?!!this.secure:req.protocol==="https"||req.connection.encrypted,cookie=new Cookie(name,value,opts),signed=opts&&opts.signed!==undefined?opts.signed:!!this.keys;if(typeof headers=="string")headers=[headers];if(!secure&&opts&&opts.secure){throw new Error("Cannot send secure cookie over unencrypted connection")}cookie.secure=opts&&opts.secure!==undefined?opts.secure:secure;if(opts&&"secureProxy"in opts){deprecate$1("\"secureProxy\" option; use \"secure\" option, provide \"secure\" to constructor if needed");cookie.secure=opts.secureProxy;}pushCookie(headers,cookie);if(opts&&signed){if(!this.keys)throw new Error(".keys required for signed cookies");cookie.value=this.keys.sign(cookie.toString());cookie.name+=".sig";pushCookie(headers,cookie);}var setHeader=res.set?http$2.OutgoingMessage.prototype.setHeader:res.setHeader;setHeader.call(res,"Set-Cookie",headers);return this};function Cookie(name,value,attrs){if(!fieldContentRegExp.test(name)){throw new TypeError("argument name is invalid")}if(value&&!fieldContentRegExp.test(value)){throw new TypeError("argument value is invalid")}this.name=name;this.value=value||"";for(var name in attrs){this[name]=attrs[name];}if(!this.value){this.expires=new Date(0);this.maxAge=null;}if(this.path&&!fieldContentRegExp.test(this.path)){throw new TypeError("option path is invalid")}if(this.domain&&!fieldContentRegExp.test(this.domain)){throw new TypeError("option domain is invalid")}if(this.sameSite&&this.sameSite!==true&&!SAME_SITE_REGEXP.test(this.sameSite)){throw new TypeError("option sameSite is invalid")}}Cookie.prototype.path="/";Cookie.prototype.expires=undefined;Cookie.prototype.domain=undefined;Cookie.prototype.httpOnly=true;Cookie.prototype.sameSite=false;Cookie.prototype.secure=false;Cookie.prototype.overwrite=false;Cookie.prototype.toString=function(){return this.name+"="+this.value};Cookie.prototype.toHeader=function(){var header=this.toString();if(this.maxAge)this.expires=new Date(Date.now()+this.maxAge);if(this.path)header+="; path="+this.path;if(this.expires)header+="; expires="+this.expires.toUTCString();if(this.domain)header+="; domain="+this.domain;if(this.sameSite)header+="; samesite="+(this.sameSite===true?"strict":this.sameSite.toLowerCase());if(this.secure)header+="; secure";if(this.httpOnly)header+="; httponly";return header};Object.defineProperty(Cookie.prototype,"maxage",{configurable:true,enumerable:true,get:function(){return this.maxAge},set:function(val){return this.maxAge=val}});deprecate$1.property(Cookie.prototype,"maxage","\"maxage\"; use \"maxAge\" instead");function getPattern(name){if(cache[name])return cache[name];return cache[name]=new RegExp("(?:^|;) *"+name.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"=([^;]*)")}function pushCookie(headers,cookie){if(cookie.overwrite){for(var i=headers.length-1;i>=0;i--){if(headers[i].indexOf(cookie.name+"=")===0){headers.splice(i,1);}}}headers.push(cookie.toHeader());}Cookies.connect=Cookies.express=function(keys){return function(req,res,next){req.cookies=res.cookies=new Cookies(req,res,{keys:keys});next();}};Cookies.Cookie=Cookie;var cookies=Cookies;

(function(module){const util=require$$0__default$2["default"];const createError=httpErrors.exports;const httpAssert$1=httpAssert;const delegate=delegates;const statuses=statuses$1;const Cookies=cookies;const COOKIES=Symbol("context#cookies");const proto=module.exports={inspect(){if(this===proto)return this;return this.toJSON()},toJSON(){return {request:this.request.toJSON(),response:this.response.toJSON(),app:this.app.toJSON(),originalUrl:this.originalUrl,req:"<original node req>",res:"<original node res>",socket:"<original node socket>"}},assert:httpAssert$1,throw(...args){throw createError(...args)},onerror(err){if(null==err)return;const isNativeError=Object.prototype.toString.call(err)==="[object Error]"||err instanceof Error;if(!isNativeError)err=new Error(util.format("non-error thrown: %j",err));let headerSent=false;if(this.headerSent||!this.writable){headerSent=err.headerSent=true;}this.app.emit("error",err,this);if(headerSent){return}const{res}=this;if(typeof res.getHeaderNames==="function"){res.getHeaderNames().forEach(name=>res.removeHeader(name));}else {res._headers={};}this.set(err.headers);this.type="text";let statusCode=err.status||err.statusCode;if("ENOENT"===err.code)statusCode=404;if("number"!==typeof statusCode||!statuses[statusCode])statusCode=500;const code=statuses[statusCode];const msg=err.expose?err.message:code;this.status=err.status=statusCode;this.length=Buffer.byteLength(msg);res.end(msg);},get cookies(){if(!this[COOKIES]){this[COOKIES]=new Cookies(this.req,this.res,{keys:this.app.keys,secure:this.request.secure});}return this[COOKIES]},set cookies(_cookies){this[COOKIES]=_cookies;}};if(util.inspect.custom){module.exports[util.inspect.custom]=module.exports.inspect;}delegate(proto,"response").method("attachment").method("redirect").method("remove").method("vary").method("has").method("set").method("append").method("flushHeaders").access("status").access("message").access("body").access("length").access("type").access("lastModified").access("etag").getter("headerSent").getter("writable");delegate(proto,"request").method("acceptsLanguages").method("acceptsEncodings").method("acceptsCharsets").method("accepts").method("get").method("is").access("querystring").access("idempotent").access("socket").access("search").access("method").access("query").access("path").access("url").access("accept").getter("origin").getter("href").getter("subdomains").getter("protocol").getter("host").getter("hostname").getter("URL").getter("header").getter("headers").getter("secure").getter("stale").getter("fresh").getter("ips").getter("ip");})(context$1);

var request$1 = {exports: {}};

var negotiator = {exports: {}};

var charset = {exports: {}};

charset.exports=preferredCharsets;charset.exports.preferredCharsets=preferredCharsets;var simpleCharsetRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseAcceptCharset(accept){var accepts=accept.split(",");for(var i=0,j=0;i<accepts.length;i++){var charset=parseCharset(accepts[i].trim(),i);if(charset){accepts[j++]=charset;}}accepts.length=j;return accepts}function parseCharset(str,i){var match=simpleCharsetRegExp.exec(str);if(!match)return null;var charset=match[1];var q=1;if(match[2]){var params=match[2].split(";");for(var j=0;j<params.length;j++){var p=params[j].trim().split("=");if(p[0]==="q"){q=parseFloat(p[1]);break}}}return {charset:charset,q:q,i:i}}function getCharsetPriority(charset,accepted,index){var priority={o:-1,q:0,s:0};for(var i=0;i<accepted.length;i++){var spec=specify$3(charset,accepted[i],index);if(spec&&(priority.s-spec.s||priority.q-spec.q||priority.o-spec.o)<0){priority=spec;}}return priority}function specify$3(charset,spec,index){var s=0;if(spec.charset.toLowerCase()===charset.toLowerCase()){s|=1;}else if(spec.charset!=="*"){return null}return {i:index,o:spec.i,q:spec.q,s:s}}function preferredCharsets(accept,provided){var accepts=parseAcceptCharset(accept===undefined?"*":accept||"");if(!provided){return accepts.filter(isQuality$3).sort(compareSpecs$3).map(getFullCharset)}var priorities=provided.map(function getPriority(type,index){return getCharsetPriority(type,accepts,index)});return priorities.filter(isQuality$3).sort(compareSpecs$3).map(function getCharset(priority){return provided[priorities.indexOf(priority)]})}function compareSpecs$3(a,b){return b.q-a.q||b.s-a.s||a.o-b.o||a.i-b.i||0}function getFullCharset(spec){return spec.charset}function isQuality$3(spec){return spec.q>0}

var encoding = {exports: {}};

encoding.exports=preferredEncodings;encoding.exports.preferredEncodings=preferredEncodings;var simpleEncodingRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseAcceptEncoding(accept){var accepts=accept.split(",");var hasIdentity=false;var minQuality=1;for(var i=0,j=0;i<accepts.length;i++){var encoding=parseEncoding(accepts[i].trim(),i);if(encoding){accepts[j++]=encoding;hasIdentity=hasIdentity||specify$2("identity",encoding);minQuality=Math.min(minQuality,encoding.q||1);}}if(!hasIdentity){accepts[j++]={encoding:"identity",q:minQuality,i:i};}accepts.length=j;return accepts}function parseEncoding(str,i){var match=simpleEncodingRegExp.exec(str);if(!match)return null;var encoding=match[1];var q=1;if(match[2]){var params=match[2].split(";");for(var j=0;j<params.length;j++){var p=params[j].trim().split("=");if(p[0]==="q"){q=parseFloat(p[1]);break}}}return {encoding:encoding,q:q,i:i}}function getEncodingPriority(encoding,accepted,index){var priority={o:-1,q:0,s:0};for(var i=0;i<accepted.length;i++){var spec=specify$2(encoding,accepted[i],index);if(spec&&(priority.s-spec.s||priority.q-spec.q||priority.o-spec.o)<0){priority=spec;}}return priority}function specify$2(encoding,spec,index){var s=0;if(spec.encoding.toLowerCase()===encoding.toLowerCase()){s|=1;}else if(spec.encoding!=="*"){return null}return {i:index,o:spec.i,q:spec.q,s:s}}function preferredEncodings(accept,provided){var accepts=parseAcceptEncoding(accept||"");if(!provided){return accepts.filter(isQuality$2).sort(compareSpecs$2).map(getFullEncoding)}var priorities=provided.map(function getPriority(type,index){return getEncodingPriority(type,accepts,index)});return priorities.filter(isQuality$2).sort(compareSpecs$2).map(function getEncoding(priority){return provided[priorities.indexOf(priority)]})}function compareSpecs$2(a,b){return b.q-a.q||b.s-a.s||a.o-b.o||a.i-b.i||0}function getFullEncoding(spec){return spec.encoding}function isQuality$2(spec){return spec.q>0}

var language = {exports: {}};

language.exports=preferredLanguages;language.exports.preferredLanguages=preferredLanguages;var simpleLanguageRegExp=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;function parseAcceptLanguage(accept){var accepts=accept.split(",");for(var i=0,j=0;i<accepts.length;i++){var language=parseLanguage(accepts[i].trim(),i);if(language){accepts[j++]=language;}}accepts.length=j;return accepts}function parseLanguage(str,i){var match=simpleLanguageRegExp.exec(str);if(!match)return null;var prefix=match[1],suffix=match[2],full=prefix;if(suffix)full+="-"+suffix;var q=1;if(match[3]){var params=match[3].split(";");for(var j=0;j<params.length;j++){var p=params[j].split("=");if(p[0]==="q")q=parseFloat(p[1]);}}return {prefix:prefix,suffix:suffix,q:q,i:i,full:full}}function getLanguagePriority(language,accepted,index){var priority={o:-1,q:0,s:0};for(var i=0;i<accepted.length;i++){var spec=specify$1(language,accepted[i],index);if(spec&&(priority.s-spec.s||priority.q-spec.q||priority.o-spec.o)<0){priority=spec;}}return priority}function specify$1(language,spec,index){var p=parseLanguage(language);if(!p)return null;var s=0;if(spec.full.toLowerCase()===p.full.toLowerCase()){s|=4;}else if(spec.prefix.toLowerCase()===p.full.toLowerCase()){s|=2;}else if(spec.full.toLowerCase()===p.prefix.toLowerCase()){s|=1;}else if(spec.full!=="*"){return null}return {i:index,o:spec.i,q:spec.q,s:s}}function preferredLanguages(accept,provided){var accepts=parseAcceptLanguage(accept===undefined?"*":accept||"");if(!provided){return accepts.filter(isQuality$1).sort(compareSpecs$1).map(getFullLanguage)}var priorities=provided.map(function getPriority(type,index){return getLanguagePriority(type,accepts,index)});return priorities.filter(isQuality$1).sort(compareSpecs$1).map(function getLanguage(priority){return provided[priorities.indexOf(priority)]})}function compareSpecs$1(a,b){return b.q-a.q||b.s-a.s||a.o-b.o||a.i-b.i||0}function getFullLanguage(spec){return spec.full}function isQuality$1(spec){return spec.q>0}

var mediaType = {exports: {}};

mediaType.exports=preferredMediaTypes;mediaType.exports.preferredMediaTypes=preferredMediaTypes;var simpleMediaTypeRegExp=/^\s*([^\s\/;]+)\/([^;\s]+)\s*(?:;(.*))?$/;function parseAccept(accept){var accepts=splitMediaTypes(accept);for(var i=0,j=0;i<accepts.length;i++){var mediaType=parseMediaType(accepts[i].trim(),i);if(mediaType){accepts[j++]=mediaType;}}accepts.length=j;return accepts}function parseMediaType(str,i){var match=simpleMediaTypeRegExp.exec(str);if(!match)return null;var params=Object.create(null);var q=1;var subtype=match[2];var type=match[1];if(match[3]){var kvps=splitParameters(match[3]).map(splitKeyValuePair);for(var j=0;j<kvps.length;j++){var pair=kvps[j];var key=pair[0].toLowerCase();var val=pair[1];var value=val&&val[0]==="\""&&val[val.length-1]==="\""?val.substr(1,val.length-2):val;if(key==="q"){q=parseFloat(value);break}params[key]=value;}}return {type:type,subtype:subtype,params:params,q:q,i:i}}function getMediaTypePriority(type,accepted,index){var priority={o:-1,q:0,s:0};for(var i=0;i<accepted.length;i++){var spec=specify(type,accepted[i],index);if(spec&&(priority.s-spec.s||priority.q-spec.q||priority.o-spec.o)<0){priority=spec;}}return priority}function specify(type,spec,index){var p=parseMediaType(type);var s=0;if(!p){return null}if(spec.type.toLowerCase()==p.type.toLowerCase()){s|=4;}else if(spec.type!="*"){return null}if(spec.subtype.toLowerCase()==p.subtype.toLowerCase()){s|=2;}else if(spec.subtype!="*"){return null}var keys=Object.keys(spec.params);if(keys.length>0){if(keys.every(function(k){return spec.params[k]=="*"||(spec.params[k]||"").toLowerCase()==(p.params[k]||"").toLowerCase()})){s|=1;}else {return null}}return {i:index,o:spec.i,q:spec.q,s:s}}function preferredMediaTypes(accept,provided){var accepts=parseAccept(accept===undefined?"*/*":accept||"");if(!provided){return accepts.filter(isQuality).sort(compareSpecs).map(getFullType)}var priorities=provided.map(function getPriority(type,index){return getMediaTypePriority(type,accepts,index)});return priorities.filter(isQuality).sort(compareSpecs).map(function getType(priority){return provided[priorities.indexOf(priority)]})}function compareSpecs(a,b){return b.q-a.q||b.s-a.s||a.o-b.o||a.i-b.i||0}function getFullType(spec){return spec.type+"/"+spec.subtype}function isQuality(spec){return spec.q>0}function quoteCount(string){var count=0;var index=0;while((index=string.indexOf("\"",index))!==-1){count++;index++;}return count}function splitKeyValuePair(str){var index=str.indexOf("=");var key;var val;if(index===-1){key=str;}else {key=str.substr(0,index);val=str.substr(index+1);}return [key,val]}function splitMediaTypes(accept){var accepts=accept.split(",");for(var i=1,j=0;i<accepts.length;i++){if(quoteCount(accepts[j])%2==0){accepts[++j]=accepts[i];}else {accepts[j]+=","+accepts[i];}}accepts.length=j+1;return accepts}function splitParameters(str){var parameters=str.split(";");for(var i=1,j=0;i<parameters.length;i++){if(quoteCount(parameters[j])%2==0){parameters[++j]=parameters[i];}else {parameters[j]+=";"+parameters[i];}}parameters.length=j+1;for(var i=0;i<parameters.length;i++){parameters[i]=parameters[i].trim();}return parameters}

var modules=Object.create(null);negotiator.exports=Negotiator$1;negotiator.exports.Negotiator=Negotiator$1;function Negotiator$1(request){if(!(this instanceof Negotiator$1)){return new Negotiator$1(request)}this.request=request;}Negotiator$1.prototype.charset=function charset(available){var set=this.charsets(available);return set&&set[0]};Negotiator$1.prototype.charsets=function charsets(available){var preferredCharsets=loadModule("charset").preferredCharsets;return preferredCharsets(this.request.headers["accept-charset"],available)};Negotiator$1.prototype.encoding=function encoding(available){var set=this.encodings(available);return set&&set[0]};Negotiator$1.prototype.encodings=function encodings(available){var preferredEncodings=loadModule("encoding").preferredEncodings;return preferredEncodings(this.request.headers["accept-encoding"],available)};Negotiator$1.prototype.language=function language(available){var set=this.languages(available);return set&&set[0]};Negotiator$1.prototype.languages=function languages(available){var preferredLanguages=loadModule("language").preferredLanguages;return preferredLanguages(this.request.headers["accept-language"],available)};Negotiator$1.prototype.mediaType=function mediaType(available){var set=this.mediaTypes(available);return set&&set[0]};Negotiator$1.prototype.mediaTypes=function mediaTypes(available){var preferredMediaTypes=loadModule("mediaType").preferredMediaTypes;return preferredMediaTypes(this.request.headers.accept,available)};Negotiator$1.prototype.preferredCharset=Negotiator$1.prototype.charset;Negotiator$1.prototype.preferredCharsets=Negotiator$1.prototype.charsets;Negotiator$1.prototype.preferredEncoding=Negotiator$1.prototype.encoding;Negotiator$1.prototype.preferredEncodings=Negotiator$1.prototype.encodings;Negotiator$1.prototype.preferredLanguage=Negotiator$1.prototype.language;Negotiator$1.prototype.preferredLanguages=Negotiator$1.prototype.languages;Negotiator$1.prototype.preferredMediaType=Negotiator$1.prototype.mediaType;Negotiator$1.prototype.preferredMediaTypes=Negotiator$1.prototype.mediaTypes;function loadModule(moduleName){var module=modules[moduleName];if(module!==undefined){return module}switch(moduleName){case"charset":module=charset.exports;break;case"encoding":module=encoding.exports;break;case"language":module=language.exports;break;case"mediaType":module=mediaType.exports;break;default:throw new Error("Cannot find module '"+moduleName+"'");}modules[moduleName]=module;return module}

var Negotiator=negotiator.exports;var mime=mimeTypes$1;var accepts=Accepts;function Accepts(req){if(!(this instanceof Accepts)){return new Accepts(req)}this.headers=req.headers;this.negotiator=new Negotiator(req);}Accepts.prototype.type=Accepts.prototype.types=function(types_){var types=types_;if(types&&!Array.isArray(types)){types=new Array(arguments.length);for(var i=0;i<types.length;i++){types[i]=arguments[i];}}if(!types||types.length===0){return this.negotiator.mediaTypes()}if(!this.headers.accept){return types[0]}var mimes=types.map(extToMime);var accepts=this.negotiator.mediaTypes(mimes.filter(validMime));var first=accepts[0];return first?types[mimes.indexOf(first)]:false};Accepts.prototype.encoding=Accepts.prototype.encodings=function(encodings_){var encodings=encodings_;if(encodings&&!Array.isArray(encodings)){encodings=new Array(arguments.length);for(var i=0;i<encodings.length;i++){encodings[i]=arguments[i];}}if(!encodings||encodings.length===0){return this.negotiator.encodings()}return this.negotiator.encodings(encodings)[0]||false};Accepts.prototype.charset=Accepts.prototype.charsets=function(charsets_){var charsets=charsets_;if(charsets&&!Array.isArray(charsets)){charsets=new Array(arguments.length);for(var i=0;i<charsets.length;i++){charsets[i]=arguments[i];}}if(!charsets||charsets.length===0){return this.negotiator.charsets()}return this.negotiator.charsets(charsets)[0]||false};Accepts.prototype.lang=Accepts.prototype.langs=Accepts.prototype.language=Accepts.prototype.languages=function(languages_){var languages=languages_;if(languages&&!Array.isArray(languages)){languages=new Array(arguments.length);for(var i=0;i<languages.length;i++){languages[i]=arguments[i];}}if(!languages||languages.length===0){return this.negotiator.languages()}return this.negotiator.languages(languages)[0]||false};function extToMime(type){return type.indexOf("/")===-1?mime.lookup(type):type}function validMime(type){return typeof type==="string"}

var contentType = {};

var PARAM_REGEXP=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g;var TEXT_REGEXP=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/;var TOKEN_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;var QESC_REGEXP=/\\([\u000b\u0020-\u00ff])/g;var QUOTE_REGEXP=/([\\"])/g;var TYPE_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;contentType.format=format;contentType.parse=parse$4;function format(obj){if(!obj||typeof obj!=="object"){throw new TypeError("argument obj is required")}var parameters=obj.parameters;var type=obj.type;if(!type||!TYPE_REGEXP.test(type)){throw new TypeError("invalid type")}var string=type;if(parameters&&typeof parameters==="object"){var param;var params=Object.keys(parameters).sort();for(var i=0;i<params.length;i++){param=params[i];if(!TOKEN_REGEXP.test(param)){throw new TypeError("invalid parameter name")}string+="; "+param+"="+qstring(parameters[param]);}}return string}function parse$4(string){if(!string){throw new TypeError("argument string is required")}var header=typeof string==="object"?getcontenttype(string):string;if(typeof header!=="string"){throw new TypeError("argument string is required to be a string")}var index=header.indexOf(";");var type=index!==-1?header.substr(0,index).trim():header.trim();if(!TYPE_REGEXP.test(type)){throw new TypeError("invalid media type")}var obj=new ContentType(type.toLowerCase());if(index!==-1){var key;var match;var value;PARAM_REGEXP.lastIndex=index;while(match=PARAM_REGEXP.exec(header)){if(match.index!==index){throw new TypeError("invalid parameter format")}index+=match[0].length;key=match[1].toLowerCase();value=match[2];if(value[0]==="\""){value=value.substr(1,value.length-2).replace(QESC_REGEXP,"$1");}obj.parameters[key]=value;}if(index!==header.length){throw new TypeError("invalid parameter format")}}return obj}function getcontenttype(obj){var header;if(typeof obj.getHeader==="function"){header=obj.getHeader("content-type");}else if(typeof obj.headers==="object"){header=obj.headers&&obj.headers["content-type"];}if(typeof header!=="string"){throw new TypeError("content-type header is missing from object")}return header}function qstring(val){var str=String(val);if(TOKEN_REGEXP.test(str)){return str}if(str.length>0&&!TEXT_REGEXP.test(str)){throw new TypeError("invalid parameter value")}return "\""+str.replace(QUOTE_REGEXP,"\\$1")+"\""}function ContentType(type){this.parameters=Object.create(null);this.type=type;}

var parseurl$1 = {exports: {}};

var url=require$$0__default$7["default"];var parse$3=url.parse;var Url=url.Url;parseurl$1.exports=parseurl;parseurl$1.exports.original=originalurl;function parseurl(req){var url=req.url;if(url===undefined){return undefined}var parsed=req._parsedUrl;if(fresh$1(url,parsed)){return parsed}parsed=fastparse(url);parsed._raw=url;return req._parsedUrl=parsed}function originalurl(req){var url=req.originalUrl;if(typeof url!=="string"){return parseurl(req)}var parsed=req._parsedOriginalUrl;if(fresh$1(url,parsed)){return parsed}parsed=fastparse(url);parsed._raw=url;return req._parsedOriginalUrl=parsed}function fastparse(str){if(typeof str!=="string"||str.charCodeAt(0)!==47){return parse$3(str)}var pathname=str;var query=null;var search=null;for(var i=1;i<str.length;i++){switch(str.charCodeAt(i)){case 63:if(search===null){pathname=str.substring(0,i);query=str.substring(i+1);search=str.substring(i);}break;case 9:case 10:case 12:case 13:case 32:case 35:case 160:case 65279:return parse$3(str);}}var url=Url!==undefined?new Url:{};url.path=str;url.href=str;url.pathname=pathname;if(search!==null){url.query=query;url.search=search;}return url}function fresh$1(url,parsedUrl){return typeof parsedUrl==="object"&&parsedUrl!==null&&(Url===undefined||parsedUrl instanceof Url)&&parsedUrl._raw===url}

var CACHE_CONTROL_NO_CACHE_REGEXP=/(?:^|,)\s*?no-cache\s*?(?:,|$)/;var fresh_1=fresh;function fresh(reqHeaders,resHeaders){var modifiedSince=reqHeaders["if-modified-since"];var noneMatch=reqHeaders["if-none-match"];if(!modifiedSince&&!noneMatch){return false}var cacheControl=reqHeaders["cache-control"];if(cacheControl&&CACHE_CONTROL_NO_CACHE_REGEXP.test(cacheControl)){return false}if(noneMatch&&noneMatch!=="*"){var etag=resHeaders["etag"];if(!etag){return false}var etagStale=true;var matches=parseTokenList(noneMatch);for(var i=0;i<matches.length;i++){var match=matches[i];if(match===etag||match==="W/"+etag||"W/"+match===etag){etagStale=false;break}}if(etagStale){return false}}if(modifiedSince){var lastModified=resHeaders["last-modified"];var modifiedStale=!lastModified||!(parseHttpDate(lastModified)<=parseHttpDate(modifiedSince));if(modifiedStale){return false}}return true}function parseHttpDate(date){var timestamp=date&&Date.parse(date);return typeof timestamp==="number"?timestamp:NaN}function parseTokenList(str){var end=0;var list=[];var start=0;for(var i=0,len=str.length;i<len;i++){switch(str.charCodeAt(i)){case 32:if(start===end){start=end=i+1;}break;case 44:list.push(str.substring(start,end));start=end=i+1;break;default:end=i+1;break;}}list.push(str.substring(start,end));return list}

(function(module){const URL=require$$0__default$7["default"].URL;const net=require$$1__default$2["default"];const accepts$1=accepts;const contentType$1=contentType;const stringify=require$$0__default$7["default"].format;const parse=parseurl$1.exports;const qs=require$$5__default$1["default"];const typeis=typeIs.exports;const fresh=fresh_1;const only=only$1;const util=require$$0__default$2["default"];const IP=Symbol("context#ip");module.exports={get header(){return this.req.headers},set header(val){this.req.headers=val;},get headers(){return this.req.headers},set headers(val){this.req.headers=val;},get url(){return this.req.url},set url(val){this.req.url=val;},get origin(){return `${this.protocol}://${this.host}`},get href(){if(/^https?:\/\//i.test(this.originalUrl))return this.originalUrl;return this.origin+this.originalUrl},get method(){return this.req.method},set method(val){this.req.method=val;},get path(){return parse(this.req).pathname},set path(path){const url=parse(this.req);if(url.pathname===path)return;url.pathname=path;url.path=null;this.url=stringify(url);},get query(){const str=this.querystring;const c=this._querycache=this._querycache||{};return c[str]||(c[str]=qs.parse(str))},set query(obj){this.querystring=qs.stringify(obj);},get querystring(){if(!this.req)return "";return parse(this.req).query||""},set querystring(str){const url=parse(this.req);if(url.search===`?${str}`)return;url.search=str;url.path=null;this.url=stringify(url);},get search(){if(!this.querystring)return "";return `?${this.querystring}`},set search(str){this.querystring=str;},get host(){const proxy=this.app.proxy;let host=proxy&&this.get("X-Forwarded-Host");if(!host){if(this.req.httpVersionMajor>=2)host=this.get(":authority");if(!host)host=this.get("Host");}if(!host)return "";return host.split(/\s*,\s*/,1)[0]},get hostname(){const host=this.host;if(!host)return "";if("["===host[0])return this.URL.hostname||"";return host.split(":",1)[0]},get URL(){if(!this.memoizedURL){const originalUrl=this.originalUrl||"";try{this.memoizedURL=new URL(`${this.origin}${originalUrl}`);}catch(err){this.memoizedURL=Object.create(null);}}return this.memoizedURL},get fresh(){const method=this.method;const s=this.ctx.status;if("GET"!==method&&"HEAD"!==method)return false;if(s>=200&&s<300||304===s){return fresh(this.header,this.response.header)}return false},get stale(){return !this.fresh},get idempotent(){const methods=["GET","HEAD","PUT","DELETE","OPTIONS","TRACE"];return !!~methods.indexOf(this.method)},get socket(){return this.req.socket},get charset(){try{const{parameters}=contentType$1.parse(this.req);return parameters.charset||""}catch(e){return ""}},get length(){const len=this.get("Content-Length");if(len==="")return;return ~~len},get protocol(){if(this.socket.encrypted)return "https";if(!this.app.proxy)return "http";const proto=this.get("X-Forwarded-Proto");return proto?proto.split(/\s*,\s*/,1)[0]:"http"},get secure(){return "https"===this.protocol},get ips(){const proxy=this.app.proxy;const val=this.get(this.app.proxyIpHeader);let ips=proxy&&val?val.split(/\s*,\s*/):[];if(this.app.maxIpsCount>0){ips=ips.slice(-this.app.maxIpsCount);}return ips},get ip(){if(!this[IP]){this[IP]=this.ips[0]||this.socket.remoteAddress||"";}return this[IP]},set ip(_ip){this[IP]=_ip;},get subdomains(){const offset=this.app.subdomainOffset;const hostname=this.hostname;if(net.isIP(hostname))return [];return hostname.split(".").reverse().slice(offset)},get accept(){return this._accept||(this._accept=accepts$1(this.req))},set accept(obj){this._accept=obj;},accepts(...args){return this.accept.types(...args)},acceptsEncodings(...args){return this.accept.encodings(...args)},acceptsCharsets(...args){return this.accept.charsets(...args)},acceptsLanguages(...args){return this.accept.languages(...args)},is(type,...types){return typeis(this.req,type,...types)},get type(){const type=this.get("Content-Type");if(!type)return "";return type.split(";")[0]},get(field){const req=this.req;switch(field=field.toLowerCase()){case"referer":case"referrer":return req.headers.referrer||req.headers.referer||"";default:return req.headers[field]||"";}},inspect(){if(!this.req)return;return this.toJSON()},toJSON(){return only(this,["method","url","header"])}};if(util.inspect.custom){module.exports[util.inspect.custom]=module.exports.inspect;}})(request$1);

var slice=Array.prototype.slice;var co_1=co$1["default"]=co$1.co=co$1;co$1.wrap=function(fn){createPromise.__generatorFunction__=fn;return createPromise;function createPromise(){return co$1.call(this,fn.apply(this,arguments))}};function co$1(gen){var ctx=this;var args=slice.call(arguments,1);return new Promise(function(resolve,reject){if(typeof gen==="function")gen=gen.apply(ctx,args);if(!gen||typeof gen.next!=="function")return resolve(gen);onFulfilled();function onFulfilled(res){var ret;try{ret=gen.next(res);}catch(e){return reject(e)}next(ret);}function onRejected(err){var ret;try{ret=gen.throw(err);}catch(e){return reject(e)}next(ret);}function next(ret){if(ret.done)return resolve(ret.value);var value=toPromise.call(ctx,ret.value);if(value&&isPromise(value))return value.then(onFulfilled,onRejected);return onRejected(new TypeError("You may only yield a function, promise, generator, array, or object, "+"but the following object was passed: \""+String(ret.value)+"\""))}})}function toPromise(obj){if(!obj)return obj;if(isPromise(obj))return obj;if(isGeneratorFunction$1(obj)||isGenerator(obj))return co$1.call(this,obj);if("function"==typeof obj)return thunkToPromise.call(this,obj);if(Array.isArray(obj))return arrayToPromise.call(this,obj);if(isObject(obj))return objectToPromise.call(this,obj);return obj}function thunkToPromise(fn){var ctx=this;return new Promise(function(resolve,reject){fn.call(ctx,function(err,res){if(err)return reject(err);if(arguments.length>2)res=slice.call(arguments,1);resolve(res);});})}function arrayToPromise(obj){return Promise.all(obj.map(toPromise,this))}function objectToPromise(obj){var results=new obj.constructor;var keys=Object.keys(obj);var promises=[];for(var i=0;i<keys.length;i++){var key=keys[i];var promise=toPromise.call(this,obj[key]);if(promise&&isPromise(promise))defer(promise,key);else results[key]=obj[key];}return Promise.all(promises).then(function(){return results});function defer(promise,key){results[key]=undefined;promises.push(promise.then(function(res){results[key]=res;}));}}function isPromise(obj){return "function"==typeof obj.then}function isGenerator(obj){return "function"==typeof obj.next&&"function"==typeof obj.throw}function isGeneratorFunction$1(obj){var constructor=obj.constructor;if(!constructor)return false;if("GeneratorFunction"===constructor.name||"GeneratorFunction"===constructor.displayName)return true;return isGenerator(constructor.prototype)}function isObject(val){return Object==val.constructor}

const co=co_1;const compose$2=koaCompose;var koaConvert=convert$1;function convert$1(mw){if(typeof mw!=="function"){throw new TypeError("middleware must be a function")}if(mw.constructor.name!=="GeneratorFunction"&&mw.constructor.name!=="AsyncGeneratorFunction"){return mw}const converted=function(ctx,next){return co.call(ctx,mw.call(ctx,function*(next){return yield next()}(next)))};converted._name=mw._name||mw.name;return converted}convert$1.compose=function(arr){if(!Array.isArray(arr)){arr=Array.from(arguments);}return compose$2(arr.map(convert$1))};convert$1.back=function(mw){if(typeof mw!=="function"){throw new TypeError("middleware must be a function")}if(mw.constructor.name==="GeneratorFunction"||mw.constructor.name==="AsyncGeneratorFunction"){return mw}const converted=function*(next){const ctx=this;let called=false;yield mw(ctx,function(){if(called){throw new Error("next() called multiple times")}called=true;return co.call(ctx,next)});};converted._name=mw._name||mw.name;return converted};

var relative=require$$0__default$1["default"].relative;var depd_1=depd;var basePath=process.cwd();function containsNamespace(str,namespace){var vals=str.split(/[ ,]+/);var ns=String(namespace).toLowerCase();for(var i=0;i<vals.length;i++){var val=vals[i];if(val&&(val==="*"||val.toLowerCase()===ns)){return true}}return false}function convertDataDescriptorToAccessor(obj,prop,message){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);var value=descriptor.value;descriptor.get=function getter(){return value};if(descriptor.writable){descriptor.set=function setter(val){return value=val};}delete descriptor.value;delete descriptor.writable;Object.defineProperty(obj,prop,descriptor);return descriptor}function createArgumentsString(arity){var str="";for(var i=0;i<arity;i++){str+=", arg"+i;}return str.substr(2)}function createStackString(stack){var str=this.name+": "+this.namespace;if(this.message){str+=" deprecated "+this.message;}for(var i=0;i<stack.length;i++){str+="\n    at "+stack[i].toString();}return str}function depd(namespace){if(!namespace){throw new TypeError("argument namespace is required")}var stack=getStack();var site=callSiteLocation(stack[1]);var file=site[0];function deprecate(message){log.call(deprecate,message);}deprecate._file=file;deprecate._ignored=isignored(namespace);deprecate._namespace=namespace;deprecate._traced=istraced(namespace);deprecate._warned=Object.create(null);deprecate.function=wrapfunction;deprecate.property=wrapproperty;return deprecate}function eehaslisteners(emitter,type){var count=typeof emitter.listenerCount!=="function"?emitter.listeners(type).length:emitter.listenerCount(type);return count>0}function isignored(namespace){if(process.noDeprecation){return true}var str=process.env.NO_DEPRECATION||"";return containsNamespace(str,namespace)}function istraced(namespace){if(process.traceDeprecation){return true}var str=process.env.TRACE_DEPRECATION||"";return containsNamespace(str,namespace)}function log(message,site){var haslisteners=eehaslisteners(process,"deprecation");if(!haslisteners&&this._ignored){return}var caller;var callFile;var callSite;var depSite;var i=0;var seen=false;var stack=getStack();var file=this._file;if(site){depSite=site;callSite=callSiteLocation(stack[1]);callSite.name=depSite.name;file=callSite[0];}else {i=2;depSite=callSiteLocation(stack[i]);callSite=depSite;}for(;i<stack.length;i++){caller=callSiteLocation(stack[i]);callFile=caller[0];if(callFile===file){seen=true;}else if(callFile===this._file){file=this._file;}else if(seen){break}}var key=caller?depSite.join(":")+"__"+caller.join(":"):undefined;if(key!==undefined&&key in this._warned){return}this._warned[key]=true;var msg=message;if(!msg){msg=callSite===depSite||!callSite.name?defaultMessage(depSite):defaultMessage(callSite);}if(haslisteners){var err=DeprecationError(this._namespace,msg,stack.slice(i));process.emit("deprecation",err);return}var format=process.stderr.isTTY?formatColor:formatPlain;var output=format.call(this,msg,caller,stack.slice(i));process.stderr.write(output+"\n","utf8");}function callSiteLocation(callSite){var file=callSite.getFileName()||"<anonymous>";var line=callSite.getLineNumber();var colm=callSite.getColumnNumber();if(callSite.isEval()){file=callSite.getEvalOrigin()+", "+file;}var site=[file,line,colm];site.callSite=callSite;site.name=callSite.getFunctionName();return site}function defaultMessage(site){var callSite=site.callSite;var funcName=site.name;if(!funcName){funcName="<anonymous@"+formatLocation(site)+">";}var context=callSite.getThis();var typeName=context&&callSite.getTypeName();if(typeName==="Object"){typeName=undefined;}if(typeName==="Function"){typeName=context.name||typeName;}return typeName&&callSite.getMethodName()?typeName+"."+funcName:funcName}function formatPlain(msg,caller,stack){var timestamp=new Date().toUTCString();var formatted=timestamp+" "+this._namespace+" deprecated "+msg;if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    at "+stack[i].toString();}return formatted}if(caller){formatted+=" at "+formatLocation(caller);}return formatted}function formatColor(msg,caller,stack){var formatted="\x1B[36;1m"+this._namespace+"\x1B[22;39m"+" \x1B[33;1mdeprecated\x1B[22;39m"+" \x1B[0m"+msg+"\x1B[39m";if(this._traced){for(var i=0;i<stack.length;i++){formatted+="\n    \x1B[36mat "+stack[i].toString()+"\x1B[39m";}return formatted}if(caller){formatted+=" \x1B[36m"+formatLocation(caller)+"\x1B[39m";}return formatted}function formatLocation(callSite){return relative(basePath,callSite[0])+":"+callSite[1]+":"+callSite[2]}function getStack(){var limit=Error.stackTraceLimit;var obj={};var prep=Error.prepareStackTrace;Error.prepareStackTrace=prepareObjectStackTrace;Error.stackTraceLimit=Math.max(10,limit);Error.captureStackTrace(obj);var stack=obj.stack.slice(1);Error.prepareStackTrace=prep;Error.stackTraceLimit=limit;return stack}function prepareObjectStackTrace(obj,stack){return stack}function wrapfunction(fn,message){if(typeof fn!=="function"){throw new TypeError("argument fn must be a function")}var args=createArgumentsString(fn.length);var stack=getStack();var site=callSiteLocation(stack[1]);site.name=fn.name;var deprecatedfn=new Function("fn","log","deprecate","message","site","\"use strict\"\n"+"return function ("+args+") {"+"log.call(deprecate, message, site)\n"+"return fn.apply(this, arguments)\n"+"}")(fn,log,this,message,site);return deprecatedfn}function wrapproperty(obj,prop,message){if(!obj||typeof obj!=="object"&&typeof obj!=="function"){throw new TypeError("argument obj must be object")}var descriptor=Object.getOwnPropertyDescriptor(obj,prop);if(!descriptor){throw new TypeError("must call property on owner object")}if(!descriptor.configurable){throw new TypeError("property must be configurable")}var deprecate=this;var stack=getStack();var site=callSiteLocation(stack[1]);site.name=prop;if("value"in descriptor){descriptor=convertDataDescriptorToAccessor(obj,prop);}var get=descriptor.get;var set=descriptor.set;if(typeof get==="function"){descriptor.get=function getter(){log.call(deprecate,message,site);return get.apply(this,arguments)};}if(typeof set==="function"){descriptor.set=function setter(){log.call(deprecate,message,site);return set.apply(this,arguments)};}Object.defineProperty(obj,prop,descriptor);}function DeprecationError(namespace,message,stack){var error=new Error;var stackString;Object.defineProperty(error,"constructor",{value:DeprecationError});Object.defineProperty(error,"message",{configurable:true,enumerable:false,value:message,writable:true});Object.defineProperty(error,"name",{enumerable:false,configurable:true,value:"DeprecationError",writable:true});Object.defineProperty(error,"namespace",{configurable:true,enumerable:false,value:namespace,writable:true});Object.defineProperty(error,"stack",{configurable:true,enumerable:false,get:function(){if(stackString!==undefined){return stackString}return stackString=createStackString.call(this,stack)},set:function setter(val){stackString=val;}});return error}

const isGeneratorFunction=isGeneratorFunction$2;const debug$1=src.exports("koa:application");const onFinished=onFinished$2.exports;const response=response$1.exports;const compose$1=koaCompose;const context=context$1.exports;const request=request$1.exports;const statuses=statuses$1;const Emitter=require$$0__default$4["default"];const util=require$$0__default$2["default"];const Stream=require$$0__default["default"];const http$1=require$$2__default["default"];const only=only$1;const convert=koaConvert;const deprecate=depd_1("koa");const{HttpError: HttpError$2}=httpErrors.exports;application.exports=class Application extends Emitter{constructor(options){super();options=options||{};this.proxy=options.proxy||false;this.subdomainOffset=options.subdomainOffset||2;this.proxyIpHeader=options.proxyIpHeader||"X-Forwarded-For";this.maxIpsCount=options.maxIpsCount||0;this.env=options.env||process.env.NODE_ENV||"development";if(options.keys)this.keys=options.keys;this.middleware=[];this.context=Object.create(context);this.request=Object.create(request);this.response=Object.create(response);if(util.inspect.custom){this[util.inspect.custom]=this.inspect;}}listen(...args){debug$1("listen");const server=http$1.createServer(this.callback());return server.listen(...args)}toJSON(){return only(this,["subdomainOffset","proxy","env"])}inspect(){return this.toJSON()}use(fn){if(typeof fn!=="function")throw new TypeError("middleware must be a function!");if(isGeneratorFunction(fn)){deprecate("Support for generators will be removed in v3. "+"See the documentation for examples of how to convert old middleware "+"https://github.com/koajs/koa/blob/master/docs/migration.md");fn=convert(fn);}debug$1("use %s",fn._name||fn.name||"-");this.middleware.push(fn);return this}callback(){const fn=compose$1(this.middleware);if(!this.listenerCount("error"))this.on("error",this.onerror);const handleRequest=(req,res)=>{const ctx=this.createContext(req,res);return this.handleRequest(ctx,fn)};return handleRequest}handleRequest(ctx,fnMiddleware){const res=ctx.res;res.statusCode=404;const onerror=err=>ctx.onerror(err);const handleResponse=()=>respond(ctx);onFinished(res,onerror);return fnMiddleware(ctx).then(handleResponse).catch(onerror)}createContext(req,res){const context=Object.create(this.context);const request=context.request=Object.create(this.request);const response=context.response=Object.create(this.response);context.app=request.app=response.app=this;context.req=request.req=response.req=req;context.res=request.res=response.res=res;request.ctx=response.ctx=context;request.response=response;response.request=request;context.originalUrl=request.originalUrl=req.url;context.state={};return context}onerror(err){const isNativeError=Object.prototype.toString.call(err)==="[object Error]"||err instanceof Error;if(!isNativeError)throw new TypeError(util.format("non-error thrown: %j",err));if(404===err.status||err.expose)return;if(this.silent)return;const msg=err.stack||err.toString();console.error(`\n${msg.replace(/^/gm,"  ")}\n`);}static get default(){return Application}};function respond(ctx){if(false===ctx.respond)return;if(!ctx.writable)return;const res=ctx.res;let body=ctx.body;const code=ctx.status;if(statuses.empty[code]){ctx.body=null;return res.end()}if("HEAD"===ctx.method){if(!res.headersSent&&!ctx.response.has("Content-Length")){const{length}=ctx.response;if(Number.isInteger(length))ctx.length=length;}return res.end()}if(null==body){if(ctx.response._explicitNullBody){ctx.response.remove("Content-Type");ctx.response.remove("Transfer-Encoding");return res.end()}if(ctx.req.httpVersionMajor>=2){body=String(code);}else {body=ctx.message||String(code);}if(!res.headersSent){ctx.type="text";ctx.length=Buffer.byteLength(body);}return res.end(body)}if(Buffer.isBuffer(body))return res.end(body);if("string"===typeof body)return res.end(body);if(body instanceof Stream)return body.pipe(res);body=JSON.stringify(body);if(!res.headersSent){ctx.length=Buffer.byteLength(body);}res.end(body);}application.exports.HttpError=HttpError$2;var mod = application.exports;

const HttpError$1=mod.HttpError;

var koa = /*#__PURE__*/Object.freeze({
  __proto__: null,
  'default': mod,
  HttpError: HttpError$1
});

const fs$3=require$$0__default$3["default"];const{Readable}=require$$0__default["default"];const sysPath$3=require$$0__default$1["default"];const{promisify: promisify$3}=require$$0__default$2["default"];const picomatch$1=picomatch$3;const readdir$1=promisify$3(fs$3.readdir);const stat$3=promisify$3(fs$3.stat);const lstat$2=promisify$3(fs$3.lstat);const realpath$1=promisify$3(fs$3.realpath);const BANG$2="!";const RECURSIVE_ERROR_CODE="READDIRP_RECURSIVE_ERROR";const NORMAL_FLOW_ERRORS=new Set(["ENOENT","EPERM","EACCES","ELOOP",RECURSIVE_ERROR_CODE]);const FILE_TYPE="files";const DIR_TYPE="directories";const FILE_DIR_TYPE="files_directories";const EVERYTHING_TYPE="all";const ALL_TYPES=[FILE_TYPE,DIR_TYPE,FILE_DIR_TYPE,EVERYTHING_TYPE];const isNormalFlowError=error=>NORMAL_FLOW_ERRORS.has(error.code);const[maj,min]=process.versions.node.split(".").slice(0,2).map(n=>Number.parseInt(n,10));const wantBigintFsStats=process.platform==="win32"&&(maj>10||maj===10&&min>=5);const normalizeFilter=filter=>{if(filter===undefined)return;if(typeof filter==="function")return filter;if(typeof filter==="string"){const glob=picomatch$1(filter.trim());return entry=>glob(entry.basename)}if(Array.isArray(filter)){const positive=[];const negative=[];for(const item of filter){const trimmed=item.trim();if(trimmed.charAt(0)===BANG$2){negative.push(picomatch$1(trimmed.slice(1)));}else {positive.push(picomatch$1(trimmed));}}if(negative.length>0){if(positive.length>0){return entry=>positive.some(f=>f(entry.basename))&&!negative.some(f=>f(entry.basename))}return entry=>!negative.some(f=>f(entry.basename))}return entry=>positive.some(f=>f(entry.basename))}};class ReaddirpStream extends Readable{static get defaultOptions(){return {root:".",fileFilter:path=>true,directoryFilter:path=>true,type:FILE_TYPE,lstat:false,depth:2147483648,alwaysStat:false}}constructor(options={}){super({objectMode:true,autoDestroy:true,highWaterMark:options.highWaterMark||4096});const opts={...ReaddirpStream.defaultOptions,...options};const{root,type}=opts;this._fileFilter=normalizeFilter(opts.fileFilter);this._directoryFilter=normalizeFilter(opts.directoryFilter);const statMethod=opts.lstat?lstat$2:stat$3;if(wantBigintFsStats){this._stat=path=>statMethod(path,{bigint:true});}else {this._stat=statMethod;}this._maxDepth=opts.depth;this._wantsDir=[DIR_TYPE,FILE_DIR_TYPE,EVERYTHING_TYPE].includes(type);this._wantsFile=[FILE_TYPE,FILE_DIR_TYPE,EVERYTHING_TYPE].includes(type);this._wantsEverything=type===EVERYTHING_TYPE;this._root=sysPath$3.resolve(root);this._isDirent="Dirent"in fs$3&&!opts.alwaysStat;this._statsProp=this._isDirent?"dirent":"stats";this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent};this.parents=[this._exploreDir(root,1)];this.reading=false;this.parent=undefined;}async _read(batch){if(this.reading)return;this.reading=true;try{while(!this.destroyed&&batch>0){const{path,depth,files=[]}=this.parent||{};if(files.length>0){const slice=files.splice(0,batch).map(dirent=>this._formatEntry(dirent,path));for(const entry of await Promise.all(slice)){if(this.destroyed)return;const entryType=await this._getEntryType(entry);if(entryType==="directory"&&this._directoryFilter(entry)){if(depth<=this._maxDepth){this.parents.push(this._exploreDir(entry.fullPath,depth+1));}if(this._wantsDir){this.push(entry);batch--;}}else if((entryType==="file"||this._includeAsFile(entry))&&this._fileFilter(entry)){if(this._wantsFile){this.push(entry);batch--;}}}}else {const parent=this.parents.pop();if(!parent){this.push(null);break}this.parent=await parent;if(this.destroyed)return}}}catch(error){this.destroy(error);}finally{this.reading=false;}}async _exploreDir(path,depth){let files;try{files=await readdir$1(path,this._rdOptions);}catch(error){this._onError(error);}return {files,depth,path}}async _formatEntry(dirent,path){let entry;try{const basename=this._isDirent?dirent.name:dirent;const fullPath=sysPath$3.resolve(sysPath$3.join(path,basename));entry={path:sysPath$3.relative(this._root,fullPath),fullPath,basename};entry[this._statsProp]=this._isDirent?dirent:await this._stat(fullPath);}catch(err){this._onError(err);}return entry}_onError(err){if(isNormalFlowError(err)&&!this.destroyed){this.emit("warn",err);}else {this.destroy(err);}}async _getEntryType(entry){const stats=entry&&entry[this._statsProp];if(!stats){return}if(stats.isFile()){return "file"}if(stats.isDirectory()){return "directory"}if(stats&&stats.isSymbolicLink()){const full=entry.fullPath;try{const entryRealPath=await realpath$1(full);const entryRealPathStats=await lstat$2(entryRealPath);if(entryRealPathStats.isFile()){return "file"}if(entryRealPathStats.isDirectory()){const len=entryRealPath.length;if(full.startsWith(entryRealPath)&&full.substr(len,1)===sysPath$3.sep){const recursiveError=new Error(`Circular symlink detected: "${full}" points to "${entryRealPath}"`);recursiveError.code=RECURSIVE_ERROR_CODE;return this._onError(recursiveError)}return "directory"}}catch(error){this._onError(error);}}}_includeAsFile(entry){const stats=entry&&entry[this._statsProp];return stats&&this._wantsEverything&&!stats.isDirectory()}}const readdirp$1=(root,options={})=>{let type=options.entryType||options.type;if(type==="both")type=FILE_DIR_TYPE;if(type)options.type=type;if(!root){throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)")}else if(typeof root!=="string"){throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)")}else if(type&&!ALL_TYPES.includes(type)){throw new Error(`readdirp: Invalid type passed. Use one of ${ALL_TYPES.join(", ")}`)}options.root=root;return new ReaddirpStream(options)};const readdirpPromise=(root,options={})=>{return new Promise((resolve,reject)=>{const files=[];readdirp$1(root,options).on("data",entry=>files.push(entry)).on("end",()=>resolve(files)).on("error",error=>reject(error));})};readdirp$1.promise=readdirpPromise;readdirp$1.ReaddirpStream=ReaddirpStream;readdirp$1.default=readdirp$1;var readdirp_1=readdirp$1;

var anymatch$2 = {exports: {}};

var normalizePath$2=function(path,stripTrailing){if(typeof path!=="string"){throw new TypeError("expected path to be a string")}if(path==="\\"||path==="/")return "/";var len=path.length;if(len<=1)return path;var prefix="";if(len>4&&path[3]==="\\"){var ch=path[2];if((ch==="?"||ch===".")&&path.slice(0,2)==="\\\\"){path=path.slice(2);prefix="//";}}var segs=path.split(/[/\\]+/);if(stripTrailing!==false&&segs[segs.length-1]===""){segs.pop();}return prefix+segs.join("/")};

Object.defineProperty(anymatch$2.exports,"__esModule",{value:true});const picomatch=picomatch$3;const normalizePath$1=normalizePath$2;const BANG$1="!";const DEFAULT_OPTIONS={returnIndex:false};const arrify$1=item=>Array.isArray(item)?item:[item];const createPattern=(matcher,options)=>{if(typeof matcher==="function"){return matcher}if(typeof matcher==="string"){const glob=picomatch(matcher,options);return string=>matcher===string||glob(string)}if(matcher instanceof RegExp){return string=>matcher.test(string)}return string=>false};const matchPatterns=(patterns,negPatterns,args,returnIndex)=>{const isList=Array.isArray(args);const _path=isList?args[0]:args;if(!isList&&typeof _path!=="string"){throw new TypeError("anymatch: second argument must be a string: got "+Object.prototype.toString.call(_path))}const path=normalizePath$1(_path);for(let index=0;index<negPatterns.length;index++){const nglob=negPatterns[index];if(nglob(path)){return returnIndex?-1:false}}const applied=isList&&[path].concat(args.slice(1));for(let index=0;index<patterns.length;index++){const pattern=patterns[index];if(isList?pattern(...applied):pattern(path)){return returnIndex?index:true}}return returnIndex?-1:false};const anymatch$1=(matchers,testString,options=DEFAULT_OPTIONS)=>{if(matchers==null){throw new TypeError("anymatch: specify first argument")}const opts=typeof options==="boolean"?{returnIndex:options}:options;const returnIndex=opts.returnIndex||false;const mtchers=arrify$1(matchers);const negatedGlobs=mtchers.filter(item=>typeof item==="string"&&item.charAt(0)===BANG$1).map(item=>item.slice(1)).map(item=>picomatch(item,opts));const patterns=mtchers.filter(item=>typeof item!=="string"||typeof item==="string"&&item.charAt(0)!==BANG$1).map(matcher=>createPattern(matcher,opts));if(testString==null){return (testString,ri=false)=>{const returnIndex=typeof ri==="boolean"?ri:false;return matchPatterns(patterns,negatedGlobs,testString,returnIndex)}}return matchPatterns(patterns,negatedGlobs,testString,returnIndex)};anymatch$1.default=anymatch$1;anymatch$2.exports=anymatch$1;getDefaultExportFromCjs(anymatch$2.exports);

var require$$0 = ["3dm","3ds","3g2","3gp","7z","a","aac","adp","ai","aif","aiff","alz","ape","apk","appimage","ar","arj","asf","au","avi","bak","baml","bh","bin","bk","bmp","btif","bz2","bzip2","cab","caf","cgm","class","cmx","cpio","cr2","cur","dat","dcm","deb","dex","djvu","dll","dmg","dng","doc","docm","docx","dot","dotm","dra","DS_Store","dsk","dts","dtshd","dvb","dwg","dxf","ecelp4800","ecelp7470","ecelp9600","egg","eol","eot","epub","exe","f4v","fbs","fh","fla","flac","flatpak","fli","flv","fpx","fst","fvt","g3","gh","gif","graffle","gz","gzip","h261","h263","h264","icns","ico","ief","img","ipa","iso","jar","jpeg","jpg","jpgv","jpm","jxr","key","ktx","lha","lib","lvp","lz","lzh","lzma","lzo","m3u","m4a","m4v","mar","mdi","mht","mid","midi","mj2","mka","mkv","mmr","mng","mobi","mov","movie","mp3","mp4","mp4a","mpeg","mpg","mpga","mxu","nef","npx","numbers","nupkg","o","odp","ods","odt","oga","ogg","ogv","otf","ott","pages","pbm","pcx","pdb","pdf","pea","pgm","pic","png","pnm","pot","potm","potx","ppa","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","psd","pya","pyc","pyo","pyv","qt","rar","ras","raw","resources","rgb","rip","rlc","rmf","rmvb","rpm","rtf","rz","s3m","s7z","scpt","sgi","shar","snap","sil","sketch","slk","smv","snk","so","stl","suo","sub","swf","tar","tbz","tbz2","tga","tgz","thmx","tif","tiff","tlz","ttc","ttf","txz","udf","uvh","uvi","uvm","uvp","uvs","uvu","viv","vob","war","wav","wax","wbmp","wdp","weba","webm","webp","whl","wim","wm","wma","wmv","wmx","woff","woff2","wrm","wvx","xbm","xif","xla","xlam","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xm","xmind","xpi","xpm","xwd","xz","z","zip","zipx"];

var binaryExtensions$1=require$$0;

const path=require$$0__default$1["default"];const binaryExtensions=binaryExtensions$1;const extensions=new Set(binaryExtensions);var isBinaryPath$1=filePath=>extensions.has(path.extname(filePath).slice(1).toLowerCase());

var constants = {};

(function(exports){const{sep}=require$$0__default$1["default"];const{platform}=process;const os=require$$1__default$1["default"];exports.EV_ALL="all";exports.EV_READY="ready";exports.EV_ADD="add";exports.EV_CHANGE="change";exports.EV_ADD_DIR="addDir";exports.EV_UNLINK="unlink";exports.EV_UNLINK_DIR="unlinkDir";exports.EV_RAW="raw";exports.EV_ERROR="error";exports.STR_DATA="data";exports.STR_END="end";exports.STR_CLOSE="close";exports.FSEVENT_CREATED="created";exports.FSEVENT_MODIFIED="modified";exports.FSEVENT_DELETED="deleted";exports.FSEVENT_MOVED="moved";exports.FSEVENT_CLONED="cloned";exports.FSEVENT_UNKNOWN="unknown";exports.FSEVENT_TYPE_FILE="file";exports.FSEVENT_TYPE_DIRECTORY="directory";exports.FSEVENT_TYPE_SYMLINK="symlink";exports.KEY_LISTENERS="listeners";exports.KEY_ERR="errHandlers";exports.KEY_RAW="rawEmitters";exports.HANDLER_KEYS=[exports.KEY_LISTENERS,exports.KEY_ERR,exports.KEY_RAW];exports.DOT_SLASH=`.${sep}`;exports.BACK_SLASH_RE=/\\/g;exports.DOUBLE_SLASH_RE=/\/\//;exports.SLASH_OR_BACK_SLASH_RE=/[/\\]/;exports.DOT_RE=/\..*\.(sw[px])$|~$|\.subl.*\.tmp/;exports.REPLACER_RE=/^\.[/\\]/;exports.SLASH="/";exports.SLASH_SLASH="//";exports.BRACE_START="{";exports.BANG="!";exports.ONE_DOT=".";exports.TWO_DOTS="..";exports.STAR="*";exports.GLOBSTAR="**";exports.ROOT_GLOBSTAR="/**/*";exports.SLASH_GLOBSTAR="/**";exports.DIR_SUFFIX="Dir";exports.ANYMATCH_OPTS={dot:true};exports.STRING_TYPE="string";exports.FUNCTION_TYPE="function";exports.EMPTY_STR="";exports.EMPTY_FN=()=>{};exports.IDENTITY_FN=val=>val;exports.isWindows=platform==="win32";exports.isMacos=platform==="darwin";exports.isLinux=platform==="linux";exports.isIBMi=os.type()==="OS400";})(constants);

const fs$2=require$$0__default$3["default"];const sysPath$2=require$$0__default$1["default"];const{promisify: promisify$2}=require$$0__default$2["default"];const isBinaryPath=isBinaryPath$1;const{isWindows: isWindows$1,isLinux,EMPTY_FN: EMPTY_FN$2,EMPTY_STR: EMPTY_STR$1,KEY_LISTENERS,KEY_ERR,KEY_RAW,HANDLER_KEYS,EV_CHANGE: EV_CHANGE$2,EV_ADD: EV_ADD$2,EV_ADD_DIR: EV_ADD_DIR$2,EV_ERROR: EV_ERROR$2,STR_DATA: STR_DATA$1,STR_END: STR_END$2,BRACE_START: BRACE_START$1,STAR}=constants;const THROTTLE_MODE_WATCH="watch";const open=promisify$2(fs$2.open);const stat$2=promisify$2(fs$2.stat);const lstat$1=promisify$2(fs$2.lstat);const close=promisify$2(fs$2.close);const fsrealpath=promisify$2(fs$2.realpath);const statMethods$1={lstat: lstat$1,stat: stat$2};const foreach=(val,fn)=>{if(val instanceof Set){val.forEach(fn);}else {fn(val);}};const addAndConvert=(main,prop,item)=>{let container=main[prop];if(!(container instanceof Set)){main[prop]=container=new Set([container]);}container.add(item);};const clearItem=cont=>key=>{const set=cont[key];if(set instanceof Set){set.clear();}else {delete cont[key];}};const delFromSet=(main,prop,item)=>{const container=main[prop];if(container instanceof Set){container.delete(item);}else if(container===item){delete main[prop];}};const isEmptySet=val=>val instanceof Set?val.size===0:!val;const FsWatchInstances=new Map;function createFsWatchInstance(path,options,listener,errHandler,emitRaw){const handleEvent=(rawEvent,evPath)=>{listener(path);emitRaw(rawEvent,evPath,{watchedPath:path});if(evPath&&path!==evPath){fsWatchBroadcast(sysPath$2.resolve(path,evPath),KEY_LISTENERS,sysPath$2.join(path,evPath));}};try{return fs$2.watch(path,options,handleEvent)}catch(error){errHandler(error);}}const fsWatchBroadcast=(fullPath,type,val1,val2,val3)=>{const cont=FsWatchInstances.get(fullPath);if(!cont)return;foreach(cont[type],listener=>{listener(val1,val2,val3);});};const setFsWatchListener=(path,fullPath,options,handlers)=>{const{listener,errHandler,rawEmitter}=handlers;let cont=FsWatchInstances.get(fullPath);let watcher;if(!options.persistent){watcher=createFsWatchInstance(path,options,listener,errHandler,rawEmitter);return watcher.close.bind(watcher)}if(cont){addAndConvert(cont,KEY_LISTENERS,listener);addAndConvert(cont,KEY_ERR,errHandler);addAndConvert(cont,KEY_RAW,rawEmitter);}else {watcher=createFsWatchInstance(path,options,fsWatchBroadcast.bind(null,fullPath,KEY_LISTENERS),errHandler,fsWatchBroadcast.bind(null,fullPath,KEY_RAW));if(!watcher)return;watcher.on(EV_ERROR$2,async error=>{const broadcastErr=fsWatchBroadcast.bind(null,fullPath,KEY_ERR);cont.watcherUnusable=true;if(isWindows$1&&error.code==="EPERM"){try{const fd=await open(path,"r");await close(fd);broadcastErr(error);}catch(err){}}else {broadcastErr(error);}});cont={listeners:listener,errHandlers:errHandler,rawEmitters:rawEmitter,watcher};FsWatchInstances.set(fullPath,cont);}return ()=>{delFromSet(cont,KEY_LISTENERS,listener);delFromSet(cont,KEY_ERR,errHandler);delFromSet(cont,KEY_RAW,rawEmitter);if(isEmptySet(cont.listeners)){cont.watcher.close();FsWatchInstances.delete(fullPath);HANDLER_KEYS.forEach(clearItem(cont));cont.watcher=undefined;Object.freeze(cont);}}};const FsWatchFileInstances=new Map;const setFsWatchFileListener=(path,fullPath,options,handlers)=>{const{listener,rawEmitter}=handlers;let cont=FsWatchFileInstances.get(fullPath);const copts=cont&&cont.options;if(copts&&(copts.persistent<options.persistent||copts.interval>options.interval)){fs$2.unwatchFile(fullPath);cont=undefined;}if(cont){addAndConvert(cont,KEY_LISTENERS,listener);addAndConvert(cont,KEY_RAW,rawEmitter);}else {cont={listeners:listener,rawEmitters:rawEmitter,options,watcher:fs$2.watchFile(fullPath,options,(curr,prev)=>{foreach(cont.rawEmitters,rawEmitter=>{rawEmitter(EV_CHANGE$2,fullPath,{curr,prev});});const currmtime=curr.mtimeMs;if(curr.size!==prev.size||currmtime>prev.mtimeMs||currmtime===0){foreach(cont.listeners,listener=>listener(path,curr));}})};FsWatchFileInstances.set(fullPath,cont);}return ()=>{delFromSet(cont,KEY_LISTENERS,listener);delFromSet(cont,KEY_RAW,rawEmitter);if(isEmptySet(cont.listeners)){FsWatchFileInstances.delete(fullPath);fs$2.unwatchFile(fullPath);cont.options=cont.watcher=undefined;Object.freeze(cont);}}};class NodeFsHandler$1{constructor(fsW){this.fsw=fsW;this._boundHandleError=error=>fsW._handleError(error);}_watchWithNodeFs(path,listener){const opts=this.fsw.options;const directory=sysPath$2.dirname(path);const basename=sysPath$2.basename(path);const parent=this.fsw._getWatchedDir(directory);parent.add(basename);const absolutePath=sysPath$2.resolve(path);const options={persistent:opts.persistent};if(!listener)listener=EMPTY_FN$2;let closer;if(opts.usePolling){options.interval=opts.enableBinaryInterval&&isBinaryPath(basename)?opts.binaryInterval:opts.interval;closer=setFsWatchFileListener(path,absolutePath,options,{listener,rawEmitter:this.fsw._emitRaw});}else {closer=setFsWatchListener(path,absolutePath,options,{listener,errHandler:this._boundHandleError,rawEmitter:this.fsw._emitRaw});}return closer}_handleFile(file,stats,initialAdd){if(this.fsw.closed){return}const dirname=sysPath$2.dirname(file);const basename=sysPath$2.basename(file);const parent=this.fsw._getWatchedDir(dirname);let prevStats=stats;if(parent.has(basename))return;const listener=async(path,newStats)=>{if(!this.fsw._throttle(THROTTLE_MODE_WATCH,file,5))return;if(!newStats||newStats.mtimeMs===0){try{const newStats=await stat$2(file);if(this.fsw.closed)return;const at=newStats.atimeMs;const mt=newStats.mtimeMs;if(!at||at<=mt||mt!==prevStats.mtimeMs){this.fsw._emit(EV_CHANGE$2,file,newStats);}if(isLinux&&prevStats.ino!==newStats.ino){this.fsw._closeFile(path);prevStats=newStats;this.fsw._addPathCloser(path,this._watchWithNodeFs(file,listener));}else {prevStats=newStats;}}catch(error){this.fsw._remove(dirname,basename);}}else if(parent.has(basename)){const at=newStats.atimeMs;const mt=newStats.mtimeMs;if(!at||at<=mt||mt!==prevStats.mtimeMs){this.fsw._emit(EV_CHANGE$2,file,newStats);}prevStats=newStats;}};const closer=this._watchWithNodeFs(file,listener);if(!(initialAdd&&this.fsw.options.ignoreInitial)&&this.fsw._isntIgnored(file)){if(!this.fsw._throttle(EV_ADD$2,file,0))return;this.fsw._emit(EV_ADD$2,file,stats);}return closer}async _handleSymlink(entry,directory,path,item){if(this.fsw.closed){return}const full=entry.fullPath;const dir=this.fsw._getWatchedDir(directory);if(!this.fsw.options.followSymlinks){this.fsw._incrReadyCount();const linkPath=await fsrealpath(path);if(this.fsw.closed)return;if(dir.has(item)){if(this.fsw._symlinkPaths.get(full)!==linkPath){this.fsw._symlinkPaths.set(full,linkPath);this.fsw._emit(EV_CHANGE$2,path,entry.stats);}}else {dir.add(item);this.fsw._symlinkPaths.set(full,linkPath);this.fsw._emit(EV_ADD$2,path,entry.stats);}this.fsw._emitReady();return true}if(this.fsw._symlinkPaths.has(full)){return true}this.fsw._symlinkPaths.set(full,true);}_handleRead(directory,initialAdd,wh,target,dir,depth,throttler){directory=sysPath$2.join(directory,EMPTY_STR$1);if(!wh.hasGlob){throttler=this.fsw._throttle("readdir",directory,1000);if(!throttler)return}const previous=this.fsw._getWatchedDir(wh.path);const current=new Set;let stream=this.fsw._readdirp(directory,{fileFilter:entry=>wh.filterPath(entry),directoryFilter:entry=>wh.filterDir(entry),depth:0}).on(STR_DATA$1,async entry=>{if(this.fsw.closed){stream=undefined;return}const item=entry.path;let path=sysPath$2.join(directory,item);current.add(item);if(entry.stats.isSymbolicLink()&&(await this._handleSymlink(entry,directory,path,item))){return}if(this.fsw.closed){stream=undefined;return}if(item===target||!target&&!previous.has(item)){this.fsw._incrReadyCount();path=sysPath$2.join(dir,sysPath$2.relative(dir,path));this._addToNodeFs(path,initialAdd,wh,depth+1);}}).on(EV_ERROR$2,this._boundHandleError);return new Promise(resolve=>stream.once(STR_END$2,()=>{if(this.fsw.closed){stream=undefined;return}const wasThrottled=throttler?throttler.clear():false;resolve();previous.getChildren().filter(item=>{return item!==directory&&!current.has(item)&&(!wh.hasGlob||wh.filterPath({fullPath:sysPath$2.resolve(directory,item)}))}).forEach(item=>{this.fsw._remove(directory,item);});stream=undefined;if(wasThrottled)this._handleRead(directory,false,wh,target,dir,depth,throttler);}))}async _handleDir(dir,stats,initialAdd,depth,target,wh,realpath){const parentDir=this.fsw._getWatchedDir(sysPath$2.dirname(dir));const tracked=parentDir.has(sysPath$2.basename(dir));if(!(initialAdd&&this.fsw.options.ignoreInitial)&&!target&&!tracked){if(!wh.hasGlob||wh.globFilter(dir))this.fsw._emit(EV_ADD_DIR$2,dir,stats);}parentDir.add(sysPath$2.basename(dir));this.fsw._getWatchedDir(dir);let throttler;let closer;const oDepth=this.fsw.options.depth;if((oDepth==null||depth<=oDepth)&&!this.fsw._symlinkPaths.has(realpath)){if(!target){await this._handleRead(dir,initialAdd,wh,target,dir,depth,throttler);if(this.fsw.closed)return}closer=this._watchWithNodeFs(dir,(dirPath,stats)=>{if(stats&&stats.mtimeMs===0)return;this._handleRead(dirPath,false,wh,target,dir,depth,throttler);});}return closer}async _addToNodeFs(path,initialAdd,priorWh,depth,target){const ready=this.fsw._emitReady;if(this.fsw._isIgnored(path)||this.fsw.closed){ready();return false}const wh=this.fsw._getWatchHelpers(path,depth);if(!wh.hasGlob&&priorWh){wh.hasGlob=priorWh.hasGlob;wh.globFilter=priorWh.globFilter;wh.filterPath=entry=>priorWh.filterPath(entry);wh.filterDir=entry=>priorWh.filterDir(entry);}try{const stats=await statMethods$1[wh.statMethod](wh.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(wh.watchPath,stats)){ready();return false}const follow=this.fsw.options.followSymlinks&&!path.includes(STAR)&&!path.includes(BRACE_START$1);let closer;if(stats.isDirectory()){const absPath=sysPath$2.resolve(path);const targetPath=follow?await fsrealpath(path):path;if(this.fsw.closed)return;closer=await this._handleDir(wh.watchPath,stats,initialAdd,depth,target,wh,targetPath);if(this.fsw.closed)return;if(absPath!==targetPath&&targetPath!==undefined){this.fsw._symlinkPaths.set(absPath,targetPath);}}else if(stats.isSymbolicLink()){const targetPath=follow?await fsrealpath(path):path;if(this.fsw.closed)return;const parent=sysPath$2.dirname(wh.watchPath);this.fsw._getWatchedDir(parent).add(wh.watchPath);this.fsw._emit(EV_ADD$2,wh.watchPath,stats);closer=await this._handleDir(parent,stats,initialAdd,depth,path,wh,targetPath);if(this.fsw.closed)return;if(targetPath!==undefined){this.fsw._symlinkPaths.set(sysPath$2.resolve(path),targetPath);}}else {closer=this._handleFile(wh.watchPath,stats,initialAdd);}ready();this.fsw._addPathCloser(path,closer);return false}catch(error){if(this.fsw._handleError(error)){ready();return path}}}}var nodefsHandler=NodeFsHandler$1;

var fseventsHandler = {exports: {}};

const fs$1=require$$0__default$3["default"];const sysPath$1=require$$0__default$1["default"];const{promisify: promisify$1}=require$$0__default$2["default"];let fsevents;try{fsevents=require("fsevents");}catch(error){if(process.env.CHOKIDAR_PRINT_FSEVENTS_REQUIRE_ERROR)console.error(error);}if(fsevents){const mtch=process.version.match(/v(\d+)\.(\d+)/);if(mtch&&mtch[1]&&mtch[2]){const maj=Number.parseInt(mtch[1],10);const min=Number.parseInt(mtch[2],10);if(maj===8&&min<16){fsevents=undefined;}}}const{EV_ADD: EV_ADD$1,EV_CHANGE: EV_CHANGE$1,EV_ADD_DIR: EV_ADD_DIR$1,EV_UNLINK: EV_UNLINK$1,EV_ERROR: EV_ERROR$1,STR_DATA,STR_END: STR_END$1,FSEVENT_CREATED,FSEVENT_MODIFIED,FSEVENT_DELETED,FSEVENT_MOVED,FSEVENT_UNKNOWN,FSEVENT_TYPE_FILE,FSEVENT_TYPE_DIRECTORY,FSEVENT_TYPE_SYMLINK,ROOT_GLOBSTAR,DIR_SUFFIX,DOT_SLASH,FUNCTION_TYPE: FUNCTION_TYPE$1,EMPTY_FN: EMPTY_FN$1,IDENTITY_FN}=constants;const Depth=value=>isNaN(value)?{}:{depth:value};const stat$1=promisify$1(fs$1.stat);const lstat=promisify$1(fs$1.lstat);const realpath=promisify$1(fs$1.realpath);const statMethods={stat: stat$1,lstat};const FSEventsWatchers=new Map;const consolidateThreshhold=10;const wrongEventFlags=new Set([69888,70400,71424,72704,73472,131328,131840,262912]);const createFSEventsInstance=(path,callback)=>{const stop=fsevents.watch(path,callback);return {stop}};function setFSEventsListener(path,realPath,listener,rawEmitter){let watchPath=sysPath$1.extname(realPath)?sysPath$1.dirname(realPath):realPath;const parentPath=sysPath$1.dirname(watchPath);let cont=FSEventsWatchers.get(watchPath);if(couldConsolidate(parentPath)){watchPath=parentPath;}const resolvedPath=sysPath$1.resolve(path);const hasSymlink=resolvedPath!==realPath;const filteredListener=(fullPath,flags,info)=>{if(hasSymlink)fullPath=fullPath.replace(realPath,resolvedPath);if(fullPath===resolvedPath||!fullPath.indexOf(resolvedPath+sysPath$1.sep))listener(fullPath,flags,info);};let watchedParent=false;for(const watchedPath of FSEventsWatchers.keys()){if(realPath.indexOf(sysPath$1.resolve(watchedPath)+sysPath$1.sep)===0){watchPath=watchedPath;cont=FSEventsWatchers.get(watchPath);watchedParent=true;break}}if(cont||watchedParent){cont.listeners.add(filteredListener);}else {cont={listeners:new Set([filteredListener]),rawEmitter,watcher:createFSEventsInstance(watchPath,(fullPath,flags)=>{if(!cont.listeners.size)return;const info=fsevents.getInfo(fullPath,flags);cont.listeners.forEach(list=>{list(fullPath,flags,info);});cont.rawEmitter(info.event,fullPath,info);})};FSEventsWatchers.set(watchPath,cont);}return ()=>{const lst=cont.listeners;lst.delete(filteredListener);if(!lst.size){FSEventsWatchers.delete(watchPath);if(cont.watcher)return cont.watcher.stop().then(()=>{cont.rawEmitter=cont.watcher=undefined;Object.freeze(cont);})}}}const couldConsolidate=path=>{let count=0;for(const watchPath of FSEventsWatchers.keys()){if(watchPath.indexOf(path)===0){count++;if(count>=consolidateThreshhold){return true}}}return false};const canUse=()=>fsevents&&FSEventsWatchers.size<128;const calcDepth=(path,root)=>{let i=0;while(!path.indexOf(root)&&(path=sysPath$1.dirname(path))!==root)i++;return i};const sameTypes=(info,stats)=>info.type===FSEVENT_TYPE_DIRECTORY&&stats.isDirectory()||info.type===FSEVENT_TYPE_SYMLINK&&stats.isSymbolicLink()||info.type===FSEVENT_TYPE_FILE&&stats.isFile();class FsEventsHandler$1{constructor(fsw){this.fsw=fsw;}checkIgnored(path,stats){const ipaths=this.fsw._ignoredPaths;if(this.fsw._isIgnored(path,stats)){ipaths.add(path);if(stats&&stats.isDirectory()){ipaths.add(path+ROOT_GLOBSTAR);}return true}ipaths.delete(path);ipaths.delete(path+ROOT_GLOBSTAR);}addOrChange(path,fullPath,realPath,parent,watchedDir,item,info,opts){const event=watchedDir.has(item)?EV_CHANGE$1:EV_ADD$1;this.handleEvent(event,path,fullPath,realPath,parent,watchedDir,item,info,opts);}async checkExists(path,fullPath,realPath,parent,watchedDir,item,info,opts){try{const stats=await stat$1(path);if(this.fsw.closed)return;if(sameTypes(info,stats)){this.addOrChange(path,fullPath,realPath,parent,watchedDir,item,info,opts);}else {this.handleEvent(EV_UNLINK$1,path,fullPath,realPath,parent,watchedDir,item,info,opts);}}catch(error){if(error.code==="EACCES"){this.addOrChange(path,fullPath,realPath,parent,watchedDir,item,info,opts);}else {this.handleEvent(EV_UNLINK$1,path,fullPath,realPath,parent,watchedDir,item,info,opts);}}}handleEvent(event,path,fullPath,realPath,parent,watchedDir,item,info,opts){if(this.fsw.closed||this.checkIgnored(path))return;if(event===EV_UNLINK$1){const isDirectory=info.type===FSEVENT_TYPE_DIRECTORY;if(isDirectory||watchedDir.has(item)){this.fsw._remove(parent,item,isDirectory);}}else {if(event===EV_ADD$1){if(info.type===FSEVENT_TYPE_DIRECTORY)this.fsw._getWatchedDir(path);if(info.type===FSEVENT_TYPE_SYMLINK&&opts.followSymlinks){const curDepth=opts.depth===undefined?undefined:calcDepth(fullPath,realPath)+1;return this._addToFsEvents(path,false,true,curDepth)}this.fsw._getWatchedDir(parent).add(item);}const eventName=info.type===FSEVENT_TYPE_DIRECTORY?event+DIR_SUFFIX:event;this.fsw._emit(eventName,path);if(eventName===EV_ADD_DIR$1)this._addToFsEvents(path,false,true);}}_watchWithFsEvents(watchPath,realPath,transform,globFilter){if(this.fsw.closed||this.fsw._isIgnored(watchPath))return;const opts=this.fsw.options;const watchCallback=async(fullPath,flags,info)=>{if(this.fsw.closed)return;if(opts.depth!==undefined&&calcDepth(fullPath,realPath)>opts.depth)return;const path=transform(sysPath$1.join(watchPath,sysPath$1.relative(watchPath,fullPath)));if(globFilter&&!globFilter(path))return;const parent=sysPath$1.dirname(path);const item=sysPath$1.basename(path);const watchedDir=this.fsw._getWatchedDir(info.type===FSEVENT_TYPE_DIRECTORY?path:parent);if(wrongEventFlags.has(flags)||info.event===FSEVENT_UNKNOWN){if(typeof opts.ignored===FUNCTION_TYPE$1){let stats;try{stats=await stat$1(path);}catch(error){}if(this.fsw.closed)return;if(this.checkIgnored(path,stats))return;if(sameTypes(info,stats)){this.addOrChange(path,fullPath,realPath,parent,watchedDir,item,info,opts);}else {this.handleEvent(EV_UNLINK$1,path,fullPath,realPath,parent,watchedDir,item,info,opts);}}else {this.checkExists(path,fullPath,realPath,parent,watchedDir,item,info,opts);}}else {switch(info.event){case FSEVENT_CREATED:case FSEVENT_MODIFIED:return this.addOrChange(path,fullPath,realPath,parent,watchedDir,item,info,opts);case FSEVENT_DELETED:case FSEVENT_MOVED:return this.checkExists(path,fullPath,realPath,parent,watchedDir,item,info,opts);}}};const closer=setFSEventsListener(watchPath,realPath,watchCallback,this.fsw._emitRaw);this.fsw._emitReady();return closer}async _handleFsEventsSymlink(linkPath,fullPath,transform,curDepth){if(this.fsw.closed||this.fsw._symlinkPaths.has(fullPath))return;this.fsw._symlinkPaths.set(fullPath,true);this.fsw._incrReadyCount();try{const linkTarget=await realpath(linkPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(linkTarget)){return this.fsw._emitReady()}this.fsw._incrReadyCount();this._addToFsEvents(linkTarget||linkPath,path=>{let aliasedPath=linkPath;if(linkTarget&&linkTarget!==DOT_SLASH){aliasedPath=path.replace(linkTarget,linkPath);}else if(path!==DOT_SLASH){aliasedPath=sysPath$1.join(linkPath,path);}return transform(aliasedPath)},false,curDepth);}catch(error){if(this.fsw._handleError(error)){return this.fsw._emitReady()}}}emitAdd(newPath,stats,processPath,opts,forceAdd){const pp=processPath(newPath);const isDir=stats.isDirectory();const dirObj=this.fsw._getWatchedDir(sysPath$1.dirname(pp));const base=sysPath$1.basename(pp);if(isDir)this.fsw._getWatchedDir(pp);if(dirObj.has(base))return;dirObj.add(base);if(!opts.ignoreInitial||forceAdd===true){this.fsw._emit(isDir?EV_ADD_DIR$1:EV_ADD$1,pp,stats);}}initWatch(realPath,path,wh,processPath){if(this.fsw.closed)return;const closer=this._watchWithFsEvents(wh.watchPath,sysPath$1.resolve(realPath||wh.watchPath),processPath,wh.globFilter);this.fsw._addPathCloser(path,closer);}async _addToFsEvents(path,transform,forceAdd,priorDepth){if(this.fsw.closed){return}const opts=this.fsw.options;const processPath=typeof transform===FUNCTION_TYPE$1?transform:IDENTITY_FN;const wh=this.fsw._getWatchHelpers(path);try{const stats=await statMethods[wh.statMethod](wh.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(wh.watchPath,stats)){throw null}if(stats.isDirectory()){if(!wh.globFilter)this.emitAdd(processPath(path),stats,processPath,opts,forceAdd);if(priorDepth&&priorDepth>opts.depth)return;this.fsw._readdirp(wh.watchPath,{fileFilter:entry=>wh.filterPath(entry),directoryFilter:entry=>wh.filterDir(entry),...Depth(opts.depth-(priorDepth||0))}).on(STR_DATA,entry=>{if(this.fsw.closed){return}if(entry.stats.isDirectory()&&!wh.filterPath(entry))return;const joinedPath=sysPath$1.join(wh.watchPath,entry.path);const{fullPath}=entry;if(wh.followSymlinks&&entry.stats.isSymbolicLink()){const curDepth=opts.depth===undefined?undefined:calcDepth(joinedPath,sysPath$1.resolve(wh.watchPath))+1;this._handleFsEventsSymlink(joinedPath,fullPath,processPath,curDepth);}else {this.emitAdd(joinedPath,entry.stats,processPath,opts,forceAdd);}}).on(EV_ERROR$1,EMPTY_FN$1).on(STR_END$1,()=>{this.fsw._emitReady();});}else {this.emitAdd(wh.watchPath,stats,processPath,opts,forceAdd);this.fsw._emitReady();}}catch(error){if(!error||this.fsw._handleError(error)){this.fsw._emitReady();this.fsw._emitReady();}}if(opts.persistent&&forceAdd!==true){if(typeof transform===FUNCTION_TYPE$1){this.initWatch(undefined,path,wh,processPath);}else {let realPath;try{realPath=await realpath(wh.watchPath);}catch(e){}this.initWatch(realPath,path,wh,processPath);}}}}fseventsHandler.exports=FsEventsHandler$1;fseventsHandler.exports.canUse=canUse;

const{EventEmitter}=require$$0__default$4["default"];const fs=require$$0__default$3["default"];const sysPath=require$$0__default$1["default"];const{promisify}=require$$0__default$2["default"];const readdirp=readdirp_1;const anymatch=anymatch$2.exports.default;const globParent=globParent$2;const isGlob=isGlob$2;const braces=braces_1;const normalizePath=normalizePath$2;const NodeFsHandler=nodefsHandler;const FsEventsHandler=fseventsHandler.exports;const{EV_ALL,EV_READY,EV_ADD,EV_CHANGE,EV_UNLINK,EV_ADD_DIR,EV_UNLINK_DIR,EV_RAW,EV_ERROR,STR_CLOSE,STR_END,BACK_SLASH_RE,DOUBLE_SLASH_RE,SLASH_OR_BACK_SLASH_RE,DOT_RE,REPLACER_RE,SLASH,SLASH_SLASH,BRACE_START,BANG,ONE_DOT,TWO_DOTS,GLOBSTAR,SLASH_GLOBSTAR,ANYMATCH_OPTS,STRING_TYPE,FUNCTION_TYPE,EMPTY_STR,EMPTY_FN,isWindows,isMacos,isIBMi}=constants;const stat=promisify(fs.stat);const readdir=promisify(fs.readdir);const arrify=(value=[])=>Array.isArray(value)?value:[value];const flatten=(list,result=[])=>{list.forEach(item=>{if(Array.isArray(item)){flatten(item,result);}else {result.push(item);}});return result};const unifyPaths=paths_=>{const paths=flatten(arrify(paths_));if(!paths.every(p=>typeof p===STRING_TYPE)){throw new TypeError(`Non-string provided as watch path: ${paths}`)}return paths.map(normalizePathToUnix)};const toUnix=string=>{let str=string.replace(BACK_SLASH_RE,SLASH);let prepend=false;if(str.startsWith(SLASH_SLASH)){prepend=true;}while(str.match(DOUBLE_SLASH_RE)){str=str.replace(DOUBLE_SLASH_RE,SLASH);}if(prepend){str=SLASH+str;}return str};const normalizePathToUnix=path=>toUnix(sysPath.normalize(toUnix(path)));const normalizeIgnored=(cwd=EMPTY_STR)=>path=>{if(typeof path!==STRING_TYPE)return path;return normalizePathToUnix(sysPath.isAbsolute(path)?path:sysPath.join(cwd,path))};const getAbsolutePath=(path,cwd)=>{if(sysPath.isAbsolute(path)){return path}if(path.startsWith(BANG)){return BANG+sysPath.join(cwd,path.slice(1))}return sysPath.join(cwd,path)};const undef=(opts,key)=>opts[key]===undefined;class DirEntry{constructor(dir,removeWatcher){this.path=dir;this._removeWatcher=removeWatcher;this.items=new Set;}add(item){const{items}=this;if(!items)return;if(item!==ONE_DOT&&item!==TWO_DOTS)items.add(item);}async remove(item){const{items}=this;if(!items)return;items.delete(item);if(items.size>0)return;const dir=this.path;try{await readdir(dir);}catch(err){if(this._removeWatcher){this._removeWatcher(sysPath.dirname(dir),sysPath.basename(dir));}}}has(item){const{items}=this;if(!items)return;return items.has(item)}getChildren(){const{items}=this;if(!items)return;return [...items.values()]}dispose(){this.items.clear();delete this.path;delete this._removeWatcher;delete this.items;Object.freeze(this);}}const STAT_METHOD_F="stat";const STAT_METHOD_L="lstat";class WatchHelper{constructor(path,watchPath,follow,fsw){this.fsw=fsw;this.path=path=path.replace(REPLACER_RE,EMPTY_STR);this.watchPath=watchPath;this.fullWatchPath=sysPath.resolve(watchPath);this.hasGlob=watchPath!==path;if(path===EMPTY_STR)this.hasGlob=false;this.globSymlink=this.hasGlob&&follow?undefined:false;this.globFilter=this.hasGlob?anymatch(path,undefined,ANYMATCH_OPTS):false;this.dirParts=this.getDirParts(path);this.dirParts.forEach(parts=>{if(parts.length>1)parts.pop();});this.followSymlinks=follow;this.statMethod=follow?STAT_METHOD_F:STAT_METHOD_L;}checkGlobSymlink(entry){if(this.globSymlink===undefined){this.globSymlink=entry.fullParentDir===this.fullWatchPath?false:{realPath:entry.fullParentDir,linkPath:this.fullWatchPath};}if(this.globSymlink){return entry.fullPath.replace(this.globSymlink.realPath,this.globSymlink.linkPath)}return entry.fullPath}entryPath(entry){return sysPath.join(this.watchPath,sysPath.relative(this.watchPath,this.checkGlobSymlink(entry)))}filterPath(entry){const{stats}=entry;if(stats&&stats.isSymbolicLink())return this.filterDir(entry);const resolvedPath=this.entryPath(entry);const matchesGlob=this.hasGlob&&typeof this.globFilter===FUNCTION_TYPE?this.globFilter(resolvedPath):true;return matchesGlob&&this.fsw._isntIgnored(resolvedPath,stats)&&this.fsw._hasReadPermissions(stats)}getDirParts(path){if(!this.hasGlob)return [];const parts=[];const expandedPath=path.includes(BRACE_START)?braces.expand(path):[path];expandedPath.forEach(path=>{parts.push(sysPath.relative(this.watchPath,path).split(SLASH_OR_BACK_SLASH_RE));});return parts}filterDir(entry){if(this.hasGlob){const entryParts=this.getDirParts(this.checkGlobSymlink(entry));let globstar=false;this.unmatchedGlob=!this.dirParts.some(parts=>{return parts.every((part,i)=>{if(part===GLOBSTAR)globstar=true;return globstar||!entryParts[0][i]||anymatch(part,entryParts[0][i],ANYMATCH_OPTS)})});}return !this.unmatchedGlob&&this.fsw._isntIgnored(this.entryPath(entry),entry.stats)}}class FSWatcher extends EventEmitter{constructor(_opts){super();const opts={};if(_opts)Object.assign(opts,_opts);this._watched=new Map;this._closers=new Map;this._ignoredPaths=new Set;this._throttled=new Map;this._symlinkPaths=new Map;this._streams=new Set;this.closed=false;if(undef(opts,"persistent"))opts.persistent=true;if(undef(opts,"ignoreInitial"))opts.ignoreInitial=false;if(undef(opts,"ignorePermissionErrors"))opts.ignorePermissionErrors=false;if(undef(opts,"interval"))opts.interval=100;if(undef(opts,"binaryInterval"))opts.binaryInterval=300;if(undef(opts,"disableGlobbing"))opts.disableGlobbing=false;opts.enableBinaryInterval=opts.binaryInterval!==opts.interval;if(undef(opts,"useFsEvents"))opts.useFsEvents=!opts.usePolling;const canUseFsEvents=FsEventsHandler.canUse();if(!canUseFsEvents)opts.useFsEvents=false;if(undef(opts,"usePolling")&&!opts.useFsEvents){opts.usePolling=isMacos;}if(isIBMi){opts.usePolling=true;}const envPoll=process.env.CHOKIDAR_USEPOLLING;if(envPoll!==undefined){const envLower=envPoll.toLowerCase();if(envLower==="false"||envLower==="0"){opts.usePolling=false;}else if(envLower==="true"||envLower==="1"){opts.usePolling=true;}else {opts.usePolling=!!envLower;}}const envInterval=process.env.CHOKIDAR_INTERVAL;if(envInterval){opts.interval=Number.parseInt(envInterval,10);}if(undef(opts,"atomic"))opts.atomic=!opts.usePolling&&!opts.useFsEvents;if(opts.atomic)this._pendingUnlinks=new Map;if(undef(opts,"followSymlinks"))opts.followSymlinks=true;if(undef(opts,"awaitWriteFinish"))opts.awaitWriteFinish=false;if(opts.awaitWriteFinish===true)opts.awaitWriteFinish={};const awf=opts.awaitWriteFinish;if(awf){if(!awf.stabilityThreshold)awf.stabilityThreshold=2000;if(!awf.pollInterval)awf.pollInterval=100;this._pendingWrites=new Map;}if(opts.ignored)opts.ignored=arrify(opts.ignored);let readyCalls=0;this._emitReady=()=>{readyCalls++;if(readyCalls>=this._readyCount){this._emitReady=EMPTY_FN;this._readyEmitted=true;process.nextTick(()=>this.emit(EV_READY));}};this._emitRaw=(...args)=>this.emit(EV_RAW,...args);this._readyEmitted=false;this.options=opts;if(opts.useFsEvents){this._fsEventsHandler=new FsEventsHandler(this);}else {this._nodeFsHandler=new NodeFsHandler(this);}Object.freeze(opts);}add(paths_,_origAdd,_internal){const{cwd,disableGlobbing}=this.options;this.closed=false;let paths=unifyPaths(paths_);if(cwd){paths=paths.map(path=>{const absPath=getAbsolutePath(path,cwd);if(disableGlobbing||!isGlob(path)){return absPath}return normalizePath(absPath)});}paths=paths.filter(path=>{if(path.startsWith(BANG)){this._ignoredPaths.add(path.slice(1));return false}this._ignoredPaths.delete(path);this._ignoredPaths.delete(path+SLASH_GLOBSTAR);this._userIgnored=undefined;return true});if(this.options.useFsEvents&&this._fsEventsHandler){if(!this._readyCount)this._readyCount=paths.length;if(this.options.persistent)this._readyCount*=2;paths.forEach(path=>this._fsEventsHandler._addToFsEvents(path));}else {if(!this._readyCount)this._readyCount=0;this._readyCount+=paths.length;Promise.all(paths.map(async path=>{const res=await this._nodeFsHandler._addToNodeFs(path,!_internal,0,0,_origAdd);if(res)this._emitReady();return res})).then(results=>{if(this.closed)return;results.filter(item=>item).forEach(item=>{this.add(sysPath.dirname(item),sysPath.basename(_origAdd||item));});});}return this}unwatch(paths_){if(this.closed)return this;const paths=unifyPaths(paths_);const{cwd}=this.options;paths.forEach(path=>{if(!sysPath.isAbsolute(path)&&!this._closers.has(path)){if(cwd)path=sysPath.join(cwd,path);path=sysPath.resolve(path);}this._closePath(path);this._ignoredPaths.add(path);if(this._watched.has(path)){this._ignoredPaths.add(path+SLASH_GLOBSTAR);}this._userIgnored=undefined;});return this}close(){if(this.closed)return this._closePromise;this.closed=true;this.removeAllListeners();const closers=[];this._closers.forEach(closerList=>closerList.forEach(closer=>{const promise=closer();if(promise instanceof Promise)closers.push(promise);}));this._streams.forEach(stream=>stream.destroy());this._userIgnored=undefined;this._readyCount=0;this._readyEmitted=false;this._watched.forEach(dirent=>dirent.dispose());["closers","watched","streams","symlinkPaths","throttled"].forEach(key=>{this[`_${key}`].clear();});this._closePromise=closers.length?Promise.all(closers).then(()=>undefined):Promise.resolve();return this._closePromise}getWatched(){const watchList={};this._watched.forEach((entry,dir)=>{const key=this.options.cwd?sysPath.relative(this.options.cwd,dir):dir;watchList[key||ONE_DOT]=entry.getChildren().sort();});return watchList}emitWithAll(event,args){this.emit(...args);if(event!==EV_ERROR)this.emit(EV_ALL,...args);}async _emit(event,path,val1,val2,val3){if(this.closed)return;const opts=this.options;if(isWindows)path=sysPath.normalize(path);if(opts.cwd)path=sysPath.relative(opts.cwd,path);const args=[event,path];if(val3!==undefined)args.push(val1,val2,val3);else if(val2!==undefined)args.push(val1,val2);else if(val1!==undefined)args.push(val1);const awf=opts.awaitWriteFinish;let pw;if(awf&&(pw=this._pendingWrites.get(path))){pw.lastChange=new Date;return this}if(opts.atomic){if(event===EV_UNLINK){this._pendingUnlinks.set(path,args);setTimeout(()=>{this._pendingUnlinks.forEach((entry,path)=>{this.emit(...entry);this.emit(EV_ALL,...entry);this._pendingUnlinks.delete(path);});},typeof opts.atomic==="number"?opts.atomic:100);return this}if(event===EV_ADD&&this._pendingUnlinks.has(path)){event=args[0]=EV_CHANGE;this._pendingUnlinks.delete(path);}}if(awf&&(event===EV_ADD||event===EV_CHANGE)&&this._readyEmitted){const awfEmit=(err,stats)=>{if(err){event=args[0]=EV_ERROR;args[1]=err;this.emitWithAll(event,args);}else if(stats){if(args.length>2){args[2]=stats;}else {args.push(stats);}this.emitWithAll(event,args);}};this._awaitWriteFinish(path,awf.stabilityThreshold,event,awfEmit);return this}if(event===EV_CHANGE){const isThrottled=!this._throttle(EV_CHANGE,path,50);if(isThrottled)return this}if(opts.alwaysStat&&val1===undefined&&(event===EV_ADD||event===EV_ADD_DIR||event===EV_CHANGE)){const fullPath=opts.cwd?sysPath.join(opts.cwd,path):path;let stats;try{stats=await stat(fullPath);}catch(err){}if(!stats||this.closed)return;args.push(stats);}this.emitWithAll(event,args);return this}_handleError(error){const code=error&&error.code;if(error&&code!=="ENOENT"&&code!=="ENOTDIR"&&(!this.options.ignorePermissionErrors||code!=="EPERM"&&code!=="EACCES")){this.emit(EV_ERROR,error);}return error||this.closed}_throttle(actionType,path,timeout){if(!this._throttled.has(actionType)){this._throttled.set(actionType,new Map);}const action=this._throttled.get(actionType);const actionPath=action.get(path);if(actionPath){actionPath.count++;return false}let timeoutObject;const clear=()=>{const item=action.get(path);const count=item?item.count:0;action.delete(path);clearTimeout(timeoutObject);if(item)clearTimeout(item.timeoutObject);return count};timeoutObject=setTimeout(clear,timeout);const thr={timeoutObject,clear,count:0};action.set(path,thr);return thr}_incrReadyCount(){return this._readyCount++}_awaitWriteFinish(path,threshold,event,awfEmit){let timeoutHandler;let fullPath=path;if(this.options.cwd&&!sysPath.isAbsolute(path)){fullPath=sysPath.join(this.options.cwd,path);}const now=new Date;const awaitWriteFinish=prevStat=>{fs.stat(fullPath,(err,curStat)=>{if(err||!this._pendingWrites.has(path)){if(err&&err.code!=="ENOENT")awfEmit(err);return}const now=Number(new Date);if(prevStat&&curStat.size!==prevStat.size){this._pendingWrites.get(path).lastChange=now;}const pw=this._pendingWrites.get(path);const df=now-pw.lastChange;if(df>=threshold){this._pendingWrites.delete(path);awfEmit(undefined,curStat);}else {timeoutHandler=setTimeout(awaitWriteFinish,this.options.awaitWriteFinish.pollInterval,curStat);}});};if(!this._pendingWrites.has(path)){this._pendingWrites.set(path,{lastChange:now,cancelWait:()=>{this._pendingWrites.delete(path);clearTimeout(timeoutHandler);return event}});timeoutHandler=setTimeout(awaitWriteFinish,this.options.awaitWriteFinish.pollInterval);}}_getGlobIgnored(){return [...this._ignoredPaths.values()]}_isIgnored(path,stats){if(this.options.atomic&&DOT_RE.test(path))return true;if(!this._userIgnored){const{cwd}=this.options;const ign=this.options.ignored;const ignored=ign&&ign.map(normalizeIgnored(cwd));const paths=arrify(ignored).filter(path=>typeof path===STRING_TYPE&&!isGlob(path)).map(path=>path+SLASH_GLOBSTAR);const list=this._getGlobIgnored().map(normalizeIgnored(cwd)).concat(ignored,paths);this._userIgnored=anymatch(list,undefined,ANYMATCH_OPTS);}return this._userIgnored([path,stats])}_isntIgnored(path,stat){return !this._isIgnored(path,stat)}_getWatchHelpers(path,depth){const watchPath=depth||this.options.disableGlobbing||!isGlob(path)?path:globParent(path);const follow=this.options.followSymlinks;return new WatchHelper(path,watchPath,follow,this)}_getWatchedDir(directory){if(!this._boundRemove)this._boundRemove=this._remove.bind(this);const dir=sysPath.resolve(directory);if(!this._watched.has(dir))this._watched.set(dir,new DirEntry(dir,this._boundRemove));return this._watched.get(dir)}_hasReadPermissions(stats){if(this.options.ignorePermissionErrors)return true;const md=stats&&Number.parseInt(stats.mode,10);const st=md&511;const it=Number.parseInt(st.toString(8)[0],10);return Boolean(4&it)}_remove(directory,item,isDirectory){const path=sysPath.join(directory,item);const fullPath=sysPath.resolve(path);isDirectory=isDirectory!=null?isDirectory:this._watched.has(path)||this._watched.has(fullPath);if(!this._throttle("remove",path,100))return;if(!isDirectory&&!this.options.useFsEvents&&this._watched.size===1){this.add(directory,item,true);}const wp=this._getWatchedDir(path);const nestedDirectoryChildren=wp.getChildren();nestedDirectoryChildren.forEach(nested=>this._remove(path,nested));const parent=this._getWatchedDir(directory);const wasTracked=parent.has(item);parent.remove(item);if(this._symlinkPaths.has(fullPath)){this._symlinkPaths.delete(fullPath);}let relPath=path;if(this.options.cwd)relPath=sysPath.relative(this.options.cwd,path);if(this.options.awaitWriteFinish&&this._pendingWrites.has(relPath)){const event=this._pendingWrites.get(relPath).cancelWait();if(event===EV_ADD)return}this._watched.delete(path);this._watched.delete(fullPath);const eventName=isDirectory?EV_UNLINK_DIR:EV_UNLINK;if(wasTracked&&!this._isIgnored(path))this._emit(eventName,path);if(!this.options.useFsEvents){this._closePath(path);}}_closePath(path){this._closeFile(path);const dir=sysPath.dirname(path);this._getWatchedDir(dir).remove(sysPath.basename(path));}_closeFile(path){const closers=this._closers.get(path);if(!closers)return;closers.forEach(closer=>closer());this._closers.delete(path);}_addPathCloser(path,closer){if(!closer)return;let list=this._closers.get(path);if(!list){list=[];this._closers.set(path,list);}list.push(closer);}_readdirp(root,opts){if(this.closed)return;const options={type:EV_ALL,alwaysStat:true,lstat:true,...opts};let stream=readdirp(root,options);this._streams.add(stream);stream.once(STR_CLOSE,()=>{stream=undefined;});stream.once(STR_END,()=>{if(stream){this._streams.delete(stream);stream=undefined;}});return stream}}const watch=(paths,options)=>{const watcher=new FSWatcher(options);watcher.add(paths);return watcher};var watch_1=watch;

var http=require$$2__default["default"];var methods$1=getCurrentNodeMethods()||getBasicNodeMethods();function getCurrentNodeMethods(){return http.METHODS&&http.METHODS.map(function lowerCaseMethod(method){return method.toLowerCase()})}function getBasicNodeMethods(){return ["get","post","put","head","delete","options","trace","copy","lock","mkcol","move","purge","propfind","proppatch","unlock","report","mkactivity","checkout","merge","m-search","notify","subscribe","unsubscribe","patch","search","connect"]}

function lexer(str){var tokens=[];var i=0;while(i<str.length){var char=str[i];if(char==="*"||char==="+"||char==="?"){tokens.push({type:"MODIFIER",index:i,value:str[i++]});continue}if(char==="\\"){tokens.push({type:"ESCAPED_CHAR",index:i++,value:str[i++]});continue}if(char==="{"){tokens.push({type:"OPEN",index:i,value:str[i++]});continue}if(char==="}"){tokens.push({type:"CLOSE",index:i,value:str[i++]});continue}if(char===":"){var name="";var j=i+1;while(j<str.length){var code=str.charCodeAt(j);if(code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122||code===95){name+=str[j++];continue}break}if(!name)throw new TypeError("Missing parameter name at "+i);tokens.push({type:"NAME",index:i,value:name});i=j;continue}if(char==="("){var count=1;var pattern="";var j=i+1;if(str[j]==="?"){throw new TypeError("Pattern cannot start with \"?\" at "+j)}while(j<str.length){if(str[j]==="\\"){pattern+=str[j++]+str[j++];continue}if(str[j]===")"){count--;if(count===0){j++;break}}else if(str[j]==="("){count++;if(str[j+1]!=="?"){throw new TypeError("Capturing groups are not allowed at "+j)}}pattern+=str[j++];}if(count)throw new TypeError("Unbalanced pattern at "+i);if(!pattern)throw new TypeError("Missing pattern at "+i);tokens.push({type:"PATTERN",index:i,value:pattern});i=j;continue}tokens.push({type:"CHAR",index:i,value:str[i++]});}tokens.push({type:"END",index:i,value:""});return tokens}function parse$2(str,options){if(options===void 0){options={};}var tokens=lexer(str);var _a=options.prefixes,prefixes=_a===void 0?"./":_a;var defaultPattern="[^"+escapeString(options.delimiter||"/#?")+"]+?";var result=[];var key=0;var i=0;var path="";var tryConsume=function(type){if(i<tokens.length&&tokens[i].type===type)return tokens[i++].value};var mustConsume=function(type){var value=tryConsume(type);if(value!==undefined)return value;var _a=tokens[i],nextType=_a.type,index=_a.index;throw new TypeError("Unexpected "+nextType+" at "+index+", expected "+type)};var consumeText=function(){var result="";var value;while(value=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR")){result+=value;}return result};while(i<tokens.length){var char=tryConsume("CHAR");var name=tryConsume("NAME");var pattern=tryConsume("PATTERN");if(name||pattern){var prefix=char||"";if(prefixes.indexOf(prefix)===-1){path+=prefix;prefix="";}if(path){result.push(path);path="";}result.push({name:name||key++,prefix:prefix,suffix:"",pattern:pattern||defaultPattern,modifier:tryConsume("MODIFIER")||""});continue}var value=char||tryConsume("ESCAPED_CHAR");if(value){path+=value;continue}if(path){result.push(path);path="";}var open=tryConsume("OPEN");if(open){var prefix=consumeText();var name_1=tryConsume("NAME")||"";var pattern_1=tryConsume("PATTERN")||"";var suffix=consumeText();mustConsume("CLOSE");result.push({name:name_1||(pattern_1?key++:""),pattern:name_1&&!pattern_1?defaultPattern:pattern_1,prefix:prefix,suffix:suffix,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END");}return result}function compile$1(str,options){return tokensToFunction(parse$2(str,options),options)}function tokensToFunction(tokens,options){if(options===void 0){options={};}var reFlags=flags(options);var _a=options.encode,encode=_a===void 0?function(x){return x}:_a,_b=options.validate,validate=_b===void 0?true:_b;var matches=tokens.map(function(token){if(typeof token==="object"){return new RegExp("^(?:"+token.pattern+")$",reFlags)}});return function(data){var path="";for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data?data[token.name]:undefined;var optional=token.modifier==="?"||token.modifier==="*";var repeat=token.modifier==="*"||token.modifier==="+";if(Array.isArray(value)){if(!repeat){throw new TypeError("Expected \""+token.name+"\" to not repeat, but got an array")}if(value.length===0){if(optional)continue;throw new TypeError("Expected \""+token.name+"\" to not be empty")}for(var j=0;j<value.length;j++){var segment=encode(value[j],token);if(validate&&!matches[i].test(segment)){throw new TypeError("Expected all \""+token.name+"\" to match \""+token.pattern+"\", but got \""+segment+"\"")}path+=token.prefix+segment+token.suffix;}continue}if(typeof value==="string"||typeof value==="number"){var segment=encode(String(value),token);if(validate&&!matches[i].test(segment)){throw new TypeError("Expected \""+token.name+"\" to match \""+token.pattern+"\", but got \""+segment+"\"")}path+=token.prefix+segment+token.suffix;continue}if(optional)continue;var typeOfMessage=repeat?"an array":"a string";throw new TypeError("Expected \""+token.name+"\" to be "+typeOfMessage)}return path}}function match(str,options){var keys=[];var re=pathToRegexp$2(str,keys,options);return regexpToFunction(re,keys,options)}function regexpToFunction(re,keys,options){if(options===void 0){options={};}var _a=options.decode,decode=_a===void 0?function(x){return x}:_a;return function(pathname){var m=re.exec(pathname);if(!m)return false;var path=m[0],index=m.index;var params=Object.create(null);var _loop_1=function(i){if(m[i]===undefined)return "continue";var key=keys[i-1];if(key.modifier==="*"||key.modifier==="+"){params[key.name]=m[i].split(key.prefix+key.suffix).map(function(value){return decode(value,key)});}else {params[key.name]=decode(m[i],key);}};for(var i=1;i<m.length;i++){_loop_1(i);}return {path:path,index:index,params:params}}}function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(options){return options&&options.sensitive?"":"i"}function regexpToRegexp(path,keys){if(!keys)return path;var groupsRegex=/\((?:\?<(.*?)>)?(?!\?)/g;var index=0;var execResult=groupsRegex.exec(path.source);while(execResult){keys.push({name:execResult[1]||index++,prefix:"",suffix:"",modifier:"",pattern:""});execResult=groupsRegex.exec(path.source);}return path}function arrayToRegexp(paths,keys,options){var parts=paths.map(function(path){return pathToRegexp$2(path,keys,options).source});return new RegExp("(?:"+parts.join("|")+")",flags(options))}function stringToRegexp(path,keys,options){return tokensToRegexp(parse$2(path,options),keys,options)}function tokensToRegexp(tokens,keys,options){if(options===void 0){options={};}var _a=options.strict,strict=_a===void 0?false:_a,_b=options.start,start=_b===void 0?true:_b,_c=options.end,end=_c===void 0?true:_c,_d=options.encode,encode=_d===void 0?function(x){return x}:_d;var endsWith="["+escapeString(options.endsWith||"")+"]|$";var delimiter="["+escapeString(options.delimiter||"/#?")+"]";var route=start?"^":"";for(var _i=0,tokens_1=tokens;_i<tokens_1.length;_i++){var token=tokens_1[_i];if(typeof token==="string"){route+=escapeString(encode(token));}else {var prefix=escapeString(encode(token.prefix));var suffix=escapeString(encode(token.suffix));if(token.pattern){if(keys)keys.push(token);if(prefix||suffix){if(token.modifier==="+"||token.modifier==="*"){var mod=token.modifier==="*"?"?":"";route+="(?:"+prefix+"((?:"+token.pattern+")(?:"+suffix+prefix+"(?:"+token.pattern+"))*)"+suffix+")"+mod;}else {route+="(?:"+prefix+"("+token.pattern+")"+suffix+")"+token.modifier;}}else {route+="("+token.pattern+")"+token.modifier;}}else {route+="(?:"+prefix+suffix+")"+token.modifier;}}}if(end){if(!strict)route+=delimiter+"?";route+=!options.endsWith?"$":"(?="+endsWith+")";}else {var endToken=tokens[tokens.length-1];var isEndDelimited=typeof endToken==="string"?delimiter.indexOf(endToken[endToken.length-1])>-1:endToken===undefined;if(!strict){route+="(?:"+delimiter+"(?="+endsWith+"))?";}if(!isEndDelimited){route+="(?="+delimiter+"|"+endsWith+")";}}return new RegExp(route,flags(options))}function pathToRegexp$2(path,keys,options){if(path instanceof RegExp)return regexpToRegexp(path,keys);if(Array.isArray(path))return arrayToRegexp(path,keys,options);return stringToRegexp(path,keys,options)}

var dist_es2015 = /*#__PURE__*/Object.freeze({
  __proto__: null,
  parse: parse$2,
  compile: compile$1,
  tokensToFunction: tokensToFunction,
  match: match,
  regexpToFunction: regexpToFunction,
  tokensToRegexp: tokensToRegexp,
  pathToRegexp: pathToRegexp$2
});

var require$$5 = /*@__PURE__*/getAugmentedNamespace(dist_es2015);

const{pathToRegexp: pathToRegexp$1,compile,parse: parse$1}=require$$5;const{parse:parseUrl,format:formatUrl}=require$$0__default$7["default"];var layer=Layer$1;function Layer$1(path,methods,middleware,opts){this.opts=opts||{};this.name=this.opts.name||null;this.methods=[];this.paramNames=[];this.stack=Array.isArray(middleware)?middleware:[middleware];for(let i=0;i<methods.length;i++){const l=this.methods.push(methods[i].toUpperCase());if(this.methods[l-1]==="GET")this.methods.unshift("HEAD");}for(let i=0;i<this.stack.length;i++){const fn=this.stack[i];const type=typeof fn;if(type!=="function")throw new Error(`${methods.toString()} \`${this.opts.name||path}\`: \`middleware\` must be a function, not \`${type}\``)}this.path=path;this.regexp=pathToRegexp$1(path,this.paramNames,this.opts);}Layer$1.prototype.match=function(path){return this.regexp.test(path)};Layer$1.prototype.params=function(path,captures,existingParams){const params=existingParams||{};for(let len=captures.length,i=0;i<len;i++){if(this.paramNames[i]){const c=captures[i];if(c&&c.length!==0)params[this.paramNames[i].name]=c?safeDecodeURIComponent(c):c;}}return params};Layer$1.prototype.captures=function(path){return this.opts.ignoreCaptures?[]:path.match(this.regexp).slice(1)};Layer$1.prototype.url=function(params,options){let args=params;const url=this.path.replace(/\(\.\*\)/g,"");if(typeof params!="object"){args=Array.prototype.slice.call(arguments);if(typeof args[args.length-1]=="object"){options=args[args.length-1];args=args.slice(0,args.length-1);}}const toPath=compile(url,options);let replaced;const tokens=parse$1(url);let replace={};if(args instanceof Array){for(let len=tokens.length,i=0,j=0;i<len;i++){if(tokens[i].name)replace[tokens[i].name]=args[j++];}}else if(tokens.some(token=>token.name)){replace=params;}else if(!options){options=params;}replaced=toPath(replace);if(options&&options.query){replaced=parseUrl(replaced);if(typeof options.query==="string"){replaced.search=options.query;}else {replaced.search=undefined;replaced.query=options.query;}return formatUrl(replaced)}return replaced};Layer$1.prototype.param=function(param,fn){const stack=this.stack;const params=this.paramNames;const middleware=function(ctx,next){return fn.call(this,ctx.params[param],ctx,next)};middleware.param=param;const names=params.map(function(p){return p.name});const x=names.indexOf(param);if(x>-1){stack.some(function(fn,i){if(!fn.param||names.indexOf(fn.param)>x){stack.splice(i,0,middleware);return true}});}return this};Layer$1.prototype.setPrefix=function(prefix){if(this.path){this.path=this.path!=="/"||this.opts.strict===true?`${prefix}${this.path}`:prefix;this.paramNames=[];this.regexp=pathToRegexp$1(this.path,this.paramNames,this.opts);}return this};function safeDecodeURIComponent(text){try{return decodeURIComponent(text)}catch(e){return text}}

const debug=src.exports("koa-router");const compose=koaCompose;const HttpError=httpErrors.exports;const methods=methods$1;const Layer=layer;const{pathToRegexp}=require$$5;var router=Router;function Router(opts){if(!(this instanceof Router))return new Router(opts);this.opts=opts||{};this.methods=this.opts.methods||["HEAD","OPTIONS","GET","PUT","PATCH","POST","DELETE"];this.params={};this.stack=[];}for(let i=0;i<methods.length;i++){function setMethodVerb(method){Router.prototype[method]=function(name,path,middleware){if(typeof path==="string"||path instanceof RegExp){middleware=Array.prototype.slice.call(arguments,2);}else {middleware=Array.prototype.slice.call(arguments,1);path=name;name=null;}this.register(path,[method],middleware,{name:name});return this};}setMethodVerb(methods[i]);}Router.prototype.del=Router.prototype["delete"];Router.prototype.use=function(){const router=this;const middleware=Array.prototype.slice.call(arguments);let path;if(Array.isArray(middleware[0])&&typeof middleware[0][0]==="string"){let arrPaths=middleware[0];for(let i=0;i<arrPaths.length;i++){const p=arrPaths[i];router.use.apply(router,[p].concat(middleware.slice(1)));}return this}const hasPath=typeof middleware[0]==="string";if(hasPath)path=middleware.shift();for(let i=0;i<middleware.length;i++){const m=middleware[i];if(m.router){const cloneRouter=Object.assign(Object.create(Router.prototype),m.router,{stack:m.router.stack.slice(0)});for(let j=0;j<cloneRouter.stack.length;j++){const nestedLayer=cloneRouter.stack[j];const cloneLayer=Object.assign(Object.create(Layer.prototype),nestedLayer);if(path)cloneLayer.setPrefix(path);if(router.opts.prefix)cloneLayer.setPrefix(router.opts.prefix);router.stack.push(cloneLayer);cloneRouter.stack[j]=cloneLayer;}if(router.params){function setRouterParams(paramArr){const routerParams=paramArr;for(let j=0;j<routerParams.length;j++){const key=routerParams[j];cloneRouter.param(key,router.params[key]);}}setRouterParams(Object.keys(router.params));}}else {const keys=[];pathToRegexp(router.opts.prefix||"",keys);const routerPrefixHasParam=router.opts.prefix&&keys.length;router.register(path||"([^/]*)",[],m,{end:false,ignoreCaptures:!hasPath&&!routerPrefixHasParam});}}return this};Router.prototype.prefix=function(prefix){prefix=prefix.replace(/\/$/,"");this.opts.prefix=prefix;for(let i=0;i<this.stack.length;i++){const route=this.stack[i];route.setPrefix(prefix);}return this};Router.prototype.routes=Router.prototype.middleware=function(){const router=this;let dispatch=function dispatch(ctx,next){debug("%s %s",ctx.method,ctx.path);const path=router.opts.routerPath||ctx.routerPath||ctx.path;const matched=router.match(path,ctx.method);let layerChain;if(ctx.matched){ctx.matched.push.apply(ctx.matched,matched.path);}else {ctx.matched=matched.path;}ctx.router=router;if(!matched.route)return next();const matchedLayers=matched.pathAndMethod;const mostSpecificLayer=matchedLayers[matchedLayers.length-1];ctx._matchedRoute=mostSpecificLayer.path;if(mostSpecificLayer.name){ctx._matchedRouteName=mostSpecificLayer.name;}layerChain=matchedLayers.reduce(function(memo,layer){memo.push(function(ctx,next){ctx.captures=layer.captures(path,ctx.captures);ctx.params=ctx.request.params=layer.params(path,ctx.captures,ctx.params);ctx.routerPath=layer.path;ctx.routerName=layer.name;ctx._matchedRoute=layer.path;if(layer.name){ctx._matchedRouteName=layer.name;}return next()});return memo.concat(layer.stack)},[]);return compose(layerChain)(ctx,next)};dispatch.router=this;return dispatch};Router.prototype.allowedMethods=function(options){options=options||{};const implemented=this.methods;return function allowedMethods(ctx,next){return next().then(function(){const allowed={};if(!ctx.status||ctx.status===404){for(let i=0;i<ctx.matched.length;i++){const route=ctx.matched[i];for(let j=0;j<route.methods.length;j++){const method=route.methods[j];allowed[method]=method;}}const allowedArr=Object.keys(allowed);if(!~implemented.indexOf(ctx.method)){if(options.throw){let notImplementedThrowable=typeof options.notImplemented==="function"?options.notImplemented():new HttpError.NotImplemented;throw notImplementedThrowable}else {ctx.status=501;ctx.set("Allow",allowedArr.join(", "));}}else if(allowedArr.length){if(ctx.method==="OPTIONS"){ctx.status=200;ctx.body="";ctx.set("Allow",allowedArr.join(", "));}else if(!allowed[ctx.method]){if(options.throw){let notAllowedThrowable=typeof options.methodNotAllowed==="function"?options.methodNotAllowed():new HttpError.MethodNotAllowed;throw notAllowedThrowable}else {ctx.status=405;ctx.set("Allow",allowedArr.join(", "));}}}}})}};Router.prototype.all=function(name,path,middleware){if(typeof path==="string"){middleware=Array.prototype.slice.call(arguments,2);}else {middleware=Array.prototype.slice.call(arguments,1);path=name;name=null;}this.register(path,methods,middleware,{name});return this};Router.prototype.redirect=function(source,destination,code){if(source[0]!=="/")source=this.url(source);if(destination[0]!=="/"&&!destination.includes("://"))destination=this.url(destination);return this.all(source,ctx=>{ctx.redirect(destination);ctx.status=code||301;})};Router.prototype.register=function(path,methods,middleware,opts){opts=opts||{};const router=this;const stack=this.stack;if(Array.isArray(path)){for(let i=0;i<path.length;i++){const curPath=path[i];router.register.call(router,curPath,methods,middleware,opts);}return this}const route=new Layer(path,methods,middleware,{end:opts.end===false?opts.end:true,name:opts.name,sensitive:opts.sensitive||this.opts.sensitive||false,strict:opts.strict||this.opts.strict||false,prefix:opts.prefix||this.opts.prefix||"",ignoreCaptures:opts.ignoreCaptures});if(this.opts.prefix){route.setPrefix(this.opts.prefix);}for(let i=0;i<Object.keys(this.params).length;i++){const param=Object.keys(this.params)[i];route.param(param,this.params[param]);}stack.push(route);debug("defined route %s %s",route.methods,route.path);return route};Router.prototype.route=function(name){const routes=this.stack;for(let len=routes.length,i=0;i<len;i++){if(routes[i].name&&routes[i].name===name)return routes[i]}return false};Router.prototype.url=function(name,params){const route=this.route(name);if(route){const args=Array.prototype.slice.call(arguments,1);return route.url.apply(route,args)}return new Error(`No route found for name: ${name}`)};Router.prototype.match=function(path,method){const layers=this.stack;let layer;const matched={path:[],pathAndMethod:[],route:false};for(let len=layers.length,i=0;i<len;i++){layer=layers[i];debug("test %s %s",layer.path,layer.regexp);if(layer.match(path)){matched.path.push(layer);if(layer.methods.length===0||~layer.methods.indexOf(method)){matched.pathAndMethod.push(layer);if(layer.methods.length)matched.route=true;}}}return matched};Router.prototype.param=function(param,middleware){this.params[param]=middleware;for(let i=0;i<this.stack.length;i++){const route=this.stack[i];route.param(param,middleware);}return this};Router.url=function(path){const args=Array.prototype.slice.call(arguments,1);return Layer.prototype.url.apply({path},args)};

const LOADER_ROOT_ROUTE_NAMESPACE="29af6f1b-7584-484a-b627-8b25d47021ec";let activeLoader;class Loader{constructor(options){_defineProperty(this,"framework",void 0);_defineProperty(this,"owner",void 0);_defineProperty(this,"server",void 0);_defineProperty(this,"controllersPath",void 0);_defineProperty(this,"trackedControllers",void 0);_defineProperty(this,"watcher",void 0);_defineProperty(this,"routers",void 0);_defineProperty(this,"routes",void 0);_defineProperty(this,"BuiltinModuleAPI",{load:Module__default["default"].prototype.load,require:Module__default["default"].prototype.require});this.framework=options.framework;this.owner=options.owner;this.server=options.server;this.controllersPath=options.controllersPath;this.trackedControllers=[];this.routers={};this.routes={};}get inDevMode(){return this.framework.inDevMode}async scanForControllers(postInitial=false){let trackingControllersCount=0;let discoveredControllers=this.trackedControllers;for(let controllerFile of await cinnamonInternals$1.fs.listRecursively(this.controllersPath)){if(controllerFile.endsWith(".ts")){const existingController=discoveredControllers.find(controller=>controller.path===controllerFile);const dateModified=await cinnamonInternals$1.fs.getLastModification(controllerFile);if(!existingController){discoveredControllers.push({path:controllerFile,dateModified,dirty:true});trackingControllersCount++;}else {if(!existingController.dateModified||dateModified.getTime()>existingController.dateModified.getTime()){existingController.dateModified=dateModified;existingController.dirty=true;}trackingControllersCount++;}}}if(postInitial){this.framework.getModule(Logger$2.prototype).info(`Changes detected. Reloaded ${trackingControllersCount} controller${trackingControllersCount!==1?"s":""}.`);}this.trackedControllers=discoveredControllers;return trackingControllersCount}async registerControllers(){this.unhookWithKoa();Object.keys(this.routes).forEach(route=>delete this.routes[route]);Object.keys(this.routers).forEach(router=>delete this.routers[router]);for(const controller of this.trackedControllers){const requireFn=this.inDevMode?this.hotRequire:this.BuiltinModuleAPI.require;if(activeLoader!=null){throw new Error("Attempted to lock already locked activeLoader interface.\n"+"This might happen if you run two web servers in development mode simultaneously.")}activeLoader=this;requireFn.call(this,controller.path);activeLoader=undefined;controller.dirty=false;}this.hookWithKoa();if(this.inDevMode){if(this.watcher){await this.watcher.close();}this.watcher=watch_1(this.trackedControllers.map(controller=>controller.path),{persistent:true,ignoreInitial:true});this.watcher.on("all",()=>{setTimeout(()=>{this.scanForControllers(true).then(_=>this.registerControllers());},100);});}}static loadRoute(routeData){if(!activeLoader){throw new Error("Attempted to lock missing activeLoader interface.\n"+"This would imply that a route attempted to register with a loader when that loader wasn't expecting it.")}if(Object.keys(activeLoader.routes).includes(routeData.identifier)){throw new Error("Duplicate route ID registered; this should be impossible.\n"+"Please ensure all route IDs are unique.")}activeLoader.routes[routeData.identifier]=routeData;}static loadController(controllerId,group){if(!activeLoader){throw new Error("Attempted to lock missing activeLoader interface.\n"+"This would imply that a controller attempted to register with a loader when that loader wasn't expecting it.")}if(Object.keys(activeLoader.routers).includes(controllerId)){throw new Error("Duplicate router for controller ID registered; this should be impossible.\n"+"Please ensure each controller has one and only one router.")}const prefix=`/${group.map(item=>item.replace(/^\/|\/$/g,"")).join("/")}`;const controllerRouter=new router({prefix});for(const route of Object.values(activeLoader.routes).filter(route=>route.controller===controllerId)){let routePath=route.path.replace(/\/$/g,"");if(!routePath.startsWith("/"))routePath=`/${routePath}`;const registerKoaRoute=controllerRouter[route.method.toLowerCase()];registerKoaRoute.call(controllerRouter,route.identifier,routePath,...route.middleware,route.handler);}activeLoader.routers[controllerId]=controllerRouter;}static loadMiddleware(routeId,fn){if(!activeLoader){throw new Error("Attempted to lock missing activeLoader interface.\n"+"This would imply that a controller attempted to register with a loader when that loader wasn't expecting it.")}if(!activeLoader.routes[routeId]){throw new Error("Attempted to register middleware for invalid route.")}activeLoader.routes[routeId].middleware.push(fn);}hotRequire(request,caller){if(!caller)caller=require.main;const exports=this.BuiltinModuleAPI.require.call(caller,request);const controller=this.trackedControllers.find(controller=>controller.path===request);let modulePath;try{modulePath=Module__default["default"]._resolveFilename(request,caller);}catch(ex){return exports}if(!controller)return exports;if(modulePath){delete require.cache[modulePath];}return exports}hookWithKoa(){const routers=this.routers;this.server.use(co_1.wrap(function*(ctx,next){for(const handler of Object.values(routers)){yield handler.routes()(ctx,async()=>{});yield handler.allowedMethods()(ctx,async()=>{});}yield next();}));const self=this;this.server.use(co_1.wrap(function*(ctx,next){const start=new Date().getTime();yield next();const responseTimeMs=new Date().getTime()-start;const statusCode=ctx.status;if(!self.owner.isLoggingEnabled&&statusCode<500)return;let status=`[${statusCode}]`;if(statusCode>=100&&statusCode<200)status=source.cyanBright(status);else if(statusCode>=200&&statusCode<300)status=source.greenBright(status);else if(statusCode>=300&&statusCode<400)status=source.blueBright(status);else if(statusCode>=400&&statusCode<500)status=source.redBright(status);else if(statusCode>=500)status=source.bgRedBright(status);if(statusCode<400)self.owner.logger.debug(`${status} ${ctx.method} ${ctx.path} (${responseTimeMs}ms) - ${ctx.headers["user-agent"]}`);else self.owner.logger.error(`${status} ${ctx.method} ${ctx.path} (${responseTimeMs}ms) - ${ctx.headers["user-agent"]}`);}));}unhookWithKoa(){this.server.middleware=[];}}

exports.Method = void 0;(function(Method){Method["GET"]="GET";Method["HEAD"]="HEAD";Method["TRACE"]="TRACE";Method["POST"]="POST";Method["PUT"]="PUT";Method["DELETE"]="DELETE";Method["OPTIONS"]="OPTIONS";Method["PATCH"]="PATCH";})(exports.Method||(exports.Method={}));

const rnds8Pool=new Uint8Array(256);let poolPtr=rnds8Pool.length;function rng(){if(poolPtr>rnds8Pool.length-16){crypto__default["default"].randomFillSync(rnds8Pool);poolPtr=0;}return rnds8Pool.slice(poolPtr,poolPtr+=16)}

var REGEX = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

function validate(uuid){return typeof uuid==="string"&&REGEX.test(uuid)}

const byteToHex=[];for(let i=0;i<256;++i){byteToHex.push((i+256).toString(16).substr(1));}function stringify(arr,offset=0){const uuid=(byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]).toLowerCase();if(!validate(uuid)){throw TypeError("Stringified UUID is invalid")}return uuid}

function parse(uuid){if(!validate(uuid)){throw TypeError("Invalid UUID")}let v;const arr=new Uint8Array(16);arr[0]=(v=parseInt(uuid.slice(0,8),16))>>>24;arr[1]=v>>>16&255;arr[2]=v>>>8&255;arr[3]=v&255;arr[4]=(v=parseInt(uuid.slice(9,13),16))>>>8;arr[5]=v&255;arr[6]=(v=parseInt(uuid.slice(14,18),16))>>>8;arr[7]=v&255;arr[8]=(v=parseInt(uuid.slice(19,23),16))>>>8;arr[9]=v&255;arr[10]=(v=parseInt(uuid.slice(24,36),16))/1099511627776&255;arr[11]=v/4294967296&255;arr[12]=v>>>24&255;arr[13]=v>>>16&255;arr[14]=v>>>8&255;arr[15]=v&255;return arr}

function stringToBytes(str){str=unescape(encodeURIComponent(str));const bytes=[];for(let i=0;i<str.length;++i){bytes.push(str.charCodeAt(i));}return bytes}const DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";const URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(name,version,hashfunc){function generateUUID(value,namespace,buf,offset){if(typeof value==="string"){value=stringToBytes(value);}if(typeof namespace==="string"){namespace=parse(namespace);}if(namespace.length!==16){throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)")}let bytes=new Uint8Array(16+value.length);bytes.set(namespace);bytes.set(value,namespace.length);bytes=hashfunc(bytes);bytes[6]=bytes[6]&15|version;bytes[8]=bytes[8]&63|128;if(buf){offset=offset||0;for(let i=0;i<16;++i){buf[offset+i]=bytes[i];}return buf}return stringify(bytes)}try{generateUUID.name=name;}catch(err){}generateUUID.DNS=DNS;generateUUID.URL=URL;return generateUUID}

function v4(options,buf,offset){options=options||{};const rnds=options.random||(options.rng||rng)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){offset=offset||0;for(let i=0;i<16;++i){buf[offset+i]=rnds[i];}return buf}return stringify(rnds)}

function sha1(bytes){if(Array.isArray(bytes)){bytes=Buffer.from(bytes);}else if(typeof bytes==="string"){bytes=Buffer.from(bytes,"utf8");}return crypto__default["default"].createHash("sha1").update(bytes).digest()}

const v5=v35("v5",80,sha1);var uuidv5 = v5;

function Controller(...group){return function(target){if(!activeLoader)throw new Error("Failed to identify the active loader.");if(!target._loaderId){activeLoader.framework.getModule(Logger$2.prototype).warn(`Empty controller ${target.name} detected. Skipping loading.`);return}const classIdentifier=target._loaderId;const controller=uuidv5(classIdentifier,LOADER_ROOT_ROUTE_NAMESPACE);Loader.loadController(controller,group);}}

function Route(method,path){return function(target,propertyKey,descriptor){if(!target.constructor._loaderId){target.constructor._loaderId=v4();}const functionName=propertyKey;const handler=descriptor===null||descriptor===void 0?void 0:descriptor.value;if(handler==null)return;const controller=uuidv5(target.constructor._loaderId,LOADER_ROOT_ROUTE_NAMESPACE);const identifier=uuidv5(functionName,controller);if(activeLoader){Loader.loadRoute({identifier,controller,method,path,handler,middleware:[]});}else throw new Error("Failed to identify the active loader.")}}

function Middleware(fn){return function(target,propertyKey){if(!activeLoader)throw new Error("Failed to identify the active loader.");const classIdentifier=target.constructor._loaderId;const methodIdentifier=propertyKey;if(!classIdentifier||!methodIdentifier){activeLoader.framework.getModule(Logger$2.prototype).warn(`Attempted to register middleware on invalid route.`);return}const classNamespace=uuidv5(classIdentifier,LOADER_ROOT_ROUTE_NAMESPACE);const identifier=uuidv5(methodIdentifier,classNamespace);Loader.loadMiddleware(identifier,fn);}}

var WebServerModuleState;(function(WebServerModuleState){WebServerModuleState[WebServerModuleState["INITIAL"]=0]="INITIAL";WebServerModuleState[WebServerModuleState["READY"]=1]="READY";WebServerModuleState[WebServerModuleState["ONLINE"]=2]="ONLINE";WebServerModuleState[WebServerModuleState["ERRORED"]=3]="ERRORED";})(WebServerModuleState||(WebServerModuleState={}));class WebServer extends CinnamonModule{constructor(framework,controllersPath){super(framework);_defineProperty(this,"controllersPath",void 0);_defineProperty(this,"controllersLoader",void 0);_defineProperty(this,"currentState",void 0);_defineProperty(this,"enableLogging",void 0);_defineProperty(this,"server",void 0);_defineProperty(this,"underlyingServer",void 0);_defineProperty(this,"activeConnections",void 0);this.controllersPath=controllersPath;this.server=new mod;this.underlyingServer=undefined;this.activeConnections={};this.currentState=WebServerModuleState.INITIAL;this.enableLogging=false;this.controllersLoader=new Loader({framework,owner:this,server:this.server,controllersPath:this.controllersPath});}get logger(){return this.framework.getModule(Logger$2.prototype)}get isLoggingEnabled(){return this.enableLogging}async initialize(){this.logger.frameworkDebug("WebServer module is loading route controllers now.");if(!(await cinnamonInternals$1.fs.directoryExists(this.controllersPath))){this.logger.error(`Unable to load web server controllers due to missing controllers directory: ${cinnamonInternals$1.fs.toAbsolutePath(this.controllersPath)}`);await this.framework.terminate(true);return}const trackingControllersCount=await this.controllersLoader.scanForControllers();this.logger.info(`Found ${trackingControllersCount} controller${trackingControllersCount!==1?"s":""}.`,"webserver");await this.controllersLoader.registerControllers();this.logger.frameworkDebug("The internal web server is ready to be started.");this.currentState=WebServerModuleState.READY;}async start(options){var _options$enable_loggi;if(this.enableLogging!==((_options$enable_loggi=options.enable_logging)!==null&&_options$enable_loggi!==void 0?_options$enable_loggi:false)){var _options$enable_loggi2;this.enableLogging=(_options$enable_loggi2=options.enable_logging)!==null&&_options$enable_loggi2!==void 0?_options$enable_loggi2:false;}if(this.currentState!=WebServerModuleState.READY){let reason="because it is in an invalid state.";if(this.currentState===WebServerModuleState.ONLINE)reason="because it is already running.";throw new Error(`The web server cannot be started ${reason}`)}return new Promise((resolve,_reject)=>{const reject=reason=>{this.currentState=WebServerModuleState.ERRORED;_reject(reason);};try{this.underlyingServer=this.server.listen(options.port,options.host,()=>{var _this$underlyingServe;if(this.underlyingServer==null)return reject("Failed to start web server!");this.logger.info(`Listening for web requests on: http://${options.host}:${options.port}/`);(_this$underlyingServe=this.underlyingServer)===null||_this$underlyingServe===void 0?void 0:_this$underlyingServe.on("connection",connection=>{const key=`${connection.remoteAddress}:${connection.remotePort}`;this.activeConnections[key]=connection;connection.on("close",()=>delete this.activeConnections[key]);});this.currentState=WebServerModuleState.READY;return resolve()});}catch(ex){reject(ex);}})}async terminate(){return new Promise((resolve,reject)=>{try{var _this$underlyingServe2;(_this$underlyingServe2=this.underlyingServer)===null||_this$underlyingServe2===void 0?void 0:_this$underlyingServe2.close(err=>{if(err)return reject(err);for(const key in this.activeConnections)this.activeConnections[key].destroy();this.currentState=WebServerModuleState.INITIAL;return resolve()});}catch(ex){reject(ex);}})}}

const CINNAMON_CORE_DEBUG_MODE=false;class Cinnamon{static get defaultInstance(){return Cinnamon._defaultInstance}constructor(props){var _props$devMode,_props$appName;_defineProperty(this,"devMode",void 0);_defineProperty(this,"appName",void 0);_defineProperty(this,"modules",void 0);this.devMode=(_props$devMode=props.devMode)!==null&&_props$devMode!==void 0?_props$devMode:false;this.appName=(_props$appName=props.appName)!==null&&_props$appName!==void 0?_props$appName:"cinnamon";this.modules=[];if(!Cinnamon._defaultInstance)Cinnamon._defaultInstance=this;}get inDevMode(){return this.devMode}hasModule(moduleType){try{return this.getModule(moduleType)}catch(ex){return false}}getModule(moduleType){const module=this.modules.find(module=>module.constructor.name===moduleType.constructor.name);if(module!=null)return module;else throw new Error("(!) Attempted to access unknown module: "+moduleType)}registerModule(module){if(this.hasModule(module))this.modules.splice(this.modules.indexOf(module),1);this.modules.push(module);}static async initialize(options){if(!(await cinnamonInternals$1.fs.fileExists("./cinnamon.toml"))){console.error(`(!) cinnamon.toml not found in ${process.cwd()}`);console.error(`(!) Please make sure your current working directory is the project's root directory and that your project's cinnamon.toml exists.`);return process.exit(1)}console.log("Initializing Cinnamon...");const projectConfigFile=await require$$0$3.promisify(require$$0__namespace.readFile)("./cinnamon.toml","utf-8");let projectConfig;try{projectConfig=cinnamonInternals$1.data.mergeObjectDeep({framework:{core:{development_mode:false},app:{name:"cinnamon"},http:{host:"0.0.0.0",port:5213,enable_logging:false},database:{},structure:{controllers:"src/controllers/",models:"src/models/"}},app:{}},toml.parse(projectConfigFile));}catch(ex){console.error(`(!) Failed to parse cinnamon.toml:`);console.error(`(!) ...parsing failed on line ${ex.line}, at column ${ex.column}: ${ex.message}`);return process.exit(2)}let forceDevMode=false;if(process.env.NODE_ENV&&process.env.NODE_ENV.toLowerCase()==="development"){forceDevMode=true;projectConfig.framework.core.development_mode=forceDevMode;}const framework=new Cinnamon({devMode:forceDevMode?forceDevMode:projectConfig.framework.core.development_mode,appName:projectConfig.framework.app.name});framework.registerModule(new Config(framework,projectConfig.app,options===null||options===void 0?void 0:options.appConfigSchema));framework.registerModule(new Logger$2(framework,framework.devMode,{showFrameworkDebugMessages:CINNAMON_CORE_DEBUG_MODE}));framework.getModule(Logger$2.prototype).info("Starting Cinnamon...");if(framework.devMode)framework.getModule(Logger$2.prototype).warn("Application running in DEVELOPMENT mode.");try{framework.getModule(Logger$2.prototype).info("Initializing database and ORM models...");const modelsPath=cinnamonInternals$1.fs.toAbsolutePath(projectConfig.framework.structure.models);if(!(await cinnamonInternals$1.fs.directoryExists(modelsPath))){framework.getModule(Logger$2.prototype).error(`(!) The specified models path does not exist: ${projectConfig.framework.structure.models}`);framework.getModule(Logger$2.prototype).error(`(!) Full resolved path: ${modelsPath}`);process.exit(3);}framework.registerModule(new Database(framework,modelsPath));await framework.getModule(Database.prototype).initialize(projectConfig.framework.database);framework.getModule(Logger$2.prototype).info("Successfully initialized database ORM and models.");framework.getModule(Logger$2.prototype).info("Initializing web service controllers...");const controllersPath=cinnamonInternals$1.fs.toAbsolutePath(projectConfig.framework.structure.controllers);if(!(await cinnamonInternals$1.fs.directoryExists(controllersPath))){framework.getModule(Logger$2.prototype).error(`(!) The specified controllers path does not exist: ${projectConfig.framework.structure.controllers}`);framework.getModule(Logger$2.prototype).error(`(!) Full resolved path: ${controllersPath}`);process.exit(3);}framework.registerModule(new WebServer(framework,controllersPath));await framework.getModule(WebServer.prototype).initialize();framework.getModule(Logger$2.prototype).info("Successfully initialized web service controllers.");if(Cinnamon.defaultInstance==framework)initializeCoreModules({Config:framework.getModule(Config.prototype),Logger:framework.getModule(Logger$2.prototype),Database:framework.getModule(Database.prototype)});await framework.getModule(WebServer.prototype).start(projectConfig.framework.http);return framework}catch(ex){framework.getModule(Logger$2.prototype).error("Failed to start Cinnamon. If you believe this is a framework error, please open an issue in the "+"Cinnamon project repository.\n"+"(Apollo Software only): please consider opening an issue with the Internal Projects team."+"\n"+"https://github.com/apollosoftwarexyz/cinnamon/issues/new\n");framework.getModule(Logger$2.prototype).error(ex.message);console.error("");console.error(ex);process.exit(1);}}async terminate(inErrorState=false){await this.getModule(WebServer.prototype).terminate();process.exit(inErrorState?1:0);}}_defineProperty(Cinnamon,"_defaultInstance",void 0);

exports.$ = createValidator;
exports.Chalk = index;
exports.CinnamonModule = CinnamonModule;
exports.Controller = Controller;
exports.Koa = koa;
exports.Middleware = Middleware;
exports.Route = Route;
exports.ValidationResult = ValidationResult;
exports.Validator = Validator;
exports.createValidator = createValidator;
exports["default"] = Cinnamon;
exports.initializeCoreModules = initializeCoreModules;
